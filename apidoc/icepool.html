<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 11.1.0"/>
    <title>icepool API documentation</title>
            <link rel="icon" href="favicon.png"/>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(:first-of-type){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.pdoc details{filter:opacity(1);}.pdoc details:not([open]){height:0;}.pdoc details > summary{position:absolute;top:-35px;right:0;font-size:.75rem;color:var(--muted);padding:0 .7em;user-select:none;cursor:pointer;}.pdoc details > summary:focus{outline:0;}.pdoc > section:first-of-type details > summary{top:-20px;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc .headerlink{position:absolute;width:0;margin-left:-1.5rem;line-height:1.4rem;font-size:1.5rem;font-weight:normal;transition:all 100ms ease-in-out;opacity:0;user-select:none;}.pdoc .attr > .headerlink{margin-left:-2.5rem;}.pdoc *:hover > .headerlink,.pdoc *:target > .attr > .headerlink{opacity:1;}.pdoc .attr{display:block;color:var(--text);margin:.5rem 0 .5rem;padding:.4rem 5rem .4rem 1rem;background-color:var(--accent);}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{white-space:pre-wrap;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>




        <h2>API Documentation</h2>
            <ul class="memberlist">
            <li>
                    <a class="function" href="#Die">Die</a>
            </li>
            <li>
                    <a class="function" href="#standard">standard</a>
            </li>
            <li>
                    <a class="function" href="#d">d</a>
            </li>
            <li>
                    <a class="function" href="#__getattr__">__getattr__</a>
            </li>
            <li>
                    <a class="function" href="#bernoulli">bernoulli</a>
            </li>
            <li>
                    <a class="function" href="#coin">coin</a>
            </li>
            <li>
                    <a class="class" href="#BaseDie">BaseDie</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#BaseDie.__init__">BaseDie</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.ndim">ndim</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.markdown">markdown</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.outcomes">outcomes</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.num_outcomes">num_outcomes</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.is_empty">is_empty</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.weights">weights</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.has_zero_weights">has_zero_weights</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.items">items</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.denominator">denominator</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.total_weight">total_weight</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.pmf">pmf</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.cweights">cweights</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.sweights">sweights</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.cdf">cdf</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.sf">sf</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.weight_eq">weight_eq</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.weight_ne">weight_ne</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.weight_le">weight_le</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.weight_lt">weight_lt</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.weight_ge">weight_ge</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.weight_gt">weight_gt</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.probability">probability</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.mode">mode</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.modal_weight">modal_weight</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.ks_stat">ks_stat</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.cvm_stat">cvm_stat</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.reduce">reduce</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.scale_weights">scale_weights</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.min_outcome">min_outcome</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.max_outcome">max_outcome</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.nearest_le">nearest_le</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.nearest_ge">nearest_ge</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.reroll">reroll</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.reroll_until">reroll_until</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.truncate">truncate</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.clip">clip</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.cond">cond</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.set_outcomes">set_outcomes</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.trim">trim</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.sub">sub</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.explode">explode</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.lowest">lowest</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.highest">highest</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.repeat_and_sum">repeat_and_sum</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.pool">pool</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.keep">keep</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.keep_highest">keep_highest</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.keep_highest_single">keep_highest_single</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.keep_lowest">keep_lowest</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.keep_lowest_single">keep_lowest_single</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.abs">abs</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.zero">zero</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.zero_outcome">zero_outcome</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.bool">bool</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.sign">sign</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.cmp">cmp</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.sample">sample</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.key_tuple">key_tuple</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.hash">hash</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseDie.equals">equals</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#EmptyDie">EmptyDie</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#EmptyDie.__init__">EmptyDie</a>
                        </li>
                        <li>
                                <a class="function" href="#EmptyDie.ndim">ndim</a>
                        </li>
                        <li>
                                <a class="function" href="#EmptyDie.markdown">markdown</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ScalarDie">ScalarDie</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ScalarDie.__init__">ScalarDie</a>
                        </li>
                        <li>
                                <a class="function" href="#ScalarDie.ndim">ndim</a>
                        </li>
                        <li>
                                <a class="function" href="#ScalarDie.d">d</a>
                        </li>
                        <li>
                                <a class="function" href="#ScalarDie.if_else">if_else</a>
                        </li>
                        <li>
                                <a class="function" href="#ScalarDie.median_left">median_left</a>
                        </li>
                        <li>
                                <a class="function" href="#ScalarDie.median_right">median_right</a>
                        </li>
                        <li>
                                <a class="function" href="#ScalarDie.median">median</a>
                        </li>
                        <li>
                                <a class="function" href="#ScalarDie.ppf_left">ppf_left</a>
                        </li>
                        <li>
                                <a class="function" href="#ScalarDie.ppf_right">ppf_right</a>
                        </li>
                        <li>
                                <a class="function" href="#ScalarDie.ppf">ppf</a>
                        </li>
                        <li>
                                <a class="function" href="#ScalarDie.mean">mean</a>
                        </li>
                        <li>
                                <a class="function" href="#ScalarDie.variance">variance</a>
                        </li>
                        <li>
                                <a class="function" href="#ScalarDie.standard_deviation">standard_deviation</a>
                        </li>
                        <li>
                                <a class="function" href="#ScalarDie.sd">sd</a>
                        </li>
                        <li>
                                <a class="function" href="#ScalarDie.standardized_moment">standardized_moment</a>
                        </li>
                        <li>
                                <a class="function" href="#ScalarDie.skewness">skewness</a>
                        </li>
                        <li>
                                <a class="function" href="#ScalarDie.excess_kurtosis">excess_kurtosis</a>
                        </li>
                        <li>
                                <a class="function" href="#ScalarDie.cartesian_product">cartesian_product</a>
                        </li>
                        <li>
                                <a class="function" href="#ScalarDie.markdown">markdown</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#VectorDie">VectorDie</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#VectorDie.__init__">VectorDie</a>
                        </li>
                        <li>
                                <a class="function" href="#VectorDie.ndim">ndim</a>
                        </li>
                        <li>
                                <a class="function" href="#VectorDie.marginal">marginal</a>
                        </li>
                        <li>
                                <a class="variable" href="#VectorDie.dim">dim</a>
                        </li>
                        <li>
                                <a class="function" href="#VectorDie.all">all</a>
                        </li>
                        <li>
                                <a class="function" href="#VectorDie.any">any</a>
                        </li>
                        <li>
                                <a class="function" href="#VectorDie.median_left">median_left</a>
                        </li>
                        <li>
                                <a class="function" href="#VectorDie.median_right">median_right</a>
                        </li>
                        <li>
                                <a class="function" href="#VectorDie.median">median</a>
                        </li>
                        <li>
                                <a class="function" href="#VectorDie.ppf_left">ppf_left</a>
                        </li>
                        <li>
                                <a class="function" href="#VectorDie.ppf_right">ppf_right</a>
                        </li>
                        <li>
                                <a class="function" href="#VectorDie.ppf">ppf</a>
                        </li>
                        <li>
                                <a class="function" href="#VectorDie.mean">mean</a>
                        </li>
                        <li>
                                <a class="function" href="#VectorDie.variance">variance</a>
                        </li>
                        <li>
                                <a class="function" href="#VectorDie.standard_deviation">standard_deviation</a>
                        </li>
                        <li>
                                <a class="function" href="#VectorDie.sd">sd</a>
                        </li>
                        <li>
                                <a class="function" href="#VectorDie.standardized_moment">standardized_moment</a>
                        </li>
                        <li>
                                <a class="function" href="#VectorDie.skewness">skewness</a>
                        </li>
                        <li>
                                <a class="function" href="#VectorDie.excess_kurtosis">excess_kurtosis</a>
                        </li>
                        <li>
                                <a class="function" href="#VectorDie.covariance">covariance</a>
                        </li>
                        <li>
                                <a class="function" href="#VectorDie.correlation">correlation</a>
                        </li>
                        <li>
                                <a class="function" href="#VectorDie.markdown">markdown</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#from_cweights">from_cweights</a>
            </li>
            <li>
                    <a class="function" href="#from_sweights">from_sweights</a>
            </li>
            <li>
                    <a class="function" href="#from_rv">from_rv</a>
            </li>
            <li>
                    <a class="function" href="#align">align</a>
            </li>
            <li>
                    <a class="function" href="#align_range">align_range</a>
            </li>
            <li>
                    <a class="function" href="#lowest">lowest</a>
            </li>
            <li>
                    <a class="function" href="#highest">highest</a>
            </li>
            <li>
                    <a class="function" href="#max_outcome">max_outcome</a>
            </li>
            <li>
                    <a class="function" href="#min_outcome">min_outcome</a>
            </li>
            <li>
                    <a class="function" href="#apply">apply</a>
            </li>
            <li>
                    <a class="function" href="#dice_with_common_ndim">dice_with_common_ndim</a>
            </li>
            <li>
                    <a class="variable" href="#Reroll">Reroll</a>
            </li>
            <li>
                    <a class="class" href="#BasePool">BasePool</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#BasePool.outcomes">outcomes</a>
                        </li>
                        <li>
                                <a class="function" href="#BasePool.eval">eval</a>
                        </li>
                        <li>
                                <a class="function" href="#BasePool.sum">sum</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#Pool">Pool</a>
            </li>
            <li>
                    <a class="function" href="#standard_pool">standard_pool</a>
            </li>
            <li>
                    <a class="class" href="#DicePool">DicePool</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DicePool.__init__">DicePool</a>
                        </li>
                        <li>
                                <a class="function" href="#DicePool.die">die</a>
                        </li>
                        <li>
                                <a class="function" href="#DicePool.outcomes">outcomes</a>
                        </li>
                        <li>
                                <a class="function" href="#DicePool.count_dice">count_dice</a>
                        </li>
                        <li>
                                <a class="function" href="#DicePool.num_dice">num_dice</a>
                        </li>
                        <li>
                                <a class="function" href="#DicePool.set_count_dice">set_count_dice</a>
                        </li>
                        <li>
                                <a class="function" href="#DicePool.truncate_min">truncate_min</a>
                        </li>
                        <li>
                                <a class="function" href="#DicePool.truncate_max">truncate_max</a>
                        </li>
                        <li>
                                <a class="function" href="#DicePool.has_counted_dice">has_counted_dice</a>
                        </li>
                        <li>
                                <a class="function" href="#DicePool.sample">sample</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#EvalPool">EvalPool</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#EvalPool.next_state">next_state</a>
                        </li>
                        <li>
                                <a class="function" href="#EvalPool.final_outcome">final_outcome</a>
                        </li>
                        <li>
                                <a class="function" href="#EvalPool.direction">direction</a>
                        </li>
                        <li>
                                <a class="function" href="#EvalPool.ndim">ndim</a>
                        </li>
                        <li>
                                <a class="function" href="#EvalPool.eval">eval</a>
                        </li>
                        <li>
                                <a class="function" href="#EvalPool.bind_dice">bind_dice</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#WrapFuncEval">WrapFuncEval</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#WrapFuncEval.__init__">WrapFuncEval</a>
                        </li>
                        <li>
                                <a class="function" href="#WrapFuncEval.next_state">next_state</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SumPool">SumPool</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SumPool.__init__">SumPool</a>
                        </li>
                        <li>
                                <a class="function" href="#SumPool.next_state">next_state</a>
                        </li>
                        <li>
                                <a class="function" href="#SumPool.direction">direction</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="variable" href="#sum_pool">sum_pool</a>
            </li>
            <li>
                    <a class="class" href="#FindBestSet">FindBestSet</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#FindBestSet.__init__">FindBestSet</a>
                        </li>
                        <li>
                                <a class="function" href="#FindBestSet.next_state">next_state</a>
                        </li>
                        <li>
                                <a class="function" href="#FindBestSet.direction">direction</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#FindBestRun">FindBestRun</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#FindBestRun.__init__">FindBestRun</a>
                        </li>
                        <li>
                                <a class="function" href="#FindBestRun.next_state">next_state</a>
                        </li>
                        <li>
                                <a class="function" href="#FindBestRun.final_outcome">final_outcome</a>
                        </li>
                        <li>
                                <a class="function" href="#FindBestRun.direction">direction</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="variable" href="#d2">d2</a>
            </li>
            <li>
                    <a class="variable" href="#d3">d3</a>
            </li>
            <li>
                    <a class="variable" href="#d4">d4</a>
            </li>
            <li>
                    <a class="variable" href="#d6">d6</a>
            </li>
            <li>
                    <a class="variable" href="#d8">d8</a>
            </li>
            <li>
                    <a class="variable" href="#d10">d10</a>
            </li>
            <li>
                    <a class="variable" href="#d12">d12</a>
            </li>
            <li>
                    <a class="variable" href="#d20">d20</a>
            </li>
            <li>
                    <a class="variable" href="#d100">d100</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section>
                    <h1 class="modulename">
icepool    </h1>

                        <div class="docstring"><p>Package for computing dice probabilities.</p>

<p>See <a href="https://highdiceroller.github.io/icepool/notebooks/lab/index.html">this JupyterLite distribution</a> for examples.</p>

<p><a href="https://github.com/HighDiceRoller/icepool">Visit the project page.</a></p>

<p>General conventions:</p>

<ul>
<li>Unless explictly specified otherwise, all sorting is in ascending order.</li>
<li>The words "min" and "max" refer to outcomes, and the words "low" and "high" refer to dice in a pool.</li>
</ul>
</div>

                        <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="L-0"><a href="#L-0"><span class="linenos"> 0</span></a><span class="sd">&quot;&quot;&quot; Package for computing dice probabilities.</span>
</span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a><span class="sd">See [this JupyterLite distribution](https://highdiceroller.github.io/icepool/notebooks/lab/index.html) for examples.</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a><span class="sd">[Visit the project page.](https://github.com/HighDiceRoller/icepool)</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a><span class="sd">General conventions:</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a><span class="sd">* Unless explictly specified otherwise, all sorting is in ascending order.</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a><span class="sd">* The words &quot;min&quot; and &quot;max&quot; refer to outcomes, and the words &quot;low&quot; and &quot;high&quot; refer to dice in a pool.</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a><span class="n">__docformat__</span> <span class="o">=</span> <span class="s1">&#39;google&#39;</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a><span class="c1"># Expose certain names at top-level.</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a><span class="kn">from</span> <span class="nn">icepool.die.create</span> <span class="kn">import</span> <span class="n">Die</span><span class="p">,</span> <span class="n">dice_with_common_ndim</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a><span class="kn">from</span> <span class="nn">icepool.die.func</span> <span class="kn">import</span> <span class="n">standard</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="fm">__getattr__</span><span class="p">,</span> <span class="n">bernoulli</span><span class="p">,</span> <span class="n">coin</span><span class="p">,</span> <span class="n">from_cweights</span><span class="p">,</span> <span class="n">from_sweights</span><span class="p">,</span> <span class="n">from_rv</span><span class="p">,</span> <span class="n">align</span><span class="p">,</span> <span class="n">align_range</span><span class="p">,</span> <span class="n">apply</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a><span class="kn">import</span> <span class="nn">icepool.die.base</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a><span class="kn">from</span> <span class="nn">icepool.die.base</span> <span class="kn">import</span> <span class="n">BaseDie</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a><span class="kn">from</span> <span class="nn">icepool.die.empty</span> <span class="kn">import</span> <span class="n">EmptyDie</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a><span class="kn">from</span> <span class="nn">icepool.die.scalar</span> <span class="kn">import</span> <span class="n">ScalarDie</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">24</span></a><span class="kn">from</span> <span class="nn">icepool.die.vector</span> <span class="kn">import</span> <span class="n">VectorDie</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a><span class="n">highest</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">die</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">BaseDie</span><span class="o">.</span><span class="n">highest</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">27</span></a><span class="n">lowest</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">die</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">BaseDie</span><span class="o">.</span><span class="n">lowest</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a><span class="n">max_outcome</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">die</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">BaseDie</span><span class="o">.</span><span class="n">max_outcome</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">29</span></a><span class="n">min_outcome</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">die</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">BaseDie</span><span class="o">.</span><span class="n">min_outcome</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">30</span></a>
</span><span id="L-31"><a href="#L-31"><span class="linenos">31</span></a><span class="kn">from</span> <span class="nn">icepool.pool.base</span> <span class="kn">import</span> <span class="n">BasePool</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">32</span></a><span class="kn">from</span> <span class="nn">icepool.pool.pool</span> <span class="kn">import</span> <span class="n">Pool</span><span class="p">,</span> <span class="n">standard_pool</span><span class="p">,</span> <span class="n">DicePool</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">33</span></a><span class="kn">from</span> <span class="nn">icepool.pool.roll</span> <span class="kn">import</span> <span class="n">PoolRoll</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">34</span></a><span class="kn">from</span> <span class="nn">icepool.pool.eval</span> <span class="kn">import</span> <span class="n">EvalPool</span><span class="p">,</span> <span class="n">WrapFuncEval</span><span class="p">,</span> <span class="n">SumPool</span><span class="p">,</span> <span class="n">sum_pool</span><span class="p">,</span> <span class="n">FindBestSet</span><span class="p">,</span> <span class="n">FindBestRun</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos">36</span></a><span class="kn">import</span> <span class="nn">enum</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos">38</span></a><span class="k">class</span> <span class="nc">SpecialValue</span><span class="p">(</span><span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">39</span></a>    <span class="n">Reroll</span> <span class="o">=</span> <span class="s1">&#39;Reroll&#39;</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">40</span></a>
</span><span id="L-41"><a href="#L-41"><span class="linenos">41</span></a><span class="n">Reroll</span> <span class="o">=</span> <span class="n">SpecialValue</span><span class="o">.</span><span class="n">Reroll</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos">43</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Die&#39;</span><span class="p">,</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">44</span></a>    <span class="s1">&#39;standard&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;__getattr__&#39;</span><span class="p">,</span> <span class="s1">&#39;bernoulli&#39;</span><span class="p">,</span> <span class="s1">&#39;coin&#39;</span><span class="p">,</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">45</span></a>    <span class="s1">&#39;BaseDie&#39;</span><span class="p">,</span> <span class="s1">&#39;EmptyDie&#39;</span><span class="p">,</span> <span class="s1">&#39;ScalarDie&#39;</span><span class="p">,</span> <span class="s1">&#39;VectorDie&#39;</span><span class="p">,</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">46</span></a>    <span class="s1">&#39;from_cweights&#39;</span><span class="p">,</span> <span class="s1">&#39;from_sweights&#39;</span><span class="p">,</span> <span class="s1">&#39;from_rv&#39;</span><span class="p">,</span> <span class="s1">&#39;align&#39;</span><span class="p">,</span> <span class="s1">&#39;align_range&#39;</span><span class="p">,</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">47</span></a>    <span class="s1">&#39;lowest&#39;</span><span class="p">,</span> <span class="s1">&#39;highest&#39;</span><span class="p">,</span> <span class="s1">&#39;max_outcome&#39;</span><span class="p">,</span> <span class="s1">&#39;min_outcome&#39;</span><span class="p">,</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">48</span></a>    <span class="s1">&#39;apply&#39;</span><span class="p">,</span> <span class="s1">&#39;dice_with_common_ndim&#39;</span><span class="p">,</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">49</span></a>    <span class="s1">&#39;Reroll&#39;</span><span class="p">,</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">50</span></a>    <span class="s1">&#39;BasePool&#39;</span><span class="p">,</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">51</span></a>    <span class="s1">&#39;Pool&#39;</span><span class="p">,</span> <span class="s1">&#39;standard_pool&#39;</span><span class="p">,</span> <span class="s1">&#39;DicePool&#39;</span><span class="p">,</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">52</span></a>    <span class="c1"># &#39;PoolRoll&#39;,  # Not needed externally due to implicit casts</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">53</span></a>    <span class="s1">&#39;EvalPool&#39;</span><span class="p">,</span> <span class="s1">&#39;WrapFuncEval&#39;</span><span class="p">,</span> <span class="s1">&#39;SumPool&#39;</span><span class="p">,</span> <span class="s1">&#39;sum_pool&#39;</span><span class="p">,</span> <span class="s1">&#39;FindBestSet&#39;</span><span class="p">,</span> <span class="s1">&#39;FindBestRun&#39;</span><span class="p">,</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">54</span></a>    <span class="s1">&#39;d2&#39;</span><span class="p">,</span> <span class="s1">&#39;d3&#39;</span><span class="p">,</span> <span class="s1">&#39;d4&#39;</span><span class="p">,</span> <span class="s1">&#39;d6&#39;</span><span class="p">,</span> <span class="s1">&#39;d8&#39;</span><span class="p">,</span> <span class="s1">&#39;d10&#39;</span><span class="p">,</span> <span class="s1">&#39;d12&#39;</span><span class="p">,</span> <span class="s1">&#39;d20&#39;</span><span class="p">,</span> <span class="s1">&#39;d100&#39;</span><span class="p">]</span>
</span></pre></div>

        </details>

            </section>
                <section id="Die">
                            <div class="attr function"><a class="headerlink" href="#Die">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">Die</span><span class="signature">(
    *args,
    weights=None,
    min_outcome=None,
    ndim=None,
    denominator_method=&#39;lcm&#39;
)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Die-9"><a href="#Die-9"><span class="linenos">  9</span></a><span class="k">def</span> <span class="nf">Die</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">min_outcome</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">denominator_method</span><span class="o">=</span><span class="s1">&#39;lcm&#39;</span><span class="p">):</span>
</span><span id="Die-10"><a href="#Die-10"><span class="linenos"> 10</span></a>    <span class="sd">&quot;&quot;&quot; Factory for constructing a die.</span>
</span><span id="Die-11"><a href="#Die-11"><span class="linenos"> 11</span></a><span class="sd">    </span>
</span><span id="Die-12"><a href="#Die-12"><span class="linenos"> 12</span></a><span class="sd">    This is capitalized because it is the preferred way of getting a new instance,</span>
</span><span id="Die-13"><a href="#Die-13"><span class="linenos"> 13</span></a><span class="sd">    and so that you can use `from icepool import Die` while leaving the name `die` free.</span>
</span><span id="Die-14"><a href="#Die-14"><span class="linenos"> 14</span></a><span class="sd">    The actual class of the result will be one of the subclasses of `BaseDie`.</span>
</span><span id="Die-15"><a href="#Die-15"><span class="linenos"> 15</span></a><span class="sd">    </span>
</span><span id="Die-16"><a href="#Die-16"><span class="linenos"> 16</span></a><span class="sd">    Don&#39;t confuse this with `icepool.d()`:</span>
</span><span id="Die-17"><a href="#Die-17"><span class="linenos"> 17</span></a><span class="sd">    </span>
</span><span id="Die-18"><a href="#Die-18"><span class="linenos"> 18</span></a><span class="sd">    * `icepool.Die(6)`: A die that always rolls the `int` 6.</span>
</span><span id="Die-19"><a href="#Die-19"><span class="linenos"> 19</span></a><span class="sd">    * `icepool.d(6)`: A d6.</span>
</span><span id="Die-20"><a href="#Die-20"><span class="linenos"> 20</span></a><span class="sd">    </span>
</span><span id="Die-21"><a href="#Die-21"><span class="linenos"> 21</span></a><span class="sd">    Here are some different ways of constructing a d6:</span>
</span><span id="Die-22"><a href="#Die-22"><span class="linenos"> 22</span></a><span class="sd">    </span>
</span><span id="Die-23"><a href="#Die-23"><span class="linenos"> 23</span></a><span class="sd">    * Just import it: `from icepool import d6`</span>
</span><span id="Die-24"><a href="#Die-24"><span class="linenos"> 24</span></a><span class="sd">    * Use the `d()` function: `icepool.d(6)`</span>
</span><span id="Die-25"><a href="#Die-25"><span class="linenos"> 25</span></a><span class="sd">    * Use a d6 that you already have: `Die(d6)`</span>
</span><span id="Die-26"><a href="#Die-26"><span class="linenos"> 26</span></a><span class="sd">    * Mix a d3 and a d3+3: `Die(d3, d3+3)`</span>
</span><span id="Die-27"><a href="#Die-27"><span class="linenos"> 27</span></a><span class="sd">    * Use a dict: `Die({1:1, 2:1, 3:1, 4:1, 5:1, 6:1})`</span>
</span><span id="Die-28"><a href="#Die-28"><span class="linenos"> 28</span></a><span class="sd">    * Give the faces as args: `Die(1, 2, 3, 4, 5, 6)`</span>
</span><span id="Die-29"><a href="#Die-29"><span class="linenos"> 29</span></a><span class="sd">    </span>
</span><span id="Die-30"><a href="#Die-30"><span class="linenos"> 30</span></a><span class="sd">    Args:</span>
</span><span id="Die-31"><a href="#Die-31"><span class="linenos"> 31</span></a><span class="sd">        *args: Each of these arguments can be one of the following:</span>
</span><span id="Die-32"><a href="#Die-32"><span class="linenos"> 32</span></a><span class="sd">            * A single outcome, which must be hashable and comparable.</span>
</span><span id="Die-33"><a href="#Die-33"><span class="linenos"> 33</span></a><span class="sd">                The same outcome can appear multiple times,</span>
</span><span id="Die-34"><a href="#Die-34"><span class="linenos"> 34</span></a><span class="sd">                in which case it will be weighted proportionally higher.</span>
</span><span id="Die-35"><a href="#Die-35"><span class="linenos"> 35</span></a><span class="sd">            </span>
</span><span id="Die-36"><a href="#Die-36"><span class="linenos"> 36</span></a><span class="sd">                Note: An argument that is a sequence will be treated as a single outcome.</span>
</span><span id="Die-37"><a href="#Die-37"><span class="linenos"> 37</span></a><span class="sd">                If you want each element in the sequence to be a separate outcome,</span>
</span><span id="Die-38"><a href="#Die-38"><span class="linenos"> 38</span></a><span class="sd">                you need to unpack it into separate arguments.</span>
</span><span id="Die-39"><a href="#Die-39"><span class="linenos"> 39</span></a><span class="sd">            * A die. The `ndim` of the die must be preserved, or this is a `ValueError`.</span>
</span><span id="Die-40"><a href="#Die-40"><span class="linenos"> 40</span></a><span class="sd">                The outcomes of the die will be &quot;flattened&quot; in the result die.</span>
</span><span id="Die-41"><a href="#Die-41"><span class="linenos"> 41</span></a><span class="sd">            * A dict-like that maps outcomes to weights.</span>
</span><span id="Die-42"><a href="#Die-42"><span class="linenos"> 42</span></a><span class="sd">                This option will be taken in preference to treating the dict-like itself as an outcome</span>
</span><span id="Die-43"><a href="#Die-43"><span class="linenos"> 43</span></a><span class="sd">                even if the dict-like itself is hashable and comparable.</span>
</span><span id="Die-44"><a href="#Die-44"><span class="linenos"> 44</span></a><span class="sd">                </span>
</span><span id="Die-45"><a href="#Die-45"><span class="linenos"> 45</span></a><span class="sd">                Not recommended options:</span>
</span><span id="Die-46"><a href="#Die-46"><span class="linenos"> 46</span></a><span class="sd">                </span>
</span><span id="Die-47"><a href="#Die-47"><span class="linenos"> 47</span></a><span class="sd">                * If you want to use the dict-like itself as an outcome, wrap it in another dict.</span>
</span><span id="Die-48"><a href="#Die-48"><span class="linenos"> 48</span></a><span class="sd">                * The dict itself can contain `icepool.Reroll`.</span>
</span><span id="Die-49"><a href="#Die-49"><span class="linenos"> 49</span></a><span class="sd">                    This will only reroll within the dict, not the entire construction.</span>
</span><span id="Die-50"><a href="#Die-50"><span class="linenos"> 50</span></a><span class="sd">            * `icepool.Reroll`, which will drop itself</span>
</span><span id="Die-51"><a href="#Die-51"><span class="linenos"> 51</span></a><span class="sd">                and the corresponding element of `weights` from consideration.</span>
</span><span id="Die-52"><a href="#Die-52"><span class="linenos"> 52</span></a><span class="sd">        weights: Controls the relative weight of the arguments.</span>
</span><span id="Die-53"><a href="#Die-53"><span class="linenos"> 53</span></a><span class="sd">            If not provided, each argument will end up with the same total weight,</span>
</span><span id="Die-54"><a href="#Die-54"><span class="linenos"> 54</span></a><span class="sd">            unless they have zero weight to begin with.</span>
</span><span id="Die-55"><a href="#Die-55"><span class="linenos"> 55</span></a><span class="sd">            For example, `Die(d6, 7)` is the same as `Die(1, 2, 3, 4, 5, 6, 7, 7, 7, 7, 7, 7)`.</span>
</span><span id="Die-56"><a href="#Die-56"><span class="linenos"> 56</span></a><span class="sd">        min_outcome: If used, there must be zero `*args` and `weights` must be provided.</span>
</span><span id="Die-57"><a href="#Die-57"><span class="linenos"> 57</span></a><span class="sd">            The outcomes of the result will be integers starting at `min_outcome`,</span>
</span><span id="Die-58"><a href="#Die-58"><span class="linenos"> 58</span></a><span class="sd">            one per weight in `weights` with that weight.</span>
</span><span id="Die-59"><a href="#Die-59"><span class="linenos"> 59</span></a><span class="sd">        ndim: If set to `&#39;scalar&#39;`, the die will be forced to be scalar.</span>
</span><span id="Die-60"><a href="#Die-60"><span class="linenos"> 60</span></a><span class="sd">            If set to an `int`, the die will be forced to be vector with that number of dimensions.</span>
</span><span id="Die-61"><a href="#Die-61"><span class="linenos"> 61</span></a><span class="sd">            If not provided, this will be automatically detected.</span>
</span><span id="Die-62"><a href="#Die-62"><span class="linenos"> 62</span></a><span class="sd">            If all arguments are `tuple`s of the same length,</span>
</span><span id="Die-63"><a href="#Die-63"><span class="linenos"> 63</span></a><span class="sd">            the result will have that many dimensions.</span>
</span><span id="Die-64"><a href="#Die-64"><span class="linenos"> 64</span></a><span class="sd">            Otherwise the result will be scalar.</span>
</span><span id="Die-65"><a href="#Die-65"><span class="linenos"> 65</span></a><span class="sd">        denominator_method: How to determine the denominator of the result</span>
</span><span id="Die-66"><a href="#Die-66"><span class="linenos"> 66</span></a><span class="sd">            if the arguments themselves contain weights.</span>
</span><span id="Die-67"><a href="#Die-67"><span class="linenos"> 67</span></a><span class="sd">            From greatest to least:</span>
</span><span id="Die-68"><a href="#Die-68"><span class="linenos"> 68</span></a><span class="sd">            * &#39;prod&#39;: Product of the individual argument denominators, times the total of `weights`.</span>
</span><span id="Die-69"><a href="#Die-69"><span class="linenos"> 69</span></a><span class="sd">                This is like rolling all of the possible dice, and then selecting a result.</span>
</span><span id="Die-70"><a href="#Die-70"><span class="linenos"> 70</span></a><span class="sd">            * &#39;lcm&#39; (default): LCM of the individual argument denominators, times the total of `weights`.</span>
</span><span id="Die-71"><a href="#Die-71"><span class="linenos"> 71</span></a><span class="sd">                This is like rolling `weights` first, then selecting an argument to roll.</span>
</span><span id="Die-72"><a href="#Die-72"><span class="linenos"> 72</span></a><span class="sd">            * &#39;lcm_weighted&#39;: LCM of the individual (argument denominators times corresponding element of `weights`).</span>
</span><span id="Die-73"><a href="#Die-73"><span class="linenos"> 73</span></a><span class="sd">                This is like rolling the above, but the specific weight rolled</span>
</span><span id="Die-74"><a href="#Die-74"><span class="linenos"> 74</span></a><span class="sd">                is used to help determine the result of the selected argument.</span>
</span><span id="Die-75"><a href="#Die-75"><span class="linenos"> 75</span></a><span class="sd">            * &#39;reduce&#39;: `reduce()` is called at the end.</span>
</span><span id="Die-76"><a href="#Die-76"><span class="linenos"> 76</span></a><span class="sd">    Raises:</span>
</span><span id="Die-77"><a href="#Die-77"><span class="linenos"> 77</span></a><span class="sd">        `ValueError` if `ndim` is set but is not consistent with `*args`,</span>
</span><span id="Die-78"><a href="#Die-78"><span class="linenos"> 78</span></a><span class="sd">            or there is a mismatch between the `ndim` of die arguments.</span>
</span><span id="Die-79"><a href="#Die-79"><span class="linenos"> 79</span></a><span class="sd">            Furthermore, `None` is not a valid outcome for a die.</span>
</span><span id="Die-80"><a href="#Die-80"><span class="linenos"> 80</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Die-81"><a href="#Die-81"><span class="linenos"> 81</span></a>    
</span><span id="Die-82"><a href="#Die-82"><span class="linenos"> 82</span></a>    <span class="k">if</span> <span class="n">min_outcome</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Die-83"><a href="#Die-83"><span class="linenos"> 83</span></a>        <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Die-84"><a href="#Die-84"><span class="linenos"> 84</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;If min_outcome is provided, weights must also be provided.&#39;</span><span class="p">)</span>
</span><span id="Die-85"><a href="#Die-85"><span class="linenos"> 85</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Die-86"><a href="#Die-86"><span class="linenos"> 86</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;If min_outcome is provided, no *args may be used.&#39;</span><span class="p">)</span>
</span><span id="Die-87"><a href="#Die-87"><span class="linenos"> 87</span></a>        <span class="k">if</span> <span class="n">ndim</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;scalar&#39;</span><span class="p">]:</span>
</span><span id="Die-88"><a href="#Die-88"><span class="linenos"> 88</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;If min_outcome is provided, the result may only be a scalar die.&#39;</span><span class="p">)</span>
</span><span id="Die-89"><a href="#Die-89"><span class="linenos"> 89</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">Counts</span><span class="p">({</span><span class="n">i</span> <span class="o">+</span> <span class="n">min_outcome</span> <span class="p">:</span> <span class="n">weight</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">weights</span><span class="p">)})</span>
</span><span id="Die-90"><a href="#Die-90"><span class="linenos"> 90</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="Die-91"><a href="#Die-91"><span class="linenos"> 91</span></a>    
</span><span id="Die-92"><a href="#Die-92"><span class="linenos"> 92</span></a>    <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Die-93"><a href="#Die-93"><span class="linenos"> 93</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
</span><span id="Die-94"><a href="#Die-94"><span class="linenos"> 94</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;If weights are provided, there must be exactly one weight per argument.&#39;</span><span class="p">)</span>
</span><span id="Die-95"><a href="#Die-95"><span class="linenos"> 95</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Die-96"><a href="#Die-96"><span class="linenos"> 96</span></a>        <span class="n">weights</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</span><span id="Die-97"><a href="#Die-97"><span class="linenos"> 97</span></a>    
</span><span id="Die-98"><a href="#Die-98"><span class="linenos"> 98</span></a>    <span class="c1"># Remove rerolls.</span>
</span><span id="Die-99"><a href="#Die-99"><span class="linenos"> 99</span></a>    <span class="n">args_weights</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">((</span><span class="n">arg</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span> <span class="k">if</span> <span class="n">arg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Reroll</span><span class="p">)))</span>
</span><span id="Die-100"><a href="#Die-100"><span class="linenos">100</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args_weights</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Die-101"><a href="#Die-101"><span class="linenos">101</span></a>        <span class="n">args</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="p">(),</span> <span class="p">()</span>
</span><span id="Die-102"><a href="#Die-102"><span class="linenos">102</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Die-103"><a href="#Die-103"><span class="linenos">103</span></a>        <span class="n">args</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">args_weights</span>
</span><span id="Die-104"><a href="#Die-104"><span class="linenos">104</span></a>    <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
</span><span id="Die-105"><a href="#Die-105"><span class="linenos">105</span></a>        <span class="k">if</span> <span class="n">_is_dict</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="ow">and</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Reroll</span> <span class="ow">in</span> <span class="n">arg</span><span class="p">:</span>
</span><span id="Die-106"><a href="#Die-106"><span class="linenos">106</span></a>            <span class="k">del</span> <span class="n">arg</span><span class="p">[</span><span class="n">icepool</span><span class="o">.</span><span class="n">Reroll</span><span class="p">]</span>
</span><span id="Die-107"><a href="#Die-107"><span class="linenos">107</span></a>    
</span><span id="Die-108"><a href="#Die-108"><span class="linenos">108</span></a>    <span class="c1"># Special cases.</span>
</span><span id="Die-109"><a href="#Die-109"><span class="linenos">109</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Die-110"><a href="#Die-110"><span class="linenos">110</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">EmptyDie</span><span class="p">()</span>
</span><span id="Die-111"><a href="#Die-111"><span class="linenos">111</span></a>    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">_is_die</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="n">weights</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Die-112"><a href="#Die-112"><span class="linenos">112</span></a>        <span class="c1"># Single unmodified die: just return the existing instance.</span>
</span><span id="Die-113"><a href="#Die-113"><span class="linenos">113</span></a>        <span class="k">return</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Die-114"><a href="#Die-114"><span class="linenos">114</span></a>    
</span><span id="Die-115"><a href="#Die-115"><span class="linenos">115</span></a>    <span class="c1"># Total weights.</span>
</span><span id="Die-116"><a href="#Die-116"><span class="linenos">116</span></a>    <span class="n">arg_denominators</span> <span class="o">=</span> <span class="p">[</span><span class="n">_arg_denominator</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
</span><span id="Die-117"><a href="#Die-117"><span class="linenos">117</span></a>    
</span><span id="Die-118"><a href="#Die-118"><span class="linenos">118</span></a>    <span class="k">if</span> <span class="n">denominator_method</span> <span class="o">==</span> <span class="s1">&#39;prod&#39;</span><span class="p">:</span>
</span><span id="Die-119"><a href="#Die-119"><span class="linenos">119</span></a>        <span class="n">denominator_prod</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">arg_denominators</span> <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Die-120"><a href="#Die-120"><span class="linenos">120</span></a>    <span class="k">elif</span> <span class="n">denominator_method</span> <span class="o">==</span> <span class="s1">&#39;lcm&#39;</span><span class="p">:</span>
</span><span id="Die-121"><a href="#Die-121"><span class="linenos">121</span></a>        <span class="n">denominator_prod</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">lcm</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">arg_denominators</span> <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="Die-122"><a href="#Die-122"><span class="linenos">122</span></a>    <span class="k">elif</span> <span class="n">denominator_method</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;lcm_weighted&#39;</span><span class="p">,</span> <span class="s1">&#39;reduce&#39;</span><span class="p">]:</span>
</span><span id="Die-123"><a href="#Die-123"><span class="linenos">123</span></a>        <span class="n">denominator_prod</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">lcm</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">d</span> <span class="o">//</span> <span class="n">math</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">arg_denominators</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span> <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="Die-124"><a href="#Die-124"><span class="linenos">124</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Die-125"><a href="#Die-125"><span class="linenos">125</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Invalid denominator_method </span><span class="si">{</span><span class="n">denominator_method</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
</span><span id="Die-126"><a href="#Die-126"><span class="linenos">126</span></a>    
</span><span id="Die-127"><a href="#Die-127"><span class="linenos">127</span></a>    <span class="c1"># Compute ndim.</span>
</span><span id="Die-128"><a href="#Die-128"><span class="linenos">128</span></a>    <span class="n">ndim</span> <span class="o">=</span> <span class="n">_calc_ndim</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">)</span>
</span><span id="Die-129"><a href="#Die-129"><span class="linenos">129</span></a>    
</span><span id="Die-130"><a href="#Die-130"><span class="linenos">130</span></a>    <span class="c1"># Make data.</span>
</span><span id="Die-131"><a href="#Die-131"><span class="linenos">131</span></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="Die-132"><a href="#Die-132"><span class="linenos">132</span></a>    <span class="k">for</span> <span class="n">arg</span><span class="p">,</span> <span class="n">arg_denominator</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">arg_denominators</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
</span><span id="Die-133"><a href="#Die-133"><span class="linenos">133</span></a>        <span class="n">factor</span> <span class="o">=</span> <span class="n">denominator_prod</span> <span class="o">*</span> <span class="n">w</span> <span class="o">//</span> <span class="n">arg_denominator</span> <span class="k">if</span> <span class="n">arg_denominator</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="Die-134"><a href="#Die-134"><span class="linenos">134</span></a>        <span class="k">if</span> <span class="n">_is_die</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="ow">or</span> <span class="n">_is_dict</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
</span><span id="Die-135"><a href="#Die-135"><span class="linenos">135</span></a>            <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="n">arg</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Die-136"><a href="#Die-136"><span class="linenos">136</span></a>                <span class="n">data</span><span class="p">[</span><span class="n">outcome</span><span class="p">]</span> <span class="o">+=</span> <span class="n">weight</span> <span class="o">*</span> <span class="n">factor</span>
</span><span id="Die-137"><a href="#Die-137"><span class="linenos">137</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Die-138"><a href="#Die-138"><span class="linenos">138</span></a>            <span class="n">data</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span> <span class="o">+=</span> <span class="n">factor</span>
</span><span id="Die-139"><a href="#Die-139"><span class="linenos">139</span></a>    
</span><span id="Die-140"><a href="#Die-140"><span class="linenos">140</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Die-141"><a href="#Die-141"><span class="linenos">141</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">EmptyDie</span><span class="p">()</span>
</span><span id="Die-142"><a href="#Die-142"><span class="linenos">142</span></a>    
</span><span id="Die-143"><a href="#Die-143"><span class="linenos">143</span></a>    <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
</span><span id="Die-144"><a href="#Die-144"><span class="linenos">144</span></a>        <span class="n">ndim</span> <span class="o">=</span> <span class="n">_arg_ndim</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">ndim</span><span class="p">)</span>
</span><span id="Die-145"><a href="#Die-145"><span class="linenos">145</span></a>    
</span><span id="Die-146"><a href="#Die-146"><span class="linenos">146</span></a>    <span class="k">if</span> <span class="n">ndim</span> <span class="o">==</span> <span class="s1">&#39;scalar&#39;</span><span class="p">:</span>
</span><span id="Die-147"><a href="#Die-147"><span class="linenos">147</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">Counts</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="Die-148"><a href="#Die-148"><span class="linenos">148</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="Die-149"><a href="#Die-149"><span class="linenos">149</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Die-150"><a href="#Die-150"><span class="linenos">150</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">Counts</span><span class="p">({</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">})</span>
</span><span id="Die-151"><a href="#Die-151"><span class="linenos">151</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">VectorDie</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="p">)</span>
</span><span id="Die-152"><a href="#Die-152"><span class="linenos">152</span></a>    
</span><span id="Die-153"><a href="#Die-153"><span class="linenos">153</span></a>    <span class="k">if</span> <span class="n">denominator_method</span> <span class="o">==</span> <span class="s1">&#39;reduce&#39;</span><span class="p">:</span>
</span><span id="Die-154"><a href="#Die-154"><span class="linenos">154</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span>
</span><span id="Die-155"><a href="#Die-155"><span class="linenos">155</span></a>    
</span><span id="Die-156"><a href="#Die-156"><span class="linenos">156</span></a>    <span class="k">return</span> <span class="n">result</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Factory for constructing a die.</p>

<p>This is capitalized because it is the preferred way of getting a new instance,
and so that you can use <code>from icepool import Die</code> while leaving the name <code>die</code> free.
The actual class of the result will be one of the subclasses of <code><a href="#BaseDie">BaseDie</a></code>.</p>

<p>Don't confuse this with <code><a href="#d">icepool.d()</a></code>:</p>

<ul>
<li><code><a href="#Die">icepool.Die</a>(6)</code>: A die that always rolls the <code>int</code> 6.</li>
<li><code><a href="#d">icepool.d</a>(6)</code>: A d6.</li>
</ul>

<p>Here are some different ways of constructing a d6:</p>

<ul>
<li>Just import it: <code>from icepool import d6</code></li>
<li>Use the <code><a href="#d">d()</a></code> function: <code><a href="#d">icepool.d</a>(6)</code></li>
<li>Use a d6 that you already have: <code>Die(d6)</code></li>
<li>Mix a d3 and a d3+3: <code>Die(d3, d3+3)</code></li>
<li>Use a dict: <code>Die({1:1, 2:1, 3:1, 4:1, 5:1, 6:1})</code></li>
<li>Give the faces as args: <code>Die(1, 2, 3, 4, 5, 6)</code></li>
</ul>

<h6 id="args">Args</h6>

<ul>
<li><p><strong>*args:</strong>  Each of these arguments can be one of the following:</p>

<ul>
<li><p>A single outcome, which must be hashable and comparable.
The same outcome can appear multiple times,
in which case it will be weighted proportionally higher.</p>

<p>Note: An argument that is a sequence will be treated as a single outcome.
If you want each element in the sequence to be a separate outcome,
you need to unpack it into separate arguments.</p></li>
<li>A die. The <code>ndim</code> of the die must be preserved, or this is a <code>ValueError</code>.
The outcomes of the die will be "flattened" in the result die.</li>
<li><p>A dict-like that maps outcomes to weights.
This option will be taken in preference to treating the dict-like itself as an outcome
even if the dict-like itself is hashable and comparable.</p>

<p>Not recommended options:</p>

<ul>
<li>If you want to use the dict-like itself as an outcome, wrap it in another dict.</li>
<li>The dict itself can contain <code><a href="#Reroll">icepool.Reroll</a></code>.
This will only reroll within the dict, not the entire construction.</li>
</ul></li>
<li><code><a href="#Reroll">icepool.Reroll</a></code>, which will drop itself
and the corresponding element of <code>weights</code> from consideration.</li>
</ul></li>
<li><strong>weights:</strong>  Controls the relative weight of the arguments.
If not provided, each argument will end up with the same total weight,
unless they have zero weight to begin with.
For example, <code>Die(d6, 7)</code> is the same as <code>Die(1, 2, 3, 4, 5, 6, 7, 7, 7, 7, 7, 7)</code>.</li>
<li><strong>min_outcome:</strong>  If used, there must be zero <code>*args</code> and <code>weights</code> must be provided.
The outcomes of the result will be integers starting at <code><a href="#min_outcome">min_outcome</a></code>,
one per weight in <code>weights</code> with that weight.</li>
<li><strong>ndim:</strong>  If set to <code>'scalar'</code>, the die will be forced to be scalar.
If set to an <code>int</code>, the die will be forced to be vector with that number of dimensions.
If not provided, this will be automatically detected.
If all arguments are <code>tuple</code>s of the same length,
the result will have that many dimensions.
Otherwise the result will be scalar.</li>
<li><strong>denominator_method:</strong>  How to determine the denominator of the result
if the arguments themselves contain weights.
From greatest to least:
<ul>
<li>'prod': Product of the individual argument denominators, times the total of <code>weights</code>.
This is like rolling all of the possible dice, and then selecting a result.</li>
<li>'lcm' (default): LCM of the individual argument denominators, times the total of <code>weights</code>.
This is like rolling <code>weights</code> first, then selecting an argument to roll.</li>
<li>'lcm_weighted': LCM of the individual (argument denominators times corresponding element of <code>weights</code>).
This is like rolling the above, but the specific weight rolled
is used to help determine the result of the selected argument.</li>
<li>'reduce': <code>reduce()</code> is called at the end.</li>
</ul></li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><code>ValueError</code> if <code>ndim</code> is set but is not consistent with <code>*args</code>,
or there is a mismatch between the <code>ndim</code> of die arguments.
Furthermore, <code>None</code> is not a valid outcome for a die.</li>
</ul>
</div>


                </section>
                <section id="standard">
                            <div class="attr function"><a class="headerlink" href="#standard">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">standard</span><span class="signature">(num_sides)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="standard-9"><a href="#standard-9"><span class="linenos"> 9</span></a><span class="k">def</span> <span class="nf">standard</span><span class="p">(</span><span class="n">num_sides</span><span class="p">):</span>
</span><span id="standard-10"><a href="#standard-10"><span class="linenos">10</span></a>    <span class="sd">&quot;&quot;&quot; A standard die.</span>
</span><span id="standard-11"><a href="#standard-11"><span class="linenos">11</span></a><span class="sd">    </span>
</span><span id="standard-12"><a href="#standard-12"><span class="linenos">12</span></a><span class="sd">    Specifically, the outcomes are `int`s from `1` to `num_sides` inclusive, with weight 1 each. </span>
</span><span id="standard-13"><a href="#standard-13"><span class="linenos">13</span></a><span class="sd">    </span>
</span><span id="standard-14"><a href="#standard-14"><span class="linenos">14</span></a><span class="sd">    Don&#39;t confuse this with `icepool.Die()`:</span>
</span><span id="standard-15"><a href="#standard-15"><span class="linenos">15</span></a><span class="sd">    </span>
</span><span id="standard-16"><a href="#standard-16"><span class="linenos">16</span></a><span class="sd">    * `icepool.Die(6)`: A die that always rolls the integer 6.</span>
</span><span id="standard-17"><a href="#standard-17"><span class="linenos">17</span></a><span class="sd">    * `icepool.d(6)`: A d6.</span>
</span><span id="standard-18"><a href="#standard-18"><span class="linenos">18</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="standard-19"><a href="#standard-19"><span class="linenos">19</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_sides</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="standard-20"><a href="#standard-20"><span class="linenos">20</span></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Argument to standard() must be an int.&#39;</span><span class="p">)</span>
</span><span id="standard-21"><a href="#standard-21"><span class="linenos">21</span></a>    <span class="k">elif</span> <span class="n">num_sides</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="standard-22"><a href="#standard-22"><span class="linenos">22</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Standard die must have at least one side.&#39;</span><span class="p">)</span>
</span><span id="standard-23"><a href="#standard-23"><span class="linenos">23</span></a>    <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_sides</span><span class="p">,</span> <span class="n">min_outcome</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="s1">&#39;scalar&#39;</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>A standard die.</p>

<p>Specifically, the outcomes are <code>int</code>s from <code>1</code> to <code>num_sides</code> inclusive, with weight 1 each. </p>

<p>Don't confuse this with <code><a href="#Die">icepool.Die()</a></code>:</p>

<ul>
<li><code><a href="#Die">icepool.Die</a>(6)</code>: A die that always rolls the integer 6.</li>
<li><code><a href="#d">icepool.d</a>(6)</code>: A d6.</li>
</ul>
</div>


                </section>
                <section id="d">
                            <div class="attr function"><a class="headerlink" href="#d">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">d</span><span class="signature">(arg)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="d-25"><a href="#d-25"><span class="linenos">25</span></a><span class="k">def</span> <span class="nf">d</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
</span><span id="d-26"><a href="#d-26"><span class="linenos">26</span></a>    <span class="sd">&quot;&quot;&quot; Converts the argument to a standard die if it is not already a die.</span>
</span><span id="d-27"><a href="#d-27"><span class="linenos">27</span></a><span class="sd">    </span>
</span><span id="d-28"><a href="#d-28"><span class="linenos">28</span></a><span class="sd">    Args:</span>
</span><span id="d-29"><a href="#d-29"><span class="linenos">29</span></a><span class="sd">        arg: Either:</span>
</span><span id="d-30"><a href="#d-30"><span class="linenos">30</span></a><span class="sd">            * An `int`, which produces a standard die.</span>
</span><span id="d-31"><a href="#d-31"><span class="linenos">31</span></a><span class="sd">            * A die, which is returned itself.</span>
</span><span id="d-32"><a href="#d-32"><span class="linenos">32</span></a><span class="sd">    </span>
</span><span id="d-33"><a href="#d-33"><span class="linenos">33</span></a><span class="sd">    Returns:</span>
</span><span id="d-34"><a href="#d-34"><span class="linenos">34</span></a><span class="sd">        A die.</span>
</span><span id="d-35"><a href="#d-35"><span class="linenos">35</span></a><span class="sd">        </span>
</span><span id="d-36"><a href="#d-36"><span class="linenos">36</span></a><span class="sd">    Raises:</span>
</span><span id="d-37"><a href="#d-37"><span class="linenos">37</span></a><span class="sd">        `TypeError` if the argument is not an `int` or a die.</span>
</span><span id="d-38"><a href="#d-38"><span class="linenos">38</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="d-39"><a href="#d-39"><span class="linenos">39</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="d-40"><a href="#d-40"><span class="linenos">40</span></a>        <span class="k">return</span> <span class="n">standard</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
</span><span id="d-41"><a href="#d-41"><span class="linenos">41</span></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">icepool</span><span class="o">.</span><span class="n">BaseDie</span><span class="p">):</span>
</span><span id="d-42"><a href="#d-42"><span class="linenos">42</span></a>        <span class="k">return</span> <span class="n">arg</span>
</span><span id="d-43"><a href="#d-43"><span class="linenos">43</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="d-44"><a href="#d-44"><span class="linenos">44</span></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The argument to d() must be an int or a die.&#39;</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Converts the argument to a standard die if it is not already a die.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>arg:</strong>  Either:
<ul>
<li>An <code>int</code>, which produces a standard die.</li>
<li>A die, which is returned itself.</li>
</ul></li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A die.</p>
</blockquote>

<h6 id="raises">Raises</h6>

<ul>
<li><code>TypeError</code> if the argument is not an <code>int</code> or a die.</li>
</ul>
</div>


                </section>
                <section id="__getattr__">
                            <div class="attr function"><a class="headerlink" href="#__getattr__">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">__getattr__</span><span class="signature">(key)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="__getattr__-46"><a href="#__getattr__-46"><span class="linenos">46</span></a><span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
</span><span id="__getattr__-47"><a href="#__getattr__-47"><span class="linenos">47</span></a>    <span class="sd">&quot;&quot;&quot; Implements the `dX` syntax for standard die with no parentheses, e.g. `icepool.d6`. &quot;&quot;&quot;</span>
</span><span id="__getattr__-48"><a href="#__getattr__-48"><span class="linenos">48</span></a>    <span class="k">if</span> <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span>
</span><span id="__getattr__-49"><a href="#__getattr__-49"><span class="linenos">49</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__getattr__-50"><a href="#__getattr__-50"><span class="linenos">50</span></a>            <span class="k">return</span> <span class="n">standard</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
</span><span id="__getattr__-51"><a href="#__getattr__-51"><span class="linenos">51</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="__getattr__-52"><a href="#__getattr__-52"><span class="linenos">52</span></a>            <span class="k">pass</span>
</span><span id="__getattr__-53"><a href="#__getattr__-53"><span class="linenos">53</span></a>    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Implements the <code>dX</code> syntax for standard die with no parentheses, e.g. <code><a href="#d6">icepool.d6</a></code>.</p>
</div>


                </section>
                <section id="bernoulli">
                            <div class="attr function"><a class="headerlink" href="#bernoulli">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">bernoulli</span><span class="signature">(n, d)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="bernoulli-55"><a href="#bernoulli-55"><span class="linenos">55</span></a><span class="k">def</span> <span class="nf">bernoulli</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
</span><span id="bernoulli-56"><a href="#bernoulli-56"><span class="linenos">56</span></a>    <span class="sd">&quot;&quot;&quot; A die that rolls `True` with chance `n / d`, and `False` otherwise. &quot;&quot;&quot;</span>
</span><span id="bernoulli-57"><a href="#bernoulli-57"><span class="linenos">57</span></a>    <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">({</span><span class="kc">False</span> <span class="p">:</span> <span class="n">d</span> <span class="o">-</span> <span class="n">n</span><span class="p">,</span> <span class="kc">True</span> <span class="p">:</span> <span class="n">n</span><span class="p">},</span> <span class="n">ndim</span><span class="o">=</span><span class="s1">&#39;scalar&#39;</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>A die that rolls <code>True</code> with chance <code>n / d</code>, and <code>False</code> otherwise.</p>
</div>


                </section>
                <section id="coin">
                            <div class="attr function"><a class="headerlink" href="#coin">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">coin</span><span class="signature">(n, d)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="coin-55"><a href="#coin-55"><span class="linenos">55</span></a><span class="k">def</span> <span class="nf">bernoulli</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
</span><span id="coin-56"><a href="#coin-56"><span class="linenos">56</span></a>    <span class="sd">&quot;&quot;&quot; A die that rolls `True` with chance `n / d`, and `False` otherwise. &quot;&quot;&quot;</span>
</span><span id="coin-57"><a href="#coin-57"><span class="linenos">57</span></a>    <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">({</span><span class="kc">False</span> <span class="p">:</span> <span class="n">d</span> <span class="o">-</span> <span class="n">n</span><span class="p">,</span> <span class="kc">True</span> <span class="p">:</span> <span class="n">n</span><span class="p">},</span> <span class="n">ndim</span><span class="o">=</span><span class="s1">&#39;scalar&#39;</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>A die that rolls <code>True</code> with chance <code>n / d</code>, and <code>False</code> otherwise.</p>
</div>


                </section>
                <section id="BaseDie">
                                <div class="attr class">
        <a class="headerlink" href="#BaseDie">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">BaseDie</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie-15"><a href="#BaseDie-15"><span class="linenos"> 15</span></a><span class="k">class</span> <span class="nc">BaseDie</span><span class="p">():</span>
</span><span id="BaseDie-16"><a href="#BaseDie-16"><span class="linenos"> 16</span></a>    <span class="sd">&quot;&quot;&quot; Abstract base class for a die.</span>
</span><span id="BaseDie-17"><a href="#BaseDie-17"><span class="linenos"> 17</span></a><span class="sd">    </span>
</span><span id="BaseDie-18"><a href="#BaseDie-18"><span class="linenos"> 18</span></a><span class="sd">    A die is a sorted mapping of outcomes to `int` weights.</span>
</span><span id="BaseDie-19"><a href="#BaseDie-19"><span class="linenos"> 19</span></a><span class="sd">    </span>
</span><span id="BaseDie-20"><a href="#BaseDie-20"><span class="linenos"> 20</span></a><span class="sd">    Dice are immutable. Methods do not modify the die in-place;</span>
</span><span id="BaseDie-21"><a href="#BaseDie-21"><span class="linenos"> 21</span></a><span class="sd">    rather they return a die representing the result.</span>
</span><span id="BaseDie-22"><a href="#BaseDie-22"><span class="linenos"> 22</span></a><span class="sd">    </span>
</span><span id="BaseDie-23"><a href="#BaseDie-23"><span class="linenos"> 23</span></a><span class="sd">    It *is* (mostly) well-defined to have a die with zero-weight outcomes,</span>
</span><span id="BaseDie-24"><a href="#BaseDie-24"><span class="linenos"> 24</span></a><span class="sd">    even though this is not a proper probability distribution.</span>
</span><span id="BaseDie-25"><a href="#BaseDie-25"><span class="linenos"> 25</span></a><span class="sd">    These can be useful in a few cases, such as:</span>
</span><span id="BaseDie-26"><a href="#BaseDie-26"><span class="linenos"> 26</span></a><span class="sd">    </span>
</span><span id="BaseDie-27"><a href="#BaseDie-27"><span class="linenos"> 27</span></a><span class="sd">    * `DicePool` and `EvalPool` will iterate through zero-weight outcomes with 0 `count`,</span>
</span><span id="BaseDie-28"><a href="#BaseDie-28"><span class="linenos"> 28</span></a><span class="sd">        rather than `None` or skipping that outcome.</span>
</span><span id="BaseDie-29"><a href="#BaseDie-29"><span class="linenos"> 29</span></a><span class="sd">    * `icepool.align()` and the like are convenient for making dice share the same set of outcomes.</span>
</span><span id="BaseDie-30"><a href="#BaseDie-30"><span class="linenos"> 30</span></a><span class="sd">    </span>
</span><span id="BaseDie-31"><a href="#BaseDie-31"><span class="linenos"> 31</span></a><span class="sd">    However, zero-weight outcomes have a computational cost like any other outcome.</span>
</span><span id="BaseDie-32"><a href="#BaseDie-32"><span class="linenos"> 32</span></a><span class="sd">    Unless you have a specific use case in mind, it&#39;s best to leave them out if not necessary.</span>
</span><span id="BaseDie-33"><a href="#BaseDie-33"><span class="linenos"> 33</span></a><span class="sd">    </span>
</span><span id="BaseDie-34"><a href="#BaseDie-34"><span class="linenos"> 34</span></a><span class="sd">    Most operators and methods will not introduce zero-weight outcomes if their arguments do not have any.</span>
</span><span id="BaseDie-35"><a href="#BaseDie-35"><span class="linenos"> 35</span></a><span class="sd">    </span>
</span><span id="BaseDie-36"><a href="#BaseDie-36"><span class="linenos"> 36</span></a><span class="sd">    It&#39;s also possible to have &quot;empty&quot; dice with no outcomes at all,</span>
</span><span id="BaseDie-37"><a href="#BaseDie-37"><span class="linenos"> 37</span></a><span class="sd">    though these have little use other than being sentinel values.</span>
</span><span id="BaseDie-38"><a href="#BaseDie-38"><span class="linenos"> 38</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="BaseDie-39"><a href="#BaseDie-39"><span class="linenos"> 39</span></a>    
</span><span id="BaseDie-40"><a href="#BaseDie-40"><span class="linenos"> 40</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BaseDie-41"><a href="#BaseDie-41"><span class="linenos"> 41</span></a>    <span class="k">def</span> <span class="nf">ndim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-42"><a href="#BaseDie-42"><span class="linenos"> 42</span></a>        <span class="sd">&quot;&quot;&quot; Returns the number of dimensions if this is a `VectorDie`.</span>
</span><span id="BaseDie-43"><a href="#BaseDie-43"><span class="linenos"> 43</span></a><span class="sd">        </span>
</span><span id="BaseDie-44"><a href="#BaseDie-44"><span class="linenos"> 44</span></a><span class="sd">        Otherwise, returns `&#39;scalar&#39;` for a `ScalarDie` and `&#39;empty&#39;` for an `EmptyDie`.</span>
</span><span id="BaseDie-45"><a href="#BaseDie-45"><span class="linenos"> 45</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-46"><a href="#BaseDie-46"><span class="linenos"> 46</span></a>    
</span><span id="BaseDie-47"><a href="#BaseDie-47"><span class="linenos"> 47</span></a>    <span class="c1"># Abstract methods.</span>
</span><span id="BaseDie-48"><a href="#BaseDie-48"><span class="linenos"> 48</span></a>    
</span><span id="BaseDie-49"><a href="#BaseDie-49"><span class="linenos"> 49</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BaseDie-50"><a href="#BaseDie-50"><span class="linenos"> 50</span></a>    <span class="k">def</span> <span class="nf">_unary_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="BaseDie-51"><a href="#BaseDie-51"><span class="linenos"> 51</span></a>        <span class="sd">&quot;&quot;&quot; Returns a die representing the effect of performing the operation on the outcomes.</span>
</span><span id="BaseDie-52"><a href="#BaseDie-52"><span class="linenos"> 52</span></a><span class="sd">        </span>
</span><span id="BaseDie-53"><a href="#BaseDie-53"><span class="linenos"> 53</span></a><span class="sd">        This is used for the operators `-, +, abs, ~, round, trunc, floor, ceil`.</span>
</span><span id="BaseDie-54"><a href="#BaseDie-54"><span class="linenos"> 54</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-55"><a href="#BaseDie-55"><span class="linenos"> 55</span></a>    
</span><span id="BaseDie-56"><a href="#BaseDie-56"><span class="linenos"> 56</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BaseDie-57"><a href="#BaseDie-57"><span class="linenos"> 57</span></a>    <span class="k">def</span> <span class="nf">_binary_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="BaseDie-58"><a href="#BaseDie-58"><span class="linenos"> 58</span></a>        <span class="sd">&quot;&quot;&quot; Returns a die representing the effect of performing the operation on pairs of outcomes from the two dice.</span>
</span><span id="BaseDie-59"><a href="#BaseDie-59"><span class="linenos"> 59</span></a><span class="sd">        </span>
</span><span id="BaseDie-60"><a href="#BaseDie-60"><span class="linenos"> 60</span></a><span class="sd">        The other operand is cast to a die (using `icepool.Die`) before performing the operation.</span>
</span><span id="BaseDie-61"><a href="#BaseDie-61"><span class="linenos"> 61</span></a><span class="sd">        </span>
</span><span id="BaseDie-62"><a href="#BaseDie-62"><span class="linenos"> 62</span></a><span class="sd">        This is used for the operators `+, -, *, /, //, %, **, &lt;&lt;, &gt;&gt;, &amp;, |, ^, &lt;, &lt;=, &gt;=, &gt;, ==, !=`.</span>
</span><span id="BaseDie-63"><a href="#BaseDie-63"><span class="linenos"> 63</span></a><span class="sd">        Note that `*` multiplies outcomes directly; it is not the same as `@` or `d()`.</span>
</span><span id="BaseDie-64"><a href="#BaseDie-64"><span class="linenos"> 64</span></a><span class="sd">        </span>
</span><span id="BaseDie-65"><a href="#BaseDie-65"><span class="linenos"> 65</span></a><span class="sd">        Special operators:</span>
</span><span id="BaseDie-66"><a href="#BaseDie-66"><span class="linenos"> 66</span></a><span class="sd">            * The `@` operator rolls the left die, then rolls the right die that many times and sums the outcomes.</span>
</span><span id="BaseDie-67"><a href="#BaseDie-67"><span class="linenos"> 67</span></a><span class="sd">                Only the left side will be cast to a die; the right side must already be a die.</span>
</span><span id="BaseDie-68"><a href="#BaseDie-68"><span class="linenos"> 68</span></a><span class="sd">            * `==` and `!=` are applied across outcomes like the other operators.</span>
</span><span id="BaseDie-69"><a href="#BaseDie-69"><span class="linenos"> 69</span></a><span class="sd">                Unfortunately this means dice are not hashable by normal means.</span>
</span><span id="BaseDie-70"><a href="#BaseDie-70"><span class="linenos"> 70</span></a><span class="sd">                Custom functions can use `key_tuple()`, `equals()` and `hash()` as workarounds.</span>
</span><span id="BaseDie-71"><a href="#BaseDie-71"><span class="linenos"> 71</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-72"><a href="#BaseDie-72"><span class="linenos"> 72</span></a>    
</span><span id="BaseDie-73"><a href="#BaseDie-73"><span class="linenos"> 73</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BaseDie-74"><a href="#BaseDie-74"><span class="linenos"> 74</span></a>    <span class="k">def</span> <span class="nf">_wrap_unpack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
</span><span id="BaseDie-75"><a href="#BaseDie-75"><span class="linenos"> 75</span></a>        <span class="sd">&quot;&quot;&quot; Possibly wraps `func` so that outcomes are unpacked before giving it to `func`. &quot;&quot;&quot;</span>
</span><span id="BaseDie-76"><a href="#BaseDie-76"><span class="linenos"> 76</span></a>        
</span><span id="BaseDie-77"><a href="#BaseDie-77"><span class="linenos"> 77</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BaseDie-78"><a href="#BaseDie-78"><span class="linenos"> 78</span></a>    <span class="k">def</span> <span class="nf">markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="BaseDie-79"><a href="#BaseDie-79"><span class="linenos"> 79</span></a>        <span class="sd">&quot;&quot;&quot; Formats the die as a Markdown string. </span>
</span><span id="BaseDie-80"><a href="#BaseDie-80"><span class="linenos"> 80</span></a><span class="sd">        </span>
</span><span id="BaseDie-81"><a href="#BaseDie-81"><span class="linenos"> 81</span></a><span class="sd">        This will have the denominator and a table of outcomes and their probabilities.</span>
</span><span id="BaseDie-82"><a href="#BaseDie-82"><span class="linenos"> 82</span></a><span class="sd">        </span>
</span><span id="BaseDie-83"><a href="#BaseDie-83"><span class="linenos"> 83</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie-84"><a href="#BaseDie-84"><span class="linenos"> 84</span></a><span class="sd">            include_weights: Iff `True`, the table will have a column for weights.</span>
</span><span id="BaseDie-85"><a href="#BaseDie-85"><span class="linenos"> 85</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-86"><a href="#BaseDie-86"><span class="linenos"> 86</span></a>    
</span><span id="BaseDie-87"><a href="#BaseDie-87"><span class="linenos"> 87</span></a>    <span class="c1"># Basic access.</span>
</span><span id="BaseDie-88"><a href="#BaseDie-88"><span class="linenos"> 88</span></a>    
</span><span id="BaseDie-89"><a href="#BaseDie-89"><span class="linenos"> 89</span></a>    <span class="k">def</span> <span class="nf">outcomes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-90"><a href="#BaseDie-90"><span class="linenos"> 90</span></a>        <span class="sd">&quot;&quot;&quot; Returns an iterable into the sorted outcomes of the die. &quot;&quot;&quot;</span>
</span><span id="BaseDie-91"><a href="#BaseDie-91"><span class="linenos"> 91</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="BaseDie-92"><a href="#BaseDie-92"><span class="linenos"> 92</span></a>        
</span><span id="BaseDie-93"><a href="#BaseDie-93"><span class="linenos"> 93</span></a>    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">):</span>
</span><span id="BaseDie-94"><a href="#BaseDie-94"><span class="linenos"> 94</span></a>        <span class="k">return</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>
</span><span id="BaseDie-95"><a href="#BaseDie-95"><span class="linenos"> 95</span></a>        
</span><span id="BaseDie-96"><a href="#BaseDie-96"><span class="linenos"> 96</span></a>    <span class="k">def</span> <span class="nf">num_outcomes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-97"><a href="#BaseDie-97"><span class="linenos"> 97</span></a>        <span class="sd">&quot;&quot;&quot; Returns the number of outcomes (including those with zero weight). &quot;&quot;&quot;</span>
</span><span id="BaseDie-98"><a href="#BaseDie-98"><span class="linenos"> 98</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>
</span><span id="BaseDie-99"><a href="#BaseDie-99"><span class="linenos"> 99</span></a>    
</span><span id="BaseDie-100"><a href="#BaseDie-100"><span class="linenos">100</span></a>    <span class="fm">__len__</span> <span class="o">=</span> <span class="n">num_outcomes</span>
</span><span id="BaseDie-101"><a href="#BaseDie-101"><span class="linenos">101</span></a>    
</span><span id="BaseDie-102"><a href="#BaseDie-102"><span class="linenos">102</span></a>    <span class="k">def</span> <span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-103"><a href="#BaseDie-103"><span class="linenos">103</span></a>        <span class="sd">&quot;&quot;&quot; Returns `True` if this die has no outcomes. &quot;&quot;&quot;</span>
</span><span id="BaseDie-104"><a href="#BaseDie-104"><span class="linenos">104</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_outcomes</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
</span><span id="BaseDie-105"><a href="#BaseDie-105"><span class="linenos">105</span></a>    
</span><span id="BaseDie-106"><a href="#BaseDie-106"><span class="linenos">106</span></a>    <span class="k">def</span> <span class="nf">weights</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-107"><a href="#BaseDie-107"><span class="linenos">107</span></a>        <span class="sd">&quot;&quot;&quot; Returns an iterable into the weights of the die in outcome order. &quot;&quot;&quot;</span>
</span><span id="BaseDie-108"><a href="#BaseDie-108"><span class="linenos">108</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="BaseDie-109"><a href="#BaseDie-109"><span class="linenos">109</span></a>    
</span><span id="BaseDie-110"><a href="#BaseDie-110"><span class="linenos">110</span></a>    <span class="k">def</span> <span class="nf">has_zero_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-111"><a href="#BaseDie-111"><span class="linenos">111</span></a>        <span class="sd">&quot;&quot;&quot; Returns `True` iff `self` contains at least one outcome with zero weight. &quot;&quot;&quot;</span>
</span><span id="BaseDie-112"><a href="#BaseDie-112"><span class="linenos">112</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">has_zero_weights</span><span class="p">()</span>
</span><span id="BaseDie-113"><a href="#BaseDie-113"><span class="linenos">113</span></a>    
</span><span id="BaseDie-114"><a href="#BaseDie-114"><span class="linenos">114</span></a>    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-115"><a href="#BaseDie-115"><span class="linenos">115</span></a>        <span class="sd">&quot;&quot;&quot; Returns all outcome, weight pairs. &quot;&quot;&quot;</span>
</span><span id="BaseDie-116"><a href="#BaseDie-116"><span class="linenos">116</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="BaseDie-117"><a href="#BaseDie-117"><span class="linenos">117</span></a>        
</span><span id="BaseDie-118"><a href="#BaseDie-118"><span class="linenos">118</span></a>    <span class="c1"># Weights.</span>
</span><span id="BaseDie-119"><a href="#BaseDie-119"><span class="linenos">119</span></a>    
</span><span id="BaseDie-120"><a href="#BaseDie-120"><span class="linenos">120</span></a>    <span class="nd">@cached_property</span>
</span><span id="BaseDie-121"><a href="#BaseDie-121"><span class="linenos">121</span></a>    <span class="k">def</span> <span class="nf">_denominator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-122"><a href="#BaseDie-122"><span class="linenos">122</span></a>        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="BaseDie-123"><a href="#BaseDie-123"><span class="linenos">123</span></a>    
</span><span id="BaseDie-124"><a href="#BaseDie-124"><span class="linenos">124</span></a>    <span class="k">def</span> <span class="nf">denominator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-125"><a href="#BaseDie-125"><span class="linenos">125</span></a>        <span class="sd">&quot;&quot;&quot; The total weight of all outcomes. &quot;&quot;&quot;</span>
</span><span id="BaseDie-126"><a href="#BaseDie-126"><span class="linenos">126</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_denominator</span>
</span><span id="BaseDie-127"><a href="#BaseDie-127"><span class="linenos">127</span></a>    
</span><span id="BaseDie-128"><a href="#BaseDie-128"><span class="linenos">128</span></a>    <span class="n">total_weight</span> <span class="o">=</span> <span class="n">denominator</span>
</span><span id="BaseDie-129"><a href="#BaseDie-129"><span class="linenos">129</span></a>    
</span><span id="BaseDie-130"><a href="#BaseDie-130"><span class="linenos">130</span></a>    <span class="nd">@cached_property</span>
</span><span id="BaseDie-131"><a href="#BaseDie-131"><span class="linenos">131</span></a>    <span class="k">def</span> <span class="nf">_pmf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-132"><a href="#BaseDie-132"><span class="linenos">132</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">weight</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="k">for</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">())</span>
</span><span id="BaseDie-133"><a href="#BaseDie-133"><span class="linenos">133</span></a>    
</span><span id="BaseDie-134"><a href="#BaseDie-134"><span class="linenos">134</span></a>    <span class="k">def</span> <span class="nf">pmf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="BaseDie-135"><a href="#BaseDie-135"><span class="linenos">135</span></a>        <span class="sd">&quot;&quot;&quot; Probability mass function. The probability of rolling each outcome in order. </span>
</span><span id="BaseDie-136"><a href="#BaseDie-136"><span class="linenos">136</span></a><span class="sd">        </span>
</span><span id="BaseDie-137"><a href="#BaseDie-137"><span class="linenos">137</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie-138"><a href="#BaseDie-138"><span class="linenos">138</span></a><span class="sd">            percent: If set, the results will be in percent (i.e. total of 100.0).</span>
</span><span id="BaseDie-139"><a href="#BaseDie-139"><span class="linenos">139</span></a><span class="sd">                Otherwise, the total will be 1.0.</span>
</span><span id="BaseDie-140"><a href="#BaseDie-140"><span class="linenos">140</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-141"><a href="#BaseDie-141"><span class="linenos">141</span></a>        <span class="k">if</span> <span class="n">percent</span><span class="p">:</span>
</span><span id="BaseDie-142"><a href="#BaseDie-142"><span class="linenos">142</span></a>            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="mf">100.0</span> <span class="o">*</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pmf</span><span class="p">)</span>
</span><span id="BaseDie-143"><a href="#BaseDie-143"><span class="linenos">143</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie-144"><a href="#BaseDie-144"><span class="linenos">144</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pmf</span>
</span><span id="BaseDie-145"><a href="#BaseDie-145"><span class="linenos">145</span></a>    
</span><span id="BaseDie-146"><a href="#BaseDie-146"><span class="linenos">146</span></a>    <span class="nd">@cached_property</span>
</span><span id="BaseDie-147"><a href="#BaseDie-147"><span class="linenos">147</span></a>    <span class="k">def</span> <span class="nf">_cweights</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-148"><a href="#BaseDie-148"><span class="linenos">148</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">()))</span>
</span><span id="BaseDie-149"><a href="#BaseDie-149"><span class="linenos">149</span></a>    
</span><span id="BaseDie-150"><a href="#BaseDie-150"><span class="linenos">150</span></a>    <span class="k">def</span> <span class="nf">cweights</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-151"><a href="#BaseDie-151"><span class="linenos">151</span></a>        <span class="sd">&quot;&quot;&quot; Cumulative weights. The weight &lt;= each outcome in order. &quot;&quot;&quot;</span>
</span><span id="BaseDie-152"><a href="#BaseDie-152"><span class="linenos">152</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cweights</span>
</span><span id="BaseDie-153"><a href="#BaseDie-153"><span class="linenos">153</span></a>    
</span><span id="BaseDie-154"><a href="#BaseDie-154"><span class="linenos">154</span></a>    <span class="nd">@cached_property</span>
</span><span id="BaseDie-155"><a href="#BaseDie-155"><span class="linenos">155</span></a>    <span class="k">def</span> <span class="nf">_sweights</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-156"><a href="#BaseDie-156"><span class="linenos">156</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">operator</span><span class="o">.</span><span class="n">sub</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()))</span>
</span><span id="BaseDie-157"><a href="#BaseDie-157"><span class="linenos">157</span></a>    
</span><span id="BaseDie-158"><a href="#BaseDie-158"><span class="linenos">158</span></a>    <span class="k">def</span> <span class="nf">sweights</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-159"><a href="#BaseDie-159"><span class="linenos">159</span></a>        <span class="sd">&quot;&quot;&quot; Survival weights. The weight &gt;= each outcome in order. &quot;&quot;&quot;</span>
</span><span id="BaseDie-160"><a href="#BaseDie-160"><span class="linenos">160</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sweights</span>
</span><span id="BaseDie-161"><a href="#BaseDie-161"><span class="linenos">161</span></a>        
</span><span id="BaseDie-162"><a href="#BaseDie-162"><span class="linenos">162</span></a>    <span class="nd">@cached_property</span>
</span><span id="BaseDie-163"><a href="#BaseDie-163"><span class="linenos">163</span></a>    <span class="k">def</span> <span class="nf">_cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-164"><a href="#BaseDie-164"><span class="linenos">164</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">weight</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="k">for</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cweights</span><span class="p">())</span>
</span><span id="BaseDie-165"><a href="#BaseDie-165"><span class="linenos">165</span></a>    
</span><span id="BaseDie-166"><a href="#BaseDie-166"><span class="linenos">166</span></a>    <span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="BaseDie-167"><a href="#BaseDie-167"><span class="linenos">167</span></a>        <span class="sd">&quot;&quot;&quot; Cumulative distribution function. The chance of rolling &lt;= each outcome in order. </span>
</span><span id="BaseDie-168"><a href="#BaseDie-168"><span class="linenos">168</span></a><span class="sd">        </span>
</span><span id="BaseDie-169"><a href="#BaseDie-169"><span class="linenos">169</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie-170"><a href="#BaseDie-170"><span class="linenos">170</span></a><span class="sd">            percent: If set, the results will be in percent (i.e. total of 100.0).</span>
</span><span id="BaseDie-171"><a href="#BaseDie-171"><span class="linenos">171</span></a><span class="sd">                Otherwise, the total will be 1.0.</span>
</span><span id="BaseDie-172"><a href="#BaseDie-172"><span class="linenos">172</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-173"><a href="#BaseDie-173"><span class="linenos">173</span></a>        <span class="k">if</span> <span class="n">percent</span><span class="p">:</span>
</span><span id="BaseDie-174"><a href="#BaseDie-174"><span class="linenos">174</span></a>            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="mf">100.0</span> <span class="o">*</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cdf</span><span class="p">)</span>
</span><span id="BaseDie-175"><a href="#BaseDie-175"><span class="linenos">175</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie-176"><a href="#BaseDie-176"><span class="linenos">176</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cdf</span>
</span><span id="BaseDie-177"><a href="#BaseDie-177"><span class="linenos">177</span></a>        
</span><span id="BaseDie-178"><a href="#BaseDie-178"><span class="linenos">178</span></a>    <span class="nd">@cached_property</span>
</span><span id="BaseDie-179"><a href="#BaseDie-179"><span class="linenos">179</span></a>    <span class="k">def</span> <span class="nf">_sf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-180"><a href="#BaseDie-180"><span class="linenos">180</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">weight</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="k">for</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sweights</span><span class="p">())</span>
</span><span id="BaseDie-181"><a href="#BaseDie-181"><span class="linenos">181</span></a>    
</span><span id="BaseDie-182"><a href="#BaseDie-182"><span class="linenos">182</span></a>    <span class="k">def</span> <span class="nf">sf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="BaseDie-183"><a href="#BaseDie-183"><span class="linenos">183</span></a>        <span class="sd">&quot;&quot;&quot; Survival function. The chance of rolling &gt;= each outcome in order. </span>
</span><span id="BaseDie-184"><a href="#BaseDie-184"><span class="linenos">184</span></a><span class="sd">        </span>
</span><span id="BaseDie-185"><a href="#BaseDie-185"><span class="linenos">185</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie-186"><a href="#BaseDie-186"><span class="linenos">186</span></a><span class="sd">            percent: If set, the results will be in percent (i.e. total of 100.0).</span>
</span><span id="BaseDie-187"><a href="#BaseDie-187"><span class="linenos">187</span></a><span class="sd">                Otherwise, the total will be 1.0.</span>
</span><span id="BaseDie-188"><a href="#BaseDie-188"><span class="linenos">188</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-189"><a href="#BaseDie-189"><span class="linenos">189</span></a>        <span class="k">if</span> <span class="n">percent</span><span class="p">:</span>
</span><span id="BaseDie-190"><a href="#BaseDie-190"><span class="linenos">190</span></a>            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="mf">100.0</span> <span class="o">*</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sf</span><span class="p">)</span>
</span><span id="BaseDie-191"><a href="#BaseDie-191"><span class="linenos">191</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie-192"><a href="#BaseDie-192"><span class="linenos">192</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sf</span>
</span><span id="BaseDie-193"><a href="#BaseDie-193"><span class="linenos">193</span></a>    
</span><span id="BaseDie-194"><a href="#BaseDie-194"><span class="linenos">194</span></a>    <span class="k">def</span> <span class="nf">weight_eq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">):</span>
</span><span id="BaseDie-195"><a href="#BaseDie-195"><span class="linenos">195</span></a>        <span class="sd">&quot;&quot;&quot; Returns the weight of a single outcome, or 0 if not present. &quot;&quot;&quot;</span>
</span><span id="BaseDie-196"><a href="#BaseDie-196"><span class="linenos">196</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">outcome</span><span class="p">]</span>
</span><span id="BaseDie-197"><a href="#BaseDie-197"><span class="linenos">197</span></a>        
</span><span id="BaseDie-198"><a href="#BaseDie-198"><span class="linenos">198</span></a>    <span class="k">def</span> <span class="nf">weight_ne</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">):</span>
</span><span id="BaseDie-199"><a href="#BaseDie-199"><span class="linenos">199</span></a>        <span class="sd">&quot;&quot;&quot; Returns the weight != a single outcome. &quot;&quot;&quot;</span>
</span><span id="BaseDie-200"><a href="#BaseDie-200"><span class="linenos">200</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_eq</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
</span><span id="BaseDie-201"><a href="#BaseDie-201"><span class="linenos">201</span></a>    
</span><span id="BaseDie-202"><a href="#BaseDie-202"><span class="linenos">202</span></a>    <span class="k">def</span> <span class="nf">weight_le</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">):</span>
</span><span id="BaseDie-203"><a href="#BaseDie-203"><span class="linenos">203</span></a>        <span class="sd">&quot;&quot;&quot; Returns the weight &lt;= a single outcome. &quot;&quot;&quot;</span>
</span><span id="BaseDie-204"><a href="#BaseDie-204"><span class="linenos">204</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_right</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="n">outcome</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="BaseDie-205"><a href="#BaseDie-205"><span class="linenos">205</span></a>        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="mi">0</span>
</span><span id="BaseDie-206"><a href="#BaseDie-206"><span class="linenos">206</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cweights</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
</span><span id="BaseDie-207"><a href="#BaseDie-207"><span class="linenos">207</span></a>        
</span><span id="BaseDie-208"><a href="#BaseDie-208"><span class="linenos">208</span></a>    <span class="k">def</span> <span class="nf">weight_lt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">):</span>
</span><span id="BaseDie-209"><a href="#BaseDie-209"><span class="linenos">209</span></a>        <span class="sd">&quot;&quot;&quot; Returns the weight &lt; a single outcome. &quot;&quot;&quot;</span>
</span><span id="BaseDie-210"><a href="#BaseDie-210"><span class="linenos">210</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_left</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="n">outcome</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="BaseDie-211"><a href="#BaseDie-211"><span class="linenos">211</span></a>        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="mi">0</span>
</span><span id="BaseDie-212"><a href="#BaseDie-212"><span class="linenos">212</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cweights</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
</span><span id="BaseDie-213"><a href="#BaseDie-213"><span class="linenos">213</span></a>        
</span><span id="BaseDie-214"><a href="#BaseDie-214"><span class="linenos">214</span></a>    <span class="k">def</span> <span class="nf">weight_ge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">):</span>
</span><span id="BaseDie-215"><a href="#BaseDie-215"><span class="linenos">215</span></a>        <span class="sd">&quot;&quot;&quot; Returns the weight &gt;= a single outcome. &quot;&quot;&quot;</span>
</span><span id="BaseDie-216"><a href="#BaseDie-216"><span class="linenos">216</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_left</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="n">outcome</span><span class="p">)</span>
</span><span id="BaseDie-217"><a href="#BaseDie-217"><span class="linenos">217</span></a>        <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_outcomes</span><span class="p">():</span> <span class="k">return</span> <span class="mi">0</span>
</span><span id="BaseDie-218"><a href="#BaseDie-218"><span class="linenos">218</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sweights</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
</span><span id="BaseDie-219"><a href="#BaseDie-219"><span class="linenos">219</span></a>        
</span><span id="BaseDie-220"><a href="#BaseDie-220"><span class="linenos">220</span></a>    <span class="k">def</span> <span class="nf">weight_gt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">):</span>
</span><span id="BaseDie-221"><a href="#BaseDie-221"><span class="linenos">221</span></a>        <span class="sd">&quot;&quot;&quot; Returns the weight &gt; a single outcome. &quot;&quot;&quot;</span>
</span><span id="BaseDie-222"><a href="#BaseDie-222"><span class="linenos">222</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_right</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="n">outcome</span><span class="p">)</span>
</span><span id="BaseDie-223"><a href="#BaseDie-223"><span class="linenos">223</span></a>        <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_outcomes</span><span class="p">():</span> <span class="k">return</span> <span class="mi">0</span>
</span><span id="BaseDie-224"><a href="#BaseDie-224"><span class="linenos">224</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sweights</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
</span><span id="BaseDie-225"><a href="#BaseDie-225"><span class="linenos">225</span></a>    
</span><span id="BaseDie-226"><a href="#BaseDie-226"><span class="linenos">226</span></a>    <span class="k">def</span> <span class="nf">probability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">):</span>
</span><span id="BaseDie-227"><a href="#BaseDie-227"><span class="linenos">227</span></a>        <span class="sd">&quot;&quot;&quot; Returns the probability of a single outcome. &quot;&quot;&quot;</span>
</span><span id="BaseDie-228"><a href="#BaseDie-228"><span class="linenos">228</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_eq</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
</span><span id="BaseDie-229"><a href="#BaseDie-229"><span class="linenos">229</span></a>    
</span><span id="BaseDie-230"><a href="#BaseDie-230"><span class="linenos">230</span></a>    <span class="c1"># Scalar(-ish) statistics.</span>
</span><span id="BaseDie-231"><a href="#BaseDie-231"><span class="linenos">231</span></a>        
</span><span id="BaseDie-232"><a href="#BaseDie-232"><span class="linenos">232</span></a>    <span class="k">def</span> <span class="nf">mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-233"><a href="#BaseDie-233"><span class="linenos">233</span></a>        <span class="sd">&quot;&quot;&quot; Returns a tuple containing the most common outcome(s) of the die.</span>
</span><span id="BaseDie-234"><a href="#BaseDie-234"><span class="linenos">234</span></a><span class="sd">        </span>
</span><span id="BaseDie-235"><a href="#BaseDie-235"><span class="linenos">235</span></a><span class="sd">        These are sorted from lowest to highest.</span>
</span><span id="BaseDie-236"><a href="#BaseDie-236"><span class="linenos">236</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-237"><a href="#BaseDie-237"><span class="linenos">237</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">outcome</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">weight</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">modal_weight</span><span class="p">())</span>
</span><span id="BaseDie-238"><a href="#BaseDie-238"><span class="linenos">238</span></a>    
</span><span id="BaseDie-239"><a href="#BaseDie-239"><span class="linenos">239</span></a>    <span class="k">def</span> <span class="nf">modal_weight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-240"><a href="#BaseDie-240"><span class="linenos">240</span></a>        <span class="sd">&quot;&quot;&quot; The highest weight of any single outcome. &quot;&quot;&quot;</span>
</span><span id="BaseDie-241"><a href="#BaseDie-241"><span class="linenos">241</span></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">())</span>
</span><span id="BaseDie-242"><a href="#BaseDie-242"><span class="linenos">242</span></a>    
</span><span id="BaseDie-243"><a href="#BaseDie-243"><span class="linenos">243</span></a>    <span class="k">def</span> <span class="nf">ks_stat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-244"><a href="#BaseDie-244"><span class="linenos">244</span></a>        <span class="sd">&quot;&quot;&quot; KolmogorovSmirnov stat. The maximum absolute difference between CDFs. &quot;&quot;&quot;</span>
</span><span id="BaseDie-245"><a href="#BaseDie-245"><span class="linenos">245</span></a>        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="BaseDie-246"><a href="#BaseDie-246"><span class="linenos">246</span></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">cdf</span><span class="p">(),</span> <span class="n">b</span><span class="o">.</span><span class="n">cdf</span><span class="p">()))</span>
</span><span id="BaseDie-247"><a href="#BaseDie-247"><span class="linenos">247</span></a>    
</span><span id="BaseDie-248"><a href="#BaseDie-248"><span class="linenos">248</span></a>    <span class="k">def</span> <span class="nf">cvm_stat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-249"><a href="#BaseDie-249"><span class="linenos">249</span></a>        <span class="sd">&quot;&quot;&quot; Cramr-von Mises stat. The sum-of-squares difference between CDFs. &quot;&quot;&quot;</span>
</span><span id="BaseDie-250"><a href="#BaseDie-250"><span class="linenos">250</span></a>        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="BaseDie-251"><a href="#BaseDie-251"><span class="linenos">251</span></a>        <span class="k">return</span> <span class="nb">sum</span><span class="p">((</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">cdf</span><span class="p">(),</span> <span class="n">b</span><span class="o">.</span><span class="n">cdf</span><span class="p">()))</span>
</span><span id="BaseDie-252"><a href="#BaseDie-252"><span class="linenos">252</span></a>    
</span><span id="BaseDie-253"><a href="#BaseDie-253"><span class="linenos">253</span></a>    <span class="c1"># Weight management.</span>
</span><span id="BaseDie-254"><a href="#BaseDie-254"><span class="linenos">254</span></a>    
</span><span id="BaseDie-255"><a href="#BaseDie-255"><span class="linenos">255</span></a>    <span class="k">def</span> <span class="nf">reduce</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-256"><a href="#BaseDie-256"><span class="linenos">256</span></a>        <span class="sd">&quot;&quot;&quot; Divides all weights by their greatest common denominator. &quot;&quot;&quot;</span>
</span><span id="BaseDie-257"><a href="#BaseDie-257"><span class="linenos">257</span></a>        <span class="n">gcd</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">())</span>
</span><span id="BaseDie-258"><a href="#BaseDie-258"><span class="linenos">258</span></a>        <span class="k">if</span> <span class="n">gcd</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="BaseDie-259"><a href="#BaseDie-259"><span class="linenos">259</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="BaseDie-260"><a href="#BaseDie-260"><span class="linenos">260</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="n">outcome</span> <span class="p">:</span> <span class="n">weight</span> <span class="o">//</span> <span class="n">gcd</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">}</span>
</span><span id="BaseDie-261"><a href="#BaseDie-261"><span class="linenos">261</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-262"><a href="#BaseDie-262"><span class="linenos">262</span></a>    
</span><span id="BaseDie-263"><a href="#BaseDie-263"><span class="linenos">263</span></a>    <span class="k">def</span> <span class="nf">scale_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="p">):</span>
</span><span id="BaseDie-264"><a href="#BaseDie-264"><span class="linenos">264</span></a>        <span class="sd">&quot;&quot;&quot; Multiplies all weights by a constant. &quot;&quot;&quot;</span>
</span><span id="BaseDie-265"><a href="#BaseDie-265"><span class="linenos">265</span></a>        <span class="k">if</span> <span class="n">scale</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="BaseDie-266"><a href="#BaseDie-266"><span class="linenos">266</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Weights cannot be scaled by a negative number.&#39;</span><span class="p">)</span>
</span><span id="BaseDie-267"><a href="#BaseDie-267"><span class="linenos">267</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="n">outcome</span> <span class="p">:</span> <span class="n">scale</span> <span class="o">*</span> <span class="n">weight</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">}</span>
</span><span id="BaseDie-268"><a href="#BaseDie-268"><span class="linenos">268</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-269"><a href="#BaseDie-269"><span class="linenos">269</span></a>    
</span><span id="BaseDie-270"><a href="#BaseDie-270"><span class="linenos">270</span></a>    <span class="c1"># Rerolls and other outcome management.</span>
</span><span id="BaseDie-271"><a href="#BaseDie-271"><span class="linenos">271</span></a>    
</span><span id="BaseDie-272"><a href="#BaseDie-272"><span class="linenos">272</span></a>    <span class="k">def</span> <span class="nf">min_outcome</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">):</span>
</span><span id="BaseDie-273"><a href="#BaseDie-273"><span class="linenos">273</span></a>        <span class="sd">&quot;&quot;&quot; Returns the minimum possible outcome among the dice. &quot;&quot;&quot;</span>
</span><span id="BaseDie-274"><a href="#BaseDie-274"><span class="linenos">274</span></a>        <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">)</span>
</span><span id="BaseDie-275"><a href="#BaseDie-275"><span class="linenos">275</span></a>    
</span><span id="BaseDie-276"><a href="#BaseDie-276"><span class="linenos">276</span></a>    <span class="k">def</span> <span class="nf">max_outcome</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">):</span>
</span><span id="BaseDie-277"><a href="#BaseDie-277"><span class="linenos">277</span></a>        <span class="sd">&quot;&quot;&quot; Returns the maximum possible outcome among the dice. &quot;&quot;&quot;</span>
</span><span id="BaseDie-278"><a href="#BaseDie-278"><span class="linenos">278</span></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">)</span>
</span><span id="BaseDie-279"><a href="#BaseDie-279"><span class="linenos">279</span></a>    
</span><span id="BaseDie-280"><a href="#BaseDie-280"><span class="linenos">280</span></a>    <span class="k">def</span> <span class="nf">nearest_le</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">):</span>
</span><span id="BaseDie-281"><a href="#BaseDie-281"><span class="linenos">281</span></a>        <span class="sd">&quot;&quot;&quot; Returns the nearest outcome that is &lt;= the argument. </span>
</span><span id="BaseDie-282"><a href="#BaseDie-282"><span class="linenos">282</span></a><span class="sd">        </span>
</span><span id="BaseDie-283"><a href="#BaseDie-283"><span class="linenos">283</span></a><span class="sd">        Returns `None` if there is no such outcome.</span>
</span><span id="BaseDie-284"><a href="#BaseDie-284"><span class="linenos">284</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-285"><a href="#BaseDie-285"><span class="linenos">285</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_right</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="n">outcome</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="BaseDie-286"><a href="#BaseDie-286"><span class="linenos">286</span></a>        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="BaseDie-287"><a href="#BaseDie-287"><span class="linenos">287</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="BaseDie-288"><a href="#BaseDie-288"><span class="linenos">288</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
</span><span id="BaseDie-289"><a href="#BaseDie-289"><span class="linenos">289</span></a>        
</span><span id="BaseDie-290"><a href="#BaseDie-290"><span class="linenos">290</span></a>    <span class="k">def</span> <span class="nf">nearest_ge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">):</span>
</span><span id="BaseDie-291"><a href="#BaseDie-291"><span class="linenos">291</span></a>        <span class="sd">&quot;&quot;&quot; Returns the nearest outcome that is &gt;= the argument. </span>
</span><span id="BaseDie-292"><a href="#BaseDie-292"><span class="linenos">292</span></a><span class="sd">        </span>
</span><span id="BaseDie-293"><a href="#BaseDie-293"><span class="linenos">293</span></a><span class="sd">        Returns `None` if there is no such outcome.</span>
</span><span id="BaseDie-294"><a href="#BaseDie-294"><span class="linenos">294</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-295"><a href="#BaseDie-295"><span class="linenos">295</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_left</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="n">outcome</span><span class="p">)</span>
</span><span id="BaseDie-296"><a href="#BaseDie-296"><span class="linenos">296</span></a>        <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_outcomes</span><span class="p">():</span>
</span><span id="BaseDie-297"><a href="#BaseDie-297"><span class="linenos">297</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="BaseDie-298"><a href="#BaseDie-298"><span class="linenos">298</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
</span><span id="BaseDie-299"><a href="#BaseDie-299"><span class="linenos">299</span></a>    
</span><span id="BaseDie-300"><a href="#BaseDie-300"><span class="linenos">300</span></a>    <span class="k">def</span> <span class="nf">reroll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcomes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseDie-301"><a href="#BaseDie-301"><span class="linenos">301</span></a>        <span class="sd">&quot;&quot;&quot; Rerolls the given outcomes.</span>
</span><span id="BaseDie-302"><a href="#BaseDie-302"><span class="linenos">302</span></a><span class="sd">        </span>
</span><span id="BaseDie-303"><a href="#BaseDie-303"><span class="linenos">303</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie-304"><a href="#BaseDie-304"><span class="linenos">304</span></a><span class="sd">            outcomes: Selects which outcomes to reroll. Options:</span>
</span><span id="BaseDie-305"><a href="#BaseDie-305"><span class="linenos">305</span></a><span class="sd">                * A callable that takes an outcome and returns `True` if it should be rerolled.</span>
</span><span id="BaseDie-306"><a href="#BaseDie-306"><span class="linenos">306</span></a><span class="sd">                    The callable will be supplied with one argument per `ndim` if this is a `VectorDie`.</span>
</span><span id="BaseDie-307"><a href="#BaseDie-307"><span class="linenos">307</span></a><span class="sd">                * A set of outcomes to reroll.</span>
</span><span id="BaseDie-308"><a href="#BaseDie-308"><span class="linenos">308</span></a><span class="sd">                * If not provided, the min outcome will be rerolled.</span>
</span><span id="BaseDie-309"><a href="#BaseDie-309"><span class="linenos">309</span></a><span class="sd">            max_depth: The maximum number of times to reroll.</span>
</span><span id="BaseDie-310"><a href="#BaseDie-310"><span class="linenos">310</span></a><span class="sd">                If omitted, rerolls an unlimited number of times.</span>
</span><span id="BaseDie-311"><a href="#BaseDie-311"><span class="linenos">311</span></a><span class="sd">        </span>
</span><span id="BaseDie-312"><a href="#BaseDie-312"><span class="linenos">312</span></a><span class="sd">        Returns:</span>
</span><span id="BaseDie-313"><a href="#BaseDie-313"><span class="linenos">313</span></a><span class="sd">            A die representing the reroll.</span>
</span><span id="BaseDie-314"><a href="#BaseDie-314"><span class="linenos">314</span></a><span class="sd">            If the reroll would never terminate, the result has no outcomes.</span>
</span><span id="BaseDie-315"><a href="#BaseDie-315"><span class="linenos">315</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-316"><a href="#BaseDie-316"><span class="linenos">316</span></a>        <span class="k">if</span> <span class="n">outcomes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseDie-317"><a href="#BaseDie-317"><span class="linenos">317</span></a>            <span class="n">outcomes</span> <span class="o">=</span> <span class="p">{</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_outcome</span><span class="p">()</span> <span class="p">}</span>
</span><span id="BaseDie-318"><a href="#BaseDie-318"><span class="linenos">318</span></a>        <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">outcomes</span><span class="p">):</span>
</span><span id="BaseDie-319"><a href="#BaseDie-319"><span class="linenos">319</span></a>            <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap_unpack</span><span class="p">(</span><span class="n">outcomes</span><span class="p">)</span>
</span><span id="BaseDie-320"><a href="#BaseDie-320"><span class="linenos">320</span></a>            <span class="n">outcomes</span> <span class="o">=</span> <span class="p">{</span> <span class="n">outcome</span> <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()</span> <span class="k">if</span> <span class="n">func</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span> <span class="p">}</span>
</span><span id="BaseDie-321"><a href="#BaseDie-321"><span class="linenos">321</span></a>        
</span><span id="BaseDie-322"><a href="#BaseDie-322"><span class="linenos">322</span></a>        <span class="k">if</span> <span class="n">max_depth</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseDie-323"><a href="#BaseDie-323"><span class="linenos">323</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="n">outcome</span> <span class="p">:</span> <span class="n">weight</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">outcome</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">outcomes</span> <span class="p">}</span>
</span><span id="BaseDie-324"><a href="#BaseDie-324"><span class="linenos">324</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie-325"><a href="#BaseDie-325"><span class="linenos">325</span></a>            <span class="n">total_reroll_weight</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">weight</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="n">outcomes</span> <span class="p">)</span>
</span><span id="BaseDie-326"><a href="#BaseDie-326"><span class="linenos">326</span></a>            <span class="n">rerollable_factor</span> <span class="o">=</span> <span class="n">total_reroll_weight</span> <span class="o">**</span> <span class="n">max_depth</span>
</span><span id="BaseDie-327"><a href="#BaseDie-327"><span class="linenos">327</span></a>            <span class="n">stop_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">**</span> <span class="n">max_depth</span> <span class="o">+</span> <span class="n">total_reroll_weight</span> <span class="o">**</span> <span class="n">max_depth</span>
</span><span id="BaseDie-328"><a href="#BaseDie-328"><span class="linenos">328</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="n">outcome</span> <span class="p">:</span> <span class="p">(</span><span class="n">rerollable_factor</span> <span class="o">*</span> <span class="n">weight</span> <span class="k">if</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="n">outcomes</span> <span class="k">else</span> <span class="n">stop_factor</span> <span class="o">*</span> <span class="n">weight</span><span class="p">)</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">}</span>
</span><span id="BaseDie-329"><a href="#BaseDie-329"><span class="linenos">329</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-330"><a href="#BaseDie-330"><span class="linenos">330</span></a>    
</span><span id="BaseDie-331"><a href="#BaseDie-331"><span class="linenos">331</span></a>    <span class="k">def</span> <span class="nf">reroll_until</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcomes</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseDie-332"><a href="#BaseDie-332"><span class="linenos">332</span></a>        <span class="sd">&quot;&quot;&quot; Rerolls until getting one of the given outcomes.</span>
</span><span id="BaseDie-333"><a href="#BaseDie-333"><span class="linenos">333</span></a><span class="sd">        </span>
</span><span id="BaseDie-334"><a href="#BaseDie-334"><span class="linenos">334</span></a><span class="sd">        Essentially the complement of `reroll()`.</span>
</span><span id="BaseDie-335"><a href="#BaseDie-335"><span class="linenos">335</span></a><span class="sd">        </span>
</span><span id="BaseDie-336"><a href="#BaseDie-336"><span class="linenos">336</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie-337"><a href="#BaseDie-337"><span class="linenos">337</span></a><span class="sd">            outcomes: Selects which outcomes to reroll until. Options:</span>
</span><span id="BaseDie-338"><a href="#BaseDie-338"><span class="linenos">338</span></a><span class="sd">                * A callable that takes an outcome and returns `True` if it should be accepted.</span>
</span><span id="BaseDie-339"><a href="#BaseDie-339"><span class="linenos">339</span></a><span class="sd">                * A set of outcomes to reroll until.</span>
</span><span id="BaseDie-340"><a href="#BaseDie-340"><span class="linenos">340</span></a><span class="sd">            max_depth: The maximum number of times to reroll.</span>
</span><span id="BaseDie-341"><a href="#BaseDie-341"><span class="linenos">341</span></a><span class="sd">                If omitted, rerolls an unlimited number of times.</span>
</span><span id="BaseDie-342"><a href="#BaseDie-342"><span class="linenos">342</span></a><span class="sd">        </span>
</span><span id="BaseDie-343"><a href="#BaseDie-343"><span class="linenos">343</span></a><span class="sd">        Returns:</span>
</span><span id="BaseDie-344"><a href="#BaseDie-344"><span class="linenos">344</span></a><span class="sd">            A die representing the reroll.</span>
</span><span id="BaseDie-345"><a href="#BaseDie-345"><span class="linenos">345</span></a><span class="sd">            If the reroll would never terminate, the result has no outcomes.</span>
</span><span id="BaseDie-346"><a href="#BaseDie-346"><span class="linenos">346</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-347"><a href="#BaseDie-347"><span class="linenos">347</span></a>        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">outcomes</span><span class="p">):</span>
</span><span id="BaseDie-348"><a href="#BaseDie-348"><span class="linenos">348</span></a>            <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap_unpack</span><span class="p">(</span><span class="n">outcomes</span><span class="p">)</span>
</span><span id="BaseDie-349"><a href="#BaseDie-349"><span class="linenos">349</span></a>            <span class="n">not_outcomes</span> <span class="o">=</span> <span class="p">{</span> <span class="n">outcome</span> <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">func</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span> <span class="p">}</span>
</span><span id="BaseDie-350"><a href="#BaseDie-350"><span class="linenos">350</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie-351"><a href="#BaseDie-351"><span class="linenos">351</span></a>            <span class="n">not_outcomes</span> <span class="o">=</span> <span class="p">{</span> <span class="n">not_outcome</span> <span class="k">for</span> <span class="n">not_outcome</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()</span> <span class="k">if</span> <span class="n">not_outcome</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">outcomes</span> <span class="p">}</span>
</span><span id="BaseDie-352"><a href="#BaseDie-352"><span class="linenos">352</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reroll</span><span class="p">(</span><span class="n">not_outcomes</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="p">)</span>
</span><span id="BaseDie-353"><a href="#BaseDie-353"><span class="linenos">353</span></a>    
</span><span id="BaseDie-354"><a href="#BaseDie-354"><span class="linenos">354</span></a>    <span class="k">def</span> <span class="nf">truncate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_outcome</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_outcome</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseDie-355"><a href="#BaseDie-355"><span class="linenos">355</span></a>        <span class="sd">&quot;&quot;&quot; Truncates the outcomes of this die to the given range.</span>
</span><span id="BaseDie-356"><a href="#BaseDie-356"><span class="linenos">356</span></a><span class="sd">        </span>
</span><span id="BaseDie-357"><a href="#BaseDie-357"><span class="linenos">357</span></a><span class="sd">        The endpoints are included in the result if applicable.</span>
</span><span id="BaseDie-358"><a href="#BaseDie-358"><span class="linenos">358</span></a><span class="sd">        If one of the arguments is not provided, that side will not be truncated.</span>
</span><span id="BaseDie-359"><a href="#BaseDie-359"><span class="linenos">359</span></a><span class="sd">        </span>
</span><span id="BaseDie-360"><a href="#BaseDie-360"><span class="linenos">360</span></a><span class="sd">        This effectively rerolls outcomes outside the given range.</span>
</span><span id="BaseDie-361"><a href="#BaseDie-361"><span class="linenos">361</span></a><span class="sd">        If instead you want to replace those outcomes with the nearest endpoint, use `clip()`.</span>
</span><span id="BaseDie-362"><a href="#BaseDie-362"><span class="linenos">362</span></a><span class="sd">        </span>
</span><span id="BaseDie-363"><a href="#BaseDie-363"><span class="linenos">363</span></a><span class="sd">        Not to be confused with `trunc(die)`, which performs integer truncation on each outcome.</span>
</span><span id="BaseDie-364"><a href="#BaseDie-364"><span class="linenos">364</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-365"><a href="#BaseDie-365"><span class="linenos">365</span></a>        <span class="k">if</span> <span class="n">min_outcome</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseDie-366"><a href="#BaseDie-366"><span class="linenos">366</span></a>            <span class="n">start</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_left</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="n">min_outcome</span><span class="p">)</span>
</span><span id="BaseDie-367"><a href="#BaseDie-367"><span class="linenos">367</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie-368"><a href="#BaseDie-368"><span class="linenos">368</span></a>            <span class="n">start</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="BaseDie-369"><a href="#BaseDie-369"><span class="linenos">369</span></a>        <span class="k">if</span> <span class="n">max_outcome</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseDie-370"><a href="#BaseDie-370"><span class="linenos">370</span></a>            <span class="n">stop</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_right</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="n">max_outcome</span><span class="p">)</span>
</span><span id="BaseDie-371"><a href="#BaseDie-371"><span class="linenos">371</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie-372"><a href="#BaseDie-372"><span class="linenos">372</span></a>            <span class="n">stop</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="BaseDie-373"><a href="#BaseDie-373"><span class="linenos">373</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="n">k</span> <span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span> <span class="p">}</span>
</span><span id="BaseDie-374"><a href="#BaseDie-374"><span class="linenos">374</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-375"><a href="#BaseDie-375"><span class="linenos">375</span></a>    
</span><span id="BaseDie-376"><a href="#BaseDie-376"><span class="linenos">376</span></a>    <span class="k">def</span> <span class="nf">clip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_outcome</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_outcome</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseDie-377"><a href="#BaseDie-377"><span class="linenos">377</span></a>        <span class="sd">&quot;&quot;&quot; Clips the outcomes of this die to the given values.</span>
</span><span id="BaseDie-378"><a href="#BaseDie-378"><span class="linenos">378</span></a><span class="sd">        </span>
</span><span id="BaseDie-379"><a href="#BaseDie-379"><span class="linenos">379</span></a><span class="sd">        The endpoints are included in the result if applicable.</span>
</span><span id="BaseDie-380"><a href="#BaseDie-380"><span class="linenos">380</span></a><span class="sd">        If one of the arguments is not provided, that side will not be clipped.</span>
</span><span id="BaseDie-381"><a href="#BaseDie-381"><span class="linenos">381</span></a><span class="sd">        </span>
</span><span id="BaseDie-382"><a href="#BaseDie-382"><span class="linenos">382</span></a><span class="sd">        This is not the same as rerolling outcomes beyond this range;</span>
</span><span id="BaseDie-383"><a href="#BaseDie-383"><span class="linenos">383</span></a><span class="sd">        the outcome is simply adjusted to fit within the range.</span>
</span><span id="BaseDie-384"><a href="#BaseDie-384"><span class="linenos">384</span></a><span class="sd">        This will typically cause some weight to bunch up at the endpoint.</span>
</span><span id="BaseDie-385"><a href="#BaseDie-385"><span class="linenos">385</span></a><span class="sd">        If you want to reroll outcomes beyond this range, use `truncate()`.</span>
</span><span id="BaseDie-386"><a href="#BaseDie-386"><span class="linenos">386</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-387"><a href="#BaseDie-387"><span class="linenos">387</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="BaseDie-388"><a href="#BaseDie-388"><span class="linenos">388</span></a>        <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="BaseDie-389"><a href="#BaseDie-389"><span class="linenos">389</span></a>            <span class="k">if</span> <span class="n">min_outcome</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">outcome</span> <span class="o">&lt;=</span> <span class="n">min_outcome</span><span class="p">:</span>
</span><span id="BaseDie-390"><a href="#BaseDie-390"><span class="linenos">390</span></a>                <span class="n">data</span><span class="p">[</span><span class="n">min_outcome</span><span class="p">]</span> <span class="o">+=</span> <span class="n">weight</span>
</span><span id="BaseDie-391"><a href="#BaseDie-391"><span class="linenos">391</span></a>            <span class="k">elif</span> <span class="n">max_outcome</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">outcome</span> <span class="o">&gt;=</span> <span class="n">max_outcome</span><span class="p">:</span>
</span><span id="BaseDie-392"><a href="#BaseDie-392"><span class="linenos">392</span></a>                <span class="n">data</span><span class="p">[</span><span class="n">max_outcome</span><span class="p">]</span> <span class="o">+=</span> <span class="n">weight</span>
</span><span id="BaseDie-393"><a href="#BaseDie-393"><span class="linenos">393</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie-394"><a href="#BaseDie-394"><span class="linenos">394</span></a>                <span class="n">data</span><span class="p">[</span><span class="n">outcome</span><span class="p">]</span> <span class="o">+=</span> <span class="n">weight</span>
</span><span id="BaseDie-395"><a href="#BaseDie-395"><span class="linenos">395</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-396"><a href="#BaseDie-396"><span class="linenos">396</span></a>    
</span><span id="BaseDie-397"><a href="#BaseDie-397"><span class="linenos">397</span></a>    <span class="k">def</span> <span class="nf">cond</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome_if_true</span><span class="p">,</span> <span class="n">outcome_if_false</span><span class="p">,</span> <span class="o">/</span><span class="p">):</span>
</span><span id="BaseDie-398"><a href="#BaseDie-398"><span class="linenos">398</span></a>        <span class="sd">&quot;&quot;&quot; Conditional operator. Also known as the ternary operator.</span>
</span><span id="BaseDie-399"><a href="#BaseDie-399"><span class="linenos">399</span></a><span class="sd">        </span>
</span><span id="BaseDie-400"><a href="#BaseDie-400"><span class="linenos">400</span></a><span class="sd">        This replaces truthy outcomes with the first argument and falsy outcomes with the second argument.</span>
</span><span id="BaseDie-401"><a href="#BaseDie-401"><span class="linenos">401</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-402"><a href="#BaseDie-402"><span class="linenos">402</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bool</span><span class="p">()</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">outcome_if_true</span> <span class="k">if</span> <span class="n">x</span> <span class="k">else</span> <span class="n">outcome_if_false</span><span class="p">)</span>
</span><span id="BaseDie-403"><a href="#BaseDie-403"><span class="linenos">403</span></a>    
</span><span id="BaseDie-404"><a href="#BaseDie-404"><span class="linenos">404</span></a>    <span class="k">def</span> <span class="nf">set_outcomes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcomes</span><span class="p">):</span>
</span><span id="BaseDie-405"><a href="#BaseDie-405"><span class="linenos">405</span></a>        <span class="sd">&quot;&quot;&quot; Sets the set of outcomes to the argument.</span>
</span><span id="BaseDie-406"><a href="#BaseDie-406"><span class="linenos">406</span></a><span class="sd">        </span>
</span><span id="BaseDie-407"><a href="#BaseDie-407"><span class="linenos">407</span></a><span class="sd">        This may remove outcomes (if they are not present in the argument)</span>
</span><span id="BaseDie-408"><a href="#BaseDie-408"><span class="linenos">408</span></a><span class="sd">        and/or add zero-weight outcomes (if they are not present in this die).</span>
</span><span id="BaseDie-409"><a href="#BaseDie-409"><span class="linenos">409</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-410"><a href="#BaseDie-410"><span class="linenos">410</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_eq</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">outcomes</span><span class="p">}</span>
</span><span id="BaseDie-411"><a href="#BaseDie-411"><span class="linenos">411</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-412"><a href="#BaseDie-412"><span class="linenos">412</span></a>    
</span><span id="BaseDie-413"><a href="#BaseDie-413"><span class="linenos">413</span></a>    <span class="k">def</span> <span class="nf">trim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-414"><a href="#BaseDie-414"><span class="linenos">414</span></a>        <span class="sd">&quot;&quot;&quot; Removes all zero-weight outcomes. &quot;&quot;&quot;</span>
</span><span id="BaseDie-415"><a href="#BaseDie-415"><span class="linenos">415</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="n">k</span> <span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">}</span>
</span><span id="BaseDie-416"><a href="#BaseDie-416"><span class="linenos">416</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-417"><a href="#BaseDie-417"><span class="linenos">417</span></a>    
</span><span id="BaseDie-418"><a href="#BaseDie-418"><span class="linenos">418</span></a>    <span class="nd">@cached_property</span>
</span><span id="BaseDie-419"><a href="#BaseDie-419"><span class="linenos">419</span></a>    <span class="k">def</span> <span class="nf">_popped_min</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-420"><a href="#BaseDie-420"><span class="linenos">420</span></a>        <span class="n">die</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">weights</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">()[</span><span class="mi">1</span><span class="p">:])</span>
</span><span id="BaseDie-421"><a href="#BaseDie-421"><span class="linenos">421</span></a>        <span class="k">return</span> <span class="n">die</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="BaseDie-422"><a href="#BaseDie-422"><span class="linenos">422</span></a>    
</span><span id="BaseDie-423"><a href="#BaseDie-423"><span class="linenos">423</span></a>    <span class="k">def</span> <span class="nf">_pop_min</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-424"><a href="#BaseDie-424"><span class="linenos">424</span></a>        <span class="sd">&quot;&quot;&quot; Remove the min outcome and return the result, along with the popped outcome, and the popped weight.</span>
</span><span id="BaseDie-425"><a href="#BaseDie-425"><span class="linenos">425</span></a><span class="sd">        </span>
</span><span id="BaseDie-426"><a href="#BaseDie-426"><span class="linenos">426</span></a><span class="sd">        Raises:</span>
</span><span id="BaseDie-427"><a href="#BaseDie-427"><span class="linenos">427</span></a><span class="sd">            `IndexError` if this die has no outcome to pop.</span>
</span><span id="BaseDie-428"><a href="#BaseDie-428"><span class="linenos">428</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-429"><a href="#BaseDie-429"><span class="linenos">429</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_popped_min</span>
</span><span id="BaseDie-430"><a href="#BaseDie-430"><span class="linenos">430</span></a>    
</span><span id="BaseDie-431"><a href="#BaseDie-431"><span class="linenos">431</span></a>    <span class="nd">@cached_property</span>
</span><span id="BaseDie-432"><a href="#BaseDie-432"><span class="linenos">432</span></a>    <span class="k">def</span> <span class="nf">_popped_max</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-433"><a href="#BaseDie-433"><span class="linenos">433</span></a>        <span class="n">die</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="BaseDie-434"><a href="#BaseDie-434"><span class="linenos">434</span></a>        <span class="k">return</span> <span class="n">die</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="BaseDie-435"><a href="#BaseDie-435"><span class="linenos">435</span></a>    
</span><span id="BaseDie-436"><a href="#BaseDie-436"><span class="linenos">436</span></a>    <span class="k">def</span> <span class="nf">_pop_max</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-437"><a href="#BaseDie-437"><span class="linenos">437</span></a>        <span class="sd">&quot;&quot;&quot; Remove the max outcome and return the result, along with the popped outcome, and the popped weight.</span>
</span><span id="BaseDie-438"><a href="#BaseDie-438"><span class="linenos">438</span></a><span class="sd">        </span>
</span><span id="BaseDie-439"><a href="#BaseDie-439"><span class="linenos">439</span></a><span class="sd">        Raises:</span>
</span><span id="BaseDie-440"><a href="#BaseDie-440"><span class="linenos">440</span></a><span class="sd">            `IndexError` if this die has no outcome to pop.</span>
</span><span id="BaseDie-441"><a href="#BaseDie-441"><span class="linenos">441</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-442"><a href="#BaseDie-442"><span class="linenos">442</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_popped_max</span>
</span><span id="BaseDie-443"><a href="#BaseDie-443"><span class="linenos">443</span></a>    
</span><span id="BaseDie-444"><a href="#BaseDie-444"><span class="linenos">444</span></a>    <span class="c1"># Mixtures.</span>
</span><span id="BaseDie-445"><a href="#BaseDie-445"><span class="linenos">445</span></a>
</span><span id="BaseDie-446"><a href="#BaseDie-446"><span class="linenos">446</span></a>    <span class="k">def</span> <span class="nf">sub</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">repl</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">denominator_method</span><span class="o">=</span><span class="s1">&#39;lcm&#39;</span><span class="p">):</span>
</span><span id="BaseDie-447"><a href="#BaseDie-447"><span class="linenos">447</span></a>        <span class="sd">&quot;&quot;&quot; Changes outcomes of the die to other outcomes.</span>
</span><span id="BaseDie-448"><a href="#BaseDie-448"><span class="linenos">448</span></a><span class="sd">        </span>
</span><span id="BaseDie-449"><a href="#BaseDie-449"><span class="linenos">449</span></a><span class="sd">        You can think of this as `sub`stituting outcomes of this die for other outcomes or dice.</span>
</span><span id="BaseDie-450"><a href="#BaseDie-450"><span class="linenos">450</span></a><span class="sd">        Or, as executing a `sub`routine based on the roll of this die.</span>
</span><span id="BaseDie-451"><a href="#BaseDie-451"><span class="linenos">451</span></a><span class="sd">        </span>
</span><span id="BaseDie-452"><a href="#BaseDie-452"><span class="linenos">452</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie-453"><a href="#BaseDie-453"><span class="linenos">453</span></a><span class="sd">            repl: One of the following:</span>
</span><span id="BaseDie-454"><a href="#BaseDie-454"><span class="linenos">454</span></a><span class="sd">                * A map from old outcomes to new outcomes.</span>
</span><span id="BaseDie-455"><a href="#BaseDie-455"><span class="linenos">455</span></a><span class="sd">                    Unmapped old outcomes stay the same.</span>
</span><span id="BaseDie-456"><a href="#BaseDie-456"><span class="linenos">456</span></a><span class="sd">                * A callable mapping old outcomes to new outcomes.</span>
</span><span id="BaseDie-457"><a href="#BaseDie-457"><span class="linenos">457</span></a><span class="sd">                    The callable will be supplied with one argument per `ndim` if this is a `VectorDie`.</span>
</span><span id="BaseDie-458"><a href="#BaseDie-458"><span class="linenos">458</span></a><span class="sd">                The new outcomes may be dice rather than just single outcomes.</span>
</span><span id="BaseDie-459"><a href="#BaseDie-459"><span class="linenos">459</span></a><span class="sd">                The special value `icepool.Reroll` will reroll that old outcome.</span>
</span><span id="BaseDie-460"><a href="#BaseDie-460"><span class="linenos">460</span></a><span class="sd">            max_depth: `sub()` will be repeated with the same argument on the result this many times.</span>
</span><span id="BaseDie-461"><a href="#BaseDie-461"><span class="linenos">461</span></a><span class="sd">                If set to `None`, this will repeat until a fixed point is reached.</span>
</span><span id="BaseDie-462"><a href="#BaseDie-462"><span class="linenos">462</span></a><span class="sd">            ndim: Sets the `ndim` of the result. If not provided, `ndim` will be determined automatically.</span>
</span><span id="BaseDie-463"><a href="#BaseDie-463"><span class="linenos">463</span></a><span class="sd">            denominator_method: As `icepool.Die()`.</span>
</span><span id="BaseDie-464"><a href="#BaseDie-464"><span class="linenos">464</span></a><span class="sd">        </span>
</span><span id="BaseDie-465"><a href="#BaseDie-465"><span class="linenos">465</span></a><span class="sd">        Returns:</span>
</span><span id="BaseDie-466"><a href="#BaseDie-466"><span class="linenos">466</span></a><span class="sd">            The relabeled die.</span>
</span><span id="BaseDie-467"><a href="#BaseDie-467"><span class="linenos">467</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-468"><a href="#BaseDie-468"><span class="linenos">468</span></a>        <span class="k">if</span> <span class="n">max_depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="BaseDie-469"><a href="#BaseDie-469"><span class="linenos">469</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="BaseDie-470"><a href="#BaseDie-470"><span class="linenos">470</span></a>        <span class="k">elif</span> <span class="n">max_depth</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="BaseDie-471"><a href="#BaseDie-471"><span class="linenos">471</span></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">repl</span><span class="p">,</span> <span class="s1">&#39;items&#39;</span><span class="p">):</span>
</span><span id="BaseDie-472"><a href="#BaseDie-472"><span class="linenos">472</span></a>                <span class="n">repl</span> <span class="o">=</span> <span class="p">[(</span><span class="n">repl</span><span class="p">[</span><span class="n">outcome</span><span class="p">]</span> <span class="k">if</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="n">repl</span> <span class="k">else</span> <span class="n">outcome</span><span class="p">)</span> <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()]</span>
</span><span id="BaseDie-473"><a href="#BaseDie-473"><span class="linenos">473</span></a>            <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">repl</span><span class="p">):</span>
</span><span id="BaseDie-474"><a href="#BaseDie-474"><span class="linenos">474</span></a>                <span class="n">repl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap_unpack</span><span class="p">(</span><span class="n">repl</span><span class="p">)</span>
</span><span id="BaseDie-475"><a href="#BaseDie-475"><span class="linenos">475</span></a>                <span class="n">repl</span> <span class="o">=</span> <span class="p">[</span><span class="n">repl</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span> <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()]</span>
</span><span id="BaseDie-476"><a href="#BaseDie-476"><span class="linenos">476</span></a>
</span><span id="BaseDie-477"><a href="#BaseDie-477"><span class="linenos">477</span></a>            <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="o">*</span><span class="n">repl</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">(),</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">denominator_method</span><span class="o">=</span><span class="n">denominator_method</span><span class="p">)</span>
</span><span id="BaseDie-478"><a href="#BaseDie-478"><span class="linenos">478</span></a>        <span class="k">elif</span> <span class="n">max_depth</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseDie-479"><a href="#BaseDie-479"><span class="linenos">479</span></a>            <span class="nb">next</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">repl</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">denominator_method</span><span class="o">=</span><span class="n">denominator_method</span><span class="p">)</span>
</span><span id="BaseDie-480"><a href="#BaseDie-480"><span class="linenos">480</span></a>            <span class="k">return</span> <span class="nb">next</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">repl</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">denominator_method</span><span class="o">=</span><span class="n">denominator_method</span><span class="p">)</span>
</span><span id="BaseDie-481"><a href="#BaseDie-481"><span class="linenos">481</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie-482"><a href="#BaseDie-482"><span class="linenos">482</span></a>            <span class="c1"># Seek fixed point.</span>
</span><span id="BaseDie-483"><a href="#BaseDie-483"><span class="linenos">483</span></a>            <span class="nb">next</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">repl</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">denominator_method</span><span class="o">=</span><span class="n">denominator_method</span><span class="p">)</span>
</span><span id="BaseDie-484"><a href="#BaseDie-484"><span class="linenos">484</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="nb">next</span><span class="o">.</span><span class="n">reduce</span><span class="p">()):</span>
</span><span id="BaseDie-485"><a href="#BaseDie-485"><span class="linenos">485</span></a>                <span class="k">return</span> <span class="bp">self</span>
</span><span id="BaseDie-486"><a href="#BaseDie-486"><span class="linenos">486</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie-487"><a href="#BaseDie-487"><span class="linenos">487</span></a>                <span class="k">return</span> <span class="nb">next</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">repl</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">denominator_method</span><span class="o">=</span><span class="n">denominator_method</span><span class="p">)</span>
</span><span id="BaseDie-488"><a href="#BaseDie-488"><span class="linenos">488</span></a>    
</span><span id="BaseDie-489"><a href="#BaseDie-489"><span class="linenos">489</span></a>    <span class="k">def</span> <span class="nf">explode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcomes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseDie-490"><a href="#BaseDie-490"><span class="linenos">490</span></a>        <span class="sd">&quot;&quot;&quot; Causes outcomes to be rolled again and added to the total.</span>
</span><span id="BaseDie-491"><a href="#BaseDie-491"><span class="linenos">491</span></a><span class="sd">        </span>
</span><span id="BaseDie-492"><a href="#BaseDie-492"><span class="linenos">492</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie-493"><a href="#BaseDie-493"><span class="linenos">493</span></a><span class="sd">            outcomes: Which outcomes to explode. Options:</span>
</span><span id="BaseDie-494"><a href="#BaseDie-494"><span class="linenos">494</span></a><span class="sd">                * An iterable containing outcomes to explode.</span>
</span><span id="BaseDie-495"><a href="#BaseDie-495"><span class="linenos">495</span></a><span class="sd">                * A callable that takes an outcome and returns `True` if it should be exploded.</span>
</span><span id="BaseDie-496"><a href="#BaseDie-496"><span class="linenos">496</span></a><span class="sd">                    The callable will be supplied with one argument per `ndim` if this is a `VectorDie`.</span>
</span><span id="BaseDie-497"><a href="#BaseDie-497"><span class="linenos">497</span></a><span class="sd">                * If not supplied, the max outcome will explode.</span>
</span><span id="BaseDie-498"><a href="#BaseDie-498"><span class="linenos">498</span></a><span class="sd">            max_depth: The maximum number of additional dice to roll.</span>
</span><span id="BaseDie-499"><a href="#BaseDie-499"><span class="linenos">499</span></a><span class="sd">                If not supplied, a default value will be used.</span>
</span><span id="BaseDie-500"><a href="#BaseDie-500"><span class="linenos">500</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-501"><a href="#BaseDie-501"><span class="linenos">501</span></a>        <span class="k">if</span> <span class="n">outcomes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseDie-502"><a href="#BaseDie-502"><span class="linenos">502</span></a>            <span class="n">outcomes</span> <span class="o">=</span> <span class="p">{</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_outcome</span><span class="p">()</span> <span class="p">}</span>
</span><span id="BaseDie-503"><a href="#BaseDie-503"><span class="linenos">503</span></a>        <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">outcomes</span><span class="p">):</span>
</span><span id="BaseDie-504"><a href="#BaseDie-504"><span class="linenos">504</span></a>            <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap_unpack</span><span class="p">(</span><span class="n">outcomes</span><span class="p">)</span>
</span><span id="BaseDie-505"><a href="#BaseDie-505"><span class="linenos">505</span></a>            <span class="n">outcomes</span> <span class="o">=</span> <span class="p">{</span> <span class="n">outcome</span> <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()</span> <span class="k">if</span> <span class="n">func</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span> <span class="p">}</span>
</span><span id="BaseDie-506"><a href="#BaseDie-506"><span class="linenos">506</span></a>        
</span><span id="BaseDie-507"><a href="#BaseDie-507"><span class="linenos">507</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">outcomes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="BaseDie-508"><a href="#BaseDie-508"><span class="linenos">508</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="BaseDie-509"><a href="#BaseDie-509"><span class="linenos">509</span></a>        
</span><span id="BaseDie-510"><a href="#BaseDie-510"><span class="linenos">510</span></a>        <span class="k">if</span> <span class="n">max_depth</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseDie-511"><a href="#BaseDie-511"><span class="linenos">511</span></a>            <span class="n">max_depth</span> <span class="o">=</span> <span class="mi">9</span>
</span><span id="BaseDie-512"><a href="#BaseDie-512"><span class="linenos">512</span></a>        <span class="k">elif</span> <span class="n">max_depth</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="BaseDie-513"><a href="#BaseDie-513"><span class="linenos">513</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;max_depth cannot be negative.&#39;</span><span class="p">)</span>
</span><span id="BaseDie-514"><a href="#BaseDie-514"><span class="linenos">514</span></a>        <span class="k">elif</span> <span class="n">max_depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="BaseDie-515"><a href="#BaseDie-515"><span class="linenos">515</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="BaseDie-516"><a href="#BaseDie-516"><span class="linenos">516</span></a>        
</span><span id="BaseDie-517"><a href="#BaseDie-517"><span class="linenos">517</span></a>        <span class="n">tail_die</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">outcomes</span><span class="o">=</span><span class="n">outcomes</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="BaseDie-518"><a href="#BaseDie-518"><span class="linenos">518</span></a>        
</span><span id="BaseDie-519"><a href="#BaseDie-519"><span class="linenos">519</span></a>        <span class="k">def</span> <span class="nf">sub_func</span><span class="p">(</span><span class="n">outcome</span><span class="p">):</span>
</span><span id="BaseDie-520"><a href="#BaseDie-520"><span class="linenos">520</span></a>            <span class="k">if</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="n">outcomes</span><span class="p">:</span>
</span><span id="BaseDie-521"><a href="#BaseDie-521"><span class="linenos">521</span></a>                <span class="k">return</span> <span class="n">outcome</span> <span class="o">+</span> <span class="n">tail_die</span>
</span><span id="BaseDie-522"><a href="#BaseDie-522"><span class="linenos">522</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie-523"><a href="#BaseDie-523"><span class="linenos">523</span></a>                <span class="k">return</span> <span class="n">outcome</span>
</span><span id="BaseDie-524"><a href="#BaseDie-524"><span class="linenos">524</span></a>        
</span><span id="BaseDie-525"><a href="#BaseDie-525"><span class="linenos">525</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">sub_func</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">(),</span> <span class="n">denominator_method</span><span class="o">=</span><span class="s1">&#39;lcm&#39;</span><span class="p">)</span>
</span><span id="BaseDie-526"><a href="#BaseDie-526"><span class="linenos">526</span></a>    
</span><span id="BaseDie-527"><a href="#BaseDie-527"><span class="linenos">527</span></a>    <span class="c1"># Pools.</span>
</span><span id="BaseDie-528"><a href="#BaseDie-528"><span class="linenos">528</span></a>    
</span><span id="BaseDie-529"><a href="#BaseDie-529"><span class="linenos">529</span></a>    <span class="k">def</span> <span class="nf">lowest</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">):</span>
</span><span id="BaseDie-530"><a href="#BaseDie-530"><span class="linenos">530</span></a>        <span class="sd">&quot;&quot;&quot; Roll all the dice and take the lowest.</span>
</span><span id="BaseDie-531"><a href="#BaseDie-531"><span class="linenos">531</span></a><span class="sd">        </span>
</span><span id="BaseDie-532"><a href="#BaseDie-532"><span class="linenos">532</span></a><span class="sd">        The maximum outcome is equal to the highest maximum outcome among all input dice.</span>
</span><span id="BaseDie-533"><a href="#BaseDie-533"><span class="linenos">533</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-534"><a href="#BaseDie-534"><span class="linenos">534</span></a>        <span class="n">dice</span><span class="p">,</span> <span class="n">ndim</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">dice_with_common_ndim</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">)</span>
</span><span id="BaseDie-535"><a href="#BaseDie-535"><span class="linenos">535</span></a>        <span class="n">max_outcome</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">max_outcome</span><span class="p">()</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">)</span>
</span><span id="BaseDie-536"><a href="#BaseDie-536"><span class="linenos">536</span></a>        <span class="n">dice</span> <span class="o">=</span> <span class="p">[</span><span class="n">die</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">max_outcome</span><span class="o">=</span><span class="n">max_outcome</span><span class="p">)</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">]</span>
</span><span id="BaseDie-537"><a href="#BaseDie-537"><span class="linenos">537</span></a>        <span class="n">dice</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">)</span>
</span><span id="BaseDie-538"><a href="#BaseDie-538"><span class="linenos">538</span></a>        <span class="n">sweights</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">sweights</span><span class="p">()</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">)))</span>
</span><span id="BaseDie-539"><a href="#BaseDie-539"><span class="linenos">539</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">from_sweights</span><span class="p">(</span><span class="n">dice</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="n">sweights</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">)</span>
</span><span id="BaseDie-540"><a href="#BaseDie-540"><span class="linenos">540</span></a>    
</span><span id="BaseDie-541"><a href="#BaseDie-541"><span class="linenos">541</span></a>    <span class="k">def</span> <span class="nf">highest</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">):</span>
</span><span id="BaseDie-542"><a href="#BaseDie-542"><span class="linenos">542</span></a>        <span class="sd">&quot;&quot;&quot; Roll all the dice and take the highest.</span>
</span><span id="BaseDie-543"><a href="#BaseDie-543"><span class="linenos">543</span></a><span class="sd">        </span>
</span><span id="BaseDie-544"><a href="#BaseDie-544"><span class="linenos">544</span></a><span class="sd">        The minimum outcome is equal to the highest minimum outcome among all input dice.</span>
</span><span id="BaseDie-545"><a href="#BaseDie-545"><span class="linenos">545</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-546"><a href="#BaseDie-546"><span class="linenos">546</span></a>        <span class="n">dice</span><span class="p">,</span> <span class="n">ndim</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">dice_with_common_ndim</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">)</span>
</span><span id="BaseDie-547"><a href="#BaseDie-547"><span class="linenos">547</span></a>        <span class="n">min_outcome</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">min_outcome</span><span class="p">()</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">)</span>
</span><span id="BaseDie-548"><a href="#BaseDie-548"><span class="linenos">548</span></a>        <span class="n">dice</span> <span class="o">=</span> <span class="p">[</span><span class="n">die</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">min_outcome</span><span class="o">=</span><span class="n">min_outcome</span><span class="p">)</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">]</span>
</span><span id="BaseDie-549"><a href="#BaseDie-549"><span class="linenos">549</span></a>        <span class="n">dice</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">)</span>
</span><span id="BaseDie-550"><a href="#BaseDie-550"><span class="linenos">550</span></a>        <span class="n">cweights</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">cweights</span><span class="p">()</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">)))</span>
</span><span id="BaseDie-551"><a href="#BaseDie-551"><span class="linenos">551</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">from_cweights</span><span class="p">(</span><span class="n">dice</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="n">cweights</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">)</span>
</span><span id="BaseDie-552"><a href="#BaseDie-552"><span class="linenos">552</span></a>
</span><span id="BaseDie-553"><a href="#BaseDie-553"><span class="linenos">553</span></a>    <span class="nd">@cached_property</span>
</span><span id="BaseDie-554"><a href="#BaseDie-554"><span class="linenos">554</span></a>    <span class="k">def</span> <span class="nf">_repeat_and_sum_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-555"><a href="#BaseDie-555"><span class="linenos">555</span></a>        <span class="k">return</span> <span class="p">{}</span>
</span><span id="BaseDie-556"><a href="#BaseDie-556"><span class="linenos">556</span></a>    
</span><span id="BaseDie-557"><a href="#BaseDie-557"><span class="linenos">557</span></a>    <span class="k">def</span> <span class="nf">repeat_and_sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_dice</span><span class="p">):</span>
</span><span id="BaseDie-558"><a href="#BaseDie-558"><span class="linenos">558</span></a>        <span class="sd">&quot;&quot;&quot; Roll this die `num_dice` times and sum the results. </span>
</span><span id="BaseDie-559"><a href="#BaseDie-559"><span class="linenos">559</span></a><span class="sd">        </span>
</span><span id="BaseDie-560"><a href="#BaseDie-560"><span class="linenos">560</span></a><span class="sd">        If `num_dice` is negative, roll the die `abs(num_dice)` times and negate the result.</span>
</span><span id="BaseDie-561"><a href="#BaseDie-561"><span class="linenos">561</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-562"><a href="#BaseDie-562"><span class="linenos">562</span></a>        <span class="k">if</span> <span class="n">num_dice</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_repeat_and_sum_cache</span><span class="p">:</span>
</span><span id="BaseDie-563"><a href="#BaseDie-563"><span class="linenos">563</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_repeat_and_sum_cache</span><span class="p">[</span><span class="n">num_dice</span><span class="p">]</span>
</span><span id="BaseDie-564"><a href="#BaseDie-564"><span class="linenos">564</span></a>        
</span><span id="BaseDie-565"><a href="#BaseDie-565"><span class="linenos">565</span></a>        <span class="k">if</span> <span class="n">num_dice</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="BaseDie-566"><a href="#BaseDie-566"><span class="linenos">566</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">repeat_and_sum</span><span class="p">(</span><span class="o">-</span><span class="n">num_dice</span><span class="p">)</span>
</span><span id="BaseDie-567"><a href="#BaseDie-567"><span class="linenos">567</span></a>        <span class="k">elif</span> <span class="n">num_dice</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="BaseDie-568"><a href="#BaseDie-568"><span class="linenos">568</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span>
</span><span id="BaseDie-569"><a href="#BaseDie-569"><span class="linenos">569</span></a>        <span class="k">elif</span> <span class="n">num_dice</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="BaseDie-570"><a href="#BaseDie-570"><span class="linenos">570</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="BaseDie-571"><a href="#BaseDie-571"><span class="linenos">571</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie-572"><a href="#BaseDie-572"><span class="linenos">572</span></a>            <span class="c1"># Binary split seems to perform much worse.</span>
</span><span id="BaseDie-573"><a href="#BaseDie-573"><span class="linenos">573</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeat_and_sum</span><span class="p">(</span><span class="n">num_dice</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="BaseDie-574"><a href="#BaseDie-574"><span class="linenos">574</span></a>        
</span><span id="BaseDie-575"><a href="#BaseDie-575"><span class="linenos">575</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_repeat_and_sum_cache</span><span class="p">[</span><span class="n">num_dice</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
</span><span id="BaseDie-576"><a href="#BaseDie-576"><span class="linenos">576</span></a>        <span class="k">return</span> <span class="n">result</span>
</span><span id="BaseDie-577"><a href="#BaseDie-577"><span class="linenos">577</span></a>    
</span><span id="BaseDie-578"><a href="#BaseDie-578"><span class="linenos">578</span></a>    <span class="k">def</span> <span class="nf">pool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="BaseDie-579"><a href="#BaseDie-579"><span class="linenos">579</span></a>        <span class="sd">&quot;&quot;&quot; Creates a pool from this die, as `icepool.Pool()`. &quot;&quot;&quot;</span>
</span><span id="BaseDie-580"><a href="#BaseDie-580"><span class="linenos">580</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="BaseDie-581"><a href="#BaseDie-581"><span class="linenos">581</span></a>    
</span><span id="BaseDie-582"><a href="#BaseDie-582"><span class="linenos">582</span></a>    <span class="k">def</span> <span class="nf">keep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_dice</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">count_dice</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">truncate_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">truncate_max</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseDie-583"><a href="#BaseDie-583"><span class="linenos">583</span></a>        <span class="sd">&quot;&quot;&quot; Roll this die several times, possibly truncating the maximum outcomes, and sum some or all of the sorted results.</span>
</span><span id="BaseDie-584"><a href="#BaseDie-584"><span class="linenos">584</span></a><span class="sd">        </span>
</span><span id="BaseDie-585"><a href="#BaseDie-585"><span class="linenos">585</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie-586"><a href="#BaseDie-586"><span class="linenos">586</span></a><span class="sd">            num_dice: The number of dice to roll. All dice will have the same outcomes as `self`.</span>
</span><span id="BaseDie-587"><a href="#BaseDie-587"><span class="linenos">587</span></a><span class="sd">            count_dice: Only dice selected by this will be counted.</span>
</span><span id="BaseDie-588"><a href="#BaseDie-588"><span class="linenos">588</span></a><span class="sd">                See `DicePool.count_dice()` for details.</span>
</span><span id="BaseDie-589"><a href="#BaseDie-589"><span class="linenos">589</span></a><span class="sd">            truncate_min: A sequence of one outcome per die.</span>
</span><span id="BaseDie-590"><a href="#BaseDie-590"><span class="linenos">590</span></a><span class="sd">                That die will be truncated to that minimum outcome, with all lower outcomes being removed (i.e. rerolled).</span>
</span><span id="BaseDie-591"><a href="#BaseDie-591"><span class="linenos">591</span></a><span class="sd">                This is not compatible with `truncate_max`.</span>
</span><span id="BaseDie-592"><a href="#BaseDie-592"><span class="linenos">592</span></a><span class="sd">            truncate_max: A sequence of one outcome per die.</span>
</span><span id="BaseDie-593"><a href="#BaseDie-593"><span class="linenos">593</span></a><span class="sd">                That die will be truncated to that maximum outcome, with all higher outcomes being removed (i.e. rerolled).</span>
</span><span id="BaseDie-594"><a href="#BaseDie-594"><span class="linenos">594</span></a><span class="sd">                This is not compatible with `truncate_min`.</span>
</span><span id="BaseDie-595"><a href="#BaseDie-595"><span class="linenos">595</span></a><span class="sd">                </span>
</span><span id="BaseDie-596"><a href="#BaseDie-596"><span class="linenos">596</span></a><span class="sd">        Returns:</span>
</span><span id="BaseDie-597"><a href="#BaseDie-597"><span class="linenos">597</span></a><span class="sd">            A Die representing the probability distribution of the sum.</span>
</span><span id="BaseDie-598"><a href="#BaseDie-598"><span class="linenos">598</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-599"><a href="#BaseDie-599"><span class="linenos">599</span></a>        <span class="n">pool</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_dice</span><span class="p">,</span> <span class="n">count_dice</span><span class="o">=</span><span class="n">count_dice</span><span class="p">,</span> <span class="n">truncate_min</span><span class="o">=</span><span class="n">truncate_min</span><span class="p">,</span> <span class="n">truncate_max</span><span class="o">=</span><span class="n">truncate_max</span><span class="p">)</span>
</span><span id="BaseDie-600"><a href="#BaseDie-600"><span class="linenos">600</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">count_dice</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="BaseDie-601"><a href="#BaseDie-601"><span class="linenos">601</span></a>            <span class="k">return</span> <span class="n">pool</span>
</span><span id="BaseDie-602"><a href="#BaseDie-602"><span class="linenos">602</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie-603"><a href="#BaseDie-603"><span class="linenos">603</span></a>            <span class="k">return</span> <span class="n">pool</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="BaseDie-604"><a href="#BaseDie-604"><span class="linenos">604</span></a>    
</span><span id="BaseDie-605"><a href="#BaseDie-605"><span class="linenos">605</span></a>    <span class="k">def</span> <span class="nf">keep_highest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_dice</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_keep</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_drop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">truncate_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">truncate_max</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseDie-606"><a href="#BaseDie-606"><span class="linenos">606</span></a>        <span class="sd">&quot;&quot;&quot; Roll this die several times, possibly truncating the maximum outcomes, and sum the sorted results from the highest.</span>
</span><span id="BaseDie-607"><a href="#BaseDie-607"><span class="linenos">607</span></a><span class="sd">        </span>
</span><span id="BaseDie-608"><a href="#BaseDie-608"><span class="linenos">608</span></a><span class="sd">        Exactly one out of `num_dice`, `truncate_min`, and `truncate_max` should be provided.</span>
</span><span id="BaseDie-609"><a href="#BaseDie-609"><span class="linenos">609</span></a><span class="sd">        </span>
</span><span id="BaseDie-610"><a href="#BaseDie-610"><span class="linenos">610</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie-611"><a href="#BaseDie-611"><span class="linenos">611</span></a><span class="sd">            num_dice: The number of dice to roll. All dice will have the same outcomes as `self`.</span>
</span><span id="BaseDie-612"><a href="#BaseDie-612"><span class="linenos">612</span></a><span class="sd">            num_keep: The number of dice to keep.</span>
</span><span id="BaseDie-613"><a href="#BaseDie-613"><span class="linenos">613</span></a><span class="sd">            num_drop: If provided, this many highest dice will be dropped before keeping.</span>
</span><span id="BaseDie-614"><a href="#BaseDie-614"><span class="linenos">614</span></a><span class="sd">            truncate_min: A sequence of one outcome per die.</span>
</span><span id="BaseDie-615"><a href="#BaseDie-615"><span class="linenos">615</span></a><span class="sd">                That die will be truncated to that minimum outcome, with all lower outcomes being removed (i.e. rerolled).</span>
</span><span id="BaseDie-616"><a href="#BaseDie-616"><span class="linenos">616</span></a><span class="sd">            truncate_max: A sequence of one outcome per die.</span>
</span><span id="BaseDie-617"><a href="#BaseDie-617"><span class="linenos">617</span></a><span class="sd">                That die will be truncated to that maximum outcome, with all higher outcomes being removed (i.e. rerolled).</span>
</span><span id="BaseDie-618"><a href="#BaseDie-618"><span class="linenos">618</span></a><span class="sd">                </span>
</span><span id="BaseDie-619"><a href="#BaseDie-619"><span class="linenos">619</span></a><span class="sd">        Returns:</span>
</span><span id="BaseDie-620"><a href="#BaseDie-620"><span class="linenos">620</span></a><span class="sd">            A die representing the probability distribution of the sum.</span>
</span><span id="BaseDie-621"><a href="#BaseDie-621"><span class="linenos">621</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-622"><a href="#BaseDie-622"><span class="linenos">622</span></a>        <span class="k">if</span> <span class="n">num_keep</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">num_drop</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">truncate_min</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">truncate_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseDie-623"><a href="#BaseDie-623"><span class="linenos">623</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep_highest_single</span><span class="p">(</span><span class="n">num_dice</span><span class="p">)</span>
</span><span id="BaseDie-624"><a href="#BaseDie-624"><span class="linenos">624</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">num_keep</span> <span class="o">+</span> <span class="p">(</span><span class="n">num_drop</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="BaseDie-625"><a href="#BaseDie-625"><span class="linenos">625</span></a>        <span class="n">stop</span> <span class="o">=</span> <span class="o">-</span><span class="n">num_drop</span> <span class="k">if</span> <span class="n">num_drop</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="BaseDie-626"><a href="#BaseDie-626"><span class="linenos">626</span></a>        <span class="n">count_dice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">)</span>
</span><span id="BaseDie-627"><a href="#BaseDie-627"><span class="linenos">627</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep</span><span class="p">(</span><span class="n">num_dice</span><span class="p">,</span> <span class="n">count_dice</span><span class="p">,</span> <span class="n">truncate_min</span><span class="o">=</span><span class="n">truncate_min</span><span class="p">,</span> <span class="n">truncate_max</span><span class="o">=</span><span class="n">truncate_max</span><span class="p">)</span>
</span><span id="BaseDie-628"><a href="#BaseDie-628"><span class="linenos">628</span></a>    
</span><span id="BaseDie-629"><a href="#BaseDie-629"><span class="linenos">629</span></a>    <span class="k">def</span> <span class="nf">keep_highest_single</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_dice</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseDie-630"><a href="#BaseDie-630"><span class="linenos">630</span></a>        <span class="sd">&quot;&quot;&quot; Faster algorithm for keeping just the single highest die. &quot;&quot;&quot;</span>
</span><span id="BaseDie-631"><a href="#BaseDie-631"><span class="linenos">631</span></a>        <span class="k">if</span> <span class="n">num_dice</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseDie-632"><a href="#BaseDie-632"><span class="linenos">632</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span>
</span><span id="BaseDie-633"><a href="#BaseDie-633"><span class="linenos">633</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">from_cweights</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="n">num_dice</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cweights</span><span class="p">()),</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-634"><a href="#BaseDie-634"><span class="linenos">634</span></a>    
</span><span id="BaseDie-635"><a href="#BaseDie-635"><span class="linenos">635</span></a>    <span class="k">def</span> <span class="nf">keep_lowest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_dice</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_keep</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_drop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">truncate_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">truncate_max</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseDie-636"><a href="#BaseDie-636"><span class="linenos">636</span></a>        <span class="sd">&quot;&quot;&quot; Roll this die several times, possibly capping the maximum outcomes, and sum the sorted results from the lowest.</span>
</span><span id="BaseDie-637"><a href="#BaseDie-637"><span class="linenos">637</span></a><span class="sd">        </span>
</span><span id="BaseDie-638"><a href="#BaseDie-638"><span class="linenos">638</span></a><span class="sd">        Exactly one out of `num_dice`, `truncate_min`, and `truncate_max` should be provided.</span>
</span><span id="BaseDie-639"><a href="#BaseDie-639"><span class="linenos">639</span></a><span class="sd">        </span>
</span><span id="BaseDie-640"><a href="#BaseDie-640"><span class="linenos">640</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie-641"><a href="#BaseDie-641"><span class="linenos">641</span></a><span class="sd">            num_dice: The number of dice to roll. All dice will have the same outcomes as `self`.</span>
</span><span id="BaseDie-642"><a href="#BaseDie-642"><span class="linenos">642</span></a><span class="sd">            num_keep: The number of dice to keep.</span>
</span><span id="BaseDie-643"><a href="#BaseDie-643"><span class="linenos">643</span></a><span class="sd">            num_drop: If provided, this many lowest dice will be dropped before keeping.</span>
</span><span id="BaseDie-644"><a href="#BaseDie-644"><span class="linenos">644</span></a><span class="sd">            truncate_min: A sequence of one outcome per die.</span>
</span><span id="BaseDie-645"><a href="#BaseDie-645"><span class="linenos">645</span></a><span class="sd">                That die will be truncated to that minimum outcome, with all lower outcomes being removed (i.e. rerolled).</span>
</span><span id="BaseDie-646"><a href="#BaseDie-646"><span class="linenos">646</span></a><span class="sd">            truncate_max: A sequence of one outcome per die.</span>
</span><span id="BaseDie-647"><a href="#BaseDie-647"><span class="linenos">647</span></a><span class="sd">                That die will be truncated to that maximum outcome, with all higher outcomes being removed (i.e. rerolled).</span>
</span><span id="BaseDie-648"><a href="#BaseDie-648"><span class="linenos">648</span></a><span class="sd">                </span>
</span><span id="BaseDie-649"><a href="#BaseDie-649"><span class="linenos">649</span></a><span class="sd">        Returns:</span>
</span><span id="BaseDie-650"><a href="#BaseDie-650"><span class="linenos">650</span></a><span class="sd">            A die representing the probability distribution of the sum.</span>
</span><span id="BaseDie-651"><a href="#BaseDie-651"><span class="linenos">651</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-652"><a href="#BaseDie-652"><span class="linenos">652</span></a>        <span class="k">if</span> <span class="n">num_keep</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">num_drop</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">truncate_min</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">truncate_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseDie-653"><a href="#BaseDie-653"><span class="linenos">653</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep_lowest_single</span><span class="p">(</span><span class="n">num_dice</span><span class="p">)</span>
</span><span id="BaseDie-654"><a href="#BaseDie-654"><span class="linenos">654</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="n">num_drop</span> <span class="k">if</span> <span class="n">num_drop</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="BaseDie-655"><a href="#BaseDie-655"><span class="linenos">655</span></a>        <span class="n">stop</span> <span class="o">=</span> <span class="n">num_keep</span> <span class="o">+</span> <span class="p">(</span><span class="n">num_drop</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="BaseDie-656"><a href="#BaseDie-656"><span class="linenos">656</span></a>        <span class="n">count_dice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">)</span>
</span><span id="BaseDie-657"><a href="#BaseDie-657"><span class="linenos">657</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep</span><span class="p">(</span><span class="n">num_dice</span><span class="p">,</span> <span class="n">count_dice</span><span class="p">,</span> <span class="n">truncate_min</span><span class="o">=</span><span class="n">truncate_min</span><span class="p">,</span> <span class="n">truncate_max</span><span class="o">=</span><span class="n">truncate_max</span><span class="p">)</span>
</span><span id="BaseDie-658"><a href="#BaseDie-658"><span class="linenos">658</span></a>    
</span><span id="BaseDie-659"><a href="#BaseDie-659"><span class="linenos">659</span></a>    <span class="k">def</span> <span class="nf">keep_lowest_single</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_dice</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseDie-660"><a href="#BaseDie-660"><span class="linenos">660</span></a>        <span class="sd">&quot;&quot;&quot; Faster algorithm for keeping just the single lowest die. &quot;&quot;&quot;</span>
</span><span id="BaseDie-661"><a href="#BaseDie-661"><span class="linenos">661</span></a>        <span class="k">if</span> <span class="n">num_dice</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseDie-662"><a href="#BaseDie-662"><span class="linenos">662</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span>
</span><span id="BaseDie-663"><a href="#BaseDie-663"><span class="linenos">663</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">from_sweights</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="n">num_dice</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sweights</span><span class="p">()),</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-664"><a href="#BaseDie-664"><span class="linenos">664</span></a>    
</span><span id="BaseDie-665"><a href="#BaseDie-665"><span class="linenos">665</span></a>    <span class="c1"># Unary operators.</span>
</span><span id="BaseDie-666"><a href="#BaseDie-666"><span class="linenos">666</span></a>    
</span><span id="BaseDie-667"><a href="#BaseDie-667"><span class="linenos">667</span></a>    <span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-668"><a href="#BaseDie-668"><span class="linenos">668</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unary_op</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">neg</span><span class="p">)</span>
</span><span id="BaseDie-669"><a href="#BaseDie-669"><span class="linenos">669</span></a>    
</span><span id="BaseDie-670"><a href="#BaseDie-670"><span class="linenos">670</span></a>    <span class="k">def</span> <span class="fm">__pos__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-671"><a href="#BaseDie-671"><span class="linenos">671</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unary_op</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>
</span><span id="BaseDie-672"><a href="#BaseDie-672"><span class="linenos">672</span></a>    
</span><span id="BaseDie-673"><a href="#BaseDie-673"><span class="linenos">673</span></a>    <span class="k">def</span> <span class="fm">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-674"><a href="#BaseDie-674"><span class="linenos">674</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unary_op</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">abs</span><span class="p">)</span>
</span><span id="BaseDie-675"><a href="#BaseDie-675"><span class="linenos">675</span></a>    
</span><span id="BaseDie-676"><a href="#BaseDie-676"><span class="linenos">676</span></a>    <span class="nb">abs</span> <span class="o">=</span> <span class="fm">__abs__</span>
</span><span id="BaseDie-677"><a href="#BaseDie-677"><span class="linenos">677</span></a>    
</span><span id="BaseDie-678"><a href="#BaseDie-678"><span class="linenos">678</span></a>    <span class="k">def</span> <span class="fm">__invert__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-679"><a href="#BaseDie-679"><span class="linenos">679</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unary_op</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">invert</span><span class="p">)</span>
</span><span id="BaseDie-680"><a href="#BaseDie-680"><span class="linenos">680</span></a>    
</span><span id="BaseDie-681"><a href="#BaseDie-681"><span class="linenos">681</span></a>    <span class="k">def</span> <span class="fm">__round__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ndigits</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseDie-682"><a href="#BaseDie-682"><span class="linenos">682</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unary_op</span><span class="p">(</span><span class="nb">round</span><span class="p">,</span> <span class="n">ndigits</span><span class="p">)</span>
</span><span id="BaseDie-683"><a href="#BaseDie-683"><span class="linenos">683</span></a>    
</span><span id="BaseDie-684"><a href="#BaseDie-684"><span class="linenos">684</span></a>    <span class="k">def</span> <span class="nf">__trunc__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-685"><a href="#BaseDie-685"><span class="linenos">685</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unary_op</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">trunc</span><span class="p">)</span>
</span><span id="BaseDie-686"><a href="#BaseDie-686"><span class="linenos">686</span></a>    
</span><span id="BaseDie-687"><a href="#BaseDie-687"><span class="linenos">687</span></a>    <span class="k">def</span> <span class="nf">__floor__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-688"><a href="#BaseDie-688"><span class="linenos">688</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unary_op</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">)</span>
</span><span id="BaseDie-689"><a href="#BaseDie-689"><span class="linenos">689</span></a>    
</span><span id="BaseDie-690"><a href="#BaseDie-690"><span class="linenos">690</span></a>    <span class="k">def</span> <span class="nf">__ceil__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-691"><a href="#BaseDie-691"><span class="linenos">691</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unary_op</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">)</span>
</span><span id="BaseDie-692"><a href="#BaseDie-692"><span class="linenos">692</span></a>    
</span><span id="BaseDie-693"><a href="#BaseDie-693"><span class="linenos">693</span></a>    <span class="nd">@staticmethod</span>
</span><span id="BaseDie-694"><a href="#BaseDie-694"><span class="linenos">694</span></a>    <span class="k">def</span> <span class="nf">_zero</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="BaseDie-695"><a href="#BaseDie-695"><span class="linenos">695</span></a>        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)()</span>
</span><span id="BaseDie-696"><a href="#BaseDie-696"><span class="linenos">696</span></a>    
</span><span id="BaseDie-697"><a href="#BaseDie-697"><span class="linenos">697</span></a>    <span class="k">def</span> <span class="nf">zero</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-698"><a href="#BaseDie-698"><span class="linenos">698</span></a>        <span class="sd">&quot;&quot;&quot; Zeros all outcomes of this die. </span>
</span><span id="BaseDie-699"><a href="#BaseDie-699"><span class="linenos">699</span></a><span class="sd">        </span>
</span><span id="BaseDie-700"><a href="#BaseDie-700"><span class="linenos">700</span></a><span class="sd">        This is done by calling the constructor for each outcome&#39;s type with no arguments.</span>
</span><span id="BaseDie-701"><a href="#BaseDie-701"><span class="linenos">701</span></a><span class="sd">        </span>
</span><span id="BaseDie-702"><a href="#BaseDie-702"><span class="linenos">702</span></a><span class="sd">        The result will have a single outcome with weight 1.</span>
</span><span id="BaseDie-703"><a href="#BaseDie-703"><span class="linenos">703</span></a><span class="sd">        </span>
</span><span id="BaseDie-704"><a href="#BaseDie-704"><span class="linenos">704</span></a><span class="sd">        Raises:</span>
</span><span id="BaseDie-705"><a href="#BaseDie-705"><span class="linenos">705</span></a><span class="sd">            `ValueError` if the zeros did not resolve to a single outcome.</span>
</span><span id="BaseDie-706"><a href="#BaseDie-706"><span class="linenos">706</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-707"><a href="#BaseDie-707"><span class="linenos">707</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unary_op</span><span class="p">(</span><span class="n">BaseDie</span><span class="o">.</span><span class="n">_zero</span><span class="p">)</span>
</span><span id="BaseDie-708"><a href="#BaseDie-708"><span class="linenos">708</span></a>        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">num_outcomes</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="BaseDie-709"><a href="#BaseDie-709"><span class="linenos">709</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;zero() did not resolve to a single outcome.&#39;</span><span class="p">)</span>
</span><span id="BaseDie-710"><a href="#BaseDie-710"><span class="linenos">710</span></a>        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span>
</span><span id="BaseDie-711"><a href="#BaseDie-711"><span class="linenos">711</span></a>    
</span><span id="BaseDie-712"><a href="#BaseDie-712"><span class="linenos">712</span></a>    <span class="k">def</span> <span class="nf">zero_outcome</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-713"><a href="#BaseDie-713"><span class="linenos">713</span></a>        <span class="sd">&quot;&quot;&quot; Returns a zero-outcome for this die, e.g. `0` for a die whose outcomes are `int`s. &quot;&quot;&quot;</span>
</span><span id="BaseDie-714"><a href="#BaseDie-714"><span class="linenos">714</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="BaseDie-715"><a href="#BaseDie-715"><span class="linenos">715</span></a>    
</span><span id="BaseDie-716"><a href="#BaseDie-716"><span class="linenos">716</span></a>    <span class="k">def</span> <span class="nf">bool</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-717"><a href="#BaseDie-717"><span class="linenos">717</span></a>        <span class="sd">&quot;&quot;&quot; Takes `bool()` of all outcomes.</span>
</span><span id="BaseDie-718"><a href="#BaseDie-718"><span class="linenos">718</span></a><span class="sd">        </span>
</span><span id="BaseDie-719"><a href="#BaseDie-719"><span class="linenos">719</span></a><span class="sd">        Note the die as a whole is not considered to have a truth value.</span>
</span><span id="BaseDie-720"><a href="#BaseDie-720"><span class="linenos">720</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-721"><a href="#BaseDie-721"><span class="linenos">721</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unary_op</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="BaseDie-722"><a href="#BaseDie-722"><span class="linenos">722</span></a>    
</span><span id="BaseDie-723"><a href="#BaseDie-723"><span class="linenos">723</span></a>    <span class="c1"># Binary operators.</span>
</span><span id="BaseDie-724"><a href="#BaseDie-724"><span class="linenos">724</span></a>    
</span><span id="BaseDie-725"><a href="#BaseDie-725"><span class="linenos">725</span></a>    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-726"><a href="#BaseDie-726"><span class="linenos">726</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-727"><a href="#BaseDie-727"><span class="linenos">727</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">)</span>
</span><span id="BaseDie-728"><a href="#BaseDie-728"><span class="linenos">728</span></a>    
</span><span id="BaseDie-729"><a href="#BaseDie-729"><span class="linenos">729</span></a>    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-730"><a href="#BaseDie-730"><span class="linenos">730</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-731"><a href="#BaseDie-731"><span class="linenos">731</span></a>        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">)</span>
</span><span id="BaseDie-732"><a href="#BaseDie-732"><span class="linenos">732</span></a>    
</span><span id="BaseDie-733"><a href="#BaseDie-733"><span class="linenos">733</span></a>    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-734"><a href="#BaseDie-734"><span class="linenos">734</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-735"><a href="#BaseDie-735"><span class="linenos">735</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">sub</span><span class="p">)</span>
</span><span id="BaseDie-736"><a href="#BaseDie-736"><span class="linenos">736</span></a>    
</span><span id="BaseDie-737"><a href="#BaseDie-737"><span class="linenos">737</span></a>    <span class="k">def</span> <span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-738"><a href="#BaseDie-738"><span class="linenos">738</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-739"><a href="#BaseDie-739"><span class="linenos">739</span></a>        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">sub</span><span class="p">)</span>
</span><span id="BaseDie-740"><a href="#BaseDie-740"><span class="linenos">740</span></a>    
</span><span id="BaseDie-741"><a href="#BaseDie-741"><span class="linenos">741</span></a>    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-742"><a href="#BaseDie-742"><span class="linenos">742</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-743"><a href="#BaseDie-743"><span class="linenos">743</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">mul</span><span class="p">)</span>
</span><span id="BaseDie-744"><a href="#BaseDie-744"><span class="linenos">744</span></a>    
</span><span id="BaseDie-745"><a href="#BaseDie-745"><span class="linenos">745</span></a>    <span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-746"><a href="#BaseDie-746"><span class="linenos">746</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-747"><a href="#BaseDie-747"><span class="linenos">747</span></a>        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">mul</span><span class="p">)</span>
</span><span id="BaseDie-748"><a href="#BaseDie-748"><span class="linenos">748</span></a>        
</span><span id="BaseDie-749"><a href="#BaseDie-749"><span class="linenos">749</span></a>    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-750"><a href="#BaseDie-750"><span class="linenos">750</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-751"><a href="#BaseDie-751"><span class="linenos">751</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">truediv</span><span class="p">)</span>
</span><span id="BaseDie-752"><a href="#BaseDie-752"><span class="linenos">752</span></a>    
</span><span id="BaseDie-753"><a href="#BaseDie-753"><span class="linenos">753</span></a>    <span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-754"><a href="#BaseDie-754"><span class="linenos">754</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-755"><a href="#BaseDie-755"><span class="linenos">755</span></a>        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">truediv</span><span class="p">)</span>
</span><span id="BaseDie-756"><a href="#BaseDie-756"><span class="linenos">756</span></a>    
</span><span id="BaseDie-757"><a href="#BaseDie-757"><span class="linenos">757</span></a>    <span class="k">def</span> <span class="fm">__floordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-758"><a href="#BaseDie-758"><span class="linenos">758</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-759"><a href="#BaseDie-759"><span class="linenos">759</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">floordiv</span><span class="p">)</span>
</span><span id="BaseDie-760"><a href="#BaseDie-760"><span class="linenos">760</span></a>    
</span><span id="BaseDie-761"><a href="#BaseDie-761"><span class="linenos">761</span></a>    <span class="k">def</span> <span class="fm">__rfloordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-762"><a href="#BaseDie-762"><span class="linenos">762</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-763"><a href="#BaseDie-763"><span class="linenos">763</span></a>        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">floordiv</span><span class="p">)</span>
</span><span id="BaseDie-764"><a href="#BaseDie-764"><span class="linenos">764</span></a>    
</span><span id="BaseDie-765"><a href="#BaseDie-765"><span class="linenos">765</span></a>    <span class="k">def</span> <span class="fm">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-766"><a href="#BaseDie-766"><span class="linenos">766</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-767"><a href="#BaseDie-767"><span class="linenos">767</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">pow</span><span class="p">)</span>
</span><span id="BaseDie-768"><a href="#BaseDie-768"><span class="linenos">768</span></a>    
</span><span id="BaseDie-769"><a href="#BaseDie-769"><span class="linenos">769</span></a>    <span class="k">def</span> <span class="fm">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-770"><a href="#BaseDie-770"><span class="linenos">770</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-771"><a href="#BaseDie-771"><span class="linenos">771</span></a>        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">pow</span><span class="p">)</span>
</span><span id="BaseDie-772"><a href="#BaseDie-772"><span class="linenos">772</span></a>    
</span><span id="BaseDie-773"><a href="#BaseDie-773"><span class="linenos">773</span></a>    <span class="k">def</span> <span class="fm">__mod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-774"><a href="#BaseDie-774"><span class="linenos">774</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-775"><a href="#BaseDie-775"><span class="linenos">775</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">mod</span><span class="p">)</span>
</span><span id="BaseDie-776"><a href="#BaseDie-776"><span class="linenos">776</span></a>    
</span><span id="BaseDie-777"><a href="#BaseDie-777"><span class="linenos">777</span></a>    <span class="k">def</span> <span class="fm">__rmod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-778"><a href="#BaseDie-778"><span class="linenos">778</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-779"><a href="#BaseDie-779"><span class="linenos">779</span></a>        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">mod</span><span class="p">)</span>
</span><span id="BaseDie-780"><a href="#BaseDie-780"><span class="linenos">780</span></a>    
</span><span id="BaseDie-781"><a href="#BaseDie-781"><span class="linenos">781</span></a>    <span class="k">def</span> <span class="fm">__lshift__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-782"><a href="#BaseDie-782"><span class="linenos">782</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-783"><a href="#BaseDie-783"><span class="linenos">783</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">lshift</span><span class="p">)</span>
</span><span id="BaseDie-784"><a href="#BaseDie-784"><span class="linenos">784</span></a>    
</span><span id="BaseDie-785"><a href="#BaseDie-785"><span class="linenos">785</span></a>    <span class="k">def</span> <span class="fm">__rlshift__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-786"><a href="#BaseDie-786"><span class="linenos">786</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-787"><a href="#BaseDie-787"><span class="linenos">787</span></a>        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">lshift</span><span class="p">)</span>
</span><span id="BaseDie-788"><a href="#BaseDie-788"><span class="linenos">788</span></a>    
</span><span id="BaseDie-789"><a href="#BaseDie-789"><span class="linenos">789</span></a>    <span class="k">def</span> <span class="fm">__rshift__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-790"><a href="#BaseDie-790"><span class="linenos">790</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-791"><a href="#BaseDie-791"><span class="linenos">791</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">rshift</span><span class="p">)</span>
</span><span id="BaseDie-792"><a href="#BaseDie-792"><span class="linenos">792</span></a>    
</span><span id="BaseDie-793"><a href="#BaseDie-793"><span class="linenos">793</span></a>    <span class="k">def</span> <span class="fm">__rrshift__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-794"><a href="#BaseDie-794"><span class="linenos">794</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-795"><a href="#BaseDie-795"><span class="linenos">795</span></a>        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">rshift</span><span class="p">)</span>
</span><span id="BaseDie-796"><a href="#BaseDie-796"><span class="linenos">796</span></a>    
</span><span id="BaseDie-797"><a href="#BaseDie-797"><span class="linenos">797</span></a>    <span class="k">def</span> <span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-798"><a href="#BaseDie-798"><span class="linenos">798</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-799"><a href="#BaseDie-799"><span class="linenos">799</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">and_</span><span class="p">)</span>
</span><span id="BaseDie-800"><a href="#BaseDie-800"><span class="linenos">800</span></a>    
</span><span id="BaseDie-801"><a href="#BaseDie-801"><span class="linenos">801</span></a>    <span class="k">def</span> <span class="fm">__rand__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-802"><a href="#BaseDie-802"><span class="linenos">802</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-803"><a href="#BaseDie-803"><span class="linenos">803</span></a>        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">and_</span><span class="p">)</span>
</span><span id="BaseDie-804"><a href="#BaseDie-804"><span class="linenos">804</span></a>        
</span><span id="BaseDie-805"><a href="#BaseDie-805"><span class="linenos">805</span></a>    <span class="k">def</span> <span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-806"><a href="#BaseDie-806"><span class="linenos">806</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-807"><a href="#BaseDie-807"><span class="linenos">807</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">or_</span><span class="p">)</span>
</span><span id="BaseDie-808"><a href="#BaseDie-808"><span class="linenos">808</span></a>    
</span><span id="BaseDie-809"><a href="#BaseDie-809"><span class="linenos">809</span></a>    <span class="k">def</span> <span class="fm">__ror__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-810"><a href="#BaseDie-810"><span class="linenos">810</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-811"><a href="#BaseDie-811"><span class="linenos">811</span></a>        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">or_</span><span class="p">)</span>
</span><span id="BaseDie-812"><a href="#BaseDie-812"><span class="linenos">812</span></a>    
</span><span id="BaseDie-813"><a href="#BaseDie-813"><span class="linenos">813</span></a>    <span class="k">def</span> <span class="fm">__xor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-814"><a href="#BaseDie-814"><span class="linenos">814</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-815"><a href="#BaseDie-815"><span class="linenos">815</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">xor</span><span class="p">)</span>
</span><span id="BaseDie-816"><a href="#BaseDie-816"><span class="linenos">816</span></a>    
</span><span id="BaseDie-817"><a href="#BaseDie-817"><span class="linenos">817</span></a>    <span class="k">def</span> <span class="fm">__rxor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-818"><a href="#BaseDie-818"><span class="linenos">818</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-819"><a href="#BaseDie-819"><span class="linenos">819</span></a>        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">xor</span><span class="p">)</span>
</span><span id="BaseDie-820"><a href="#BaseDie-820"><span class="linenos">820</span></a>    
</span><span id="BaseDie-821"><a href="#BaseDie-821"><span class="linenos">821</span></a>    <span class="c1"># Comparators.</span>
</span><span id="BaseDie-822"><a href="#BaseDie-822"><span class="linenos">822</span></a>    
</span><span id="BaseDie-823"><a href="#BaseDie-823"><span class="linenos">823</span></a>    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-824"><a href="#BaseDie-824"><span class="linenos">824</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-825"><a href="#BaseDie-825"><span class="linenos">825</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">lt</span><span class="p">)</span>
</span><span id="BaseDie-826"><a href="#BaseDie-826"><span class="linenos">826</span></a>        
</span><span id="BaseDie-827"><a href="#BaseDie-827"><span class="linenos">827</span></a>    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-828"><a href="#BaseDie-828"><span class="linenos">828</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-829"><a href="#BaseDie-829"><span class="linenos">829</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">le</span><span class="p">)</span>
</span><span id="BaseDie-830"><a href="#BaseDie-830"><span class="linenos">830</span></a>    
</span><span id="BaseDie-831"><a href="#BaseDie-831"><span class="linenos">831</span></a>    <span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-832"><a href="#BaseDie-832"><span class="linenos">832</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-833"><a href="#BaseDie-833"><span class="linenos">833</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">ge</span><span class="p">)</span>
</span><span id="BaseDie-834"><a href="#BaseDie-834"><span class="linenos">834</span></a>        
</span><span id="BaseDie-835"><a href="#BaseDie-835"><span class="linenos">835</span></a>    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-836"><a href="#BaseDie-836"><span class="linenos">836</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-837"><a href="#BaseDie-837"><span class="linenos">837</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">gt</span><span class="p">)</span>
</span><span id="BaseDie-838"><a href="#BaseDie-838"><span class="linenos">838</span></a>    
</span><span id="BaseDie-839"><a href="#BaseDie-839"><span class="linenos">839</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-840"><a href="#BaseDie-840"><span class="linenos">840</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-841"><a href="#BaseDie-841"><span class="linenos">841</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">eq</span><span class="p">)</span>
</span><span id="BaseDie-842"><a href="#BaseDie-842"><span class="linenos">842</span></a>    
</span><span id="BaseDie-843"><a href="#BaseDie-843"><span class="linenos">843</span></a>    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-844"><a href="#BaseDie-844"><span class="linenos">844</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-845"><a href="#BaseDie-845"><span class="linenos">845</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">ne</span><span class="p">)</span>
</span><span id="BaseDie-846"><a href="#BaseDie-846"><span class="linenos">846</span></a>    
</span><span id="BaseDie-847"><a href="#BaseDie-847"><span class="linenos">847</span></a>    <span class="nd">@staticmethod</span>
</span><span id="BaseDie-848"><a href="#BaseDie-848"><span class="linenos">848</span></a>    <span class="k">def</span> <span class="nf">_sign</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="BaseDie-849"><a href="#BaseDie-849"><span class="linenos">849</span></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">BaseDie</span><span class="o">.</span><span class="n">_zero</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="BaseDie-850"><a href="#BaseDie-850"><span class="linenos">850</span></a>        <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">z</span><span class="p">:</span>
</span><span id="BaseDie-851"><a href="#BaseDie-851"><span class="linenos">851</span></a>            <span class="k">return</span> <span class="mi">1</span>
</span><span id="BaseDie-852"><a href="#BaseDie-852"><span class="linenos">852</span></a>        <span class="k">elif</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">z</span><span class="p">:</span>
</span><span id="BaseDie-853"><a href="#BaseDie-853"><span class="linenos">853</span></a>            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="BaseDie-854"><a href="#BaseDie-854"><span class="linenos">854</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie-855"><a href="#BaseDie-855"><span class="linenos">855</span></a>            <span class="k">return</span> <span class="mi">0</span>
</span><span id="BaseDie-856"><a href="#BaseDie-856"><span class="linenos">856</span></a>    
</span><span id="BaseDie-857"><a href="#BaseDie-857"><span class="linenos">857</span></a>    <span class="k">def</span> <span class="nf">sign</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-858"><a href="#BaseDie-858"><span class="linenos">858</span></a>        <span class="sd">&quot;&quot;&quot; Outcomes become 1 if greater than `zero()`, -1 if less than `zero()`, and 0 otherwise.</span>
</span><span id="BaseDie-859"><a href="#BaseDie-859"><span class="linenos">859</span></a><span class="sd">        </span>
</span><span id="BaseDie-860"><a href="#BaseDie-860"><span class="linenos">860</span></a><span class="sd">        Note that for `float`s, +0.0, -0.0, and nan all become 0.</span>
</span><span id="BaseDie-861"><a href="#BaseDie-861"><span class="linenos">861</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-862"><a href="#BaseDie-862"><span class="linenos">862</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unary_op</span><span class="p">(</span><span class="n">BaseDie</span><span class="o">.</span><span class="n">_sign</span><span class="p">)</span>
</span><span id="BaseDie-863"><a href="#BaseDie-863"><span class="linenos">863</span></a>    
</span><span id="BaseDie-864"><a href="#BaseDie-864"><span class="linenos">864</span></a>    <span class="nd">@staticmethod</span>
</span><span id="BaseDie-865"><a href="#BaseDie-865"><span class="linenos">865</span></a>    <span class="k">def</span> <span class="nf">_cmp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="BaseDie-866"><a href="#BaseDie-866"><span class="linenos">866</span></a>        <span class="k">return</span> <span class="n">BaseDie</span><span class="o">.</span><span class="n">_sign</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>
</span><span id="BaseDie-867"><a href="#BaseDie-867"><span class="linenos">867</span></a>    
</span><span id="BaseDie-868"><a href="#BaseDie-868"><span class="linenos">868</span></a>    <span class="k">def</span> <span class="nf">cmp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-869"><a href="#BaseDie-869"><span class="linenos">869</span></a>        <span class="sd">&quot;&quot;&quot; Returns a die with possible outcomes 1, -1, and 0.</span>
</span><span id="BaseDie-870"><a href="#BaseDie-870"><span class="linenos">870</span></a><span class="sd">        </span>
</span><span id="BaseDie-871"><a href="#BaseDie-871"><span class="linenos">871</span></a><span class="sd">        The weights are equal to the positive outcome of `self &gt; other`, `self &lt; other`, and the remainder respectively.</span>
</span><span id="BaseDie-872"><a href="#BaseDie-872"><span class="linenos">872</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-873"><a href="#BaseDie-873"><span class="linenos">873</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BaseDie</span><span class="o">.</span><span class="n">_cmp</span><span class="p">)</span>
</span><span id="BaseDie-874"><a href="#BaseDie-874"><span class="linenos">874</span></a>    
</span><span id="BaseDie-875"><a href="#BaseDie-875"><span class="linenos">875</span></a>    <span class="c1"># Special operators.</span>
</span><span id="BaseDie-876"><a href="#BaseDie-876"><span class="linenos">876</span></a>    
</span><span id="BaseDie-877"><a href="#BaseDie-877"><span class="linenos">877</span></a>    <span class="k">def</span> <span class="fm">__rmatmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie-878"><a href="#BaseDie-878"><span class="linenos">878</span></a>        <span class="sd">&quot;&quot;&quot; Roll the left die, then roll the right die that many times and sum the outcomes. </span>
</span><span id="BaseDie-879"><a href="#BaseDie-879"><span class="linenos">879</span></a><span class="sd">        </span>
</span><span id="BaseDie-880"><a href="#BaseDie-880"><span class="linenos">880</span></a><span class="sd">        Unlike other operators, this does not work for built-in types on the right side.</span>
</span><span id="BaseDie-881"><a href="#BaseDie-881"><span class="linenos">881</span></a><span class="sd">        For example, `1 @ 6` does not work, nor does `d(6) @ 6`. But `1 @ d(6)` works.</span>
</span><span id="BaseDie-882"><a href="#BaseDie-882"><span class="linenos">882</span></a><span class="sd">        </span>
</span><span id="BaseDie-883"><a href="#BaseDie-883"><span class="linenos">883</span></a><span class="sd">        This is because all other operators convert their right side to a die using die,</span>
</span><span id="BaseDie-884"><a href="#BaseDie-884"><span class="linenos">884</span></a><span class="sd">        so `6` would become a constant 6, while  `d()` converts `int`s to a standard die with that many sides,</span>
</span><span id="BaseDie-885"><a href="#BaseDie-885"><span class="linenos">885</span></a><span class="sd">        so `6` would become a d6. Thus the right-side conversion of `@` would be ambiguous.</span>
</span><span id="BaseDie-886"><a href="#BaseDie-886"><span class="linenos">886</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-887"><a href="#BaseDie-887"><span class="linenos">887</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-888"><a href="#BaseDie-888"><span class="linenos">888</span></a>        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">d</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="BaseDie-889"><a href="#BaseDie-889"><span class="linenos">889</span></a>    
</span><span id="BaseDie-890"><a href="#BaseDie-890"><span class="linenos">890</span></a>    <span class="c1"># Rolling.</span>
</span><span id="BaseDie-891"><a href="#BaseDie-891"><span class="linenos">891</span></a>    
</span><span id="BaseDie-892"><a href="#BaseDie-892"><span class="linenos">892</span></a>    <span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-893"><a href="#BaseDie-893"><span class="linenos">893</span></a>        <span class="sd">&quot;&quot;&quot; Returns a random roll of this die. </span>
</span><span id="BaseDie-894"><a href="#BaseDie-894"><span class="linenos">894</span></a><span class="sd">        </span>
</span><span id="BaseDie-895"><a href="#BaseDie-895"><span class="linenos">895</span></a><span class="sd">        Do not use for security purposes.</span>
</span><span id="BaseDie-896"><a href="#BaseDie-896"><span class="linenos">896</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-897"><a href="#BaseDie-897"><span class="linenos">897</span></a>        <span class="c1"># We don&#39;t use random.choices since that is based on floats rather than ints.</span>
</span><span id="BaseDie-898"><a href="#BaseDie-898"><span class="linenos">898</span></a>        <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">())</span>
</span><span id="BaseDie-899"><a href="#BaseDie-899"><span class="linenos">899</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_right</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cweights</span><span class="p">(),</span> <span class="n">r</span><span class="p">)</span>
</span><span id="BaseDie-900"><a href="#BaseDie-900"><span class="linenos">900</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
</span><span id="BaseDie-901"><a href="#BaseDie-901"><span class="linenos">901</span></a>    
</span><span id="BaseDie-902"><a href="#BaseDie-902"><span class="linenos">902</span></a>    <span class="c1"># Invalid operations.</span>
</span><span id="BaseDie-903"><a href="#BaseDie-903"><span class="linenos">903</span></a>    
</span><span id="BaseDie-904"><a href="#BaseDie-904"><span class="linenos">904</span></a>    <span class="k">def</span> <span class="fm">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-905"><a href="#BaseDie-905"><span class="linenos">905</span></a>        <span class="sd">&quot;&quot;&quot; Dice are not considered to have truth values. </span>
</span><span id="BaseDie-906"><a href="#BaseDie-906"><span class="linenos">906</span></a><span class="sd">        </span>
</span><span id="BaseDie-907"><a href="#BaseDie-907"><span class="linenos">907</span></a><span class="sd">        The result of a comparator operation is a die,</span>
</span><span id="BaseDie-908"><a href="#BaseDie-908"><span class="linenos">908</span></a><span class="sd">        which if considered to have a truth value,</span>
</span><span id="BaseDie-909"><a href="#BaseDie-909"><span class="linenos">909</span></a><span class="sd">        would imply that dice are sortable by that operator.</span>
</span><span id="BaseDie-910"><a href="#BaseDie-910"><span class="linenos">910</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-911"><a href="#BaseDie-911"><span class="linenos">911</span></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;A die does not have a truth value. If this is in the conditional of an if-statement, you probably want to use die.cond() instead.&#39;</span><span class="p">)</span>
</span><span id="BaseDie-912"><a href="#BaseDie-912"><span class="linenos">912</span></a>    
</span><span id="BaseDie-913"><a href="#BaseDie-913"><span class="linenos">913</span></a>    <span class="k">def</span> <span class="fm">__reversed__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-914"><a href="#BaseDie-914"><span class="linenos">914</span></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;A die cannot be reversed.&#39;</span><span class="p">)</span>
</span><span id="BaseDie-915"><a href="#BaseDie-915"><span class="linenos">915</span></a>    
</span><span id="BaseDie-916"><a href="#BaseDie-916"><span class="linenos">916</span></a>    <span class="c1"># Equality and hashing.</span>
</span><span id="BaseDie-917"><a href="#BaseDie-917"><span class="linenos">917</span></a>    
</span><span id="BaseDie-918"><a href="#BaseDie-918"><span class="linenos">918</span></a>    <span class="nd">@cached_property</span>
</span><span id="BaseDie-919"><a href="#BaseDie-919"><span class="linenos">919</span></a>    <span class="k">def</span> <span class="nf">_key_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-920"><a href="#BaseDie-920"><span class="linenos">920</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">()</span>
</span><span id="BaseDie-921"><a href="#BaseDie-921"><span class="linenos">921</span></a>        
</span><span id="BaseDie-922"><a href="#BaseDie-922"><span class="linenos">922</span></a>    <span class="k">def</span> <span class="nf">key_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-923"><a href="#BaseDie-923"><span class="linenos">923</span></a>        <span class="sd">&quot;&quot;&quot; Returns a tuple that uniquely (as `equals()`) identifies this die. &quot;&quot;&quot;</span>
</span><span id="BaseDie-924"><a href="#BaseDie-924"><span class="linenos">924</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_key_tuple</span>
</span><span id="BaseDie-925"><a href="#BaseDie-925"><span class="linenos">925</span></a>
</span><span id="BaseDie-926"><a href="#BaseDie-926"><span class="linenos">926</span></a>    <span class="k">def</span> <span class="nf">hash</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-927"><a href="#BaseDie-927"><span class="linenos">927</span></a>        <span class="sd">&quot;&quot;&quot; A true __hash__ doesn&#39;t work because we used the __eq__ operator </span>
</span><span id="BaseDie-928"><a href="#BaseDie-928"><span class="linenos">928</span></a><span class="sd">        for determining the chance two dice will roll equal to each other.</span>
</span><span id="BaseDie-929"><a href="#BaseDie-929"><span class="linenos">929</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-930"><a href="#BaseDie-930"><span class="linenos">930</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key_tuple</span><span class="p">())</span>
</span><span id="BaseDie-931"><a href="#BaseDie-931"><span class="linenos">931</span></a>    
</span><span id="BaseDie-932"><a href="#BaseDie-932"><span class="linenos">932</span></a>    <span class="fm">__hash__</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="BaseDie-933"><a href="#BaseDie-933"><span class="linenos">933</span></a>    
</span><span id="BaseDie-934"><a href="#BaseDie-934"><span class="linenos">934</span></a>    <span class="k">def</span> <span class="nf">equals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">reduce</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="BaseDie-935"><a href="#BaseDie-935"><span class="linenos">935</span></a>        <span class="sd">&quot;&quot;&quot; Returns `True` iff both dice have the same ndim, outcomes, and weights.</span>
</span><span id="BaseDie-936"><a href="#BaseDie-936"><span class="linenos">936</span></a><span class="sd">        </span>
</span><span id="BaseDie-937"><a href="#BaseDie-937"><span class="linenos">937</span></a><span class="sd">        Also, if one die has a zero-weight outcome and the other die does not contain that outcome,</span>
</span><span id="BaseDie-938"><a href="#BaseDie-938"><span class="linenos">938</span></a><span class="sd">        they are treated as unequal by this function.</span>
</span><span id="BaseDie-939"><a href="#BaseDie-939"><span class="linenos">939</span></a><span class="sd">        </span>
</span><span id="BaseDie-940"><a href="#BaseDie-940"><span class="linenos">940</span></a><span class="sd">        For the chance of two dice rolling the same outcome, use the `==` operator.</span>
</span><span id="BaseDie-941"><a href="#BaseDie-941"><span class="linenos">941</span></a><span class="sd">        </span>
</span><span id="BaseDie-942"><a href="#BaseDie-942"><span class="linenos">942</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie-943"><a href="#BaseDie-943"><span class="linenos">943</span></a><span class="sd">            reduce: If `True`, the dice will be reduced before comparing.</span>
</span><span id="BaseDie-944"><a href="#BaseDie-944"><span class="linenos">944</span></a><span class="sd">                Otherwise, e.g. a 2:2 coin is not `equals()` to a 1:1 coin. </span>
</span><span id="BaseDie-945"><a href="#BaseDie-945"><span class="linenos">945</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie-946"><a href="#BaseDie-946"><span class="linenos">946</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="BaseDie-947"><a href="#BaseDie-947"><span class="linenos">947</span></a>            <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie-948"><a href="#BaseDie-948"><span class="linenos">948</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="BaseDie-949"><a href="#BaseDie-949"><span class="linenos">949</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="BaseDie-950"><a href="#BaseDie-950"><span class="linenos">950</span></a>        
</span><span id="BaseDie-951"><a href="#BaseDie-951"><span class="linenos">951</span></a>        <span class="k">if</span> <span class="n">reduce</span><span class="p">:</span>
</span><span id="BaseDie-952"><a href="#BaseDie-952"><span class="linenos">952</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span><span class="o">.</span><span class="n">key_tuple</span><span class="p">()</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span><span class="o">.</span><span class="n">key_tuple</span><span class="p">()</span>
</span><span id="BaseDie-953"><a href="#BaseDie-953"><span class="linenos">953</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie-954"><a href="#BaseDie-954"><span class="linenos">954</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">key_tuple</span><span class="p">()</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">key_tuple</span><span class="p">()</span>
</span><span id="BaseDie-955"><a href="#BaseDie-955"><span class="linenos">955</span></a>    
</span><span id="BaseDie-956"><a href="#BaseDie-956"><span class="linenos">956</span></a>    <span class="c1"># Strings.</span>
</span><span id="BaseDie-957"><a href="#BaseDie-957"><span class="linenos">957</span></a>    
</span><span id="BaseDie-958"><a href="#BaseDie-958"><span class="linenos">958</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie-959"><a href="#BaseDie-959"><span class="linenos">959</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="n">include_weights</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">30</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Abstract base class for a die.</p>

<p>A die is a sorted mapping of outcomes to <code>int</code> weights.</p>

<p>Dice are immutable. Methods do not modify the die in-place;
rather they return a die representing the result.</p>

<p>It <em>is</em> (mostly) well-defined to have a die with zero-weight outcomes,
even though this is not a proper probability distribution.
These can be useful in a few cases, such as:</p>

<ul>
<li><code><a href="#DicePool">DicePool</a></code> and <code><a href="#EvalPool">EvalPool</a></code> will iterate through zero-weight outcomes with 0 <code>count</code>,
rather than <code>None</code> or skipping that outcome.</li>
<li><code><a href="#align">icepool.align()</a></code> and the like are convenient for making dice share the same set of outcomes.</li>
</ul>

<p>However, zero-weight outcomes have a computational cost like any other outcome.
Unless you have a specific use case in mind, it's best to leave them out if not necessary.</p>

<p>Most operators and methods will not introduce zero-weight outcomes if their arguments do not have any.</p>

<p>It's also possible to have "empty" dice with no outcomes at all,
though these have little use other than being sentinel values.</p>
</div>


                            <div id="BaseDie.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">BaseDie</span><span class="signature">()</span>
    </div>

    
    

                            </div>
                            <div id="BaseDie.ndim" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.ndim">#&nbsp;&nbsp</a>

                <div class="decorator">@abstractmethod</div>

            <span class="def">def</span>
            <span class="name">ndim</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.ndim-40"><a href="#BaseDie.ndim-40"><span class="linenos">40</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BaseDie.ndim-41"><a href="#BaseDie.ndim-41"><span class="linenos">41</span></a>    <span class="k">def</span> <span class="nf">ndim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie.ndim-42"><a href="#BaseDie.ndim-42"><span class="linenos">42</span></a>        <span class="sd">&quot;&quot;&quot; Returns the number of dimensions if this is a `VectorDie`.</span>
</span><span id="BaseDie.ndim-43"><a href="#BaseDie.ndim-43"><span class="linenos">43</span></a><span class="sd">        </span>
</span><span id="BaseDie.ndim-44"><a href="#BaseDie.ndim-44"><span class="linenos">44</span></a><span class="sd">        Otherwise, returns `&#39;scalar&#39;` for a `ScalarDie` and `&#39;empty&#39;` for an `EmptyDie`.</span>
</span><span id="BaseDie.ndim-45"><a href="#BaseDie.ndim-45"><span class="linenos">45</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns the number of dimensions if this is a <code><a href="#VectorDie">VectorDie</a></code>.</p>

<p>Otherwise, returns <code>'scalar'</code> for a <code><a href="#ScalarDie">ScalarDie</a></code> and <code>'empty'</code> for an <code><a href="#EmptyDie">EmptyDie</a></code>.</p>
</div>


                            </div>
                            <div id="BaseDie.markdown" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.markdown">#&nbsp;&nbsp</a>

                <div class="decorator">@abstractmethod</div>

            <span class="def">def</span>
            <span class="name">markdown</span><span class="signature">(self, include_weights=True)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.markdown-77"><a href="#BaseDie.markdown-77"><span class="linenos">77</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BaseDie.markdown-78"><a href="#BaseDie.markdown-78"><span class="linenos">78</span></a>    <span class="k">def</span> <span class="nf">markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="BaseDie.markdown-79"><a href="#BaseDie.markdown-79"><span class="linenos">79</span></a>        <span class="sd">&quot;&quot;&quot; Formats the die as a Markdown string. </span>
</span><span id="BaseDie.markdown-80"><a href="#BaseDie.markdown-80"><span class="linenos">80</span></a><span class="sd">        </span>
</span><span id="BaseDie.markdown-81"><a href="#BaseDie.markdown-81"><span class="linenos">81</span></a><span class="sd">        This will have the denominator and a table of outcomes and their probabilities.</span>
</span><span id="BaseDie.markdown-82"><a href="#BaseDie.markdown-82"><span class="linenos">82</span></a><span class="sd">        </span>
</span><span id="BaseDie.markdown-83"><a href="#BaseDie.markdown-83"><span class="linenos">83</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie.markdown-84"><a href="#BaseDie.markdown-84"><span class="linenos">84</span></a><span class="sd">            include_weights: Iff `True`, the table will have a column for weights.</span>
</span><span id="BaseDie.markdown-85"><a href="#BaseDie.markdown-85"><span class="linenos">85</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Formats the die as a Markdown string. </p>

<p>This will have the denominator and a table of outcomes and their probabilities.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>include_weights:</strong>  Iff <code>True</code>, the table will have a column for weights.</li>
</ul>
</div>


                            </div>
                            <div id="BaseDie.outcomes" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.outcomes">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">outcomes</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.outcomes-89"><a href="#BaseDie.outcomes-89"><span class="linenos">89</span></a>    <span class="k">def</span> <span class="nf">outcomes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie.outcomes-90"><a href="#BaseDie.outcomes-90"><span class="linenos">90</span></a>        <span class="sd">&quot;&quot;&quot; Returns an iterable into the sorted outcomes of the die. &quot;&quot;&quot;</span>
</span><span id="BaseDie.outcomes-91"><a href="#BaseDie.outcomes-91"><span class="linenos">91</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns an iterable into the sorted outcomes of the die.</p>
</div>


                            </div>
                            <div id="BaseDie.num_outcomes" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.num_outcomes">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">num_outcomes</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.num_outcomes-96"><a href="#BaseDie.num_outcomes-96"><span class="linenos">96</span></a>    <span class="k">def</span> <span class="nf">num_outcomes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie.num_outcomes-97"><a href="#BaseDie.num_outcomes-97"><span class="linenos">97</span></a>        <span class="sd">&quot;&quot;&quot; Returns the number of outcomes (including those with zero weight). &quot;&quot;&quot;</span>
</span><span id="BaseDie.num_outcomes-98"><a href="#BaseDie.num_outcomes-98"><span class="linenos">98</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns the number of outcomes (including those with zero weight).</p>
</div>


                            </div>
                            <div id="BaseDie.is_empty" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.is_empty">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">is_empty</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.is_empty-102"><a href="#BaseDie.is_empty-102"><span class="linenos">102</span></a>    <span class="k">def</span> <span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie.is_empty-103"><a href="#BaseDie.is_empty-103"><span class="linenos">103</span></a>        <span class="sd">&quot;&quot;&quot; Returns `True` if this die has no outcomes. &quot;&quot;&quot;</span>
</span><span id="BaseDie.is_empty-104"><a href="#BaseDie.is_empty-104"><span class="linenos">104</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_outcomes</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns <code>True</code> if this die has no outcomes.</p>
</div>


                            </div>
                            <div id="BaseDie.weights" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.weights">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">weights</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.weights-106"><a href="#BaseDie.weights-106"><span class="linenos">106</span></a>    <span class="k">def</span> <span class="nf">weights</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie.weights-107"><a href="#BaseDie.weights-107"><span class="linenos">107</span></a>        <span class="sd">&quot;&quot;&quot; Returns an iterable into the weights of the die in outcome order. &quot;&quot;&quot;</span>
</span><span id="BaseDie.weights-108"><a href="#BaseDie.weights-108"><span class="linenos">108</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns an iterable into the weights of the die in outcome order.</p>
</div>


                            </div>
                            <div id="BaseDie.has_zero_weights" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.has_zero_weights">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">has_zero_weights</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.has_zero_weights-110"><a href="#BaseDie.has_zero_weights-110"><span class="linenos">110</span></a>    <span class="k">def</span> <span class="nf">has_zero_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie.has_zero_weights-111"><a href="#BaseDie.has_zero_weights-111"><span class="linenos">111</span></a>        <span class="sd">&quot;&quot;&quot; Returns `True` iff `self` contains at least one outcome with zero weight. &quot;&quot;&quot;</span>
</span><span id="BaseDie.has_zero_weights-112"><a href="#BaseDie.has_zero_weights-112"><span class="linenos">112</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">has_zero_weights</span><span class="p">()</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns <code>True</code> iff <code>self</code> contains at least one outcome with zero weight.</p>
</div>


                            </div>
                            <div id="BaseDie.items" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.items">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">items</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.items-114"><a href="#BaseDie.items-114"><span class="linenos">114</span></a>    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie.items-115"><a href="#BaseDie.items-115"><span class="linenos">115</span></a>        <span class="sd">&quot;&quot;&quot; Returns all outcome, weight pairs. &quot;&quot;&quot;</span>
</span><span id="BaseDie.items-116"><a href="#BaseDie.items-116"><span class="linenos">116</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns all outcome, weight pairs.</p>
</div>


                            </div>
                            <div id="BaseDie.denominator" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.denominator">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">denominator</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.denominator-124"><a href="#BaseDie.denominator-124"><span class="linenos">124</span></a>    <span class="k">def</span> <span class="nf">denominator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie.denominator-125"><a href="#BaseDie.denominator-125"><span class="linenos">125</span></a>        <span class="sd">&quot;&quot;&quot; The total weight of all outcomes. &quot;&quot;&quot;</span>
</span><span id="BaseDie.denominator-126"><a href="#BaseDie.denominator-126"><span class="linenos">126</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_denominator</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>The total weight of all outcomes.</p>
</div>


                            </div>
                            <div id="BaseDie.total_weight" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.total_weight">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">total_weight</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.total_weight-124"><a href="#BaseDie.total_weight-124"><span class="linenos">124</span></a>    <span class="k">def</span> <span class="nf">denominator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie.total_weight-125"><a href="#BaseDie.total_weight-125"><span class="linenos">125</span></a>        <span class="sd">&quot;&quot;&quot; The total weight of all outcomes. &quot;&quot;&quot;</span>
</span><span id="BaseDie.total_weight-126"><a href="#BaseDie.total_weight-126"><span class="linenos">126</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_denominator</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>The total weight of all outcomes.</p>
</div>


                            </div>
                            <div id="BaseDie.pmf" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.pmf">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">pmf</span><span class="signature">(self, percent=False)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.pmf-134"><a href="#BaseDie.pmf-134"><span class="linenos">134</span></a>    <span class="k">def</span> <span class="nf">pmf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="BaseDie.pmf-135"><a href="#BaseDie.pmf-135"><span class="linenos">135</span></a>        <span class="sd">&quot;&quot;&quot; Probability mass function. The probability of rolling each outcome in order. </span>
</span><span id="BaseDie.pmf-136"><a href="#BaseDie.pmf-136"><span class="linenos">136</span></a><span class="sd">        </span>
</span><span id="BaseDie.pmf-137"><a href="#BaseDie.pmf-137"><span class="linenos">137</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie.pmf-138"><a href="#BaseDie.pmf-138"><span class="linenos">138</span></a><span class="sd">            percent: If set, the results will be in percent (i.e. total of 100.0).</span>
</span><span id="BaseDie.pmf-139"><a href="#BaseDie.pmf-139"><span class="linenos">139</span></a><span class="sd">                Otherwise, the total will be 1.0.</span>
</span><span id="BaseDie.pmf-140"><a href="#BaseDie.pmf-140"><span class="linenos">140</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.pmf-141"><a href="#BaseDie.pmf-141"><span class="linenos">141</span></a>        <span class="k">if</span> <span class="n">percent</span><span class="p">:</span>
</span><span id="BaseDie.pmf-142"><a href="#BaseDie.pmf-142"><span class="linenos">142</span></a>            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="mf">100.0</span> <span class="o">*</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pmf</span><span class="p">)</span>
</span><span id="BaseDie.pmf-143"><a href="#BaseDie.pmf-143"><span class="linenos">143</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie.pmf-144"><a href="#BaseDie.pmf-144"><span class="linenos">144</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pmf</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Probability mass function. The probability of rolling each outcome in order. </p>

<h6 id="args">Args</h6>

<ul>
<li><strong>percent:</strong>  If set, the results will be in percent (i.e. total of 100.0).
Otherwise, the total will be 1.0.</li>
</ul>
</div>


                            </div>
                            <div id="BaseDie.cweights" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.cweights">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">cweights</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.cweights-150"><a href="#BaseDie.cweights-150"><span class="linenos">150</span></a>    <span class="k">def</span> <span class="nf">cweights</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie.cweights-151"><a href="#BaseDie.cweights-151"><span class="linenos">151</span></a>        <span class="sd">&quot;&quot;&quot; Cumulative weights. The weight &lt;= each outcome in order. &quot;&quot;&quot;</span>
</span><span id="BaseDie.cweights-152"><a href="#BaseDie.cweights-152"><span class="linenos">152</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cweights</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Cumulative weights. The weight &lt;= each outcome in order.</p>
</div>


                            </div>
                            <div id="BaseDie.sweights" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.sweights">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">sweights</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.sweights-158"><a href="#BaseDie.sweights-158"><span class="linenos">158</span></a>    <span class="k">def</span> <span class="nf">sweights</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie.sweights-159"><a href="#BaseDie.sweights-159"><span class="linenos">159</span></a>        <span class="sd">&quot;&quot;&quot; Survival weights. The weight &gt;= each outcome in order. &quot;&quot;&quot;</span>
</span><span id="BaseDie.sweights-160"><a href="#BaseDie.sweights-160"><span class="linenos">160</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sweights</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Survival weights. The weight &gt;= each outcome in order.</p>
</div>


                            </div>
                            <div id="BaseDie.cdf" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.cdf">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">cdf</span><span class="signature">(self, percent=False)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.cdf-166"><a href="#BaseDie.cdf-166"><span class="linenos">166</span></a>    <span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="BaseDie.cdf-167"><a href="#BaseDie.cdf-167"><span class="linenos">167</span></a>        <span class="sd">&quot;&quot;&quot; Cumulative distribution function. The chance of rolling &lt;= each outcome in order. </span>
</span><span id="BaseDie.cdf-168"><a href="#BaseDie.cdf-168"><span class="linenos">168</span></a><span class="sd">        </span>
</span><span id="BaseDie.cdf-169"><a href="#BaseDie.cdf-169"><span class="linenos">169</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie.cdf-170"><a href="#BaseDie.cdf-170"><span class="linenos">170</span></a><span class="sd">            percent: If set, the results will be in percent (i.e. total of 100.0).</span>
</span><span id="BaseDie.cdf-171"><a href="#BaseDie.cdf-171"><span class="linenos">171</span></a><span class="sd">                Otherwise, the total will be 1.0.</span>
</span><span id="BaseDie.cdf-172"><a href="#BaseDie.cdf-172"><span class="linenos">172</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.cdf-173"><a href="#BaseDie.cdf-173"><span class="linenos">173</span></a>        <span class="k">if</span> <span class="n">percent</span><span class="p">:</span>
</span><span id="BaseDie.cdf-174"><a href="#BaseDie.cdf-174"><span class="linenos">174</span></a>            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="mf">100.0</span> <span class="o">*</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cdf</span><span class="p">)</span>
</span><span id="BaseDie.cdf-175"><a href="#BaseDie.cdf-175"><span class="linenos">175</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie.cdf-176"><a href="#BaseDie.cdf-176"><span class="linenos">176</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cdf</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Cumulative distribution function. The chance of rolling &lt;= each outcome in order. </p>

<h6 id="args">Args</h6>

<ul>
<li><strong>percent:</strong>  If set, the results will be in percent (i.e. total of 100.0).
Otherwise, the total will be 1.0.</li>
</ul>
</div>


                            </div>
                            <div id="BaseDie.sf" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.sf">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">sf</span><span class="signature">(self, percent=False)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.sf-182"><a href="#BaseDie.sf-182"><span class="linenos">182</span></a>    <span class="k">def</span> <span class="nf">sf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="BaseDie.sf-183"><a href="#BaseDie.sf-183"><span class="linenos">183</span></a>        <span class="sd">&quot;&quot;&quot; Survival function. The chance of rolling &gt;= each outcome in order. </span>
</span><span id="BaseDie.sf-184"><a href="#BaseDie.sf-184"><span class="linenos">184</span></a><span class="sd">        </span>
</span><span id="BaseDie.sf-185"><a href="#BaseDie.sf-185"><span class="linenos">185</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie.sf-186"><a href="#BaseDie.sf-186"><span class="linenos">186</span></a><span class="sd">            percent: If set, the results will be in percent (i.e. total of 100.0).</span>
</span><span id="BaseDie.sf-187"><a href="#BaseDie.sf-187"><span class="linenos">187</span></a><span class="sd">                Otherwise, the total will be 1.0.</span>
</span><span id="BaseDie.sf-188"><a href="#BaseDie.sf-188"><span class="linenos">188</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.sf-189"><a href="#BaseDie.sf-189"><span class="linenos">189</span></a>        <span class="k">if</span> <span class="n">percent</span><span class="p">:</span>
</span><span id="BaseDie.sf-190"><a href="#BaseDie.sf-190"><span class="linenos">190</span></a>            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="mf">100.0</span> <span class="o">*</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sf</span><span class="p">)</span>
</span><span id="BaseDie.sf-191"><a href="#BaseDie.sf-191"><span class="linenos">191</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie.sf-192"><a href="#BaseDie.sf-192"><span class="linenos">192</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sf</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Survival function. The chance of rolling &gt;= each outcome in order. </p>

<h6 id="args">Args</h6>

<ul>
<li><strong>percent:</strong>  If set, the results will be in percent (i.e. total of 100.0).
Otherwise, the total will be 1.0.</li>
</ul>
</div>


                            </div>
                            <div id="BaseDie.weight_eq" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.weight_eq">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">weight_eq</span><span class="signature">(self, outcome)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.weight_eq-194"><a href="#BaseDie.weight_eq-194"><span class="linenos">194</span></a>    <span class="k">def</span> <span class="nf">weight_eq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">):</span>
</span><span id="BaseDie.weight_eq-195"><a href="#BaseDie.weight_eq-195"><span class="linenos">195</span></a>        <span class="sd">&quot;&quot;&quot; Returns the weight of a single outcome, or 0 if not present. &quot;&quot;&quot;</span>
</span><span id="BaseDie.weight_eq-196"><a href="#BaseDie.weight_eq-196"><span class="linenos">196</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">outcome</span><span class="p">]</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns the weight of a single outcome, or 0 if not present.</p>
</div>


                            </div>
                            <div id="BaseDie.weight_ne" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.weight_ne">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">weight_ne</span><span class="signature">(self, outcome)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.weight_ne-198"><a href="#BaseDie.weight_ne-198"><span class="linenos">198</span></a>    <span class="k">def</span> <span class="nf">weight_ne</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">):</span>
</span><span id="BaseDie.weight_ne-199"><a href="#BaseDie.weight_ne-199"><span class="linenos">199</span></a>        <span class="sd">&quot;&quot;&quot; Returns the weight != a single outcome. &quot;&quot;&quot;</span>
</span><span id="BaseDie.weight_ne-200"><a href="#BaseDie.weight_ne-200"><span class="linenos">200</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_eq</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns the weight != a single outcome.</p>
</div>


                            </div>
                            <div id="BaseDie.weight_le" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.weight_le">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">weight_le</span><span class="signature">(self, outcome)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.weight_le-202"><a href="#BaseDie.weight_le-202"><span class="linenos">202</span></a>    <span class="k">def</span> <span class="nf">weight_le</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">):</span>
</span><span id="BaseDie.weight_le-203"><a href="#BaseDie.weight_le-203"><span class="linenos">203</span></a>        <span class="sd">&quot;&quot;&quot; Returns the weight &lt;= a single outcome. &quot;&quot;&quot;</span>
</span><span id="BaseDie.weight_le-204"><a href="#BaseDie.weight_le-204"><span class="linenos">204</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_right</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="n">outcome</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="BaseDie.weight_le-205"><a href="#BaseDie.weight_le-205"><span class="linenos">205</span></a>        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="mi">0</span>
</span><span id="BaseDie.weight_le-206"><a href="#BaseDie.weight_le-206"><span class="linenos">206</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cweights</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns the weight &lt;= a single outcome.</p>
</div>


                            </div>
                            <div id="BaseDie.weight_lt" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.weight_lt">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">weight_lt</span><span class="signature">(self, outcome)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.weight_lt-208"><a href="#BaseDie.weight_lt-208"><span class="linenos">208</span></a>    <span class="k">def</span> <span class="nf">weight_lt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">):</span>
</span><span id="BaseDie.weight_lt-209"><a href="#BaseDie.weight_lt-209"><span class="linenos">209</span></a>        <span class="sd">&quot;&quot;&quot; Returns the weight &lt; a single outcome. &quot;&quot;&quot;</span>
</span><span id="BaseDie.weight_lt-210"><a href="#BaseDie.weight_lt-210"><span class="linenos">210</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_left</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="n">outcome</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="BaseDie.weight_lt-211"><a href="#BaseDie.weight_lt-211"><span class="linenos">211</span></a>        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="mi">0</span>
</span><span id="BaseDie.weight_lt-212"><a href="#BaseDie.weight_lt-212"><span class="linenos">212</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cweights</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns the weight &lt; a single outcome.</p>
</div>


                            </div>
                            <div id="BaseDie.weight_ge" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.weight_ge">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">weight_ge</span><span class="signature">(self, outcome)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.weight_ge-214"><a href="#BaseDie.weight_ge-214"><span class="linenos">214</span></a>    <span class="k">def</span> <span class="nf">weight_ge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">):</span>
</span><span id="BaseDie.weight_ge-215"><a href="#BaseDie.weight_ge-215"><span class="linenos">215</span></a>        <span class="sd">&quot;&quot;&quot; Returns the weight &gt;= a single outcome. &quot;&quot;&quot;</span>
</span><span id="BaseDie.weight_ge-216"><a href="#BaseDie.weight_ge-216"><span class="linenos">216</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_left</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="n">outcome</span><span class="p">)</span>
</span><span id="BaseDie.weight_ge-217"><a href="#BaseDie.weight_ge-217"><span class="linenos">217</span></a>        <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_outcomes</span><span class="p">():</span> <span class="k">return</span> <span class="mi">0</span>
</span><span id="BaseDie.weight_ge-218"><a href="#BaseDie.weight_ge-218"><span class="linenos">218</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sweights</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns the weight &gt;= a single outcome.</p>
</div>


                            </div>
                            <div id="BaseDie.weight_gt" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.weight_gt">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">weight_gt</span><span class="signature">(self, outcome)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.weight_gt-220"><a href="#BaseDie.weight_gt-220"><span class="linenos">220</span></a>    <span class="k">def</span> <span class="nf">weight_gt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">):</span>
</span><span id="BaseDie.weight_gt-221"><a href="#BaseDie.weight_gt-221"><span class="linenos">221</span></a>        <span class="sd">&quot;&quot;&quot; Returns the weight &gt; a single outcome. &quot;&quot;&quot;</span>
</span><span id="BaseDie.weight_gt-222"><a href="#BaseDie.weight_gt-222"><span class="linenos">222</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_right</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="n">outcome</span><span class="p">)</span>
</span><span id="BaseDie.weight_gt-223"><a href="#BaseDie.weight_gt-223"><span class="linenos">223</span></a>        <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_outcomes</span><span class="p">():</span> <span class="k">return</span> <span class="mi">0</span>
</span><span id="BaseDie.weight_gt-224"><a href="#BaseDie.weight_gt-224"><span class="linenos">224</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sweights</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns the weight &gt; a single outcome.</p>
</div>


                            </div>
                            <div id="BaseDie.probability" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.probability">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">probability</span><span class="signature">(self, outcome)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.probability-226"><a href="#BaseDie.probability-226"><span class="linenos">226</span></a>    <span class="k">def</span> <span class="nf">probability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">):</span>
</span><span id="BaseDie.probability-227"><a href="#BaseDie.probability-227"><span class="linenos">227</span></a>        <span class="sd">&quot;&quot;&quot; Returns the probability of a single outcome. &quot;&quot;&quot;</span>
</span><span id="BaseDie.probability-228"><a href="#BaseDie.probability-228"><span class="linenos">228</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_eq</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns the probability of a single outcome.</p>
</div>


                            </div>
                            <div id="BaseDie.mode" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.mode">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">mode</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.mode-232"><a href="#BaseDie.mode-232"><span class="linenos">232</span></a>    <span class="k">def</span> <span class="nf">mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie.mode-233"><a href="#BaseDie.mode-233"><span class="linenos">233</span></a>        <span class="sd">&quot;&quot;&quot; Returns a tuple containing the most common outcome(s) of the die.</span>
</span><span id="BaseDie.mode-234"><a href="#BaseDie.mode-234"><span class="linenos">234</span></a><span class="sd">        </span>
</span><span id="BaseDie.mode-235"><a href="#BaseDie.mode-235"><span class="linenos">235</span></a><span class="sd">        These are sorted from lowest to highest.</span>
</span><span id="BaseDie.mode-236"><a href="#BaseDie.mode-236"><span class="linenos">236</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.mode-237"><a href="#BaseDie.mode-237"><span class="linenos">237</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">outcome</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">weight</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">modal_weight</span><span class="p">())</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns a tuple containing the most common outcome(s) of the die.</p>

<p>These are sorted from lowest to highest.</p>
</div>


                            </div>
                            <div id="BaseDie.modal_weight" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.modal_weight">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">modal_weight</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.modal_weight-239"><a href="#BaseDie.modal_weight-239"><span class="linenos">239</span></a>    <span class="k">def</span> <span class="nf">modal_weight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie.modal_weight-240"><a href="#BaseDie.modal_weight-240"><span class="linenos">240</span></a>        <span class="sd">&quot;&quot;&quot; The highest weight of any single outcome. &quot;&quot;&quot;</span>
</span><span id="BaseDie.modal_weight-241"><a href="#BaseDie.modal_weight-241"><span class="linenos">241</span></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">())</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>The highest weight of any single outcome.</p>
</div>


                            </div>
                            <div id="BaseDie.ks_stat" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.ks_stat">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">ks_stat</span><span class="signature">(self, other)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.ks_stat-243"><a href="#BaseDie.ks_stat-243"><span class="linenos">243</span></a>    <span class="k">def</span> <span class="nf">ks_stat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie.ks_stat-244"><a href="#BaseDie.ks_stat-244"><span class="linenos">244</span></a>        <span class="sd">&quot;&quot;&quot; KolmogorovSmirnov stat. The maximum absolute difference between CDFs. &quot;&quot;&quot;</span>
</span><span id="BaseDie.ks_stat-245"><a href="#BaseDie.ks_stat-245"><span class="linenos">245</span></a>        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="BaseDie.ks_stat-246"><a href="#BaseDie.ks_stat-246"><span class="linenos">246</span></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">cdf</span><span class="p">(),</span> <span class="n">b</span><span class="o">.</span><span class="n">cdf</span><span class="p">()))</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>KolmogorovSmirnov stat. The maximum absolute difference between CDFs.</p>
</div>


                            </div>
                            <div id="BaseDie.cvm_stat" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.cvm_stat">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">cvm_stat</span><span class="signature">(self, other)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.cvm_stat-248"><a href="#BaseDie.cvm_stat-248"><span class="linenos">248</span></a>    <span class="k">def</span> <span class="nf">cvm_stat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie.cvm_stat-249"><a href="#BaseDie.cvm_stat-249"><span class="linenos">249</span></a>        <span class="sd">&quot;&quot;&quot; Cramr-von Mises stat. The sum-of-squares difference between CDFs. &quot;&quot;&quot;</span>
</span><span id="BaseDie.cvm_stat-250"><a href="#BaseDie.cvm_stat-250"><span class="linenos">250</span></a>        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="BaseDie.cvm_stat-251"><a href="#BaseDie.cvm_stat-251"><span class="linenos">251</span></a>        <span class="k">return</span> <span class="nb">sum</span><span class="p">((</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">cdf</span><span class="p">(),</span> <span class="n">b</span><span class="o">.</span><span class="n">cdf</span><span class="p">()))</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Cramr-von Mises stat. The sum-of-squares difference between CDFs.</p>
</div>


                            </div>
                            <div id="BaseDie.reduce" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.reduce">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">reduce</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.reduce-255"><a href="#BaseDie.reduce-255"><span class="linenos">255</span></a>    <span class="k">def</span> <span class="nf">reduce</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie.reduce-256"><a href="#BaseDie.reduce-256"><span class="linenos">256</span></a>        <span class="sd">&quot;&quot;&quot; Divides all weights by their greatest common denominator. &quot;&quot;&quot;</span>
</span><span id="BaseDie.reduce-257"><a href="#BaseDie.reduce-257"><span class="linenos">257</span></a>        <span class="n">gcd</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">())</span>
</span><span id="BaseDie.reduce-258"><a href="#BaseDie.reduce-258"><span class="linenos">258</span></a>        <span class="k">if</span> <span class="n">gcd</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="BaseDie.reduce-259"><a href="#BaseDie.reduce-259"><span class="linenos">259</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="BaseDie.reduce-260"><a href="#BaseDie.reduce-260"><span class="linenos">260</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="n">outcome</span> <span class="p">:</span> <span class="n">weight</span> <span class="o">//</span> <span class="n">gcd</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">}</span>
</span><span id="BaseDie.reduce-261"><a href="#BaseDie.reduce-261"><span class="linenos">261</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Divides all weights by their greatest common denominator.</p>
</div>


                            </div>
                            <div id="BaseDie.scale_weights" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.scale_weights">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">scale_weights</span><span class="signature">(self, scale)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.scale_weights-263"><a href="#BaseDie.scale_weights-263"><span class="linenos">263</span></a>    <span class="k">def</span> <span class="nf">scale_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="p">):</span>
</span><span id="BaseDie.scale_weights-264"><a href="#BaseDie.scale_weights-264"><span class="linenos">264</span></a>        <span class="sd">&quot;&quot;&quot; Multiplies all weights by a constant. &quot;&quot;&quot;</span>
</span><span id="BaseDie.scale_weights-265"><a href="#BaseDie.scale_weights-265"><span class="linenos">265</span></a>        <span class="k">if</span> <span class="n">scale</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="BaseDie.scale_weights-266"><a href="#BaseDie.scale_weights-266"><span class="linenos">266</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Weights cannot be scaled by a negative number.&#39;</span><span class="p">)</span>
</span><span id="BaseDie.scale_weights-267"><a href="#BaseDie.scale_weights-267"><span class="linenos">267</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="n">outcome</span> <span class="p">:</span> <span class="n">scale</span> <span class="o">*</span> <span class="n">weight</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">}</span>
</span><span id="BaseDie.scale_weights-268"><a href="#BaseDie.scale_weights-268"><span class="linenos">268</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Multiplies all weights by a constant.</p>
</div>


                            </div>
                            <div id="BaseDie.min_outcome" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.min_outcome">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">min_outcome</span><span class="signature">(*dice)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.min_outcome-272"><a href="#BaseDie.min_outcome-272"><span class="linenos">272</span></a>    <span class="k">def</span> <span class="nf">min_outcome</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">):</span>
</span><span id="BaseDie.min_outcome-273"><a href="#BaseDie.min_outcome-273"><span class="linenos">273</span></a>        <span class="sd">&quot;&quot;&quot; Returns the minimum possible outcome among the dice. &quot;&quot;&quot;</span>
</span><span id="BaseDie.min_outcome-274"><a href="#BaseDie.min_outcome-274"><span class="linenos">274</span></a>        <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns the minimum possible outcome among the dice.</p>
</div>


                            </div>
                            <div id="BaseDie.max_outcome" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.max_outcome">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">max_outcome</span><span class="signature">(*dice)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.max_outcome-276"><a href="#BaseDie.max_outcome-276"><span class="linenos">276</span></a>    <span class="k">def</span> <span class="nf">max_outcome</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">):</span>
</span><span id="BaseDie.max_outcome-277"><a href="#BaseDie.max_outcome-277"><span class="linenos">277</span></a>        <span class="sd">&quot;&quot;&quot; Returns the maximum possible outcome among the dice. &quot;&quot;&quot;</span>
</span><span id="BaseDie.max_outcome-278"><a href="#BaseDie.max_outcome-278"><span class="linenos">278</span></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns the maximum possible outcome among the dice.</p>
</div>


                            </div>
                            <div id="BaseDie.nearest_le" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.nearest_le">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">nearest_le</span><span class="signature">(self, outcome)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.nearest_le-280"><a href="#BaseDie.nearest_le-280"><span class="linenos">280</span></a>    <span class="k">def</span> <span class="nf">nearest_le</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">):</span>
</span><span id="BaseDie.nearest_le-281"><a href="#BaseDie.nearest_le-281"><span class="linenos">281</span></a>        <span class="sd">&quot;&quot;&quot; Returns the nearest outcome that is &lt;= the argument. </span>
</span><span id="BaseDie.nearest_le-282"><a href="#BaseDie.nearest_le-282"><span class="linenos">282</span></a><span class="sd">        </span>
</span><span id="BaseDie.nearest_le-283"><a href="#BaseDie.nearest_le-283"><span class="linenos">283</span></a><span class="sd">        Returns `None` if there is no such outcome.</span>
</span><span id="BaseDie.nearest_le-284"><a href="#BaseDie.nearest_le-284"><span class="linenos">284</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.nearest_le-285"><a href="#BaseDie.nearest_le-285"><span class="linenos">285</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_right</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="n">outcome</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="BaseDie.nearest_le-286"><a href="#BaseDie.nearest_le-286"><span class="linenos">286</span></a>        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="BaseDie.nearest_le-287"><a href="#BaseDie.nearest_le-287"><span class="linenos">287</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="BaseDie.nearest_le-288"><a href="#BaseDie.nearest_le-288"><span class="linenos">288</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns the nearest outcome that is &lt;= the argument. </p>

<p>Returns <code>None</code> if there is no such outcome.</p>
</div>


                            </div>
                            <div id="BaseDie.nearest_ge" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.nearest_ge">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">nearest_ge</span><span class="signature">(self, outcome)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.nearest_ge-290"><a href="#BaseDie.nearest_ge-290"><span class="linenos">290</span></a>    <span class="k">def</span> <span class="nf">nearest_ge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">):</span>
</span><span id="BaseDie.nearest_ge-291"><a href="#BaseDie.nearest_ge-291"><span class="linenos">291</span></a>        <span class="sd">&quot;&quot;&quot; Returns the nearest outcome that is &gt;= the argument. </span>
</span><span id="BaseDie.nearest_ge-292"><a href="#BaseDie.nearest_ge-292"><span class="linenos">292</span></a><span class="sd">        </span>
</span><span id="BaseDie.nearest_ge-293"><a href="#BaseDie.nearest_ge-293"><span class="linenos">293</span></a><span class="sd">        Returns `None` if there is no such outcome.</span>
</span><span id="BaseDie.nearest_ge-294"><a href="#BaseDie.nearest_ge-294"><span class="linenos">294</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.nearest_ge-295"><a href="#BaseDie.nearest_ge-295"><span class="linenos">295</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_left</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="n">outcome</span><span class="p">)</span>
</span><span id="BaseDie.nearest_ge-296"><a href="#BaseDie.nearest_ge-296"><span class="linenos">296</span></a>        <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_outcomes</span><span class="p">():</span>
</span><span id="BaseDie.nearest_ge-297"><a href="#BaseDie.nearest_ge-297"><span class="linenos">297</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="BaseDie.nearest_ge-298"><a href="#BaseDie.nearest_ge-298"><span class="linenos">298</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns the nearest outcome that is &gt;= the argument. </p>

<p>Returns <code>None</code> if there is no such outcome.</p>
</div>


                            </div>
                            <div id="BaseDie.reroll" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.reroll">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">reroll</span><span class="signature">(self, outcomes=None, *, max_depth=None)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.reroll-300"><a href="#BaseDie.reroll-300"><span class="linenos">300</span></a>    <span class="k">def</span> <span class="nf">reroll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcomes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseDie.reroll-301"><a href="#BaseDie.reroll-301"><span class="linenos">301</span></a>        <span class="sd">&quot;&quot;&quot; Rerolls the given outcomes.</span>
</span><span id="BaseDie.reroll-302"><a href="#BaseDie.reroll-302"><span class="linenos">302</span></a><span class="sd">        </span>
</span><span id="BaseDie.reroll-303"><a href="#BaseDie.reroll-303"><span class="linenos">303</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie.reroll-304"><a href="#BaseDie.reroll-304"><span class="linenos">304</span></a><span class="sd">            outcomes: Selects which outcomes to reroll. Options:</span>
</span><span id="BaseDie.reroll-305"><a href="#BaseDie.reroll-305"><span class="linenos">305</span></a><span class="sd">                * A callable that takes an outcome and returns `True` if it should be rerolled.</span>
</span><span id="BaseDie.reroll-306"><a href="#BaseDie.reroll-306"><span class="linenos">306</span></a><span class="sd">                    The callable will be supplied with one argument per `ndim` if this is a `VectorDie`.</span>
</span><span id="BaseDie.reroll-307"><a href="#BaseDie.reroll-307"><span class="linenos">307</span></a><span class="sd">                * A set of outcomes to reroll.</span>
</span><span id="BaseDie.reroll-308"><a href="#BaseDie.reroll-308"><span class="linenos">308</span></a><span class="sd">                * If not provided, the min outcome will be rerolled.</span>
</span><span id="BaseDie.reroll-309"><a href="#BaseDie.reroll-309"><span class="linenos">309</span></a><span class="sd">            max_depth: The maximum number of times to reroll.</span>
</span><span id="BaseDie.reroll-310"><a href="#BaseDie.reroll-310"><span class="linenos">310</span></a><span class="sd">                If omitted, rerolls an unlimited number of times.</span>
</span><span id="BaseDie.reroll-311"><a href="#BaseDie.reroll-311"><span class="linenos">311</span></a><span class="sd">        </span>
</span><span id="BaseDie.reroll-312"><a href="#BaseDie.reroll-312"><span class="linenos">312</span></a><span class="sd">        Returns:</span>
</span><span id="BaseDie.reroll-313"><a href="#BaseDie.reroll-313"><span class="linenos">313</span></a><span class="sd">            A die representing the reroll.</span>
</span><span id="BaseDie.reroll-314"><a href="#BaseDie.reroll-314"><span class="linenos">314</span></a><span class="sd">            If the reroll would never terminate, the result has no outcomes.</span>
</span><span id="BaseDie.reroll-315"><a href="#BaseDie.reroll-315"><span class="linenos">315</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.reroll-316"><a href="#BaseDie.reroll-316"><span class="linenos">316</span></a>        <span class="k">if</span> <span class="n">outcomes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseDie.reroll-317"><a href="#BaseDie.reroll-317"><span class="linenos">317</span></a>            <span class="n">outcomes</span> <span class="o">=</span> <span class="p">{</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_outcome</span><span class="p">()</span> <span class="p">}</span>
</span><span id="BaseDie.reroll-318"><a href="#BaseDie.reroll-318"><span class="linenos">318</span></a>        <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">outcomes</span><span class="p">):</span>
</span><span id="BaseDie.reroll-319"><a href="#BaseDie.reroll-319"><span class="linenos">319</span></a>            <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap_unpack</span><span class="p">(</span><span class="n">outcomes</span><span class="p">)</span>
</span><span id="BaseDie.reroll-320"><a href="#BaseDie.reroll-320"><span class="linenos">320</span></a>            <span class="n">outcomes</span> <span class="o">=</span> <span class="p">{</span> <span class="n">outcome</span> <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()</span> <span class="k">if</span> <span class="n">func</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span> <span class="p">}</span>
</span><span id="BaseDie.reroll-321"><a href="#BaseDie.reroll-321"><span class="linenos">321</span></a>        
</span><span id="BaseDie.reroll-322"><a href="#BaseDie.reroll-322"><span class="linenos">322</span></a>        <span class="k">if</span> <span class="n">max_depth</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseDie.reroll-323"><a href="#BaseDie.reroll-323"><span class="linenos">323</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="n">outcome</span> <span class="p">:</span> <span class="n">weight</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">outcome</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">outcomes</span> <span class="p">}</span>
</span><span id="BaseDie.reroll-324"><a href="#BaseDie.reroll-324"><span class="linenos">324</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie.reroll-325"><a href="#BaseDie.reroll-325"><span class="linenos">325</span></a>            <span class="n">total_reroll_weight</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">weight</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="n">outcomes</span> <span class="p">)</span>
</span><span id="BaseDie.reroll-326"><a href="#BaseDie.reroll-326"><span class="linenos">326</span></a>            <span class="n">rerollable_factor</span> <span class="o">=</span> <span class="n">total_reroll_weight</span> <span class="o">**</span> <span class="n">max_depth</span>
</span><span id="BaseDie.reroll-327"><a href="#BaseDie.reroll-327"><span class="linenos">327</span></a>            <span class="n">stop_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">**</span> <span class="n">max_depth</span> <span class="o">+</span> <span class="n">total_reroll_weight</span> <span class="o">**</span> <span class="n">max_depth</span>
</span><span id="BaseDie.reroll-328"><a href="#BaseDie.reroll-328"><span class="linenos">328</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="n">outcome</span> <span class="p">:</span> <span class="p">(</span><span class="n">rerollable_factor</span> <span class="o">*</span> <span class="n">weight</span> <span class="k">if</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="n">outcomes</span> <span class="k">else</span> <span class="n">stop_factor</span> <span class="o">*</span> <span class="n">weight</span><span class="p">)</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">}</span>
</span><span id="BaseDie.reroll-329"><a href="#BaseDie.reroll-329"><span class="linenos">329</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Rerolls the given outcomes.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>outcomes:</strong>  Selects which outcomes to reroll. Options:
<ul>
<li>A callable that takes an outcome and returns <code>True</code> if it should be rerolled.
The callable will be supplied with one argument per <code><a href="#BaseDie.ndim">ndim</a></code> if this is a <code><a href="#VectorDie">VectorDie</a></code>.</li>
<li>A set of outcomes to reroll.</li>
<li>If not provided, the min outcome will be rerolled.</li>
</ul></li>
<li><strong>max_depth:</strong>  The maximum number of times to reroll.
If omitted, rerolls an unlimited number of times.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A die representing the reroll.
  If the reroll would never terminate, the result has no outcomes.</p>
</blockquote>
</div>


                            </div>
                            <div id="BaseDie.reroll_until" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.reroll_until">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">reroll_until</span><span class="signature">(self, outcomes, *, max_depth=None)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.reroll_until-331"><a href="#BaseDie.reroll_until-331"><span class="linenos">331</span></a>    <span class="k">def</span> <span class="nf">reroll_until</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcomes</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseDie.reroll_until-332"><a href="#BaseDie.reroll_until-332"><span class="linenos">332</span></a>        <span class="sd">&quot;&quot;&quot; Rerolls until getting one of the given outcomes.</span>
</span><span id="BaseDie.reroll_until-333"><a href="#BaseDie.reroll_until-333"><span class="linenos">333</span></a><span class="sd">        </span>
</span><span id="BaseDie.reroll_until-334"><a href="#BaseDie.reroll_until-334"><span class="linenos">334</span></a><span class="sd">        Essentially the complement of `reroll()`.</span>
</span><span id="BaseDie.reroll_until-335"><a href="#BaseDie.reroll_until-335"><span class="linenos">335</span></a><span class="sd">        </span>
</span><span id="BaseDie.reroll_until-336"><a href="#BaseDie.reroll_until-336"><span class="linenos">336</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie.reroll_until-337"><a href="#BaseDie.reroll_until-337"><span class="linenos">337</span></a><span class="sd">            outcomes: Selects which outcomes to reroll until. Options:</span>
</span><span id="BaseDie.reroll_until-338"><a href="#BaseDie.reroll_until-338"><span class="linenos">338</span></a><span class="sd">                * A callable that takes an outcome and returns `True` if it should be accepted.</span>
</span><span id="BaseDie.reroll_until-339"><a href="#BaseDie.reroll_until-339"><span class="linenos">339</span></a><span class="sd">                * A set of outcomes to reroll until.</span>
</span><span id="BaseDie.reroll_until-340"><a href="#BaseDie.reroll_until-340"><span class="linenos">340</span></a><span class="sd">            max_depth: The maximum number of times to reroll.</span>
</span><span id="BaseDie.reroll_until-341"><a href="#BaseDie.reroll_until-341"><span class="linenos">341</span></a><span class="sd">                If omitted, rerolls an unlimited number of times.</span>
</span><span id="BaseDie.reroll_until-342"><a href="#BaseDie.reroll_until-342"><span class="linenos">342</span></a><span class="sd">        </span>
</span><span id="BaseDie.reroll_until-343"><a href="#BaseDie.reroll_until-343"><span class="linenos">343</span></a><span class="sd">        Returns:</span>
</span><span id="BaseDie.reroll_until-344"><a href="#BaseDie.reroll_until-344"><span class="linenos">344</span></a><span class="sd">            A die representing the reroll.</span>
</span><span id="BaseDie.reroll_until-345"><a href="#BaseDie.reroll_until-345"><span class="linenos">345</span></a><span class="sd">            If the reroll would never terminate, the result has no outcomes.</span>
</span><span id="BaseDie.reroll_until-346"><a href="#BaseDie.reroll_until-346"><span class="linenos">346</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.reroll_until-347"><a href="#BaseDie.reroll_until-347"><span class="linenos">347</span></a>        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">outcomes</span><span class="p">):</span>
</span><span id="BaseDie.reroll_until-348"><a href="#BaseDie.reroll_until-348"><span class="linenos">348</span></a>            <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap_unpack</span><span class="p">(</span><span class="n">outcomes</span><span class="p">)</span>
</span><span id="BaseDie.reroll_until-349"><a href="#BaseDie.reroll_until-349"><span class="linenos">349</span></a>            <span class="n">not_outcomes</span> <span class="o">=</span> <span class="p">{</span> <span class="n">outcome</span> <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">func</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span> <span class="p">}</span>
</span><span id="BaseDie.reroll_until-350"><a href="#BaseDie.reroll_until-350"><span class="linenos">350</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie.reroll_until-351"><a href="#BaseDie.reroll_until-351"><span class="linenos">351</span></a>            <span class="n">not_outcomes</span> <span class="o">=</span> <span class="p">{</span> <span class="n">not_outcome</span> <span class="k">for</span> <span class="n">not_outcome</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()</span> <span class="k">if</span> <span class="n">not_outcome</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">outcomes</span> <span class="p">}</span>
</span><span id="BaseDie.reroll_until-352"><a href="#BaseDie.reroll_until-352"><span class="linenos">352</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reroll</span><span class="p">(</span><span class="n">not_outcomes</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Rerolls until getting one of the given outcomes.</p>

<p>Essentially the complement of <code><a href="#BaseDie.reroll">reroll()</a></code>.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>outcomes:</strong>  Selects which outcomes to reroll until. Options:
<ul>
<li>A callable that takes an outcome and returns <code>True</code> if it should be accepted.</li>
<li>A set of outcomes to reroll until.</li>
</ul></li>
<li><strong>max_depth:</strong>  The maximum number of times to reroll.
If omitted, rerolls an unlimited number of times.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A die representing the reroll.
  If the reroll would never terminate, the result has no outcomes.</p>
</blockquote>
</div>


                            </div>
                            <div id="BaseDie.truncate" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.truncate">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">truncate</span><span class="signature">(self, min_outcome=None, max_outcome=None)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.truncate-354"><a href="#BaseDie.truncate-354"><span class="linenos">354</span></a>    <span class="k">def</span> <span class="nf">truncate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_outcome</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_outcome</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseDie.truncate-355"><a href="#BaseDie.truncate-355"><span class="linenos">355</span></a>        <span class="sd">&quot;&quot;&quot; Truncates the outcomes of this die to the given range.</span>
</span><span id="BaseDie.truncate-356"><a href="#BaseDie.truncate-356"><span class="linenos">356</span></a><span class="sd">        </span>
</span><span id="BaseDie.truncate-357"><a href="#BaseDie.truncate-357"><span class="linenos">357</span></a><span class="sd">        The endpoints are included in the result if applicable.</span>
</span><span id="BaseDie.truncate-358"><a href="#BaseDie.truncate-358"><span class="linenos">358</span></a><span class="sd">        If one of the arguments is not provided, that side will not be truncated.</span>
</span><span id="BaseDie.truncate-359"><a href="#BaseDie.truncate-359"><span class="linenos">359</span></a><span class="sd">        </span>
</span><span id="BaseDie.truncate-360"><a href="#BaseDie.truncate-360"><span class="linenos">360</span></a><span class="sd">        This effectively rerolls outcomes outside the given range.</span>
</span><span id="BaseDie.truncate-361"><a href="#BaseDie.truncate-361"><span class="linenos">361</span></a><span class="sd">        If instead you want to replace those outcomes with the nearest endpoint, use `clip()`.</span>
</span><span id="BaseDie.truncate-362"><a href="#BaseDie.truncate-362"><span class="linenos">362</span></a><span class="sd">        </span>
</span><span id="BaseDie.truncate-363"><a href="#BaseDie.truncate-363"><span class="linenos">363</span></a><span class="sd">        Not to be confused with `trunc(die)`, which performs integer truncation on each outcome.</span>
</span><span id="BaseDie.truncate-364"><a href="#BaseDie.truncate-364"><span class="linenos">364</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.truncate-365"><a href="#BaseDie.truncate-365"><span class="linenos">365</span></a>        <span class="k">if</span> <span class="n">min_outcome</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseDie.truncate-366"><a href="#BaseDie.truncate-366"><span class="linenos">366</span></a>            <span class="n">start</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_left</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="n">min_outcome</span><span class="p">)</span>
</span><span id="BaseDie.truncate-367"><a href="#BaseDie.truncate-367"><span class="linenos">367</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie.truncate-368"><a href="#BaseDie.truncate-368"><span class="linenos">368</span></a>            <span class="n">start</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="BaseDie.truncate-369"><a href="#BaseDie.truncate-369"><span class="linenos">369</span></a>        <span class="k">if</span> <span class="n">max_outcome</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseDie.truncate-370"><a href="#BaseDie.truncate-370"><span class="linenos">370</span></a>            <span class="n">stop</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_right</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="n">max_outcome</span><span class="p">)</span>
</span><span id="BaseDie.truncate-371"><a href="#BaseDie.truncate-371"><span class="linenos">371</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie.truncate-372"><a href="#BaseDie.truncate-372"><span class="linenos">372</span></a>            <span class="n">stop</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="BaseDie.truncate-373"><a href="#BaseDie.truncate-373"><span class="linenos">373</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="n">k</span> <span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span> <span class="p">}</span>
</span><span id="BaseDie.truncate-374"><a href="#BaseDie.truncate-374"><span class="linenos">374</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Truncates the outcomes of this die to the given range.</p>

<p>The endpoints are included in the result if applicable.
If one of the arguments is not provided, that side will not be truncated.</p>

<p>This effectively rerolls outcomes outside the given range.
If instead you want to replace those outcomes with the nearest endpoint, use <code><a href="#BaseDie.clip">clip()</a></code>.</p>

<p>Not to be confused with <code>trunc(die)</code>, which performs integer truncation on each outcome.</p>
</div>


                            </div>
                            <div id="BaseDie.clip" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.clip">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">clip</span><span class="signature">(self, min_outcome=None, max_outcome=None)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.clip-376"><a href="#BaseDie.clip-376"><span class="linenos">376</span></a>    <span class="k">def</span> <span class="nf">clip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_outcome</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_outcome</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseDie.clip-377"><a href="#BaseDie.clip-377"><span class="linenos">377</span></a>        <span class="sd">&quot;&quot;&quot; Clips the outcomes of this die to the given values.</span>
</span><span id="BaseDie.clip-378"><a href="#BaseDie.clip-378"><span class="linenos">378</span></a><span class="sd">        </span>
</span><span id="BaseDie.clip-379"><a href="#BaseDie.clip-379"><span class="linenos">379</span></a><span class="sd">        The endpoints are included in the result if applicable.</span>
</span><span id="BaseDie.clip-380"><a href="#BaseDie.clip-380"><span class="linenos">380</span></a><span class="sd">        If one of the arguments is not provided, that side will not be clipped.</span>
</span><span id="BaseDie.clip-381"><a href="#BaseDie.clip-381"><span class="linenos">381</span></a><span class="sd">        </span>
</span><span id="BaseDie.clip-382"><a href="#BaseDie.clip-382"><span class="linenos">382</span></a><span class="sd">        This is not the same as rerolling outcomes beyond this range;</span>
</span><span id="BaseDie.clip-383"><a href="#BaseDie.clip-383"><span class="linenos">383</span></a><span class="sd">        the outcome is simply adjusted to fit within the range.</span>
</span><span id="BaseDie.clip-384"><a href="#BaseDie.clip-384"><span class="linenos">384</span></a><span class="sd">        This will typically cause some weight to bunch up at the endpoint.</span>
</span><span id="BaseDie.clip-385"><a href="#BaseDie.clip-385"><span class="linenos">385</span></a><span class="sd">        If you want to reroll outcomes beyond this range, use `truncate()`.</span>
</span><span id="BaseDie.clip-386"><a href="#BaseDie.clip-386"><span class="linenos">386</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.clip-387"><a href="#BaseDie.clip-387"><span class="linenos">387</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="BaseDie.clip-388"><a href="#BaseDie.clip-388"><span class="linenos">388</span></a>        <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="BaseDie.clip-389"><a href="#BaseDie.clip-389"><span class="linenos">389</span></a>            <span class="k">if</span> <span class="n">min_outcome</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">outcome</span> <span class="o">&lt;=</span> <span class="n">min_outcome</span><span class="p">:</span>
</span><span id="BaseDie.clip-390"><a href="#BaseDie.clip-390"><span class="linenos">390</span></a>                <span class="n">data</span><span class="p">[</span><span class="n">min_outcome</span><span class="p">]</span> <span class="o">+=</span> <span class="n">weight</span>
</span><span id="BaseDie.clip-391"><a href="#BaseDie.clip-391"><span class="linenos">391</span></a>            <span class="k">elif</span> <span class="n">max_outcome</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">outcome</span> <span class="o">&gt;=</span> <span class="n">max_outcome</span><span class="p">:</span>
</span><span id="BaseDie.clip-392"><a href="#BaseDie.clip-392"><span class="linenos">392</span></a>                <span class="n">data</span><span class="p">[</span><span class="n">max_outcome</span><span class="p">]</span> <span class="o">+=</span> <span class="n">weight</span>
</span><span id="BaseDie.clip-393"><a href="#BaseDie.clip-393"><span class="linenos">393</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie.clip-394"><a href="#BaseDie.clip-394"><span class="linenos">394</span></a>                <span class="n">data</span><span class="p">[</span><span class="n">outcome</span><span class="p">]</span> <span class="o">+=</span> <span class="n">weight</span>
</span><span id="BaseDie.clip-395"><a href="#BaseDie.clip-395"><span class="linenos">395</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Clips the outcomes of this die to the given values.</p>

<p>The endpoints are included in the result if applicable.
If one of the arguments is not provided, that side will not be clipped.</p>

<p>This is not the same as rerolling outcomes beyond this range;
the outcome is simply adjusted to fit within the range.
This will typically cause some weight to bunch up at the endpoint.
If you want to reroll outcomes beyond this range, use <code><a href="#BaseDie.truncate">truncate()</a></code>.</p>
</div>


                            </div>
                            <div id="BaseDie.cond" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.cond">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">cond</span><span class="signature">(self, outcome_if_true, outcome_if_false, /)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.cond-397"><a href="#BaseDie.cond-397"><span class="linenos">397</span></a>    <span class="k">def</span> <span class="nf">cond</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome_if_true</span><span class="p">,</span> <span class="n">outcome_if_false</span><span class="p">,</span> <span class="o">/</span><span class="p">):</span>
</span><span id="BaseDie.cond-398"><a href="#BaseDie.cond-398"><span class="linenos">398</span></a>        <span class="sd">&quot;&quot;&quot; Conditional operator. Also known as the ternary operator.</span>
</span><span id="BaseDie.cond-399"><a href="#BaseDie.cond-399"><span class="linenos">399</span></a><span class="sd">        </span>
</span><span id="BaseDie.cond-400"><a href="#BaseDie.cond-400"><span class="linenos">400</span></a><span class="sd">        This replaces truthy outcomes with the first argument and falsy outcomes with the second argument.</span>
</span><span id="BaseDie.cond-401"><a href="#BaseDie.cond-401"><span class="linenos">401</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.cond-402"><a href="#BaseDie.cond-402"><span class="linenos">402</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bool</span><span class="p">()</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">outcome_if_true</span> <span class="k">if</span> <span class="n">x</span> <span class="k">else</span> <span class="n">outcome_if_false</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Conditional operator. Also known as the ternary operator.</p>

<p>This replaces truthy outcomes with the first argument and falsy outcomes with the second argument.</p>
</div>


                            </div>
                            <div id="BaseDie.set_outcomes" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.set_outcomes">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_outcomes</span><span class="signature">(self, outcomes)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.set_outcomes-404"><a href="#BaseDie.set_outcomes-404"><span class="linenos">404</span></a>    <span class="k">def</span> <span class="nf">set_outcomes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcomes</span><span class="p">):</span>
</span><span id="BaseDie.set_outcomes-405"><a href="#BaseDie.set_outcomes-405"><span class="linenos">405</span></a>        <span class="sd">&quot;&quot;&quot; Sets the set of outcomes to the argument.</span>
</span><span id="BaseDie.set_outcomes-406"><a href="#BaseDie.set_outcomes-406"><span class="linenos">406</span></a><span class="sd">        </span>
</span><span id="BaseDie.set_outcomes-407"><a href="#BaseDie.set_outcomes-407"><span class="linenos">407</span></a><span class="sd">        This may remove outcomes (if they are not present in the argument)</span>
</span><span id="BaseDie.set_outcomes-408"><a href="#BaseDie.set_outcomes-408"><span class="linenos">408</span></a><span class="sd">        and/or add zero-weight outcomes (if they are not present in this die).</span>
</span><span id="BaseDie.set_outcomes-409"><a href="#BaseDie.set_outcomes-409"><span class="linenos">409</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.set_outcomes-410"><a href="#BaseDie.set_outcomes-410"><span class="linenos">410</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_eq</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">outcomes</span><span class="p">}</span>
</span><span id="BaseDie.set_outcomes-411"><a href="#BaseDie.set_outcomes-411"><span class="linenos">411</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Sets the set of outcomes to the argument.</p>

<p>This may remove outcomes (if they are not present in the argument)
and/or add zero-weight outcomes (if they are not present in this die).</p>
</div>


                            </div>
                            <div id="BaseDie.trim" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.trim">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">trim</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.trim-413"><a href="#BaseDie.trim-413"><span class="linenos">413</span></a>    <span class="k">def</span> <span class="nf">trim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie.trim-414"><a href="#BaseDie.trim-414"><span class="linenos">414</span></a>        <span class="sd">&quot;&quot;&quot; Removes all zero-weight outcomes. &quot;&quot;&quot;</span>
</span><span id="BaseDie.trim-415"><a href="#BaseDie.trim-415"><span class="linenos">415</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="n">k</span> <span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">}</span>
</span><span id="BaseDie.trim-416"><a href="#BaseDie.trim-416"><span class="linenos">416</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Removes all zero-weight outcomes.</p>
</div>


                            </div>
                            <div id="BaseDie.sub" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.sub">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">sub</span><span class="signature">(self, repl, /, *, max_depth=1, ndim=None, denominator_method=&#39;lcm&#39;)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.sub-446"><a href="#BaseDie.sub-446"><span class="linenos">446</span></a>    <span class="k">def</span> <span class="nf">sub</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">repl</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">denominator_method</span><span class="o">=</span><span class="s1">&#39;lcm&#39;</span><span class="p">):</span>
</span><span id="BaseDie.sub-447"><a href="#BaseDie.sub-447"><span class="linenos">447</span></a>        <span class="sd">&quot;&quot;&quot; Changes outcomes of the die to other outcomes.</span>
</span><span id="BaseDie.sub-448"><a href="#BaseDie.sub-448"><span class="linenos">448</span></a><span class="sd">        </span>
</span><span id="BaseDie.sub-449"><a href="#BaseDie.sub-449"><span class="linenos">449</span></a><span class="sd">        You can think of this as `sub`stituting outcomes of this die for other outcomes or dice.</span>
</span><span id="BaseDie.sub-450"><a href="#BaseDie.sub-450"><span class="linenos">450</span></a><span class="sd">        Or, as executing a `sub`routine based on the roll of this die.</span>
</span><span id="BaseDie.sub-451"><a href="#BaseDie.sub-451"><span class="linenos">451</span></a><span class="sd">        </span>
</span><span id="BaseDie.sub-452"><a href="#BaseDie.sub-452"><span class="linenos">452</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie.sub-453"><a href="#BaseDie.sub-453"><span class="linenos">453</span></a><span class="sd">            repl: One of the following:</span>
</span><span id="BaseDie.sub-454"><a href="#BaseDie.sub-454"><span class="linenos">454</span></a><span class="sd">                * A map from old outcomes to new outcomes.</span>
</span><span id="BaseDie.sub-455"><a href="#BaseDie.sub-455"><span class="linenos">455</span></a><span class="sd">                    Unmapped old outcomes stay the same.</span>
</span><span id="BaseDie.sub-456"><a href="#BaseDie.sub-456"><span class="linenos">456</span></a><span class="sd">                * A callable mapping old outcomes to new outcomes.</span>
</span><span id="BaseDie.sub-457"><a href="#BaseDie.sub-457"><span class="linenos">457</span></a><span class="sd">                    The callable will be supplied with one argument per `ndim` if this is a `VectorDie`.</span>
</span><span id="BaseDie.sub-458"><a href="#BaseDie.sub-458"><span class="linenos">458</span></a><span class="sd">                The new outcomes may be dice rather than just single outcomes.</span>
</span><span id="BaseDie.sub-459"><a href="#BaseDie.sub-459"><span class="linenos">459</span></a><span class="sd">                The special value `icepool.Reroll` will reroll that old outcome.</span>
</span><span id="BaseDie.sub-460"><a href="#BaseDie.sub-460"><span class="linenos">460</span></a><span class="sd">            max_depth: `sub()` will be repeated with the same argument on the result this many times.</span>
</span><span id="BaseDie.sub-461"><a href="#BaseDie.sub-461"><span class="linenos">461</span></a><span class="sd">                If set to `None`, this will repeat until a fixed point is reached.</span>
</span><span id="BaseDie.sub-462"><a href="#BaseDie.sub-462"><span class="linenos">462</span></a><span class="sd">            ndim: Sets the `ndim` of the result. If not provided, `ndim` will be determined automatically.</span>
</span><span id="BaseDie.sub-463"><a href="#BaseDie.sub-463"><span class="linenos">463</span></a><span class="sd">            denominator_method: As `icepool.Die()`.</span>
</span><span id="BaseDie.sub-464"><a href="#BaseDie.sub-464"><span class="linenos">464</span></a><span class="sd">        </span>
</span><span id="BaseDie.sub-465"><a href="#BaseDie.sub-465"><span class="linenos">465</span></a><span class="sd">        Returns:</span>
</span><span id="BaseDie.sub-466"><a href="#BaseDie.sub-466"><span class="linenos">466</span></a><span class="sd">            The relabeled die.</span>
</span><span id="BaseDie.sub-467"><a href="#BaseDie.sub-467"><span class="linenos">467</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.sub-468"><a href="#BaseDie.sub-468"><span class="linenos">468</span></a>        <span class="k">if</span> <span class="n">max_depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="BaseDie.sub-469"><a href="#BaseDie.sub-469"><span class="linenos">469</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="BaseDie.sub-470"><a href="#BaseDie.sub-470"><span class="linenos">470</span></a>        <span class="k">elif</span> <span class="n">max_depth</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="BaseDie.sub-471"><a href="#BaseDie.sub-471"><span class="linenos">471</span></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">repl</span><span class="p">,</span> <span class="s1">&#39;items&#39;</span><span class="p">):</span>
</span><span id="BaseDie.sub-472"><a href="#BaseDie.sub-472"><span class="linenos">472</span></a>                <span class="n">repl</span> <span class="o">=</span> <span class="p">[(</span><span class="n">repl</span><span class="p">[</span><span class="n">outcome</span><span class="p">]</span> <span class="k">if</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="n">repl</span> <span class="k">else</span> <span class="n">outcome</span><span class="p">)</span> <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()]</span>
</span><span id="BaseDie.sub-473"><a href="#BaseDie.sub-473"><span class="linenos">473</span></a>            <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">repl</span><span class="p">):</span>
</span><span id="BaseDie.sub-474"><a href="#BaseDie.sub-474"><span class="linenos">474</span></a>                <span class="n">repl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap_unpack</span><span class="p">(</span><span class="n">repl</span><span class="p">)</span>
</span><span id="BaseDie.sub-475"><a href="#BaseDie.sub-475"><span class="linenos">475</span></a>                <span class="n">repl</span> <span class="o">=</span> <span class="p">[</span><span class="n">repl</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span> <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()]</span>
</span><span id="BaseDie.sub-476"><a href="#BaseDie.sub-476"><span class="linenos">476</span></a>
</span><span id="BaseDie.sub-477"><a href="#BaseDie.sub-477"><span class="linenos">477</span></a>            <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="o">*</span><span class="n">repl</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">(),</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">denominator_method</span><span class="o">=</span><span class="n">denominator_method</span><span class="p">)</span>
</span><span id="BaseDie.sub-478"><a href="#BaseDie.sub-478"><span class="linenos">478</span></a>        <span class="k">elif</span> <span class="n">max_depth</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseDie.sub-479"><a href="#BaseDie.sub-479"><span class="linenos">479</span></a>            <span class="nb">next</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">repl</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">denominator_method</span><span class="o">=</span><span class="n">denominator_method</span><span class="p">)</span>
</span><span id="BaseDie.sub-480"><a href="#BaseDie.sub-480"><span class="linenos">480</span></a>            <span class="k">return</span> <span class="nb">next</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">repl</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">denominator_method</span><span class="o">=</span><span class="n">denominator_method</span><span class="p">)</span>
</span><span id="BaseDie.sub-481"><a href="#BaseDie.sub-481"><span class="linenos">481</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie.sub-482"><a href="#BaseDie.sub-482"><span class="linenos">482</span></a>            <span class="c1"># Seek fixed point.</span>
</span><span id="BaseDie.sub-483"><a href="#BaseDie.sub-483"><span class="linenos">483</span></a>            <span class="nb">next</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">repl</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">denominator_method</span><span class="o">=</span><span class="n">denominator_method</span><span class="p">)</span>
</span><span id="BaseDie.sub-484"><a href="#BaseDie.sub-484"><span class="linenos">484</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="nb">next</span><span class="o">.</span><span class="n">reduce</span><span class="p">()):</span>
</span><span id="BaseDie.sub-485"><a href="#BaseDie.sub-485"><span class="linenos">485</span></a>                <span class="k">return</span> <span class="bp">self</span>
</span><span id="BaseDie.sub-486"><a href="#BaseDie.sub-486"><span class="linenos">486</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie.sub-487"><a href="#BaseDie.sub-487"><span class="linenos">487</span></a>                <span class="k">return</span> <span class="nb">next</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">repl</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">denominator_method</span><span class="o">=</span><span class="n">denominator_method</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Changes outcomes of the die to other outcomes.</p>

<p>You can think of this as <code><a href="#BaseDie.sub">sub</a></code>stituting outcomes of this die for other outcomes or dice.
Or, as executing a <code><a href="#BaseDie.sub">sub</a></code>routine based on the roll of this die.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>repl:</strong>  One of the following:
<ul>
<li>A map from old outcomes to new outcomes.
Unmapped old outcomes stay the same.</li>
<li>A callable mapping old outcomes to new outcomes.
The callable will be supplied with one argument per <code><a href="#BaseDie.ndim">ndim</a></code> if this is a <code><a href="#VectorDie">VectorDie</a></code>.
The new outcomes may be dice rather than just single outcomes.
The special value <code><a href="#Reroll">icepool.Reroll</a></code> will reroll that old outcome.</li>
</ul></li>
<li><strong>max_depth:</strong>  <code><a href="#BaseDie.sub">sub()</a></code> will be repeated with the same argument on the result this many times.
If set to <code>None</code>, this will repeat until a fixed point is reached.</li>
<li><strong>ndim:</strong>  Sets the <code><a href="#BaseDie.ndim">ndim</a></code> of the result. If not provided, <code><a href="#BaseDie.ndim">ndim</a></code> will be determined automatically.</li>
<li><strong>denominator_method:</strong>  As <code><a href="#Die">icepool.Die()</a></code>.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The relabeled die.</p>
</blockquote>
</div>


                            </div>
                            <div id="BaseDie.explode" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.explode">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">explode</span><span class="signature">(self, outcomes=None, *, max_depth=None)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.explode-489"><a href="#BaseDie.explode-489"><span class="linenos">489</span></a>    <span class="k">def</span> <span class="nf">explode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcomes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseDie.explode-490"><a href="#BaseDie.explode-490"><span class="linenos">490</span></a>        <span class="sd">&quot;&quot;&quot; Causes outcomes to be rolled again and added to the total.</span>
</span><span id="BaseDie.explode-491"><a href="#BaseDie.explode-491"><span class="linenos">491</span></a><span class="sd">        </span>
</span><span id="BaseDie.explode-492"><a href="#BaseDie.explode-492"><span class="linenos">492</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie.explode-493"><a href="#BaseDie.explode-493"><span class="linenos">493</span></a><span class="sd">            outcomes: Which outcomes to explode. Options:</span>
</span><span id="BaseDie.explode-494"><a href="#BaseDie.explode-494"><span class="linenos">494</span></a><span class="sd">                * An iterable containing outcomes to explode.</span>
</span><span id="BaseDie.explode-495"><a href="#BaseDie.explode-495"><span class="linenos">495</span></a><span class="sd">                * A callable that takes an outcome and returns `True` if it should be exploded.</span>
</span><span id="BaseDie.explode-496"><a href="#BaseDie.explode-496"><span class="linenos">496</span></a><span class="sd">                    The callable will be supplied with one argument per `ndim` if this is a `VectorDie`.</span>
</span><span id="BaseDie.explode-497"><a href="#BaseDie.explode-497"><span class="linenos">497</span></a><span class="sd">                * If not supplied, the max outcome will explode.</span>
</span><span id="BaseDie.explode-498"><a href="#BaseDie.explode-498"><span class="linenos">498</span></a><span class="sd">            max_depth: The maximum number of additional dice to roll.</span>
</span><span id="BaseDie.explode-499"><a href="#BaseDie.explode-499"><span class="linenos">499</span></a><span class="sd">                If not supplied, a default value will be used.</span>
</span><span id="BaseDie.explode-500"><a href="#BaseDie.explode-500"><span class="linenos">500</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.explode-501"><a href="#BaseDie.explode-501"><span class="linenos">501</span></a>        <span class="k">if</span> <span class="n">outcomes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseDie.explode-502"><a href="#BaseDie.explode-502"><span class="linenos">502</span></a>            <span class="n">outcomes</span> <span class="o">=</span> <span class="p">{</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_outcome</span><span class="p">()</span> <span class="p">}</span>
</span><span id="BaseDie.explode-503"><a href="#BaseDie.explode-503"><span class="linenos">503</span></a>        <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">outcomes</span><span class="p">):</span>
</span><span id="BaseDie.explode-504"><a href="#BaseDie.explode-504"><span class="linenos">504</span></a>            <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap_unpack</span><span class="p">(</span><span class="n">outcomes</span><span class="p">)</span>
</span><span id="BaseDie.explode-505"><a href="#BaseDie.explode-505"><span class="linenos">505</span></a>            <span class="n">outcomes</span> <span class="o">=</span> <span class="p">{</span> <span class="n">outcome</span> <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()</span> <span class="k">if</span> <span class="n">func</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span> <span class="p">}</span>
</span><span id="BaseDie.explode-506"><a href="#BaseDie.explode-506"><span class="linenos">506</span></a>        
</span><span id="BaseDie.explode-507"><a href="#BaseDie.explode-507"><span class="linenos">507</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">outcomes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="BaseDie.explode-508"><a href="#BaseDie.explode-508"><span class="linenos">508</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="BaseDie.explode-509"><a href="#BaseDie.explode-509"><span class="linenos">509</span></a>        
</span><span id="BaseDie.explode-510"><a href="#BaseDie.explode-510"><span class="linenos">510</span></a>        <span class="k">if</span> <span class="n">max_depth</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseDie.explode-511"><a href="#BaseDie.explode-511"><span class="linenos">511</span></a>            <span class="n">max_depth</span> <span class="o">=</span> <span class="mi">9</span>
</span><span id="BaseDie.explode-512"><a href="#BaseDie.explode-512"><span class="linenos">512</span></a>        <span class="k">elif</span> <span class="n">max_depth</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="BaseDie.explode-513"><a href="#BaseDie.explode-513"><span class="linenos">513</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;max_depth cannot be negative.&#39;</span><span class="p">)</span>
</span><span id="BaseDie.explode-514"><a href="#BaseDie.explode-514"><span class="linenos">514</span></a>        <span class="k">elif</span> <span class="n">max_depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="BaseDie.explode-515"><a href="#BaseDie.explode-515"><span class="linenos">515</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="BaseDie.explode-516"><a href="#BaseDie.explode-516"><span class="linenos">516</span></a>        
</span><span id="BaseDie.explode-517"><a href="#BaseDie.explode-517"><span class="linenos">517</span></a>        <span class="n">tail_die</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">outcomes</span><span class="o">=</span><span class="n">outcomes</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="BaseDie.explode-518"><a href="#BaseDie.explode-518"><span class="linenos">518</span></a>        
</span><span id="BaseDie.explode-519"><a href="#BaseDie.explode-519"><span class="linenos">519</span></a>        <span class="k">def</span> <span class="nf">sub_func</span><span class="p">(</span><span class="n">outcome</span><span class="p">):</span>
</span><span id="BaseDie.explode-520"><a href="#BaseDie.explode-520"><span class="linenos">520</span></a>            <span class="k">if</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="n">outcomes</span><span class="p">:</span>
</span><span id="BaseDie.explode-521"><a href="#BaseDie.explode-521"><span class="linenos">521</span></a>                <span class="k">return</span> <span class="n">outcome</span> <span class="o">+</span> <span class="n">tail_die</span>
</span><span id="BaseDie.explode-522"><a href="#BaseDie.explode-522"><span class="linenos">522</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie.explode-523"><a href="#BaseDie.explode-523"><span class="linenos">523</span></a>                <span class="k">return</span> <span class="n">outcome</span>
</span><span id="BaseDie.explode-524"><a href="#BaseDie.explode-524"><span class="linenos">524</span></a>        
</span><span id="BaseDie.explode-525"><a href="#BaseDie.explode-525"><span class="linenos">525</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">sub_func</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">(),</span> <span class="n">denominator_method</span><span class="o">=</span><span class="s1">&#39;lcm&#39;</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Causes outcomes to be rolled again and added to the total.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>outcomes:</strong>  Which outcomes to explode. Options:
<ul>
<li>An iterable containing outcomes to explode.</li>
<li>A callable that takes an outcome and returns <code>True</code> if it should be exploded.
The callable will be supplied with one argument per <code><a href="#BaseDie.ndim">ndim</a></code> if this is a <code><a href="#VectorDie">VectorDie</a></code>.</li>
<li>If not supplied, the max outcome will explode.</li>
</ul></li>
<li><strong>max_depth:</strong>  The maximum number of additional dice to roll.
If not supplied, a default value will be used.</li>
</ul>
</div>


                            </div>
                            <div id="BaseDie.lowest" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.lowest">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">lowest</span><span class="signature">(*dice)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.lowest-529"><a href="#BaseDie.lowest-529"><span class="linenos">529</span></a>    <span class="k">def</span> <span class="nf">lowest</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">):</span>
</span><span id="BaseDie.lowest-530"><a href="#BaseDie.lowest-530"><span class="linenos">530</span></a>        <span class="sd">&quot;&quot;&quot; Roll all the dice and take the lowest.</span>
</span><span id="BaseDie.lowest-531"><a href="#BaseDie.lowest-531"><span class="linenos">531</span></a><span class="sd">        </span>
</span><span id="BaseDie.lowest-532"><a href="#BaseDie.lowest-532"><span class="linenos">532</span></a><span class="sd">        The maximum outcome is equal to the highest maximum outcome among all input dice.</span>
</span><span id="BaseDie.lowest-533"><a href="#BaseDie.lowest-533"><span class="linenos">533</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.lowest-534"><a href="#BaseDie.lowest-534"><span class="linenos">534</span></a>        <span class="n">dice</span><span class="p">,</span> <span class="n">ndim</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">dice_with_common_ndim</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">)</span>
</span><span id="BaseDie.lowest-535"><a href="#BaseDie.lowest-535"><span class="linenos">535</span></a>        <span class="n">max_outcome</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">max_outcome</span><span class="p">()</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">)</span>
</span><span id="BaseDie.lowest-536"><a href="#BaseDie.lowest-536"><span class="linenos">536</span></a>        <span class="n">dice</span> <span class="o">=</span> <span class="p">[</span><span class="n">die</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">max_outcome</span><span class="o">=</span><span class="n">max_outcome</span><span class="p">)</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">]</span>
</span><span id="BaseDie.lowest-537"><a href="#BaseDie.lowest-537"><span class="linenos">537</span></a>        <span class="n">dice</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">)</span>
</span><span id="BaseDie.lowest-538"><a href="#BaseDie.lowest-538"><span class="linenos">538</span></a>        <span class="n">sweights</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">sweights</span><span class="p">()</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">)))</span>
</span><span id="BaseDie.lowest-539"><a href="#BaseDie.lowest-539"><span class="linenos">539</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">from_sweights</span><span class="p">(</span><span class="n">dice</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="n">sweights</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Roll all the dice and take the lowest.</p>

<p>The maximum outcome is equal to the highest maximum outcome among all input dice.</p>
</div>


                            </div>
                            <div id="BaseDie.highest" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.highest">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">highest</span><span class="signature">(*dice)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.highest-541"><a href="#BaseDie.highest-541"><span class="linenos">541</span></a>    <span class="k">def</span> <span class="nf">highest</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">):</span>
</span><span id="BaseDie.highest-542"><a href="#BaseDie.highest-542"><span class="linenos">542</span></a>        <span class="sd">&quot;&quot;&quot; Roll all the dice and take the highest.</span>
</span><span id="BaseDie.highest-543"><a href="#BaseDie.highest-543"><span class="linenos">543</span></a><span class="sd">        </span>
</span><span id="BaseDie.highest-544"><a href="#BaseDie.highest-544"><span class="linenos">544</span></a><span class="sd">        The minimum outcome is equal to the highest minimum outcome among all input dice.</span>
</span><span id="BaseDie.highest-545"><a href="#BaseDie.highest-545"><span class="linenos">545</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.highest-546"><a href="#BaseDie.highest-546"><span class="linenos">546</span></a>        <span class="n">dice</span><span class="p">,</span> <span class="n">ndim</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">dice_with_common_ndim</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">)</span>
</span><span id="BaseDie.highest-547"><a href="#BaseDie.highest-547"><span class="linenos">547</span></a>        <span class="n">min_outcome</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">min_outcome</span><span class="p">()</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">)</span>
</span><span id="BaseDie.highest-548"><a href="#BaseDie.highest-548"><span class="linenos">548</span></a>        <span class="n">dice</span> <span class="o">=</span> <span class="p">[</span><span class="n">die</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">min_outcome</span><span class="o">=</span><span class="n">min_outcome</span><span class="p">)</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">]</span>
</span><span id="BaseDie.highest-549"><a href="#BaseDie.highest-549"><span class="linenos">549</span></a>        <span class="n">dice</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">)</span>
</span><span id="BaseDie.highest-550"><a href="#BaseDie.highest-550"><span class="linenos">550</span></a>        <span class="n">cweights</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">cweights</span><span class="p">()</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">)))</span>
</span><span id="BaseDie.highest-551"><a href="#BaseDie.highest-551"><span class="linenos">551</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">from_cweights</span><span class="p">(</span><span class="n">dice</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="n">cweights</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Roll all the dice and take the highest.</p>

<p>The minimum outcome is equal to the highest minimum outcome among all input dice.</p>
</div>


                            </div>
                            <div id="BaseDie.repeat_and_sum" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.repeat_and_sum">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">repeat_and_sum</span><span class="signature">(self, num_dice)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.repeat_and_sum-557"><a href="#BaseDie.repeat_and_sum-557"><span class="linenos">557</span></a>    <span class="k">def</span> <span class="nf">repeat_and_sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_dice</span><span class="p">):</span>
</span><span id="BaseDie.repeat_and_sum-558"><a href="#BaseDie.repeat_and_sum-558"><span class="linenos">558</span></a>        <span class="sd">&quot;&quot;&quot; Roll this die `num_dice` times and sum the results. </span>
</span><span id="BaseDie.repeat_and_sum-559"><a href="#BaseDie.repeat_and_sum-559"><span class="linenos">559</span></a><span class="sd">        </span>
</span><span id="BaseDie.repeat_and_sum-560"><a href="#BaseDie.repeat_and_sum-560"><span class="linenos">560</span></a><span class="sd">        If `num_dice` is negative, roll the die `abs(num_dice)` times and negate the result.</span>
</span><span id="BaseDie.repeat_and_sum-561"><a href="#BaseDie.repeat_and_sum-561"><span class="linenos">561</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.repeat_and_sum-562"><a href="#BaseDie.repeat_and_sum-562"><span class="linenos">562</span></a>        <span class="k">if</span> <span class="n">num_dice</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_repeat_and_sum_cache</span><span class="p">:</span>
</span><span id="BaseDie.repeat_and_sum-563"><a href="#BaseDie.repeat_and_sum-563"><span class="linenos">563</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_repeat_and_sum_cache</span><span class="p">[</span><span class="n">num_dice</span><span class="p">]</span>
</span><span id="BaseDie.repeat_and_sum-564"><a href="#BaseDie.repeat_and_sum-564"><span class="linenos">564</span></a>        
</span><span id="BaseDie.repeat_and_sum-565"><a href="#BaseDie.repeat_and_sum-565"><span class="linenos">565</span></a>        <span class="k">if</span> <span class="n">num_dice</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="BaseDie.repeat_and_sum-566"><a href="#BaseDie.repeat_and_sum-566"><span class="linenos">566</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">repeat_and_sum</span><span class="p">(</span><span class="o">-</span><span class="n">num_dice</span><span class="p">)</span>
</span><span id="BaseDie.repeat_and_sum-567"><a href="#BaseDie.repeat_and_sum-567"><span class="linenos">567</span></a>        <span class="k">elif</span> <span class="n">num_dice</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="BaseDie.repeat_and_sum-568"><a href="#BaseDie.repeat_and_sum-568"><span class="linenos">568</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span>
</span><span id="BaseDie.repeat_and_sum-569"><a href="#BaseDie.repeat_and_sum-569"><span class="linenos">569</span></a>        <span class="k">elif</span> <span class="n">num_dice</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="BaseDie.repeat_and_sum-570"><a href="#BaseDie.repeat_and_sum-570"><span class="linenos">570</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="BaseDie.repeat_and_sum-571"><a href="#BaseDie.repeat_and_sum-571"><span class="linenos">571</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie.repeat_and_sum-572"><a href="#BaseDie.repeat_and_sum-572"><span class="linenos">572</span></a>            <span class="c1"># Binary split seems to perform much worse.</span>
</span><span id="BaseDie.repeat_and_sum-573"><a href="#BaseDie.repeat_and_sum-573"><span class="linenos">573</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeat_and_sum</span><span class="p">(</span><span class="n">num_dice</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="BaseDie.repeat_and_sum-574"><a href="#BaseDie.repeat_and_sum-574"><span class="linenos">574</span></a>        
</span><span id="BaseDie.repeat_and_sum-575"><a href="#BaseDie.repeat_and_sum-575"><span class="linenos">575</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_repeat_and_sum_cache</span><span class="p">[</span><span class="n">num_dice</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
</span><span id="BaseDie.repeat_and_sum-576"><a href="#BaseDie.repeat_and_sum-576"><span class="linenos">576</span></a>        <span class="k">return</span> <span class="n">result</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Roll this die <code>num_dice</code> times and sum the results. </p>

<p>If <code>num_dice</code> is negative, roll the die <code>abs(num_dice)</code> times and negate the result.</p>
</div>


                            </div>
                            <div id="BaseDie.pool" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.pool">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">pool</span><span class="signature">(self, *args, **kwargs)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.pool-578"><a href="#BaseDie.pool-578"><span class="linenos">578</span></a>    <span class="k">def</span> <span class="nf">pool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="BaseDie.pool-579"><a href="#BaseDie.pool-579"><span class="linenos">579</span></a>        <span class="sd">&quot;&quot;&quot; Creates a pool from this die, as `icepool.Pool()`. &quot;&quot;&quot;</span>
</span><span id="BaseDie.pool-580"><a href="#BaseDie.pool-580"><span class="linenos">580</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Creates a pool from this die, as <code><a href="#Pool">icepool.Pool()</a></code>.</p>
</div>


                            </div>
                            <div id="BaseDie.keep" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.keep">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">keep</span><span class="signature">(
    self,
    num_dice=None,
    count_dice=None,
    *,
    truncate_min=None,
    truncate_max=None
)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.keep-582"><a href="#BaseDie.keep-582"><span class="linenos">582</span></a>    <span class="k">def</span> <span class="nf">keep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_dice</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">count_dice</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">truncate_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">truncate_max</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseDie.keep-583"><a href="#BaseDie.keep-583"><span class="linenos">583</span></a>        <span class="sd">&quot;&quot;&quot; Roll this die several times, possibly truncating the maximum outcomes, and sum some or all of the sorted results.</span>
</span><span id="BaseDie.keep-584"><a href="#BaseDie.keep-584"><span class="linenos">584</span></a><span class="sd">        </span>
</span><span id="BaseDie.keep-585"><a href="#BaseDie.keep-585"><span class="linenos">585</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie.keep-586"><a href="#BaseDie.keep-586"><span class="linenos">586</span></a><span class="sd">            num_dice: The number of dice to roll. All dice will have the same outcomes as `self`.</span>
</span><span id="BaseDie.keep-587"><a href="#BaseDie.keep-587"><span class="linenos">587</span></a><span class="sd">            count_dice: Only dice selected by this will be counted.</span>
</span><span id="BaseDie.keep-588"><a href="#BaseDie.keep-588"><span class="linenos">588</span></a><span class="sd">                See `DicePool.count_dice()` for details.</span>
</span><span id="BaseDie.keep-589"><a href="#BaseDie.keep-589"><span class="linenos">589</span></a><span class="sd">            truncate_min: A sequence of one outcome per die.</span>
</span><span id="BaseDie.keep-590"><a href="#BaseDie.keep-590"><span class="linenos">590</span></a><span class="sd">                That die will be truncated to that minimum outcome, with all lower outcomes being removed (i.e. rerolled).</span>
</span><span id="BaseDie.keep-591"><a href="#BaseDie.keep-591"><span class="linenos">591</span></a><span class="sd">                This is not compatible with `truncate_max`.</span>
</span><span id="BaseDie.keep-592"><a href="#BaseDie.keep-592"><span class="linenos">592</span></a><span class="sd">            truncate_max: A sequence of one outcome per die.</span>
</span><span id="BaseDie.keep-593"><a href="#BaseDie.keep-593"><span class="linenos">593</span></a><span class="sd">                That die will be truncated to that maximum outcome, with all higher outcomes being removed (i.e. rerolled).</span>
</span><span id="BaseDie.keep-594"><a href="#BaseDie.keep-594"><span class="linenos">594</span></a><span class="sd">                This is not compatible with `truncate_min`.</span>
</span><span id="BaseDie.keep-595"><a href="#BaseDie.keep-595"><span class="linenos">595</span></a><span class="sd">                </span>
</span><span id="BaseDie.keep-596"><a href="#BaseDie.keep-596"><span class="linenos">596</span></a><span class="sd">        Returns:</span>
</span><span id="BaseDie.keep-597"><a href="#BaseDie.keep-597"><span class="linenos">597</span></a><span class="sd">            A Die representing the probability distribution of the sum.</span>
</span><span id="BaseDie.keep-598"><a href="#BaseDie.keep-598"><span class="linenos">598</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.keep-599"><a href="#BaseDie.keep-599"><span class="linenos">599</span></a>        <span class="n">pool</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_dice</span><span class="p">,</span> <span class="n">count_dice</span><span class="o">=</span><span class="n">count_dice</span><span class="p">,</span> <span class="n">truncate_min</span><span class="o">=</span><span class="n">truncate_min</span><span class="p">,</span> <span class="n">truncate_max</span><span class="o">=</span><span class="n">truncate_max</span><span class="p">)</span>
</span><span id="BaseDie.keep-600"><a href="#BaseDie.keep-600"><span class="linenos">600</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">count_dice</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="BaseDie.keep-601"><a href="#BaseDie.keep-601"><span class="linenos">601</span></a>            <span class="k">return</span> <span class="n">pool</span>
</span><span id="BaseDie.keep-602"><a href="#BaseDie.keep-602"><span class="linenos">602</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie.keep-603"><a href="#BaseDie.keep-603"><span class="linenos">603</span></a>            <span class="k">return</span> <span class="n">pool</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Roll this die several times, possibly truncating the maximum outcomes, and sum some or all of the sorted results.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>num_dice:</strong>  The number of dice to roll. All dice will have the same outcomes as <code>self</code>.</li>
<li><strong>count_dice:</strong>  Only dice selected by this will be counted.
See <code><a href="#DicePool.count_dice">DicePool.count_dice()</a></code> for details.</li>
<li><strong>truncate_min:</strong>  A sequence of one outcome per die.
That die will be truncated to that minimum outcome, with all lower outcomes being removed (i.e. rerolled).
This is not compatible with <code>truncate_max</code>.</li>
<li><strong>truncate_max:</strong>  A sequence of one outcome per die.
That die will be truncated to that maximum outcome, with all higher outcomes being removed (i.e. rerolled).
This is not compatible with <code>truncate_min</code>.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A Die representing the probability distribution of the sum.</p>
</blockquote>
</div>


                            </div>
                            <div id="BaseDie.keep_highest" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.keep_highest">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">keep_highest</span><span class="signature">(
    self,
    num_dice=None,
    num_keep=1,
    num_drop=0,
    *,
    truncate_min=None,
    truncate_max=None
)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.keep_highest-605"><a href="#BaseDie.keep_highest-605"><span class="linenos">605</span></a>    <span class="k">def</span> <span class="nf">keep_highest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_dice</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_keep</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_drop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">truncate_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">truncate_max</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseDie.keep_highest-606"><a href="#BaseDie.keep_highest-606"><span class="linenos">606</span></a>        <span class="sd">&quot;&quot;&quot; Roll this die several times, possibly truncating the maximum outcomes, and sum the sorted results from the highest.</span>
</span><span id="BaseDie.keep_highest-607"><a href="#BaseDie.keep_highest-607"><span class="linenos">607</span></a><span class="sd">        </span>
</span><span id="BaseDie.keep_highest-608"><a href="#BaseDie.keep_highest-608"><span class="linenos">608</span></a><span class="sd">        Exactly one out of `num_dice`, `truncate_min`, and `truncate_max` should be provided.</span>
</span><span id="BaseDie.keep_highest-609"><a href="#BaseDie.keep_highest-609"><span class="linenos">609</span></a><span class="sd">        </span>
</span><span id="BaseDie.keep_highest-610"><a href="#BaseDie.keep_highest-610"><span class="linenos">610</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie.keep_highest-611"><a href="#BaseDie.keep_highest-611"><span class="linenos">611</span></a><span class="sd">            num_dice: The number of dice to roll. All dice will have the same outcomes as `self`.</span>
</span><span id="BaseDie.keep_highest-612"><a href="#BaseDie.keep_highest-612"><span class="linenos">612</span></a><span class="sd">            num_keep: The number of dice to keep.</span>
</span><span id="BaseDie.keep_highest-613"><a href="#BaseDie.keep_highest-613"><span class="linenos">613</span></a><span class="sd">            num_drop: If provided, this many highest dice will be dropped before keeping.</span>
</span><span id="BaseDie.keep_highest-614"><a href="#BaseDie.keep_highest-614"><span class="linenos">614</span></a><span class="sd">            truncate_min: A sequence of one outcome per die.</span>
</span><span id="BaseDie.keep_highest-615"><a href="#BaseDie.keep_highest-615"><span class="linenos">615</span></a><span class="sd">                That die will be truncated to that minimum outcome, with all lower outcomes being removed (i.e. rerolled).</span>
</span><span id="BaseDie.keep_highest-616"><a href="#BaseDie.keep_highest-616"><span class="linenos">616</span></a><span class="sd">            truncate_max: A sequence of one outcome per die.</span>
</span><span id="BaseDie.keep_highest-617"><a href="#BaseDie.keep_highest-617"><span class="linenos">617</span></a><span class="sd">                That die will be truncated to that maximum outcome, with all higher outcomes being removed (i.e. rerolled).</span>
</span><span id="BaseDie.keep_highest-618"><a href="#BaseDie.keep_highest-618"><span class="linenos">618</span></a><span class="sd">                </span>
</span><span id="BaseDie.keep_highest-619"><a href="#BaseDie.keep_highest-619"><span class="linenos">619</span></a><span class="sd">        Returns:</span>
</span><span id="BaseDie.keep_highest-620"><a href="#BaseDie.keep_highest-620"><span class="linenos">620</span></a><span class="sd">            A die representing the probability distribution of the sum.</span>
</span><span id="BaseDie.keep_highest-621"><a href="#BaseDie.keep_highest-621"><span class="linenos">621</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.keep_highest-622"><a href="#BaseDie.keep_highest-622"><span class="linenos">622</span></a>        <span class="k">if</span> <span class="n">num_keep</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">num_drop</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">truncate_min</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">truncate_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseDie.keep_highest-623"><a href="#BaseDie.keep_highest-623"><span class="linenos">623</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep_highest_single</span><span class="p">(</span><span class="n">num_dice</span><span class="p">)</span>
</span><span id="BaseDie.keep_highest-624"><a href="#BaseDie.keep_highest-624"><span class="linenos">624</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">num_keep</span> <span class="o">+</span> <span class="p">(</span><span class="n">num_drop</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="BaseDie.keep_highest-625"><a href="#BaseDie.keep_highest-625"><span class="linenos">625</span></a>        <span class="n">stop</span> <span class="o">=</span> <span class="o">-</span><span class="n">num_drop</span> <span class="k">if</span> <span class="n">num_drop</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="BaseDie.keep_highest-626"><a href="#BaseDie.keep_highest-626"><span class="linenos">626</span></a>        <span class="n">count_dice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">)</span>
</span><span id="BaseDie.keep_highest-627"><a href="#BaseDie.keep_highest-627"><span class="linenos">627</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep</span><span class="p">(</span><span class="n">num_dice</span><span class="p">,</span> <span class="n">count_dice</span><span class="p">,</span> <span class="n">truncate_min</span><span class="o">=</span><span class="n">truncate_min</span><span class="p">,</span> <span class="n">truncate_max</span><span class="o">=</span><span class="n">truncate_max</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Roll this die several times, possibly truncating the maximum outcomes, and sum the sorted results from the highest.</p>

<p>Exactly one out of <code>num_dice</code>, <code>truncate_min</code>, and <code>truncate_max</code> should be provided.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>num_dice:</strong>  The number of dice to roll. All dice will have the same outcomes as <code>self</code>.</li>
<li><strong>num_keep:</strong>  The number of dice to keep.</li>
<li><strong>num_drop:</strong>  If provided, this many highest dice will be dropped before keeping.</li>
<li><strong>truncate_min:</strong>  A sequence of one outcome per die.
That die will be truncated to that minimum outcome, with all lower outcomes being removed (i.e. rerolled).</li>
<li><strong>truncate_max:</strong>  A sequence of one outcome per die.
That die will be truncated to that maximum outcome, with all higher outcomes being removed (i.e. rerolled).</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A die representing the probability distribution of the sum.</p>
</blockquote>
</div>


                            </div>
                            <div id="BaseDie.keep_highest_single" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.keep_highest_single">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">keep_highest_single</span><span class="signature">(self, num_dice=None)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.keep_highest_single-629"><a href="#BaseDie.keep_highest_single-629"><span class="linenos">629</span></a>    <span class="k">def</span> <span class="nf">keep_highest_single</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_dice</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseDie.keep_highest_single-630"><a href="#BaseDie.keep_highest_single-630"><span class="linenos">630</span></a>        <span class="sd">&quot;&quot;&quot; Faster algorithm for keeping just the single highest die. &quot;&quot;&quot;</span>
</span><span id="BaseDie.keep_highest_single-631"><a href="#BaseDie.keep_highest_single-631"><span class="linenos">631</span></a>        <span class="k">if</span> <span class="n">num_dice</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseDie.keep_highest_single-632"><a href="#BaseDie.keep_highest_single-632"><span class="linenos">632</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span>
</span><span id="BaseDie.keep_highest_single-633"><a href="#BaseDie.keep_highest_single-633"><span class="linenos">633</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">from_cweights</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="n">num_dice</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cweights</span><span class="p">()),</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Faster algorithm for keeping just the single highest die.</p>
</div>


                            </div>
                            <div id="BaseDie.keep_lowest" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.keep_lowest">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">keep_lowest</span><span class="signature">(
    self,
    num_dice=None,
    num_keep=1,
    num_drop=0,
    *,
    truncate_min=None,
    truncate_max=None
)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.keep_lowest-635"><a href="#BaseDie.keep_lowest-635"><span class="linenos">635</span></a>    <span class="k">def</span> <span class="nf">keep_lowest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_dice</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_keep</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_drop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">truncate_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">truncate_max</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseDie.keep_lowest-636"><a href="#BaseDie.keep_lowest-636"><span class="linenos">636</span></a>        <span class="sd">&quot;&quot;&quot; Roll this die several times, possibly capping the maximum outcomes, and sum the sorted results from the lowest.</span>
</span><span id="BaseDie.keep_lowest-637"><a href="#BaseDie.keep_lowest-637"><span class="linenos">637</span></a><span class="sd">        </span>
</span><span id="BaseDie.keep_lowest-638"><a href="#BaseDie.keep_lowest-638"><span class="linenos">638</span></a><span class="sd">        Exactly one out of `num_dice`, `truncate_min`, and `truncate_max` should be provided.</span>
</span><span id="BaseDie.keep_lowest-639"><a href="#BaseDie.keep_lowest-639"><span class="linenos">639</span></a><span class="sd">        </span>
</span><span id="BaseDie.keep_lowest-640"><a href="#BaseDie.keep_lowest-640"><span class="linenos">640</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie.keep_lowest-641"><a href="#BaseDie.keep_lowest-641"><span class="linenos">641</span></a><span class="sd">            num_dice: The number of dice to roll. All dice will have the same outcomes as `self`.</span>
</span><span id="BaseDie.keep_lowest-642"><a href="#BaseDie.keep_lowest-642"><span class="linenos">642</span></a><span class="sd">            num_keep: The number of dice to keep.</span>
</span><span id="BaseDie.keep_lowest-643"><a href="#BaseDie.keep_lowest-643"><span class="linenos">643</span></a><span class="sd">            num_drop: If provided, this many lowest dice will be dropped before keeping.</span>
</span><span id="BaseDie.keep_lowest-644"><a href="#BaseDie.keep_lowest-644"><span class="linenos">644</span></a><span class="sd">            truncate_min: A sequence of one outcome per die.</span>
</span><span id="BaseDie.keep_lowest-645"><a href="#BaseDie.keep_lowest-645"><span class="linenos">645</span></a><span class="sd">                That die will be truncated to that minimum outcome, with all lower outcomes being removed (i.e. rerolled).</span>
</span><span id="BaseDie.keep_lowest-646"><a href="#BaseDie.keep_lowest-646"><span class="linenos">646</span></a><span class="sd">            truncate_max: A sequence of one outcome per die.</span>
</span><span id="BaseDie.keep_lowest-647"><a href="#BaseDie.keep_lowest-647"><span class="linenos">647</span></a><span class="sd">                That die will be truncated to that maximum outcome, with all higher outcomes being removed (i.e. rerolled).</span>
</span><span id="BaseDie.keep_lowest-648"><a href="#BaseDie.keep_lowest-648"><span class="linenos">648</span></a><span class="sd">                </span>
</span><span id="BaseDie.keep_lowest-649"><a href="#BaseDie.keep_lowest-649"><span class="linenos">649</span></a><span class="sd">        Returns:</span>
</span><span id="BaseDie.keep_lowest-650"><a href="#BaseDie.keep_lowest-650"><span class="linenos">650</span></a><span class="sd">            A die representing the probability distribution of the sum.</span>
</span><span id="BaseDie.keep_lowest-651"><a href="#BaseDie.keep_lowest-651"><span class="linenos">651</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.keep_lowest-652"><a href="#BaseDie.keep_lowest-652"><span class="linenos">652</span></a>        <span class="k">if</span> <span class="n">num_keep</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">num_drop</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">truncate_min</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">truncate_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseDie.keep_lowest-653"><a href="#BaseDie.keep_lowest-653"><span class="linenos">653</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep_lowest_single</span><span class="p">(</span><span class="n">num_dice</span><span class="p">)</span>
</span><span id="BaseDie.keep_lowest-654"><a href="#BaseDie.keep_lowest-654"><span class="linenos">654</span></a>        <span class="n">start</span> <span class="o">=</span> <span class="n">num_drop</span> <span class="k">if</span> <span class="n">num_drop</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="BaseDie.keep_lowest-655"><a href="#BaseDie.keep_lowest-655"><span class="linenos">655</span></a>        <span class="n">stop</span> <span class="o">=</span> <span class="n">num_keep</span> <span class="o">+</span> <span class="p">(</span><span class="n">num_drop</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="BaseDie.keep_lowest-656"><a href="#BaseDie.keep_lowest-656"><span class="linenos">656</span></a>        <span class="n">count_dice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">)</span>
</span><span id="BaseDie.keep_lowest-657"><a href="#BaseDie.keep_lowest-657"><span class="linenos">657</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep</span><span class="p">(</span><span class="n">num_dice</span><span class="p">,</span> <span class="n">count_dice</span><span class="p">,</span> <span class="n">truncate_min</span><span class="o">=</span><span class="n">truncate_min</span><span class="p">,</span> <span class="n">truncate_max</span><span class="o">=</span><span class="n">truncate_max</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Roll this die several times, possibly capping the maximum outcomes, and sum the sorted results from the lowest.</p>

<p>Exactly one out of <code>num_dice</code>, <code>truncate_min</code>, and <code>truncate_max</code> should be provided.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>num_dice:</strong>  The number of dice to roll. All dice will have the same outcomes as <code>self</code>.</li>
<li><strong>num_keep:</strong>  The number of dice to keep.</li>
<li><strong>num_drop:</strong>  If provided, this many lowest dice will be dropped before keeping.</li>
<li><strong>truncate_min:</strong>  A sequence of one outcome per die.
That die will be truncated to that minimum outcome, with all lower outcomes being removed (i.e. rerolled).</li>
<li><strong>truncate_max:</strong>  A sequence of one outcome per die.
That die will be truncated to that maximum outcome, with all higher outcomes being removed (i.e. rerolled).</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A die representing the probability distribution of the sum.</p>
</blockquote>
</div>


                            </div>
                            <div id="BaseDie.keep_lowest_single" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.keep_lowest_single">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">keep_lowest_single</span><span class="signature">(self, num_dice=None)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.keep_lowest_single-659"><a href="#BaseDie.keep_lowest_single-659"><span class="linenos">659</span></a>    <span class="k">def</span> <span class="nf">keep_lowest_single</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_dice</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseDie.keep_lowest_single-660"><a href="#BaseDie.keep_lowest_single-660"><span class="linenos">660</span></a>        <span class="sd">&quot;&quot;&quot; Faster algorithm for keeping just the single lowest die. &quot;&quot;&quot;</span>
</span><span id="BaseDie.keep_lowest_single-661"><a href="#BaseDie.keep_lowest_single-661"><span class="linenos">661</span></a>        <span class="k">if</span> <span class="n">num_dice</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseDie.keep_lowest_single-662"><a href="#BaseDie.keep_lowest_single-662"><span class="linenos">662</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span>
</span><span id="BaseDie.keep_lowest_single-663"><a href="#BaseDie.keep_lowest_single-663"><span class="linenos">663</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">from_sweights</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="n">num_dice</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sweights</span><span class="p">()),</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Faster algorithm for keeping just the single lowest die.</p>
</div>


                            </div>
                            <div id="BaseDie.abs" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.abs">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">abs</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.abs-673"><a href="#BaseDie.abs-673"><span class="linenos">673</span></a>    <span class="k">def</span> <span class="fm">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie.abs-674"><a href="#BaseDie.abs-674"><span class="linenos">674</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unary_op</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">abs</span><span class="p">)</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="BaseDie.zero" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.zero">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">zero</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.zero-697"><a href="#BaseDie.zero-697"><span class="linenos">697</span></a>    <span class="k">def</span> <span class="nf">zero</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie.zero-698"><a href="#BaseDie.zero-698"><span class="linenos">698</span></a>        <span class="sd">&quot;&quot;&quot; Zeros all outcomes of this die. </span>
</span><span id="BaseDie.zero-699"><a href="#BaseDie.zero-699"><span class="linenos">699</span></a><span class="sd">        </span>
</span><span id="BaseDie.zero-700"><a href="#BaseDie.zero-700"><span class="linenos">700</span></a><span class="sd">        This is done by calling the constructor for each outcome&#39;s type with no arguments.</span>
</span><span id="BaseDie.zero-701"><a href="#BaseDie.zero-701"><span class="linenos">701</span></a><span class="sd">        </span>
</span><span id="BaseDie.zero-702"><a href="#BaseDie.zero-702"><span class="linenos">702</span></a><span class="sd">        The result will have a single outcome with weight 1.</span>
</span><span id="BaseDie.zero-703"><a href="#BaseDie.zero-703"><span class="linenos">703</span></a><span class="sd">        </span>
</span><span id="BaseDie.zero-704"><a href="#BaseDie.zero-704"><span class="linenos">704</span></a><span class="sd">        Raises:</span>
</span><span id="BaseDie.zero-705"><a href="#BaseDie.zero-705"><span class="linenos">705</span></a><span class="sd">            `ValueError` if the zeros did not resolve to a single outcome.</span>
</span><span id="BaseDie.zero-706"><a href="#BaseDie.zero-706"><span class="linenos">706</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.zero-707"><a href="#BaseDie.zero-707"><span class="linenos">707</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unary_op</span><span class="p">(</span><span class="n">BaseDie</span><span class="o">.</span><span class="n">_zero</span><span class="p">)</span>
</span><span id="BaseDie.zero-708"><a href="#BaseDie.zero-708"><span class="linenos">708</span></a>        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">num_outcomes</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="BaseDie.zero-709"><a href="#BaseDie.zero-709"><span class="linenos">709</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;zero() did not resolve to a single outcome.&#39;</span><span class="p">)</span>
</span><span id="BaseDie.zero-710"><a href="#BaseDie.zero-710"><span class="linenos">710</span></a>        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Zeros all outcomes of this die. </p>

<p>This is done by calling the constructor for each outcome's type with no arguments.</p>

<p>The result will have a single outcome with weight 1.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><code>ValueError</code> if the zeros did not resolve to a single outcome.</li>
</ul>
</div>


                            </div>
                            <div id="BaseDie.zero_outcome" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.zero_outcome">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">zero_outcome</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.zero_outcome-712"><a href="#BaseDie.zero_outcome-712"><span class="linenos">712</span></a>    <span class="k">def</span> <span class="nf">zero_outcome</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie.zero_outcome-713"><a href="#BaseDie.zero_outcome-713"><span class="linenos">713</span></a>        <span class="sd">&quot;&quot;&quot; Returns a zero-outcome for this die, e.g. `0` for a die whose outcomes are `int`s. &quot;&quot;&quot;</span>
</span><span id="BaseDie.zero_outcome-714"><a href="#BaseDie.zero_outcome-714"><span class="linenos">714</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns a zero-outcome for this die, e.g. <code>0</code> for a die whose outcomes are <code>int</code>s.</p>
</div>


                            </div>
                            <div id="BaseDie.bool" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.bool">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">bool</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.bool-716"><a href="#BaseDie.bool-716"><span class="linenos">716</span></a>    <span class="k">def</span> <span class="nf">bool</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie.bool-717"><a href="#BaseDie.bool-717"><span class="linenos">717</span></a>        <span class="sd">&quot;&quot;&quot; Takes `bool()` of all outcomes.</span>
</span><span id="BaseDie.bool-718"><a href="#BaseDie.bool-718"><span class="linenos">718</span></a><span class="sd">        </span>
</span><span id="BaseDie.bool-719"><a href="#BaseDie.bool-719"><span class="linenos">719</span></a><span class="sd">        Note the die as a whole is not considered to have a truth value.</span>
</span><span id="BaseDie.bool-720"><a href="#BaseDie.bool-720"><span class="linenos">720</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.bool-721"><a href="#BaseDie.bool-721"><span class="linenos">721</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unary_op</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Takes <code><a href="#BaseDie.bool">bool()</a></code> of all outcomes.</p>

<p>Note the die as a whole is not considered to have a truth value.</p>
</div>


                            </div>
                            <div id="BaseDie.sign" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.sign">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">sign</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.sign-857"><a href="#BaseDie.sign-857"><span class="linenos">857</span></a>    <span class="k">def</span> <span class="nf">sign</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie.sign-858"><a href="#BaseDie.sign-858"><span class="linenos">858</span></a>        <span class="sd">&quot;&quot;&quot; Outcomes become 1 if greater than `zero()`, -1 if less than `zero()`, and 0 otherwise.</span>
</span><span id="BaseDie.sign-859"><a href="#BaseDie.sign-859"><span class="linenos">859</span></a><span class="sd">        </span>
</span><span id="BaseDie.sign-860"><a href="#BaseDie.sign-860"><span class="linenos">860</span></a><span class="sd">        Note that for `float`s, +0.0, -0.0, and nan all become 0.</span>
</span><span id="BaseDie.sign-861"><a href="#BaseDie.sign-861"><span class="linenos">861</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.sign-862"><a href="#BaseDie.sign-862"><span class="linenos">862</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unary_op</span><span class="p">(</span><span class="n">BaseDie</span><span class="o">.</span><span class="n">_sign</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Outcomes become 1 if greater than <code><a href="#BaseDie.zero">zero()</a></code>, -1 if less than <code><a href="#BaseDie.zero">zero()</a></code>, and 0 otherwise.</p>

<p>Note that for <code>float</code>s, +0.0, -0.0, and nan all become 0.</p>
</div>


                            </div>
                            <div id="BaseDie.cmp" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.cmp">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">cmp</span><span class="signature">(self, other)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.cmp-868"><a href="#BaseDie.cmp-868"><span class="linenos">868</span></a>    <span class="k">def</span> <span class="nf">cmp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="BaseDie.cmp-869"><a href="#BaseDie.cmp-869"><span class="linenos">869</span></a>        <span class="sd">&quot;&quot;&quot; Returns a die with possible outcomes 1, -1, and 0.</span>
</span><span id="BaseDie.cmp-870"><a href="#BaseDie.cmp-870"><span class="linenos">870</span></a><span class="sd">        </span>
</span><span id="BaseDie.cmp-871"><a href="#BaseDie.cmp-871"><span class="linenos">871</span></a><span class="sd">        The weights are equal to the positive outcome of `self &gt; other`, `self &lt; other`, and the remainder respectively.</span>
</span><span id="BaseDie.cmp-872"><a href="#BaseDie.cmp-872"><span class="linenos">872</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.cmp-873"><a href="#BaseDie.cmp-873"><span class="linenos">873</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BaseDie</span><span class="o">.</span><span class="n">_cmp</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns a die with possible outcomes 1, -1, and 0.</p>

<p>The weights are equal to the positive outcome of <code>self &gt; other</code>, <code>self &lt; other</code>, and the remainder respectively.</p>
</div>


                            </div>
                            <div id="BaseDie.sample" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.sample">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">sample</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.sample-892"><a href="#BaseDie.sample-892"><span class="linenos">892</span></a>    <span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie.sample-893"><a href="#BaseDie.sample-893"><span class="linenos">893</span></a>        <span class="sd">&quot;&quot;&quot; Returns a random roll of this die. </span>
</span><span id="BaseDie.sample-894"><a href="#BaseDie.sample-894"><span class="linenos">894</span></a><span class="sd">        </span>
</span><span id="BaseDie.sample-895"><a href="#BaseDie.sample-895"><span class="linenos">895</span></a><span class="sd">        Do not use for security purposes.</span>
</span><span id="BaseDie.sample-896"><a href="#BaseDie.sample-896"><span class="linenos">896</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.sample-897"><a href="#BaseDie.sample-897"><span class="linenos">897</span></a>        <span class="c1"># We don&#39;t use random.choices since that is based on floats rather than ints.</span>
</span><span id="BaseDie.sample-898"><a href="#BaseDie.sample-898"><span class="linenos">898</span></a>        <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">())</span>
</span><span id="BaseDie.sample-899"><a href="#BaseDie.sample-899"><span class="linenos">899</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_right</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cweights</span><span class="p">(),</span> <span class="n">r</span><span class="p">)</span>
</span><span id="BaseDie.sample-900"><a href="#BaseDie.sample-900"><span class="linenos">900</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns a random roll of this die. </p>

<p>Do not use for security purposes.</p>
</div>


                            </div>
                            <div id="BaseDie.key_tuple" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.key_tuple">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">key_tuple</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.key_tuple-922"><a href="#BaseDie.key_tuple-922"><span class="linenos">922</span></a>    <span class="k">def</span> <span class="nf">key_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie.key_tuple-923"><a href="#BaseDie.key_tuple-923"><span class="linenos">923</span></a>        <span class="sd">&quot;&quot;&quot; Returns a tuple that uniquely (as `equals()`) identifies this die. &quot;&quot;&quot;</span>
</span><span id="BaseDie.key_tuple-924"><a href="#BaseDie.key_tuple-924"><span class="linenos">924</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_key_tuple</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns a tuple that uniquely (as <code><a href="#BaseDie.equals">equals()</a></code>) identifies this die.</p>
</div>


                            </div>
                            <div id="BaseDie.hash" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.hash">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">hash</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.hash-926"><a href="#BaseDie.hash-926"><span class="linenos">926</span></a>    <span class="k">def</span> <span class="nf">hash</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseDie.hash-927"><a href="#BaseDie.hash-927"><span class="linenos">927</span></a>        <span class="sd">&quot;&quot;&quot; A true __hash__ doesn&#39;t work because we used the __eq__ operator </span>
</span><span id="BaseDie.hash-928"><a href="#BaseDie.hash-928"><span class="linenos">928</span></a><span class="sd">        for determining the chance two dice will roll equal to each other.</span>
</span><span id="BaseDie.hash-929"><a href="#BaseDie.hash-929"><span class="linenos">929</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.hash-930"><a href="#BaseDie.hash-930"><span class="linenos">930</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key_tuple</span><span class="p">())</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>A true __hash__ doesn't work because we used the __eq__ operator 
for determining the chance two dice will roll equal to each other.</p>
</div>


                            </div>
                            <div id="BaseDie.equals" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseDie.equals">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">equals</span><span class="signature">(self, other, *, reduce=False)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseDie.equals-934"><a href="#BaseDie.equals-934"><span class="linenos">934</span></a>    <span class="k">def</span> <span class="nf">equals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">reduce</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="BaseDie.equals-935"><a href="#BaseDie.equals-935"><span class="linenos">935</span></a>        <span class="sd">&quot;&quot;&quot; Returns `True` iff both dice have the same ndim, outcomes, and weights.</span>
</span><span id="BaseDie.equals-936"><a href="#BaseDie.equals-936"><span class="linenos">936</span></a><span class="sd">        </span>
</span><span id="BaseDie.equals-937"><a href="#BaseDie.equals-937"><span class="linenos">937</span></a><span class="sd">        Also, if one die has a zero-weight outcome and the other die does not contain that outcome,</span>
</span><span id="BaseDie.equals-938"><a href="#BaseDie.equals-938"><span class="linenos">938</span></a><span class="sd">        they are treated as unequal by this function.</span>
</span><span id="BaseDie.equals-939"><a href="#BaseDie.equals-939"><span class="linenos">939</span></a><span class="sd">        </span>
</span><span id="BaseDie.equals-940"><a href="#BaseDie.equals-940"><span class="linenos">940</span></a><span class="sd">        For the chance of two dice rolling the same outcome, use the `==` operator.</span>
</span><span id="BaseDie.equals-941"><a href="#BaseDie.equals-941"><span class="linenos">941</span></a><span class="sd">        </span>
</span><span id="BaseDie.equals-942"><a href="#BaseDie.equals-942"><span class="linenos">942</span></a><span class="sd">        Args:</span>
</span><span id="BaseDie.equals-943"><a href="#BaseDie.equals-943"><span class="linenos">943</span></a><span class="sd">            reduce: If `True`, the dice will be reduced before comparing.</span>
</span><span id="BaseDie.equals-944"><a href="#BaseDie.equals-944"><span class="linenos">944</span></a><span class="sd">                Otherwise, e.g. a 2:2 coin is not `equals()` to a 1:1 coin. </span>
</span><span id="BaseDie.equals-945"><a href="#BaseDie.equals-945"><span class="linenos">945</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseDie.equals-946"><a href="#BaseDie.equals-946"><span class="linenos">946</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="BaseDie.equals-947"><a href="#BaseDie.equals-947"><span class="linenos">947</span></a>            <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="BaseDie.equals-948"><a href="#BaseDie.equals-948"><span class="linenos">948</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="BaseDie.equals-949"><a href="#BaseDie.equals-949"><span class="linenos">949</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="BaseDie.equals-950"><a href="#BaseDie.equals-950"><span class="linenos">950</span></a>        
</span><span id="BaseDie.equals-951"><a href="#BaseDie.equals-951"><span class="linenos">951</span></a>        <span class="k">if</span> <span class="n">reduce</span><span class="p">:</span>
</span><span id="BaseDie.equals-952"><a href="#BaseDie.equals-952"><span class="linenos">952</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span><span class="o">.</span><span class="n">key_tuple</span><span class="p">()</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span><span class="o">.</span><span class="n">key_tuple</span><span class="p">()</span>
</span><span id="BaseDie.equals-953"><a href="#BaseDie.equals-953"><span class="linenos">953</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseDie.equals-954"><a href="#BaseDie.equals-954"><span class="linenos">954</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">key_tuple</span><span class="p">()</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">key_tuple</span><span class="p">()</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns <code>True</code> iff both dice have the same ndim, outcomes, and weights.</p>

<p>Also, if one die has a zero-weight outcome and the other die does not contain that outcome,
they are treated as unequal by this function.</p>

<p>For the chance of two dice rolling the same outcome, use the <code>==</code> operator.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>reduce:</strong>  If <code>True</code>, the dice will be reduced before comparing.
Otherwise, e.g. a 2:2 coin is not <code><a href="#BaseDie.equals">equals()</a></code> to a 1:1 coin.</li>
</ul>
</div>


                            </div>
                </section>
                <section id="EmptyDie">
                                <div class="attr class">
        <a class="headerlink" href="#EmptyDie">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">EmptyDie</span><wbr>(<span class="base"><a href="#BaseDie">icepool.BaseDie</a></span>):
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmptyDie-7"><a href="#EmptyDie-7"><span class="linenos"> 7</span></a><span class="k">class</span> <span class="nc">EmptyDie</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">die</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">BaseDie</span><span class="p">):</span>
</span><span id="EmptyDie-8"><a href="#EmptyDie-8"><span class="linenos"> 8</span></a>    <span class="sd">&quot;&quot;&quot; Die with no outcomes. &quot;&quot;&quot;</span>
</span><span id="EmptyDie-9"><a href="#EmptyDie-9"><span class="linenos"> 9</span></a>    
</span><span id="EmptyDie-10"><a href="#EmptyDie-10"><span class="linenos">10</span></a>    <span class="k">def</span> <span class="nf">ndim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmptyDie-11"><a href="#EmptyDie-11"><span class="linenos">11</span></a>        <span class="k">return</span> <span class="s1">&#39;empty&#39;</span>
</span><span id="EmptyDie-12"><a href="#EmptyDie-12"><span class="linenos">12</span></a>    
</span><span id="EmptyDie-13"><a href="#EmptyDie-13"><span class="linenos">13</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmptyDie-14"><a href="#EmptyDie-14"><span class="linenos">14</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">Counts</span><span class="p">({})</span>
</span><span id="EmptyDie-15"><a href="#EmptyDie-15"><span class="linenos">15</span></a>        
</span><span id="EmptyDie-16"><a href="#EmptyDie-16"><span class="linenos">16</span></a>    <span class="k">def</span> <span class="nf">_unary_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="EmptyDie-17"><a href="#EmptyDie-17"><span class="linenos">17</span></a>        <span class="sd">&quot;&quot;&quot; There are no outcomes, so nothing happens. &quot;&quot;&quot;</span>
</span><span id="EmptyDie-18"><a href="#EmptyDie-18"><span class="linenos">18</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="EmptyDie-19"><a href="#EmptyDie-19"><span class="linenos">19</span></a>    
</span><span id="EmptyDie-20"><a href="#EmptyDie-20"><span class="linenos">20</span></a>    <span class="k">def</span> <span class="nf">_binary_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="EmptyDie-21"><a href="#EmptyDie-21"><span class="linenos">21</span></a>        <span class="sd">&quot;&quot;&quot; There are no outcomes, so nothing happens. &quot;&quot;&quot;</span>
</span><span id="EmptyDie-22"><a href="#EmptyDie-22"><span class="linenos">22</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="EmptyDie-23"><a href="#EmptyDie-23"><span class="linenos">23</span></a>    
</span><span id="EmptyDie-24"><a href="#EmptyDie-24"><span class="linenos">24</span></a>    <span class="k">def</span> <span class="nf">_wrap_unpack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
</span><span id="EmptyDie-25"><a href="#EmptyDie-25"><span class="linenos">25</span></a>        <span class="k">return</span> <span class="n">func</span>
</span><span id="EmptyDie-26"><a href="#EmptyDie-26"><span class="linenos">26</span></a>
</span><span id="EmptyDie-27"><a href="#EmptyDie-27"><span class="linenos">27</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmptyDie-28"><a href="#EmptyDie-28"><span class="linenos">28</span></a>        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__qualname__</span> <span class="o">+</span> <span class="s1">&#39;()&#39;</span>
</span><span id="EmptyDie-29"><a href="#EmptyDie-29"><span class="linenos">29</span></a>    
</span><span id="EmptyDie-30"><a href="#EmptyDie-30"><span class="linenos">30</span></a>    <span class="k">def</span> <span class="nf">markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="EmptyDie-31"><a href="#EmptyDie-31"><span class="linenos">31</span></a>        <span class="k">return</span> <span class="s1">&#39;EmptyDie&#39;</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Die with no outcomes.</p>
</div>


                            <div id="EmptyDie.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#EmptyDie.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">EmptyDie</span><span class="signature">()</span>
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmptyDie.__init__-13"><a href="#EmptyDie.__init__-13"><span class="linenos">13</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmptyDie.__init__-14"><a href="#EmptyDie.__init__-14"><span class="linenos">14</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">Counts</span><span class="p">({})</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="EmptyDie.ndim" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#EmptyDie.ndim">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">ndim</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmptyDie.ndim-10"><a href="#EmptyDie.ndim-10"><span class="linenos">10</span></a>    <span class="k">def</span> <span class="nf">ndim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmptyDie.ndim-11"><a href="#EmptyDie.ndim-11"><span class="linenos">11</span></a>        <span class="k">return</span> <span class="s1">&#39;empty&#39;</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns the number of dimensions if this is a <code><a href="#VectorDie">VectorDie</a></code>.</p>

<p>Otherwise, returns <code>'scalar'</code> for a <code><a href="#ScalarDie">ScalarDie</a></code> and <code>'empty'</code> for an <code><a href="#EmptyDie">EmptyDie</a></code>.</p>
</div>


                            </div>
                            <div id="EmptyDie.markdown" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#EmptyDie.markdown">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">markdown</span><span class="signature">(self, include_weights=True)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmptyDie.markdown-30"><a href="#EmptyDie.markdown-30"><span class="linenos">30</span></a>    <span class="k">def</span> <span class="nf">markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="EmptyDie.markdown-31"><a href="#EmptyDie.markdown-31"><span class="linenos">31</span></a>        <span class="k">return</span> <span class="s1">&#39;EmptyDie&#39;</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Formats the die as a Markdown string. </p>

<p>This will have the denominator and a table of outcomes and their probabilities.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>include_weights:</strong>  Iff <code>True</code>, the table will have a column for weights.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#BaseDie">BaseDie</a></dt>
                                <dd id="EmptyDie.outcomes" class="function"><a href="#BaseDie.outcomes">outcomes</a></dd>
                <dd id="EmptyDie.num_outcomes" class="function"><a href="#BaseDie.num_outcomes">num_outcomes</a></dd>
                <dd id="EmptyDie.is_empty" class="function"><a href="#BaseDie.is_empty">is_empty</a></dd>
                <dd id="EmptyDie.weights" class="function"><a href="#BaseDie.weights">weights</a></dd>
                <dd id="EmptyDie.has_zero_weights" class="function"><a href="#BaseDie.has_zero_weights">has_zero_weights</a></dd>
                <dd id="EmptyDie.items" class="function"><a href="#BaseDie.items">items</a></dd>
                <dd id="EmptyDie.denominator" class="function"><a href="#BaseDie.denominator">denominator</a></dd>
                <dd id="EmptyDie.total_weight" class="function"><a href="#BaseDie.total_weight">total_weight</a></dd>
                <dd id="EmptyDie.pmf" class="function"><a href="#BaseDie.pmf">pmf</a></dd>
                <dd id="EmptyDie.cweights" class="function"><a href="#BaseDie.cweights">cweights</a></dd>
                <dd id="EmptyDie.sweights" class="function"><a href="#BaseDie.sweights">sweights</a></dd>
                <dd id="EmptyDie.cdf" class="function"><a href="#BaseDie.cdf">cdf</a></dd>
                <dd id="EmptyDie.sf" class="function"><a href="#BaseDie.sf">sf</a></dd>
                <dd id="EmptyDie.weight_eq" class="function"><a href="#BaseDie.weight_eq">weight_eq</a></dd>
                <dd id="EmptyDie.weight_ne" class="function"><a href="#BaseDie.weight_ne">weight_ne</a></dd>
                <dd id="EmptyDie.weight_le" class="function"><a href="#BaseDie.weight_le">weight_le</a></dd>
                <dd id="EmptyDie.weight_lt" class="function"><a href="#BaseDie.weight_lt">weight_lt</a></dd>
                <dd id="EmptyDie.weight_ge" class="function"><a href="#BaseDie.weight_ge">weight_ge</a></dd>
                <dd id="EmptyDie.weight_gt" class="function"><a href="#BaseDie.weight_gt">weight_gt</a></dd>
                <dd id="EmptyDie.probability" class="function"><a href="#BaseDie.probability">probability</a></dd>
                <dd id="EmptyDie.mode" class="function"><a href="#BaseDie.mode">mode</a></dd>
                <dd id="EmptyDie.modal_weight" class="function"><a href="#BaseDie.modal_weight">modal_weight</a></dd>
                <dd id="EmptyDie.ks_stat" class="function"><a href="#BaseDie.ks_stat">ks_stat</a></dd>
                <dd id="EmptyDie.cvm_stat" class="function"><a href="#BaseDie.cvm_stat">cvm_stat</a></dd>
                <dd id="EmptyDie.reduce" class="function"><a href="#BaseDie.reduce">reduce</a></dd>
                <dd id="EmptyDie.scale_weights" class="function"><a href="#BaseDie.scale_weights">scale_weights</a></dd>
                <dd id="EmptyDie.min_outcome" class="function"><a href="#BaseDie.min_outcome">min_outcome</a></dd>
                <dd id="EmptyDie.max_outcome" class="function"><a href="#BaseDie.max_outcome">max_outcome</a></dd>
                <dd id="EmptyDie.nearest_le" class="function"><a href="#BaseDie.nearest_le">nearest_le</a></dd>
                <dd id="EmptyDie.nearest_ge" class="function"><a href="#BaseDie.nearest_ge">nearest_ge</a></dd>
                <dd id="EmptyDie.reroll" class="function"><a href="#BaseDie.reroll">reroll</a></dd>
                <dd id="EmptyDie.reroll_until" class="function"><a href="#BaseDie.reroll_until">reroll_until</a></dd>
                <dd id="EmptyDie.truncate" class="function"><a href="#BaseDie.truncate">truncate</a></dd>
                <dd id="EmptyDie.clip" class="function"><a href="#BaseDie.clip">clip</a></dd>
                <dd id="EmptyDie.cond" class="function"><a href="#BaseDie.cond">cond</a></dd>
                <dd id="EmptyDie.set_outcomes" class="function"><a href="#BaseDie.set_outcomes">set_outcomes</a></dd>
                <dd id="EmptyDie.trim" class="function"><a href="#BaseDie.trim">trim</a></dd>
                <dd id="EmptyDie.sub" class="function"><a href="#BaseDie.sub">sub</a></dd>
                <dd id="EmptyDie.explode" class="function"><a href="#BaseDie.explode">explode</a></dd>
                <dd id="EmptyDie.lowest" class="function"><a href="#BaseDie.lowest">lowest</a></dd>
                <dd id="EmptyDie.highest" class="function"><a href="#BaseDie.highest">highest</a></dd>
                <dd id="EmptyDie.repeat_and_sum" class="function"><a href="#BaseDie.repeat_and_sum">repeat_and_sum</a></dd>
                <dd id="EmptyDie.pool" class="function"><a href="#BaseDie.pool">pool</a></dd>
                <dd id="EmptyDie.keep" class="function"><a href="#BaseDie.keep">keep</a></dd>
                <dd id="EmptyDie.keep_highest" class="function"><a href="#BaseDie.keep_highest">keep_highest</a></dd>
                <dd id="EmptyDie.keep_highest_single" class="function"><a href="#BaseDie.keep_highest_single">keep_highest_single</a></dd>
                <dd id="EmptyDie.keep_lowest" class="function"><a href="#BaseDie.keep_lowest">keep_lowest</a></dd>
                <dd id="EmptyDie.keep_lowest_single" class="function"><a href="#BaseDie.keep_lowest_single">keep_lowest_single</a></dd>
                <dd id="EmptyDie.abs" class="function"><a href="#BaseDie.abs">abs</a></dd>
                <dd id="EmptyDie.zero" class="function"><a href="#BaseDie.zero">zero</a></dd>
                <dd id="EmptyDie.zero_outcome" class="function"><a href="#BaseDie.zero_outcome">zero_outcome</a></dd>
                <dd id="EmptyDie.bool" class="function"><a href="#BaseDie.bool">bool</a></dd>
                <dd id="EmptyDie.sign" class="function"><a href="#BaseDie.sign">sign</a></dd>
                <dd id="EmptyDie.cmp" class="function"><a href="#BaseDie.cmp">cmp</a></dd>
                <dd id="EmptyDie.sample" class="function"><a href="#BaseDie.sample">sample</a></dd>
                <dd id="EmptyDie.key_tuple" class="function"><a href="#BaseDie.key_tuple">key_tuple</a></dd>
                <dd id="EmptyDie.hash" class="function"><a href="#BaseDie.hash">hash</a></dd>
                <dd id="EmptyDie.equals" class="function"><a href="#BaseDie.equals">equals</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="ScalarDie">
                                <div class="attr class">
        <a class="headerlink" href="#ScalarDie">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">ScalarDie</span><wbr>(<span class="base"><a href="#BaseDie">icepool.BaseDie</a></span>):
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScalarDie-12"><a href="#ScalarDie-12"><span class="linenos"> 12</span></a><span class="k">class</span> <span class="nc">ScalarDie</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">die</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">BaseDie</span><span class="p">):</span>
</span><span id="ScalarDie-13"><a href="#ScalarDie-13"><span class="linenos"> 13</span></a>    <span class="sd">&quot;&quot;&quot; Univariate die.</span>
</span><span id="ScalarDie-14"><a href="#ScalarDie-14"><span class="linenos"> 14</span></a><span class="sd">    </span>
</span><span id="ScalarDie-15"><a href="#ScalarDie-15"><span class="linenos"> 15</span></a><span class="sd">    Outcomes are scalars and operations are performed directly on the outcomes.</span>
</span><span id="ScalarDie-16"><a href="#ScalarDie-16"><span class="linenos"> 16</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ScalarDie-17"><a href="#ScalarDie-17"><span class="linenos"> 17</span></a>    
</span><span id="ScalarDie-18"><a href="#ScalarDie-18"><span class="linenos"> 18</span></a>    <span class="k">def</span> <span class="nf">ndim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScalarDie-19"><a href="#ScalarDie-19"><span class="linenos"> 19</span></a>        <span class="k">return</span> <span class="s1">&#39;scalar&#39;</span>
</span><span id="ScalarDie-20"><a href="#ScalarDie-20"><span class="linenos"> 20</span></a>    
</span><span id="ScalarDie-21"><a href="#ScalarDie-21"><span class="linenos"> 21</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="ScalarDie-22"><a href="#ScalarDie-22"><span class="linenos"> 22</span></a>        <span class="sd">&quot;&quot;&quot; Constructor.</span>
</span><span id="ScalarDie-23"><a href="#ScalarDie-23"><span class="linenos"> 23</span></a><span class="sd">        </span>
</span><span id="ScalarDie-24"><a href="#ScalarDie-24"><span class="linenos"> 24</span></a><span class="sd">        Dice should not be constructed directly;</span>
</span><span id="ScalarDie-25"><a href="#ScalarDie-25"><span class="linenos"> 25</span></a><span class="sd">        instead, use one of the methods defined in `icepool.die.func` </span>
</span><span id="ScalarDie-26"><a href="#ScalarDie-26"><span class="linenos"> 26</span></a><span class="sd">        (which are imported into the top-level `icepool` module).</span>
</span><span id="ScalarDie-27"><a href="#ScalarDie-27"><span class="linenos"> 27</span></a><span class="sd">        </span>
</span><span id="ScalarDie-28"><a href="#ScalarDie-28"><span class="linenos"> 28</span></a><span class="sd">        Args:</span>
</span><span id="ScalarDie-29"><a href="#ScalarDie-29"><span class="linenos"> 29</span></a><span class="sd">            data: A `Counts` mapping outcomes to weights.</span>
</span><span id="ScalarDie-30"><a href="#ScalarDie-30"><span class="linenos"> 30</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ScalarDie-31"><a href="#ScalarDie-31"><span class="linenos"> 31</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">data</span>
</span><span id="ScalarDie-32"><a href="#ScalarDie-32"><span class="linenos"> 32</span></a>    
</span><span id="ScalarDie-33"><a href="#ScalarDie-33"><span class="linenos"> 33</span></a>    <span class="k">def</span> <span class="nf">_unary_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ScalarDie-34"><a href="#ScalarDie-34"><span class="linenos"> 34</span></a>        <span class="sd">&quot;&quot;&quot; Returns a die representing the effect of performing the operation on the outcomes. &quot;&quot;&quot;</span>
</span><span id="ScalarDie-35"><a href="#ScalarDie-35"><span class="linenos"> 35</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="ScalarDie-36"><a href="#ScalarDie-36"><span class="linenos"> 36</span></a>        <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ScalarDie-37"><a href="#ScalarDie-37"><span class="linenos"> 37</span></a>            <span class="n">data</span><span class="p">[</span><span class="n">op</span><span class="p">(</span><span class="n">outcome</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">weight</span>
</span><span id="ScalarDie-38"><a href="#ScalarDie-38"><span class="linenos"> 38</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="s1">&#39;scalar&#39;</span><span class="p">)</span>
</span><span id="ScalarDie-39"><a href="#ScalarDie-39"><span class="linenos"> 39</span></a>    
</span><span id="ScalarDie-40"><a href="#ScalarDie-40"><span class="linenos"> 40</span></a>    <span class="k">def</span> <span class="nf">_binary_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ScalarDie-41"><a href="#ScalarDie-41"><span class="linenos"> 41</span></a>        <span class="sd">&quot;&quot;&quot; Returns a die representing the effect of performing the operation on pairs of outcomes from the two dice. &quot;&quot;&quot;</span>
</span><span id="ScalarDie-42"><a href="#ScalarDie-42"><span class="linenos"> 42</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="ScalarDie-43"><a href="#ScalarDie-43"><span class="linenos"> 43</span></a>        <span class="k">for</span> <span class="p">(</span><span class="n">outcome_self</span><span class="p">,</span> <span class="n">weight_self</span><span class="p">),</span> <span class="p">(</span><span class="n">outcome_other</span><span class="p">,</span> <span class="n">weight_other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">other</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
</span><span id="ScalarDie-44"><a href="#ScalarDie-44"><span class="linenos"> 44</span></a>            <span class="n">data</span><span class="p">[</span><span class="n">op</span><span class="p">(</span><span class="n">outcome_self</span><span class="p">,</span> <span class="n">outcome_other</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">weight_self</span> <span class="o">*</span> <span class="n">weight_other</span>
</span><span id="ScalarDie-45"><a href="#ScalarDie-45"><span class="linenos"> 45</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="s1">&#39;scalar&#39;</span><span class="p">)</span>
</span><span id="ScalarDie-46"><a href="#ScalarDie-46"><span class="linenos"> 46</span></a>    
</span><span id="ScalarDie-47"><a href="#ScalarDie-47"><span class="linenos"> 47</span></a>    <span class="k">def</span> <span class="nf">_wrap_unpack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
</span><span id="ScalarDie-48"><a href="#ScalarDie-48"><span class="linenos"> 48</span></a>        <span class="k">return</span> <span class="n">func</span>
</span><span id="ScalarDie-49"><a href="#ScalarDie-49"><span class="linenos"> 49</span></a>    
</span><span id="ScalarDie-50"><a href="#ScalarDie-50"><span class="linenos"> 50</span></a>    <span class="c1"># Special operators.</span>
</span><span id="ScalarDie-51"><a href="#ScalarDie-51"><span class="linenos"> 51</span></a>    
</span><span id="ScalarDie-52"><a href="#ScalarDie-52"><span class="linenos"> 52</span></a>    <span class="k">def</span> <span class="nf">d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="ScalarDie-53"><a href="#ScalarDie-53"><span class="linenos"> 53</span></a>        <span class="sd">&quot;&quot;&quot; Roll the left die, then roll the right die that many times and sum the outcomes. </span>
</span><span id="ScalarDie-54"><a href="#ScalarDie-54"><span class="linenos"> 54</span></a><span class="sd">        </span>
</span><span id="ScalarDie-55"><a href="#ScalarDie-55"><span class="linenos"> 55</span></a><span class="sd">        If an `int` is provided for the right side, it becomes a standard die with that many faces.</span>
</span><span id="ScalarDie-56"><a href="#ScalarDie-56"><span class="linenos"> 56</span></a><span class="sd">        Otherwise it is cast to a die.</span>
</span><span id="ScalarDie-57"><a href="#ScalarDie-57"><span class="linenos"> 57</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ScalarDie-58"><a href="#ScalarDie-58"><span class="linenos"> 58</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="ScalarDie-59"><a href="#ScalarDie-59"><span class="linenos"> 59</span></a>            <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">standard</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="ScalarDie-60"><a href="#ScalarDie-60"><span class="linenos"> 60</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ScalarDie-61"><a href="#ScalarDie-61"><span class="linenos"> 61</span></a>            <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">)</span>
</span><span id="ScalarDie-62"><a href="#ScalarDie-62"><span class="linenos"> 62</span></a>        
</span><span id="ScalarDie-63"><a href="#ScalarDie-63"><span class="linenos"> 63</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="ScalarDie-64"><a href="#ScalarDie-64"><span class="linenos"> 64</span></a>        
</span><span id="ScalarDie-65"><a href="#ScalarDie-65"><span class="linenos"> 65</span></a>        <span class="n">max_abs_die_count</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_outcome</span><span class="p">()),</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_outcome</span><span class="p">()))</span>
</span><span id="ScalarDie-66"><a href="#ScalarDie-66"><span class="linenos"> 66</span></a>        <span class="k">for</span> <span class="n">die_count</span><span class="p">,</span> <span class="n">die_count_weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ScalarDie-67"><a href="#ScalarDie-67"><span class="linenos"> 67</span></a>            <span class="n">factor</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">**</span> <span class="p">(</span><span class="n">max_abs_die_count</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">die_count</span><span class="p">))</span>
</span><span id="ScalarDie-68"><a href="#ScalarDie-68"><span class="linenos"> 68</span></a>            <span class="n">subresult</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">repeat_and_sum</span><span class="p">(</span><span class="n">die_count</span><span class="p">)</span>
</span><span id="ScalarDie-69"><a href="#ScalarDie-69"><span class="linenos"> 69</span></a>            <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">subresult_weight</span> <span class="ow">in</span> <span class="n">subresult</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ScalarDie-70"><a href="#ScalarDie-70"><span class="linenos"> 70</span></a>                <span class="n">data</span><span class="p">[</span><span class="n">outcome</span><span class="p">]</span> <span class="o">+=</span> <span class="n">subresult_weight</span> <span class="o">*</span> <span class="n">die_count_weight</span> <span class="o">*</span> <span class="n">factor</span>
</span><span id="ScalarDie-71"><a href="#ScalarDie-71"><span class="linenos"> 71</span></a>            
</span><span id="ScalarDie-72"><a href="#ScalarDie-72"><span class="linenos"> 72</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">other</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="ScalarDie-73"><a href="#ScalarDie-73"><span class="linenos"> 73</span></a>    
</span><span id="ScalarDie-74"><a href="#ScalarDie-74"><span class="linenos"> 74</span></a>    <span class="k">def</span> <span class="fm">__matmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="ScalarDie-75"><a href="#ScalarDie-75"><span class="linenos"> 75</span></a>        <span class="sd">&quot;&quot;&quot; Roll the left die, then roll the right die that many times and sum the outcomes. </span>
</span><span id="ScalarDie-76"><a href="#ScalarDie-76"><span class="linenos"> 76</span></a><span class="sd">        </span>
</span><span id="ScalarDie-77"><a href="#ScalarDie-77"><span class="linenos"> 77</span></a><span class="sd">        Unlike other operators, this does not work for built-in types on the right side.</span>
</span><span id="ScalarDie-78"><a href="#ScalarDie-78"><span class="linenos"> 78</span></a><span class="sd">        For example, `1 @ 6` does not work, nor does `d(6) @ 6`. But `1 @ d(6)` works.</span>
</span><span id="ScalarDie-79"><a href="#ScalarDie-79"><span class="linenos"> 79</span></a><span class="sd">        </span>
</span><span id="ScalarDie-80"><a href="#ScalarDie-80"><span class="linenos"> 80</span></a><span class="sd">        This is because all other operators convert their right side to a die using die,</span>
</span><span id="ScalarDie-81"><a href="#ScalarDie-81"><span class="linenos"> 81</span></a><span class="sd">        so `6` would become a constant 6, while  `d()` converts `int`s to a standard die with that many sides,</span>
</span><span id="ScalarDie-82"><a href="#ScalarDie-82"><span class="linenos"> 82</span></a><span class="sd">        so `6` would become a d6. Thus the right-side conversion of `@` would be ambiguous.</span>
</span><span id="ScalarDie-83"><a href="#ScalarDie-83"><span class="linenos"> 83</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ScalarDie-84"><a href="#ScalarDie-84"><span class="linenos"> 84</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">icepool</span><span class="o">.</span><span class="n">die</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">BaseDie</span><span class="p">):</span>
</span><span id="ScalarDie-85"><a href="#ScalarDie-85"><span class="linenos"> 85</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The @ operator will not automatically convert the right side of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__qualname__</span><span class="si">}</span><span class="s1"> to a die.&#39;</span><span class="p">)</span>
</span><span id="ScalarDie-86"><a href="#ScalarDie-86"><span class="linenos"> 86</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="ScalarDie-87"><a href="#ScalarDie-87"><span class="linenos"> 87</span></a>    
</span><span id="ScalarDie-88"><a href="#ScalarDie-88"><span class="linenos"> 88</span></a>    <span class="k">def</span> <span class="nf">if_else</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">true_die</span><span class="p">,</span> <span class="n">false_die</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">denominator_method</span><span class="o">=</span><span class="s1">&#39;lcm&#39;</span><span class="p">):</span>
</span><span id="ScalarDie-89"><a href="#ScalarDie-89"><span class="linenos"> 89</span></a>        <span class="sd">&quot;&quot;&quot; If the result of `self` has a true value, roll `true_die`, else roll `false_die`.</span>
</span><span id="ScalarDie-90"><a href="#ScalarDie-90"><span class="linenos"> 90</span></a><span class="sd">        </span>
</span><span id="ScalarDie-91"><a href="#ScalarDie-91"><span class="linenos"> 91</span></a><span class="sd">        Also known as the ternary conditional operator.</span>
</span><span id="ScalarDie-92"><a href="#ScalarDie-92"><span class="linenos"> 92</span></a><span class="sd">        </span>
</span><span id="ScalarDie-93"><a href="#ScalarDie-93"><span class="linenos"> 93</span></a><span class="sd">        Args:</span>
</span><span id="ScalarDie-94"><a href="#ScalarDie-94"><span class="linenos"> 94</span></a><span class="sd">            true_die: The die to roll if `self.bool()` rolls `True`.</span>
</span><span id="ScalarDie-95"><a href="#ScalarDie-95"><span class="linenos"> 95</span></a><span class="sd">            false_die: The die to roll if `self.bool()` rolls `False`.</span>
</span><span id="ScalarDie-96"><a href="#ScalarDie-96"><span class="linenos"> 96</span></a><span class="sd">            denominator_method: As `icepool.Die()`.</span>
</span><span id="ScalarDie-97"><a href="#ScalarDie-97"><span class="linenos"> 97</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ScalarDie-98"><a href="#ScalarDie-98"><span class="linenos"> 98</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="k">lambda</span> <span class="n">outcome</span><span class="p">:</span> <span class="n">true_die</span> <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span> <span class="k">else</span> <span class="n">false_die</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">denominator_method</span><span class="o">=</span><span class="n">denominator_method</span><span class="p">)</span>
</span><span id="ScalarDie-99"><a href="#ScalarDie-99"><span class="linenos"> 99</span></a>    
</span><span id="ScalarDie-100"><a href="#ScalarDie-100"><span class="linenos">100</span></a>    <span class="c1"># Statistics.</span>
</span><span id="ScalarDie-101"><a href="#ScalarDie-101"><span class="linenos">101</span></a>    
</span><span id="ScalarDie-102"><a href="#ScalarDie-102"><span class="linenos">102</span></a>    <span class="k">def</span> <span class="nf">median_left</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScalarDie-103"><a href="#ScalarDie-103"><span class="linenos">103</span></a>        <span class="sd">&quot;&quot;&quot; Returns the median.</span>
</span><span id="ScalarDie-104"><a href="#ScalarDie-104"><span class="linenos">104</span></a><span class="sd">        </span>
</span><span id="ScalarDie-105"><a href="#ScalarDie-105"><span class="linenos">105</span></a><span class="sd">        If the median lies between two outcomes, returns the lower of the two. &quot;&quot;&quot;</span>
</span><span id="ScalarDie-106"><a href="#ScalarDie-106"><span class="linenos">106</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf_left</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="ScalarDie-107"><a href="#ScalarDie-107"><span class="linenos">107</span></a>    
</span><span id="ScalarDie-108"><a href="#ScalarDie-108"><span class="linenos">108</span></a>    <span class="k">def</span> <span class="nf">median_right</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScalarDie-109"><a href="#ScalarDie-109"><span class="linenos">109</span></a>        <span class="sd">&quot;&quot;&quot; Returns the median.</span>
</span><span id="ScalarDie-110"><a href="#ScalarDie-110"><span class="linenos">110</span></a><span class="sd">        </span>
</span><span id="ScalarDie-111"><a href="#ScalarDie-111"><span class="linenos">111</span></a><span class="sd">        If the median lies between two outcomes, returns the higher of the two. &quot;&quot;&quot;</span>
</span><span id="ScalarDie-112"><a href="#ScalarDie-112"><span class="linenos">112</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf_right</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="ScalarDie-113"><a href="#ScalarDie-113"><span class="linenos">113</span></a>    
</span><span id="ScalarDie-114"><a href="#ScalarDie-114"><span class="linenos">114</span></a>    <span class="k">def</span> <span class="nf">median</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScalarDie-115"><a href="#ScalarDie-115"><span class="linenos">115</span></a>        <span class="sd">&quot;&quot;&quot; Returns the median.</span>
</span><span id="ScalarDie-116"><a href="#ScalarDie-116"><span class="linenos">116</span></a><span class="sd">        </span>
</span><span id="ScalarDie-117"><a href="#ScalarDie-117"><span class="linenos">117</span></a><span class="sd">        If the median lies between two outcomes, returns the mean of the two.</span>
</span><span id="ScalarDie-118"><a href="#ScalarDie-118"><span class="linenos">118</span></a><span class="sd">        This will fail if the outcomes do not support division;</span>
</span><span id="ScalarDie-119"><a href="#ScalarDie-119"><span class="linenos">119</span></a><span class="sd">        in this case, use `median_left` or `median_right` instead.</span>
</span><span id="ScalarDie-120"><a href="#ScalarDie-120"><span class="linenos">120</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ScalarDie-121"><a href="#ScalarDie-121"><span class="linenos">121</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="ScalarDie-122"><a href="#ScalarDie-122"><span class="linenos">122</span></a>    
</span><span id="ScalarDie-123"><a href="#ScalarDie-123"><span class="linenos">123</span></a>    <span class="k">def</span> <span class="nf">ppf_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
</span><span id="ScalarDie-124"><a href="#ScalarDie-124"><span class="linenos">124</span></a>        <span class="sd">&quot;&quot;&quot; Returns a quantile, `n / d` of the way through the cdf.</span>
</span><span id="ScalarDie-125"><a href="#ScalarDie-125"><span class="linenos">125</span></a><span class="sd">        </span>
</span><span id="ScalarDie-126"><a href="#ScalarDie-126"><span class="linenos">126</span></a><span class="sd">        If the result lies between two outcomes, returns the lower of the two.</span>
</span><span id="ScalarDie-127"><a href="#ScalarDie-127"><span class="linenos">127</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ScalarDie-128"><a href="#ScalarDie-128"><span class="linenos">128</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_left</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cweights</span><span class="p">(),</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">+</span> <span class="n">d</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">d</span><span class="p">)</span>
</span><span id="ScalarDie-129"><a href="#ScalarDie-129"><span class="linenos">129</span></a>        <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_outcomes</span><span class="p">():</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_outcome</span><span class="p">()</span>
</span><span id="ScalarDie-130"><a href="#ScalarDie-130"><span class="linenos">130</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
</span><span id="ScalarDie-131"><a href="#ScalarDie-131"><span class="linenos">131</span></a>    
</span><span id="ScalarDie-132"><a href="#ScalarDie-132"><span class="linenos">132</span></a>    <span class="k">def</span> <span class="nf">ppf_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
</span><span id="ScalarDie-133"><a href="#ScalarDie-133"><span class="linenos">133</span></a>        <span class="sd">&quot;&quot;&quot; Returns a quantile, `n / d` of the way through the cdf.</span>
</span><span id="ScalarDie-134"><a href="#ScalarDie-134"><span class="linenos">134</span></a><span class="sd">        </span>
</span><span id="ScalarDie-135"><a href="#ScalarDie-135"><span class="linenos">135</span></a><span class="sd">        If the result lies between two outcomes, returns the higher of the two.</span>
</span><span id="ScalarDie-136"><a href="#ScalarDie-136"><span class="linenos">136</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ScalarDie-137"><a href="#ScalarDie-137"><span class="linenos">137</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_right</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cweights</span><span class="p">(),</span> <span class="n">n</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">//</span> <span class="n">d</span><span class="p">)</span>
</span><span id="ScalarDie-138"><a href="#ScalarDie-138"><span class="linenos">138</span></a>        <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_outcomes</span><span class="p">():</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_outcome</span><span class="p">()</span>
</span><span id="ScalarDie-139"><a href="#ScalarDie-139"><span class="linenos">139</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
</span><span id="ScalarDie-140"><a href="#ScalarDie-140"><span class="linenos">140</span></a>    
</span><span id="ScalarDie-141"><a href="#ScalarDie-141"><span class="linenos">141</span></a>    <span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
</span><span id="ScalarDie-142"><a href="#ScalarDie-142"><span class="linenos">142</span></a>        <span class="sd">&quot;&quot;&quot; Returns a quantile, `n / d` of the way through the cdf.</span>
</span><span id="ScalarDie-143"><a href="#ScalarDie-143"><span class="linenos">143</span></a><span class="sd">        </span>
</span><span id="ScalarDie-144"><a href="#ScalarDie-144"><span class="linenos">144</span></a><span class="sd">        If the result lies between two outcomes, returns the mean of the two.</span>
</span><span id="ScalarDie-145"><a href="#ScalarDie-145"><span class="linenos">145</span></a><span class="sd">        This will fail if the outcomes do not support division;</span>
</span><span id="ScalarDie-146"><a href="#ScalarDie-146"><span class="linenos">146</span></a><span class="sd">        in this case, use `ppf_left` or `ppf_right` instead.</span>
</span><span id="ScalarDie-147"><a href="#ScalarDie-147"><span class="linenos">147</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ScalarDie-148"><a href="#ScalarDie-148"><span class="linenos">148</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ppf_left</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf_right</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="ScalarDie-149"><a href="#ScalarDie-149"><span class="linenos">149</span></a>    
</span><span id="ScalarDie-150"><a href="#ScalarDie-150"><span class="linenos">150</span></a>    <span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScalarDie-151"><a href="#ScalarDie-151"><span class="linenos">151</span></a>        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">outcome</span> <span class="o">*</span> <span class="n">p</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">pmf</span><span class="p">()))</span>
</span><span id="ScalarDie-152"><a href="#ScalarDie-152"><span class="linenos">152</span></a>    
</span><span id="ScalarDie-153"><a href="#ScalarDie-153"><span class="linenos">153</span></a>    <span class="k">def</span> <span class="nf">variance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScalarDie-154"><a href="#ScalarDie-154"><span class="linenos">154</span></a>        <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span><span id="ScalarDie-155"><a href="#ScalarDie-155"><span class="linenos">155</span></a>        <span class="n">mean_of_squares</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">outcome</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">pmf</span><span class="p">()))</span>
</span><span id="ScalarDie-156"><a href="#ScalarDie-156"><span class="linenos">156</span></a>        <span class="k">return</span> <span class="n">mean_of_squares</span> <span class="o">-</span> <span class="n">mean</span> <span class="o">*</span> <span class="n">mean</span>
</span><span id="ScalarDie-157"><a href="#ScalarDie-157"><span class="linenos">157</span></a>    
</span><span id="ScalarDie-158"><a href="#ScalarDie-158"><span class="linenos">158</span></a>    <span class="k">def</span> <span class="nf">standard_deviation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScalarDie-159"><a href="#ScalarDie-159"><span class="linenos">159</span></a>        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variance</span><span class="p">())</span>
</span><span id="ScalarDie-160"><a href="#ScalarDie-160"><span class="linenos">160</span></a>    
</span><span id="ScalarDie-161"><a href="#ScalarDie-161"><span class="linenos">161</span></a>    <span class="n">sd</span> <span class="o">=</span> <span class="n">standard_deviation</span>
</span><span id="ScalarDie-162"><a href="#ScalarDie-162"><span class="linenos">162</span></a>    
</span><span id="ScalarDie-163"><a href="#ScalarDie-163"><span class="linenos">163</span></a>    <span class="k">def</span> <span class="nf">standardized_moment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span id="ScalarDie-164"><a href="#ScalarDie-164"><span class="linenos">164</span></a>        <span class="n">sd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">()</span>
</span><span id="ScalarDie-165"><a href="#ScalarDie-165"><span class="linenos">165</span></a>        <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span><span id="ScalarDie-166"><a href="#ScalarDie-166"><span class="linenos">166</span></a>        <span class="n">ev</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="n">outcome</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">**</span> <span class="n">k</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">pmf</span><span class="p">()))</span>
</span><span id="ScalarDie-167"><a href="#ScalarDie-167"><span class="linenos">167</span></a>        <span class="k">return</span> <span class="n">ev</span> <span class="o">/</span> <span class="p">(</span><span class="n">sd</span> <span class="o">**</span> <span class="n">k</span><span class="p">)</span>
</span><span id="ScalarDie-168"><a href="#ScalarDie-168"><span class="linenos">168</span></a>    
</span><span id="ScalarDie-169"><a href="#ScalarDie-169"><span class="linenos">169</span></a>    <span class="k">def</span> <span class="nf">skewness</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScalarDie-170"><a href="#ScalarDie-170"><span class="linenos">170</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">standardized_moment</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
</span><span id="ScalarDie-171"><a href="#ScalarDie-171"><span class="linenos">171</span></a>    
</span><span id="ScalarDie-172"><a href="#ScalarDie-172"><span class="linenos">172</span></a>    <span class="k">def</span> <span class="nf">excess_kurtosis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScalarDie-173"><a href="#ScalarDie-173"><span class="linenos">173</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">standardized_moment</span><span class="p">(</span><span class="mf">4.0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">3.0</span>
</span><span id="ScalarDie-174"><a href="#ScalarDie-174"><span class="linenos">174</span></a>    
</span><span id="ScalarDie-175"><a href="#ScalarDie-175"><span class="linenos">175</span></a>    <span class="k">def</span> <span class="nf">cartesian_product</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">):</span>
</span><span id="ScalarDie-176"><a href="#ScalarDie-176"><span class="linenos">176</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="ScalarDie-177"><a href="#ScalarDie-177"><span class="linenos">177</span></a><span class="sd">        Produces a `VectorDie` from the Cartesian product of the input `ScalarDie`.</span>
</span><span id="ScalarDie-178"><a href="#ScalarDie-178"><span class="linenos">178</span></a><span class="sd">        </span>
</span><span id="ScalarDie-179"><a href="#ScalarDie-179"><span class="linenos">179</span></a><span class="sd">        This is usually not recommended, as it takes space and time exponential in the number of dice,</span>
</span><span id="ScalarDie-180"><a href="#ScalarDie-180"><span class="linenos">180</span></a><span class="sd">        while not actually producing any additional information.</span>
</span><span id="ScalarDie-181"><a href="#ScalarDie-181"><span class="linenos">181</span></a><span class="sd">        </span>
</span><span id="ScalarDie-182"><a href="#ScalarDie-182"><span class="linenos">182</span></a><span class="sd">        Args:</span>
</span><span id="ScalarDie-183"><a href="#ScalarDie-183"><span class="linenos">183</span></a><span class="sd">            *dice: Multiple dice or a single iterable of dice.</span>
</span><span id="ScalarDie-184"><a href="#ScalarDie-184"><span class="linenos">184</span></a><span class="sd">        </span>
</span><span id="ScalarDie-185"><a href="#ScalarDie-185"><span class="linenos">185</span></a><span class="sd">        Raises:</span>
</span><span id="ScalarDie-186"><a href="#ScalarDie-186"><span class="linenos">186</span></a><span class="sd">            `TypeError` if any of the input dice are already `VectorDie`.</span>
</span><span id="ScalarDie-187"><a href="#ScalarDie-187"><span class="linenos">187</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ScalarDie-188"><a href="#ScalarDie-188"><span class="linenos">188</span></a>        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">):</span>
</span><span id="ScalarDie-189"><a href="#ScalarDie-189"><span class="linenos">189</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;cartesian_product() is only valid on ScalarDie.&#39;</span><span class="p">)</span>
</span><span id="ScalarDie-190"><a href="#ScalarDie-190"><span class="linenos">190</span></a>        
</span><span id="ScalarDie-191"><a href="#ScalarDie-191"><span class="linenos">191</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="ScalarDie-192"><a href="#ScalarDie-192"><span class="linenos">192</span></a>        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">)):</span>
</span><span id="ScalarDie-193"><a href="#ScalarDie-193"><span class="linenos">193</span></a>            <span class="n">outcomes</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
</span><span id="ScalarDie-194"><a href="#ScalarDie-194"><span class="linenos">194</span></a>            <span class="n">data</span><span class="p">[</span><span class="n">outcomes</span><span class="p">]</span> <span class="o">+=</span> <span class="n">math</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
</span><span id="ScalarDie-195"><a href="#ScalarDie-195"><span class="linenos">195</span></a>        
</span><span id="ScalarDie-196"><a href="#ScalarDie-196"><span class="linenos">196</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dice</span><span class="p">))</span>
</span><span id="ScalarDie-197"><a href="#ScalarDie-197"><span class="linenos">197</span></a>    
</span><span id="ScalarDie-198"><a href="#ScalarDie-198"><span class="linenos">198</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScalarDie-199"><a href="#ScalarDie-199"><span class="linenos">199</span></a>        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__qualname__</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span><span class="si">}</span><span class="s1">)&#39;</span>
</span><span id="ScalarDie-200"><a href="#ScalarDie-200"><span class="linenos">200</span></a>    
</span><span id="ScalarDie-201"><a href="#ScalarDie-201"><span class="linenos">201</span></a>    <span class="k">def</span> <span class="nf">markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="ScalarDie-202"><a href="#ScalarDie-202"><span class="linenos">202</span></a>        <span class="n">outcome_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">outcome</span><span class="p">))</span> <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">())</span> <span class="o">+</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;Outcome&#39;</span><span class="p">),))</span>
</span><span id="ScalarDie-203"><a href="#ScalarDie-203"><span class="linenos">203</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="ScalarDie-204"><a href="#ScalarDie-204"><span class="linenos">204</span></a>        <span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;Denominator: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">&#39;</span>
</span><span id="ScalarDie-205"><a href="#ScalarDie-205"><span class="linenos">205</span></a>        <span class="n">result</span> <span class="o">+=</span>  <span class="s1">&#39;| &#39;</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="n">outcome_length</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="s1">&#39;Outcome&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;Outcome |&#39;</span>
</span><span id="ScalarDie-206"><a href="#ScalarDie-206"><span class="linenos">206</span></a>        <span class="k">if</span> <span class="n">include_weights</span><span class="p">:</span>
</span><span id="ScalarDie-207"><a href="#ScalarDie-207"><span class="linenos">207</span></a>            <span class="n">weight_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">weight</span><span class="p">))</span> <span class="k">for</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">())</span> <span class="o">+</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;Weight&#39;</span><span class="p">),))</span>
</span><span id="ScalarDie-208"><a href="#ScalarDie-208"><span class="linenos">208</span></a>            <span class="n">result</span> <span class="o">+=</span>   <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="n">weight_length</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="s1">&#39;Weight&#39;</span><span class="p">))</span>   <span class="o">+</span>  <span class="s1">&#39;Weight |&#39;</span>
</span><span id="ScalarDie-209"><a href="#ScalarDie-209"><span class="linenos">209</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ScalarDie-210"><a href="#ScalarDie-210"><span class="linenos">210</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39; Probability |&#39;</span>
</span><span id="ScalarDie-211"><a href="#ScalarDie-211"><span class="linenos">211</span></a>        <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="ScalarDie-212"><a href="#ScalarDie-212"><span class="linenos">212</span></a>        <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;|-&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="n">outcome_length</span> <span class="o">+</span> <span class="s1">&#39;:|&#39;</span>
</span><span id="ScalarDie-213"><a href="#ScalarDie-213"><span class="linenos">213</span></a>        <span class="k">if</span> <span class="n">include_weights</span><span class="p">:</span>
</span><span id="ScalarDie-214"><a href="#ScalarDie-214"><span class="linenos">214</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="n">weight_length</span> <span class="o">+</span> <span class="s1">&#39;:|&#39;</span>
</span><span id="ScalarDie-215"><a href="#ScalarDie-215"><span class="linenos">215</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ScalarDie-216"><a href="#ScalarDie-216"><span class="linenos">216</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;------------:|&#39;</span>
</span><span id="ScalarDie-217"><a href="#ScalarDie-217"><span class="linenos">217</span></a>        <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="ScalarDie-218"><a href="#ScalarDie-218"><span class="linenos">218</span></a>        <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">pmf</span><span class="p">()):</span>
</span><span id="ScalarDie-219"><a href="#ScalarDie-219"><span class="linenos">219</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;| </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span><span class="si">:</span><span class="s1">&gt;</span><span class="si">{</span><span class="n">outcome_length</span><span class="si">}}</span><span class="s1"> |&#39;</span>
</span><span id="ScalarDie-220"><a href="#ScalarDie-220"><span class="linenos">220</span></a>            <span class="k">if</span> <span class="n">include_weights</span><span class="p">:</span>
</span><span id="ScalarDie-221"><a href="#ScalarDie-221"><span class="linenos">221</span></a>                <span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">weight</span><span class="si">:</span><span class="s1">&gt;</span><span class="si">{</span><span class="n">weight_length</span><span class="si">}}</span><span class="s1"> |&#39;</span>
</span><span id="ScalarDie-222"><a href="#ScalarDie-222"><span class="linenos">222</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ScalarDie-223"><a href="#ScalarDie-223"><span class="linenos">223</span></a>                <span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s1">11.6%</span><span class="si">}</span><span class="s1"> |&#39;</span>
</span><span id="ScalarDie-224"><a href="#ScalarDie-224"><span class="linenos">224</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="ScalarDie-225"><a href="#ScalarDie-225"><span class="linenos">225</span></a>        <span class="k">return</span> <span class="n">result</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Univariate die.</p>

<p>Outcomes are scalars and operations are performed directly on the outcomes.</p>
</div>


                            <div id="ScalarDie.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ScalarDie.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">ScalarDie</span><span class="signature">(data)</span>
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScalarDie.__init__-21"><a href="#ScalarDie.__init__-21"><span class="linenos">21</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="ScalarDie.__init__-22"><a href="#ScalarDie.__init__-22"><span class="linenos">22</span></a>        <span class="sd">&quot;&quot;&quot; Constructor.</span>
</span><span id="ScalarDie.__init__-23"><a href="#ScalarDie.__init__-23"><span class="linenos">23</span></a><span class="sd">        </span>
</span><span id="ScalarDie.__init__-24"><a href="#ScalarDie.__init__-24"><span class="linenos">24</span></a><span class="sd">        Dice should not be constructed directly;</span>
</span><span id="ScalarDie.__init__-25"><a href="#ScalarDie.__init__-25"><span class="linenos">25</span></a><span class="sd">        instead, use one of the methods defined in `icepool.die.func` </span>
</span><span id="ScalarDie.__init__-26"><a href="#ScalarDie.__init__-26"><span class="linenos">26</span></a><span class="sd">        (which are imported into the top-level `icepool` module).</span>
</span><span id="ScalarDie.__init__-27"><a href="#ScalarDie.__init__-27"><span class="linenos">27</span></a><span class="sd">        </span>
</span><span id="ScalarDie.__init__-28"><a href="#ScalarDie.__init__-28"><span class="linenos">28</span></a><span class="sd">        Args:</span>
</span><span id="ScalarDie.__init__-29"><a href="#ScalarDie.__init__-29"><span class="linenos">29</span></a><span class="sd">            data: A `Counts` mapping outcomes to weights.</span>
</span><span id="ScalarDie.__init__-30"><a href="#ScalarDie.__init__-30"><span class="linenos">30</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ScalarDie.__init__-31"><a href="#ScalarDie.__init__-31"><span class="linenos">31</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">data</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Constructor.</p>

<p>Dice should not be constructed directly;
instead, use one of the methods defined in <code>icepool.die.func</code> 
(which are imported into the top-level <code><a href="">icepool</a></code> module).</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>data:</strong>  A <code>Counts</code> mapping outcomes to weights.</li>
</ul>
</div>


                            </div>
                            <div id="ScalarDie.ndim" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ScalarDie.ndim">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">ndim</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScalarDie.ndim-18"><a href="#ScalarDie.ndim-18"><span class="linenos">18</span></a>    <span class="k">def</span> <span class="nf">ndim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScalarDie.ndim-19"><a href="#ScalarDie.ndim-19"><span class="linenos">19</span></a>        <span class="k">return</span> <span class="s1">&#39;scalar&#39;</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns the number of dimensions if this is a <code><a href="#VectorDie">VectorDie</a></code>.</p>

<p>Otherwise, returns <code>'scalar'</code> for a <code><a href="#ScalarDie">ScalarDie</a></code> and <code>'empty'</code> for an <code><a href="#EmptyDie">EmptyDie</a></code>.</p>
</div>


                            </div>
                            <div id="ScalarDie.d" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ScalarDie.d">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">d</span><span class="signature">(self, other, *, ndim=None)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScalarDie.d-52"><a href="#ScalarDie.d-52"><span class="linenos">52</span></a>    <span class="k">def</span> <span class="nf">d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="ScalarDie.d-53"><a href="#ScalarDie.d-53"><span class="linenos">53</span></a>        <span class="sd">&quot;&quot;&quot; Roll the left die, then roll the right die that many times and sum the outcomes. </span>
</span><span id="ScalarDie.d-54"><a href="#ScalarDie.d-54"><span class="linenos">54</span></a><span class="sd">        </span>
</span><span id="ScalarDie.d-55"><a href="#ScalarDie.d-55"><span class="linenos">55</span></a><span class="sd">        If an `int` is provided for the right side, it becomes a standard die with that many faces.</span>
</span><span id="ScalarDie.d-56"><a href="#ScalarDie.d-56"><span class="linenos">56</span></a><span class="sd">        Otherwise it is cast to a die.</span>
</span><span id="ScalarDie.d-57"><a href="#ScalarDie.d-57"><span class="linenos">57</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ScalarDie.d-58"><a href="#ScalarDie.d-58"><span class="linenos">58</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="ScalarDie.d-59"><a href="#ScalarDie.d-59"><span class="linenos">59</span></a>            <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">standard</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="ScalarDie.d-60"><a href="#ScalarDie.d-60"><span class="linenos">60</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ScalarDie.d-61"><a href="#ScalarDie.d-61"><span class="linenos">61</span></a>            <span class="n">other</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">)</span>
</span><span id="ScalarDie.d-62"><a href="#ScalarDie.d-62"><span class="linenos">62</span></a>        
</span><span id="ScalarDie.d-63"><a href="#ScalarDie.d-63"><span class="linenos">63</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="ScalarDie.d-64"><a href="#ScalarDie.d-64"><span class="linenos">64</span></a>        
</span><span id="ScalarDie.d-65"><a href="#ScalarDie.d-65"><span class="linenos">65</span></a>        <span class="n">max_abs_die_count</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_outcome</span><span class="p">()),</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_outcome</span><span class="p">()))</span>
</span><span id="ScalarDie.d-66"><a href="#ScalarDie.d-66"><span class="linenos">66</span></a>        <span class="k">for</span> <span class="n">die_count</span><span class="p">,</span> <span class="n">die_count_weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ScalarDie.d-67"><a href="#ScalarDie.d-67"><span class="linenos">67</span></a>            <span class="n">factor</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">**</span> <span class="p">(</span><span class="n">max_abs_die_count</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">die_count</span><span class="p">))</span>
</span><span id="ScalarDie.d-68"><a href="#ScalarDie.d-68"><span class="linenos">68</span></a>            <span class="n">subresult</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">repeat_and_sum</span><span class="p">(</span><span class="n">die_count</span><span class="p">)</span>
</span><span id="ScalarDie.d-69"><a href="#ScalarDie.d-69"><span class="linenos">69</span></a>            <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">subresult_weight</span> <span class="ow">in</span> <span class="n">subresult</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ScalarDie.d-70"><a href="#ScalarDie.d-70"><span class="linenos">70</span></a>                <span class="n">data</span><span class="p">[</span><span class="n">outcome</span><span class="p">]</span> <span class="o">+=</span> <span class="n">subresult_weight</span> <span class="o">*</span> <span class="n">die_count_weight</span> <span class="o">*</span> <span class="n">factor</span>
</span><span id="ScalarDie.d-71"><a href="#ScalarDie.d-71"><span class="linenos">71</span></a>            
</span><span id="ScalarDie.d-72"><a href="#ScalarDie.d-72"><span class="linenos">72</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">other</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Roll the left die, then roll the right die that many times and sum the outcomes. </p>

<p>If an <code>int</code> is provided for the right side, it becomes a standard die with that many faces.
Otherwise it is cast to a die.</p>
</div>


                            </div>
                            <div id="ScalarDie.if_else" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ScalarDie.if_else">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">if_else</span><span class="signature">(self, true_die, false_die, *, ndim=None, denominator_method=&#39;lcm&#39;)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScalarDie.if_else-88"><a href="#ScalarDie.if_else-88"><span class="linenos">88</span></a>    <span class="k">def</span> <span class="nf">if_else</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">true_die</span><span class="p">,</span> <span class="n">false_die</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">denominator_method</span><span class="o">=</span><span class="s1">&#39;lcm&#39;</span><span class="p">):</span>
</span><span id="ScalarDie.if_else-89"><a href="#ScalarDie.if_else-89"><span class="linenos">89</span></a>        <span class="sd">&quot;&quot;&quot; If the result of `self` has a true value, roll `true_die`, else roll `false_die`.</span>
</span><span id="ScalarDie.if_else-90"><a href="#ScalarDie.if_else-90"><span class="linenos">90</span></a><span class="sd">        </span>
</span><span id="ScalarDie.if_else-91"><a href="#ScalarDie.if_else-91"><span class="linenos">91</span></a><span class="sd">        Also known as the ternary conditional operator.</span>
</span><span id="ScalarDie.if_else-92"><a href="#ScalarDie.if_else-92"><span class="linenos">92</span></a><span class="sd">        </span>
</span><span id="ScalarDie.if_else-93"><a href="#ScalarDie.if_else-93"><span class="linenos">93</span></a><span class="sd">        Args:</span>
</span><span id="ScalarDie.if_else-94"><a href="#ScalarDie.if_else-94"><span class="linenos">94</span></a><span class="sd">            true_die: The die to roll if `self.bool()` rolls `True`.</span>
</span><span id="ScalarDie.if_else-95"><a href="#ScalarDie.if_else-95"><span class="linenos">95</span></a><span class="sd">            false_die: The die to roll if `self.bool()` rolls `False`.</span>
</span><span id="ScalarDie.if_else-96"><a href="#ScalarDie.if_else-96"><span class="linenos">96</span></a><span class="sd">            denominator_method: As `icepool.Die()`.</span>
</span><span id="ScalarDie.if_else-97"><a href="#ScalarDie.if_else-97"><span class="linenos">97</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ScalarDie.if_else-98"><a href="#ScalarDie.if_else-98"><span class="linenos">98</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="k">lambda</span> <span class="n">outcome</span><span class="p">:</span> <span class="n">true_die</span> <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span> <span class="k">else</span> <span class="n">false_die</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">,</span> <span class="n">denominator_method</span><span class="o">=</span><span class="n">denominator_method</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>If the result of <code>self</code> has a true value, roll <code>true_die</code>, else roll <code>false_die</code>.</p>

<p>Also known as the ternary conditional operator.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>true_die:</strong>  The die to roll if <code>self.bool()</code> rolls <code>True</code>.</li>
<li><strong>false_die:</strong>  The die to roll if <code>self.bool()</code> rolls <code>False</code>.</li>
<li><strong>denominator_method:</strong>  As <code><a href="#Die">icepool.Die()</a></code>.</li>
</ul>
</div>


                            </div>
                            <div id="ScalarDie.median_left" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ScalarDie.median_left">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">median_left</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScalarDie.median_left-102"><a href="#ScalarDie.median_left-102"><span class="linenos">102</span></a>    <span class="k">def</span> <span class="nf">median_left</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScalarDie.median_left-103"><a href="#ScalarDie.median_left-103"><span class="linenos">103</span></a>        <span class="sd">&quot;&quot;&quot; Returns the median.</span>
</span><span id="ScalarDie.median_left-104"><a href="#ScalarDie.median_left-104"><span class="linenos">104</span></a><span class="sd">        </span>
</span><span id="ScalarDie.median_left-105"><a href="#ScalarDie.median_left-105"><span class="linenos">105</span></a><span class="sd">        If the median lies between two outcomes, returns the lower of the two. &quot;&quot;&quot;</span>
</span><span id="ScalarDie.median_left-106"><a href="#ScalarDie.median_left-106"><span class="linenos">106</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf_left</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns the median.</p>

<p>If the median lies between two outcomes, returns the lower of the two.</p>
</div>


                            </div>
                            <div id="ScalarDie.median_right" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ScalarDie.median_right">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">median_right</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScalarDie.median_right-108"><a href="#ScalarDie.median_right-108"><span class="linenos">108</span></a>    <span class="k">def</span> <span class="nf">median_right</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScalarDie.median_right-109"><a href="#ScalarDie.median_right-109"><span class="linenos">109</span></a>        <span class="sd">&quot;&quot;&quot; Returns the median.</span>
</span><span id="ScalarDie.median_right-110"><a href="#ScalarDie.median_right-110"><span class="linenos">110</span></a><span class="sd">        </span>
</span><span id="ScalarDie.median_right-111"><a href="#ScalarDie.median_right-111"><span class="linenos">111</span></a><span class="sd">        If the median lies between two outcomes, returns the higher of the two. &quot;&quot;&quot;</span>
</span><span id="ScalarDie.median_right-112"><a href="#ScalarDie.median_right-112"><span class="linenos">112</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf_right</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns the median.</p>

<p>If the median lies between two outcomes, returns the higher of the two.</p>
</div>


                            </div>
                            <div id="ScalarDie.median" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ScalarDie.median">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">median</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScalarDie.median-114"><a href="#ScalarDie.median-114"><span class="linenos">114</span></a>    <span class="k">def</span> <span class="nf">median</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScalarDie.median-115"><a href="#ScalarDie.median-115"><span class="linenos">115</span></a>        <span class="sd">&quot;&quot;&quot; Returns the median.</span>
</span><span id="ScalarDie.median-116"><a href="#ScalarDie.median-116"><span class="linenos">116</span></a><span class="sd">        </span>
</span><span id="ScalarDie.median-117"><a href="#ScalarDie.median-117"><span class="linenos">117</span></a><span class="sd">        If the median lies between two outcomes, returns the mean of the two.</span>
</span><span id="ScalarDie.median-118"><a href="#ScalarDie.median-118"><span class="linenos">118</span></a><span class="sd">        This will fail if the outcomes do not support division;</span>
</span><span id="ScalarDie.median-119"><a href="#ScalarDie.median-119"><span class="linenos">119</span></a><span class="sd">        in this case, use `median_left` or `median_right` instead.</span>
</span><span id="ScalarDie.median-120"><a href="#ScalarDie.median-120"><span class="linenos">120</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ScalarDie.median-121"><a href="#ScalarDie.median-121"><span class="linenos">121</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns the median.</p>

<p>If the median lies between two outcomes, returns the mean of the two.
This will fail if the outcomes do not support division;
in this case, use <code><a href="#ScalarDie.median_left">median_left</a></code> or <code><a href="#ScalarDie.median_right">median_right</a></code> instead.</p>
</div>


                            </div>
                            <div id="ScalarDie.ppf_left" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ScalarDie.ppf_left">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">ppf_left</span><span class="signature">(self, n, d=100)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScalarDie.ppf_left-123"><a href="#ScalarDie.ppf_left-123"><span class="linenos">123</span></a>    <span class="k">def</span> <span class="nf">ppf_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
</span><span id="ScalarDie.ppf_left-124"><a href="#ScalarDie.ppf_left-124"><span class="linenos">124</span></a>        <span class="sd">&quot;&quot;&quot; Returns a quantile, `n / d` of the way through the cdf.</span>
</span><span id="ScalarDie.ppf_left-125"><a href="#ScalarDie.ppf_left-125"><span class="linenos">125</span></a><span class="sd">        </span>
</span><span id="ScalarDie.ppf_left-126"><a href="#ScalarDie.ppf_left-126"><span class="linenos">126</span></a><span class="sd">        If the result lies between two outcomes, returns the lower of the two.</span>
</span><span id="ScalarDie.ppf_left-127"><a href="#ScalarDie.ppf_left-127"><span class="linenos">127</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ScalarDie.ppf_left-128"><a href="#ScalarDie.ppf_left-128"><span class="linenos">128</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_left</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cweights</span><span class="p">(),</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">+</span> <span class="n">d</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">d</span><span class="p">)</span>
</span><span id="ScalarDie.ppf_left-129"><a href="#ScalarDie.ppf_left-129"><span class="linenos">129</span></a>        <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_outcomes</span><span class="p">():</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_outcome</span><span class="p">()</span>
</span><span id="ScalarDie.ppf_left-130"><a href="#ScalarDie.ppf_left-130"><span class="linenos">130</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns a quantile, <code>n / d</code> of the way through the cdf.</p>

<p>If the result lies between two outcomes, returns the lower of the two.</p>
</div>


                            </div>
                            <div id="ScalarDie.ppf_right" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ScalarDie.ppf_right">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">ppf_right</span><span class="signature">(self, n, d=100)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScalarDie.ppf_right-132"><a href="#ScalarDie.ppf_right-132"><span class="linenos">132</span></a>    <span class="k">def</span> <span class="nf">ppf_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
</span><span id="ScalarDie.ppf_right-133"><a href="#ScalarDie.ppf_right-133"><span class="linenos">133</span></a>        <span class="sd">&quot;&quot;&quot; Returns a quantile, `n / d` of the way through the cdf.</span>
</span><span id="ScalarDie.ppf_right-134"><a href="#ScalarDie.ppf_right-134"><span class="linenos">134</span></a><span class="sd">        </span>
</span><span id="ScalarDie.ppf_right-135"><a href="#ScalarDie.ppf_right-135"><span class="linenos">135</span></a><span class="sd">        If the result lies between two outcomes, returns the higher of the two.</span>
</span><span id="ScalarDie.ppf_right-136"><a href="#ScalarDie.ppf_right-136"><span class="linenos">136</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ScalarDie.ppf_right-137"><a href="#ScalarDie.ppf_right-137"><span class="linenos">137</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_right</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cweights</span><span class="p">(),</span> <span class="n">n</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">//</span> <span class="n">d</span><span class="p">)</span>
</span><span id="ScalarDie.ppf_right-138"><a href="#ScalarDie.ppf_right-138"><span class="linenos">138</span></a>        <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_outcomes</span><span class="p">():</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_outcome</span><span class="p">()</span>
</span><span id="ScalarDie.ppf_right-139"><a href="#ScalarDie.ppf_right-139"><span class="linenos">139</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns a quantile, <code>n / d</code> of the way through the cdf.</p>

<p>If the result lies between two outcomes, returns the higher of the two.</p>
</div>


                            </div>
                            <div id="ScalarDie.ppf" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ScalarDie.ppf">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">ppf</span><span class="signature">(self, n, d=100)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScalarDie.ppf-141"><a href="#ScalarDie.ppf-141"><span class="linenos">141</span></a>    <span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
</span><span id="ScalarDie.ppf-142"><a href="#ScalarDie.ppf-142"><span class="linenos">142</span></a>        <span class="sd">&quot;&quot;&quot; Returns a quantile, `n / d` of the way through the cdf.</span>
</span><span id="ScalarDie.ppf-143"><a href="#ScalarDie.ppf-143"><span class="linenos">143</span></a><span class="sd">        </span>
</span><span id="ScalarDie.ppf-144"><a href="#ScalarDie.ppf-144"><span class="linenos">144</span></a><span class="sd">        If the result lies between two outcomes, returns the mean of the two.</span>
</span><span id="ScalarDie.ppf-145"><a href="#ScalarDie.ppf-145"><span class="linenos">145</span></a><span class="sd">        This will fail if the outcomes do not support division;</span>
</span><span id="ScalarDie.ppf-146"><a href="#ScalarDie.ppf-146"><span class="linenos">146</span></a><span class="sd">        in this case, use `ppf_left` or `ppf_right` instead.</span>
</span><span id="ScalarDie.ppf-147"><a href="#ScalarDie.ppf-147"><span class="linenos">147</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ScalarDie.ppf-148"><a href="#ScalarDie.ppf-148"><span class="linenos">148</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ppf_left</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppf_right</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns a quantile, <code>n / d</code> of the way through the cdf.</p>

<p>If the result lies between two outcomes, returns the mean of the two.
This will fail if the outcomes do not support division;
in this case, use <code><a href="#ScalarDie.ppf_left">ppf_left</a></code> or <code><a href="#ScalarDie.ppf_right">ppf_right</a></code> instead.</p>
</div>


                            </div>
                            <div id="ScalarDie.mean" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ScalarDie.mean">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">mean</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScalarDie.mean-150"><a href="#ScalarDie.mean-150"><span class="linenos">150</span></a>    <span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScalarDie.mean-151"><a href="#ScalarDie.mean-151"><span class="linenos">151</span></a>        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">outcome</span> <span class="o">*</span> <span class="n">p</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">pmf</span><span class="p">()))</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="ScalarDie.variance" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ScalarDie.variance">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">variance</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScalarDie.variance-153"><a href="#ScalarDie.variance-153"><span class="linenos">153</span></a>    <span class="k">def</span> <span class="nf">variance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScalarDie.variance-154"><a href="#ScalarDie.variance-154"><span class="linenos">154</span></a>        <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span><span id="ScalarDie.variance-155"><a href="#ScalarDie.variance-155"><span class="linenos">155</span></a>        <span class="n">mean_of_squares</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">outcome</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">pmf</span><span class="p">()))</span>
</span><span id="ScalarDie.variance-156"><a href="#ScalarDie.variance-156"><span class="linenos">156</span></a>        <span class="k">return</span> <span class="n">mean_of_squares</span> <span class="o">-</span> <span class="n">mean</span> <span class="o">*</span> <span class="n">mean</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="ScalarDie.standard_deviation" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ScalarDie.standard_deviation">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">standard_deviation</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScalarDie.standard_deviation-158"><a href="#ScalarDie.standard_deviation-158"><span class="linenos">158</span></a>    <span class="k">def</span> <span class="nf">standard_deviation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScalarDie.standard_deviation-159"><a href="#ScalarDie.standard_deviation-159"><span class="linenos">159</span></a>        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variance</span><span class="p">())</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="ScalarDie.sd" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ScalarDie.sd">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">sd</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScalarDie.sd-158"><a href="#ScalarDie.sd-158"><span class="linenos">158</span></a>    <span class="k">def</span> <span class="nf">standard_deviation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScalarDie.sd-159"><a href="#ScalarDie.sd-159"><span class="linenos">159</span></a>        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variance</span><span class="p">())</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="ScalarDie.standardized_moment" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ScalarDie.standardized_moment">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">standardized_moment</span><span class="signature">(self, k)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScalarDie.standardized_moment-163"><a href="#ScalarDie.standardized_moment-163"><span class="linenos">163</span></a>    <span class="k">def</span> <span class="nf">standardized_moment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span id="ScalarDie.standardized_moment-164"><a href="#ScalarDie.standardized_moment-164"><span class="linenos">164</span></a>        <span class="n">sd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">()</span>
</span><span id="ScalarDie.standardized_moment-165"><a href="#ScalarDie.standardized_moment-165"><span class="linenos">165</span></a>        <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span><span id="ScalarDie.standardized_moment-166"><a href="#ScalarDie.standardized_moment-166"><span class="linenos">166</span></a>        <span class="n">ev</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="n">outcome</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">**</span> <span class="n">k</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">pmf</span><span class="p">()))</span>
</span><span id="ScalarDie.standardized_moment-167"><a href="#ScalarDie.standardized_moment-167"><span class="linenos">167</span></a>        <span class="k">return</span> <span class="n">ev</span> <span class="o">/</span> <span class="p">(</span><span class="n">sd</span> <span class="o">**</span> <span class="n">k</span><span class="p">)</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="ScalarDie.skewness" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ScalarDie.skewness">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">skewness</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScalarDie.skewness-169"><a href="#ScalarDie.skewness-169"><span class="linenos">169</span></a>    <span class="k">def</span> <span class="nf">skewness</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScalarDie.skewness-170"><a href="#ScalarDie.skewness-170"><span class="linenos">170</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">standardized_moment</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="ScalarDie.excess_kurtosis" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ScalarDie.excess_kurtosis">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">excess_kurtosis</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScalarDie.excess_kurtosis-172"><a href="#ScalarDie.excess_kurtosis-172"><span class="linenos">172</span></a>    <span class="k">def</span> <span class="nf">excess_kurtosis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ScalarDie.excess_kurtosis-173"><a href="#ScalarDie.excess_kurtosis-173"><span class="linenos">173</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">standardized_moment</span><span class="p">(</span><span class="mf">4.0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">3.0</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="ScalarDie.cartesian_product" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ScalarDie.cartesian_product">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">cartesian_product</span><span class="signature">(*dice)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScalarDie.cartesian_product-175"><a href="#ScalarDie.cartesian_product-175"><span class="linenos">175</span></a>    <span class="k">def</span> <span class="nf">cartesian_product</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">):</span>
</span><span id="ScalarDie.cartesian_product-176"><a href="#ScalarDie.cartesian_product-176"><span class="linenos">176</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="ScalarDie.cartesian_product-177"><a href="#ScalarDie.cartesian_product-177"><span class="linenos">177</span></a><span class="sd">        Produces a `VectorDie` from the Cartesian product of the input `ScalarDie`.</span>
</span><span id="ScalarDie.cartesian_product-178"><a href="#ScalarDie.cartesian_product-178"><span class="linenos">178</span></a><span class="sd">        </span>
</span><span id="ScalarDie.cartesian_product-179"><a href="#ScalarDie.cartesian_product-179"><span class="linenos">179</span></a><span class="sd">        This is usually not recommended, as it takes space and time exponential in the number of dice,</span>
</span><span id="ScalarDie.cartesian_product-180"><a href="#ScalarDie.cartesian_product-180"><span class="linenos">180</span></a><span class="sd">        while not actually producing any additional information.</span>
</span><span id="ScalarDie.cartesian_product-181"><a href="#ScalarDie.cartesian_product-181"><span class="linenos">181</span></a><span class="sd">        </span>
</span><span id="ScalarDie.cartesian_product-182"><a href="#ScalarDie.cartesian_product-182"><span class="linenos">182</span></a><span class="sd">        Args:</span>
</span><span id="ScalarDie.cartesian_product-183"><a href="#ScalarDie.cartesian_product-183"><span class="linenos">183</span></a><span class="sd">            *dice: Multiple dice or a single iterable of dice.</span>
</span><span id="ScalarDie.cartesian_product-184"><a href="#ScalarDie.cartesian_product-184"><span class="linenos">184</span></a><span class="sd">        </span>
</span><span id="ScalarDie.cartesian_product-185"><a href="#ScalarDie.cartesian_product-185"><span class="linenos">185</span></a><span class="sd">        Raises:</span>
</span><span id="ScalarDie.cartesian_product-186"><a href="#ScalarDie.cartesian_product-186"><span class="linenos">186</span></a><span class="sd">            `TypeError` if any of the input dice are already `VectorDie`.</span>
</span><span id="ScalarDie.cartesian_product-187"><a href="#ScalarDie.cartesian_product-187"><span class="linenos">187</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ScalarDie.cartesian_product-188"><a href="#ScalarDie.cartesian_product-188"><span class="linenos">188</span></a>        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">):</span>
</span><span id="ScalarDie.cartesian_product-189"><a href="#ScalarDie.cartesian_product-189"><span class="linenos">189</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;cartesian_product() is only valid on ScalarDie.&#39;</span><span class="p">)</span>
</span><span id="ScalarDie.cartesian_product-190"><a href="#ScalarDie.cartesian_product-190"><span class="linenos">190</span></a>        
</span><span id="ScalarDie.cartesian_product-191"><a href="#ScalarDie.cartesian_product-191"><span class="linenos">191</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="ScalarDie.cartesian_product-192"><a href="#ScalarDie.cartesian_product-192"><span class="linenos">192</span></a>        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">)):</span>
</span><span id="ScalarDie.cartesian_product-193"><a href="#ScalarDie.cartesian_product-193"><span class="linenos">193</span></a>            <span class="n">outcomes</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
</span><span id="ScalarDie.cartesian_product-194"><a href="#ScalarDie.cartesian_product-194"><span class="linenos">194</span></a>            <span class="n">data</span><span class="p">[</span><span class="n">outcomes</span><span class="p">]</span> <span class="o">+=</span> <span class="n">math</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
</span><span id="ScalarDie.cartesian_product-195"><a href="#ScalarDie.cartesian_product-195"><span class="linenos">195</span></a>        
</span><span id="ScalarDie.cartesian_product-196"><a href="#ScalarDie.cartesian_product-196"><span class="linenos">196</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dice</span><span class="p">))</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Produces a <code><a href="#VectorDie">VectorDie</a></code> from the Cartesian product of the input <code><a href="#ScalarDie">ScalarDie</a></code>.</p>

<p>This is usually not recommended, as it takes space and time exponential in the number of dice,
while not actually producing any additional information.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>*dice:</strong>  Multiple dice or a single iterable of dice.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><code>TypeError</code> if any of the input dice are already <code><a href="#VectorDie">VectorDie</a></code>.</li>
</ul>
</div>


                            </div>
                            <div id="ScalarDie.markdown" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#ScalarDie.markdown">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">markdown</span><span class="signature">(self, include_weights=True)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScalarDie.markdown-201"><a href="#ScalarDie.markdown-201"><span class="linenos">201</span></a>    <span class="k">def</span> <span class="nf">markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="ScalarDie.markdown-202"><a href="#ScalarDie.markdown-202"><span class="linenos">202</span></a>        <span class="n">outcome_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">outcome</span><span class="p">))</span> <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">())</span> <span class="o">+</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;Outcome&#39;</span><span class="p">),))</span>
</span><span id="ScalarDie.markdown-203"><a href="#ScalarDie.markdown-203"><span class="linenos">203</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="ScalarDie.markdown-204"><a href="#ScalarDie.markdown-204"><span class="linenos">204</span></a>        <span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;Denominator: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">&#39;</span>
</span><span id="ScalarDie.markdown-205"><a href="#ScalarDie.markdown-205"><span class="linenos">205</span></a>        <span class="n">result</span> <span class="o">+=</span>  <span class="s1">&#39;| &#39;</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="n">outcome_length</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="s1">&#39;Outcome&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;Outcome |&#39;</span>
</span><span id="ScalarDie.markdown-206"><a href="#ScalarDie.markdown-206"><span class="linenos">206</span></a>        <span class="k">if</span> <span class="n">include_weights</span><span class="p">:</span>
</span><span id="ScalarDie.markdown-207"><a href="#ScalarDie.markdown-207"><span class="linenos">207</span></a>            <span class="n">weight_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">weight</span><span class="p">))</span> <span class="k">for</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">())</span> <span class="o">+</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;Weight&#39;</span><span class="p">),))</span>
</span><span id="ScalarDie.markdown-208"><a href="#ScalarDie.markdown-208"><span class="linenos">208</span></a>            <span class="n">result</span> <span class="o">+=</span>   <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="n">weight_length</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="s1">&#39;Weight&#39;</span><span class="p">))</span>   <span class="o">+</span>  <span class="s1">&#39;Weight |&#39;</span>
</span><span id="ScalarDie.markdown-209"><a href="#ScalarDie.markdown-209"><span class="linenos">209</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ScalarDie.markdown-210"><a href="#ScalarDie.markdown-210"><span class="linenos">210</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39; Probability |&#39;</span>
</span><span id="ScalarDie.markdown-211"><a href="#ScalarDie.markdown-211"><span class="linenos">211</span></a>        <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="ScalarDie.markdown-212"><a href="#ScalarDie.markdown-212"><span class="linenos">212</span></a>        <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;|-&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="n">outcome_length</span> <span class="o">+</span> <span class="s1">&#39;:|&#39;</span>
</span><span id="ScalarDie.markdown-213"><a href="#ScalarDie.markdown-213"><span class="linenos">213</span></a>        <span class="k">if</span> <span class="n">include_weights</span><span class="p">:</span>
</span><span id="ScalarDie.markdown-214"><a href="#ScalarDie.markdown-214"><span class="linenos">214</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="n">weight_length</span> <span class="o">+</span> <span class="s1">&#39;:|&#39;</span>
</span><span id="ScalarDie.markdown-215"><a href="#ScalarDie.markdown-215"><span class="linenos">215</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ScalarDie.markdown-216"><a href="#ScalarDie.markdown-216"><span class="linenos">216</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;------------:|&#39;</span>
</span><span id="ScalarDie.markdown-217"><a href="#ScalarDie.markdown-217"><span class="linenos">217</span></a>        <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="ScalarDie.markdown-218"><a href="#ScalarDie.markdown-218"><span class="linenos">218</span></a>        <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">pmf</span><span class="p">()):</span>
</span><span id="ScalarDie.markdown-219"><a href="#ScalarDie.markdown-219"><span class="linenos">219</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;| </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span><span class="si">:</span><span class="s1">&gt;</span><span class="si">{</span><span class="n">outcome_length</span><span class="si">}}</span><span class="s1"> |&#39;</span>
</span><span id="ScalarDie.markdown-220"><a href="#ScalarDie.markdown-220"><span class="linenos">220</span></a>            <span class="k">if</span> <span class="n">include_weights</span><span class="p">:</span>
</span><span id="ScalarDie.markdown-221"><a href="#ScalarDie.markdown-221"><span class="linenos">221</span></a>                <span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">weight</span><span class="si">:</span><span class="s1">&gt;</span><span class="si">{</span><span class="n">weight_length</span><span class="si">}}</span><span class="s1"> |&#39;</span>
</span><span id="ScalarDie.markdown-222"><a href="#ScalarDie.markdown-222"><span class="linenos">222</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ScalarDie.markdown-223"><a href="#ScalarDie.markdown-223"><span class="linenos">223</span></a>                <span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s1">11.6%</span><span class="si">}</span><span class="s1"> |&#39;</span>
</span><span id="ScalarDie.markdown-224"><a href="#ScalarDie.markdown-224"><span class="linenos">224</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="ScalarDie.markdown-225"><a href="#ScalarDie.markdown-225"><span class="linenos">225</span></a>        <span class="k">return</span> <span class="n">result</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Formats the die as a Markdown string. </p>

<p>This will have the denominator and a table of outcomes and their probabilities.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>include_weights:</strong>  Iff <code>True</code>, the table will have a column for weights.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#BaseDie">BaseDie</a></dt>
                                <dd id="ScalarDie.outcomes" class="function"><a href="#BaseDie.outcomes">outcomes</a></dd>
                <dd id="ScalarDie.num_outcomes" class="function"><a href="#BaseDie.num_outcomes">num_outcomes</a></dd>
                <dd id="ScalarDie.is_empty" class="function"><a href="#BaseDie.is_empty">is_empty</a></dd>
                <dd id="ScalarDie.weights" class="function"><a href="#BaseDie.weights">weights</a></dd>
                <dd id="ScalarDie.has_zero_weights" class="function"><a href="#BaseDie.has_zero_weights">has_zero_weights</a></dd>
                <dd id="ScalarDie.items" class="function"><a href="#BaseDie.items">items</a></dd>
                <dd id="ScalarDie.denominator" class="function"><a href="#BaseDie.denominator">denominator</a></dd>
                <dd id="ScalarDie.total_weight" class="function"><a href="#BaseDie.total_weight">total_weight</a></dd>
                <dd id="ScalarDie.pmf" class="function"><a href="#BaseDie.pmf">pmf</a></dd>
                <dd id="ScalarDie.cweights" class="function"><a href="#BaseDie.cweights">cweights</a></dd>
                <dd id="ScalarDie.sweights" class="function"><a href="#BaseDie.sweights">sweights</a></dd>
                <dd id="ScalarDie.cdf" class="function"><a href="#BaseDie.cdf">cdf</a></dd>
                <dd id="ScalarDie.sf" class="function"><a href="#BaseDie.sf">sf</a></dd>
                <dd id="ScalarDie.weight_eq" class="function"><a href="#BaseDie.weight_eq">weight_eq</a></dd>
                <dd id="ScalarDie.weight_ne" class="function"><a href="#BaseDie.weight_ne">weight_ne</a></dd>
                <dd id="ScalarDie.weight_le" class="function"><a href="#BaseDie.weight_le">weight_le</a></dd>
                <dd id="ScalarDie.weight_lt" class="function"><a href="#BaseDie.weight_lt">weight_lt</a></dd>
                <dd id="ScalarDie.weight_ge" class="function"><a href="#BaseDie.weight_ge">weight_ge</a></dd>
                <dd id="ScalarDie.weight_gt" class="function"><a href="#BaseDie.weight_gt">weight_gt</a></dd>
                <dd id="ScalarDie.probability" class="function"><a href="#BaseDie.probability">probability</a></dd>
                <dd id="ScalarDie.mode" class="function"><a href="#BaseDie.mode">mode</a></dd>
                <dd id="ScalarDie.modal_weight" class="function"><a href="#BaseDie.modal_weight">modal_weight</a></dd>
                <dd id="ScalarDie.ks_stat" class="function"><a href="#BaseDie.ks_stat">ks_stat</a></dd>
                <dd id="ScalarDie.cvm_stat" class="function"><a href="#BaseDie.cvm_stat">cvm_stat</a></dd>
                <dd id="ScalarDie.reduce" class="function"><a href="#BaseDie.reduce">reduce</a></dd>
                <dd id="ScalarDie.scale_weights" class="function"><a href="#BaseDie.scale_weights">scale_weights</a></dd>
                <dd id="ScalarDie.min_outcome" class="function"><a href="#BaseDie.min_outcome">min_outcome</a></dd>
                <dd id="ScalarDie.max_outcome" class="function"><a href="#BaseDie.max_outcome">max_outcome</a></dd>
                <dd id="ScalarDie.nearest_le" class="function"><a href="#BaseDie.nearest_le">nearest_le</a></dd>
                <dd id="ScalarDie.nearest_ge" class="function"><a href="#BaseDie.nearest_ge">nearest_ge</a></dd>
                <dd id="ScalarDie.reroll" class="function"><a href="#BaseDie.reroll">reroll</a></dd>
                <dd id="ScalarDie.reroll_until" class="function"><a href="#BaseDie.reroll_until">reroll_until</a></dd>
                <dd id="ScalarDie.truncate" class="function"><a href="#BaseDie.truncate">truncate</a></dd>
                <dd id="ScalarDie.clip" class="function"><a href="#BaseDie.clip">clip</a></dd>
                <dd id="ScalarDie.cond" class="function"><a href="#BaseDie.cond">cond</a></dd>
                <dd id="ScalarDie.set_outcomes" class="function"><a href="#BaseDie.set_outcomes">set_outcomes</a></dd>
                <dd id="ScalarDie.trim" class="function"><a href="#BaseDie.trim">trim</a></dd>
                <dd id="ScalarDie.sub" class="function"><a href="#BaseDie.sub">sub</a></dd>
                <dd id="ScalarDie.explode" class="function"><a href="#BaseDie.explode">explode</a></dd>
                <dd id="ScalarDie.lowest" class="function"><a href="#BaseDie.lowest">lowest</a></dd>
                <dd id="ScalarDie.highest" class="function"><a href="#BaseDie.highest">highest</a></dd>
                <dd id="ScalarDie.repeat_and_sum" class="function"><a href="#BaseDie.repeat_and_sum">repeat_and_sum</a></dd>
                <dd id="ScalarDie.pool" class="function"><a href="#BaseDie.pool">pool</a></dd>
                <dd id="ScalarDie.keep" class="function"><a href="#BaseDie.keep">keep</a></dd>
                <dd id="ScalarDie.keep_highest" class="function"><a href="#BaseDie.keep_highest">keep_highest</a></dd>
                <dd id="ScalarDie.keep_highest_single" class="function"><a href="#BaseDie.keep_highest_single">keep_highest_single</a></dd>
                <dd id="ScalarDie.keep_lowest" class="function"><a href="#BaseDie.keep_lowest">keep_lowest</a></dd>
                <dd id="ScalarDie.keep_lowest_single" class="function"><a href="#BaseDie.keep_lowest_single">keep_lowest_single</a></dd>
                <dd id="ScalarDie.abs" class="function"><a href="#BaseDie.abs">abs</a></dd>
                <dd id="ScalarDie.zero" class="function"><a href="#BaseDie.zero">zero</a></dd>
                <dd id="ScalarDie.zero_outcome" class="function"><a href="#BaseDie.zero_outcome">zero_outcome</a></dd>
                <dd id="ScalarDie.bool" class="function"><a href="#BaseDie.bool">bool</a></dd>
                <dd id="ScalarDie.sign" class="function"><a href="#BaseDie.sign">sign</a></dd>
                <dd id="ScalarDie.cmp" class="function"><a href="#BaseDie.cmp">cmp</a></dd>
                <dd id="ScalarDie.sample" class="function"><a href="#BaseDie.sample">sample</a></dd>
                <dd id="ScalarDie.key_tuple" class="function"><a href="#BaseDie.key_tuple">key_tuple</a></dd>
                <dd id="ScalarDie.hash" class="function"><a href="#BaseDie.hash">hash</a></dd>
                <dd id="ScalarDie.equals" class="function"><a href="#BaseDie.equals">equals</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="VectorDie">
                                <div class="attr class">
        <a class="headerlink" href="#VectorDie">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">VectorDie</span><wbr>(<span class="base"><a href="#BaseDie">icepool.BaseDie</a></span>):
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VectorDie-11"><a href="#VectorDie-11"><span class="linenos"> 11</span></a><span class="k">class</span> <span class="nc">VectorDie</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">die</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">BaseDie</span><span class="p">):</span>
</span><span id="VectorDie-12"><a href="#VectorDie-12"><span class="linenos"> 12</span></a>    <span class="sd">&quot;&quot;&quot; Multivariate die.</span>
</span><span id="VectorDie-13"><a href="#VectorDie-13"><span class="linenos"> 13</span></a><span class="sd">    </span>
</span><span id="VectorDie-14"><a href="#VectorDie-14"><span class="linenos"> 14</span></a><span class="sd">    Outcomes are tuples. Most methods and operators are performed elementwise.</span>
</span><span id="VectorDie-15"><a href="#VectorDie-15"><span class="linenos"> 15</span></a><span class="sd">    Methods that depend on a flat outcome order use tuple order.</span>
</span><span id="VectorDie-16"><a href="#VectorDie-16"><span class="linenos"> 16</span></a><span class="sd">    </span>
</span><span id="VectorDie-17"><a href="#VectorDie-17"><span class="linenos"> 17</span></a><span class="sd">    Statistical methods other than `mode()` take in an argument `i` specifying which dimension to take the statistic over.</span>
</span><span id="VectorDie-18"><a href="#VectorDie-18"><span class="linenos"> 18</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="VectorDie-19"><a href="#VectorDie-19"><span class="linenos"> 19</span></a>    
</span><span id="VectorDie-20"><a href="#VectorDie-20"><span class="linenos"> 20</span></a>    <span class="k">def</span> <span class="nf">ndim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VectorDie-21"><a href="#VectorDie-21"><span class="linenos"> 21</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ndim</span>
</span><span id="VectorDie-22"><a href="#VectorDie-22"><span class="linenos"> 22</span></a>    
</span><span id="VectorDie-23"><a href="#VectorDie-23"><span class="linenos"> 23</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="p">):</span>
</span><span id="VectorDie-24"><a href="#VectorDie-24"><span class="linenos"> 24</span></a>        <span class="sd">&quot;&quot;&quot; Constructor.</span>
</span><span id="VectorDie-25"><a href="#VectorDie-25"><span class="linenos"> 25</span></a><span class="sd">        </span>
</span><span id="VectorDie-26"><a href="#VectorDie-26"><span class="linenos"> 26</span></a><span class="sd">        Dice should not be constructed directly;</span>
</span><span id="VectorDie-27"><a href="#VectorDie-27"><span class="linenos"> 27</span></a><span class="sd">        instead, use one of the methods defined in `icepool.die.func` </span>
</span><span id="VectorDie-28"><a href="#VectorDie-28"><span class="linenos"> 28</span></a><span class="sd">        (which are imported into the top-level `icepool` module).</span>
</span><span id="VectorDie-29"><a href="#VectorDie-29"><span class="linenos"> 29</span></a><span class="sd">        </span>
</span><span id="VectorDie-30"><a href="#VectorDie-30"><span class="linenos"> 30</span></a><span class="sd">        Args:</span>
</span><span id="VectorDie-31"><a href="#VectorDie-31"><span class="linenos"> 31</span></a><span class="sd">            data: A `Counts` mapping outcomes to weights.</span>
</span><span id="VectorDie-32"><a href="#VectorDie-32"><span class="linenos"> 32</span></a><span class="sd">            ndim: The number of dimensions of this die.</span>
</span><span id="VectorDie-33"><a href="#VectorDie-33"><span class="linenos"> 33</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="VectorDie-34"><a href="#VectorDie-34"><span class="linenos"> 34</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">data</span>
</span><span id="VectorDie-35"><a href="#VectorDie-35"><span class="linenos"> 35</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ndim</span> <span class="o">=</span> <span class="n">ndim</span>
</span><span id="VectorDie-36"><a href="#VectorDie-36"><span class="linenos"> 36</span></a>    
</span><span id="VectorDie-37"><a href="#VectorDie-37"><span class="linenos"> 37</span></a>    <span class="k">def</span> <span class="nf">_unary_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="VectorDie-38"><a href="#VectorDie-38"><span class="linenos"> 38</span></a>        <span class="sd">&quot;&quot;&quot; Returns a die representing the effect of performing the operation elementwise on the outcome sequences. &quot;&quot;&quot;</span>
</span><span id="VectorDie-39"><a href="#VectorDie-39"><span class="linenos"> 39</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="VectorDie-40"><a href="#VectorDie-40"><span class="linenos"> 40</span></a>        <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="VectorDie-41"><a href="#VectorDie-41"><span class="linenos"> 41</span></a>            <span class="n">new_outcome</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">op</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">outcome</span><span class="p">)</span>
</span><span id="VectorDie-42"><a href="#VectorDie-42"><span class="linenos"> 42</span></a>            <span class="n">data</span><span class="p">[</span><span class="n">new_outcome</span><span class="p">]</span> <span class="o">+=</span> <span class="n">weight</span>
</span><span id="VectorDie-43"><a href="#VectorDie-43"><span class="linenos"> 43</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="VectorDie-44"><a href="#VectorDie-44"><span class="linenos"> 44</span></a>    
</span><span id="VectorDie-45"><a href="#VectorDie-45"><span class="linenos"> 45</span></a>    <span class="k">def</span> <span class="nf">_binary_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="VectorDie-46"><a href="#VectorDie-46"><span class="linenos"> 46</span></a>        <span class="sd">&quot;&quot;&quot; Returns a die representing the effect of performing the operation elementwise on pairs of outcome sequences from the two dice. &quot;&quot;&quot;</span>
</span><span id="VectorDie-47"><a href="#VectorDie-47"><span class="linenos"> 47</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="VectorDie-48"><a href="#VectorDie-48"><span class="linenos"> 48</span></a>        <span class="k">for</span> <span class="p">(</span><span class="n">outcome_self</span><span class="p">,</span> <span class="n">weight_self</span><span class="p">),</span> <span class="p">(</span><span class="n">outcome_other</span><span class="p">,</span> <span class="n">weight_other</span><span class="p">)</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">other</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
</span><span id="VectorDie-49"><a href="#VectorDie-49"><span class="linenos"> 49</span></a>            <span class="n">new_outcome</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">op</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">outcome_self</span><span class="p">,</span> <span class="n">outcome_other</span><span class="p">))</span>
</span><span id="VectorDie-50"><a href="#VectorDie-50"><span class="linenos"> 50</span></a>            <span class="n">data</span><span class="p">[</span><span class="n">new_outcome</span><span class="p">]</span> <span class="o">+=</span> <span class="n">weight_self</span> <span class="o">*</span> <span class="n">weight_other</span>
</span><span id="VectorDie-51"><a href="#VectorDie-51"><span class="linenos"> 51</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())</span>
</span><span id="VectorDie-52"><a href="#VectorDie-52"><span class="linenos"> 52</span></a>    
</span><span id="VectorDie-53"><a href="#VectorDie-53"><span class="linenos"> 53</span></a>    <span class="k">def</span> <span class="nf">_wrap_unpack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
</span><span id="VectorDie-54"><a href="#VectorDie-54"><span class="linenos"> 54</span></a>        <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
</span><span id="VectorDie-55"><a href="#VectorDie-55"><span class="linenos"> 55</span></a>        <span class="k">def</span> <span class="nf">unpacked_func</span><span class="p">(</span><span class="n">outcome</span><span class="p">):</span>
</span><span id="VectorDie-56"><a href="#VectorDie-56"><span class="linenos"> 56</span></a>            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">outcome</span><span class="p">)</span>
</span><span id="VectorDie-57"><a href="#VectorDie-57"><span class="linenos"> 57</span></a>        <span class="k">return</span> <span class="n">unpacked_func</span>
</span><span id="VectorDie-58"><a href="#VectorDie-58"><span class="linenos"> 58</span></a>    
</span><span id="VectorDie-59"><a href="#VectorDie-59"><span class="linenos"> 59</span></a>    <span class="k">def</span> <span class="nf">marginal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select</span><span class="p">):</span>
</span><span id="VectorDie-60"><a href="#VectorDie-60"><span class="linenos"> 60</span></a>        <span class="sd">&quot;&quot;&quot; Returns the marginal distribution over selected dimensions of the die. &quot;&quot;&quot;</span>
</span><span id="VectorDie-61"><a href="#VectorDie-61"><span class="linenos"> 61</span></a>        <span class="n">test_select</span> <span class="o">=</span> <span class="p">([</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())[</span><span class="n">select</span><span class="p">]</span>
</span><span id="VectorDie-62"><a href="#VectorDie-62"><span class="linenos"> 62</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">test_select</span><span class="p">,</span> <span class="s1">&#39;__len__&#39;</span><span class="p">):</span>
</span><span id="VectorDie-63"><a href="#VectorDie-63"><span class="linenos"> 63</span></a>            <span class="n">ndim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_select</span><span class="p">)</span>
</span><span id="VectorDie-64"><a href="#VectorDie-64"><span class="linenos"> 64</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="VectorDie-65"><a href="#VectorDie-65"><span class="linenos"> 65</span></a>            <span class="n">ndim</span> <span class="o">=</span> <span class="s1">&#39;scalar&#39;</span>
</span><span id="VectorDie-66"><a href="#VectorDie-66"><span class="linenos"> 66</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="VectorDie-67"><a href="#VectorDie-67"><span class="linenos"> 67</span></a>        <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="VectorDie-68"><a href="#VectorDie-68"><span class="linenos"> 68</span></a>            <span class="n">data</span><span class="p">[</span><span class="n">outcome</span><span class="p">[</span><span class="n">select</span><span class="p">]]</span> <span class="o">+=</span> <span class="n">weight</span>
</span><span id="VectorDie-69"><a href="#VectorDie-69"><span class="linenos"> 69</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">)</span>
</span><span id="VectorDie-70"><a href="#VectorDie-70"><span class="linenos"> 70</span></a>    
</span><span id="VectorDie-71"><a href="#VectorDie-71"><span class="linenos"> 71</span></a>    <span class="nd">@cached_property</span>
</span><span id="VectorDie-72"><a href="#VectorDie-72"><span class="linenos"> 72</span></a>    <span class="k">def</span> <span class="nf">dim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VectorDie-73"><a href="#VectorDie-73"><span class="linenos"> 73</span></a>        <span class="sd">&quot;&quot;&quot; Subscript this to produce a marginal distribution.</span>
</span><span id="VectorDie-74"><a href="#VectorDie-74"><span class="linenos"> 74</span></a><span class="sd">        </span>
</span><span id="VectorDie-75"><a href="#VectorDie-75"><span class="linenos"> 75</span></a><span class="sd">        For example, `die.dim[0]` will extract the 0th dimension.</span>
</span><span id="VectorDie-76"><a href="#VectorDie-76"><span class="linenos"> 76</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="VectorDie-77"><a href="#VectorDie-77"><span class="linenos"> 77</span></a>        <span class="k">return</span> <span class="n">Slicer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">marginal</span><span class="p">)</span>
</span><span id="VectorDie-78"><a href="#VectorDie-78"><span class="linenos"> 78</span></a>    
</span><span id="VectorDie-79"><a href="#VectorDie-79"><span class="linenos"> 79</span></a>    <span class="k">def</span> <span class="nf">all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VectorDie-80"><a href="#VectorDie-80"><span class="linenos"> 80</span></a>        <span class="sd">&quot;&quot;&quot; Returns a die representing whether all dimensions are true. &quot;&quot;&quot;</span>
</span><span id="VectorDie-81"><a href="#VectorDie-81"><span class="linenos"> 81</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="k">lambda</span> <span class="o">*</span><span class="n">outcome</span><span class="p">:</span> <span class="nb">all</span><span class="p">(</span><span class="n">outcome</span><span class="p">),</span> <span class="n">ndim</span><span class="o">=</span><span class="s1">&#39;scalar&#39;</span><span class="p">)</span>
</span><span id="VectorDie-82"><a href="#VectorDie-82"><span class="linenos"> 82</span></a>    
</span><span id="VectorDie-83"><a href="#VectorDie-83"><span class="linenos"> 83</span></a>    <span class="k">def</span> <span class="nf">any</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VectorDie-84"><a href="#VectorDie-84"><span class="linenos"> 84</span></a>        <span class="sd">&quot;&quot;&quot; Returns a die representing whether any dimension is true. &quot;&quot;&quot;</span>
</span><span id="VectorDie-85"><a href="#VectorDie-85"><span class="linenos"> 85</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="k">lambda</span> <span class="o">*</span><span class="n">outcome</span><span class="p">:</span> <span class="nb">any</span><span class="p">(</span><span class="n">outcome</span><span class="p">),</span> <span class="n">ndim</span><span class="o">=</span><span class="s1">&#39;scalar&#39;</span><span class="p">)</span>
</span><span id="VectorDie-86"><a href="#VectorDie-86"><span class="linenos"> 86</span></a>    
</span><span id="VectorDie-87"><a href="#VectorDie-87"><span class="linenos"> 87</span></a>    <span class="c1"># Statistics.</span>
</span><span id="VectorDie-88"><a href="#VectorDie-88"><span class="linenos"> 88</span></a>    <span class="c1"># These apply to a single dimension `i`.</span>
</span><span id="VectorDie-89"><a href="#VectorDie-89"><span class="linenos"> 89</span></a>    
</span><span id="VectorDie-90"><a href="#VectorDie-90"><span class="linenos"> 90</span></a>    <span class="k">def</span> <span class="nf">_apply_to_dim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="VectorDie-91"><a href="#VectorDie-91"><span class="linenos"> 91</span></a>        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="VectorDie-92"><a href="#VectorDie-92"><span class="linenos"> 92</span></a>    
</span><span id="VectorDie-93"><a href="#VectorDie-93"><span class="linenos"> 93</span></a>    <span class="k">def</span> <span class="nf">median_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="VectorDie-94"><a href="#VectorDie-94"><span class="linenos"> 94</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">median_left</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="VectorDie-95"><a href="#VectorDie-95"><span class="linenos"> 95</span></a>        
</span><span id="VectorDie-96"><a href="#VectorDie-96"><span class="linenos"> 96</span></a>    <span class="k">def</span> <span class="nf">median_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="VectorDie-97"><a href="#VectorDie-97"><span class="linenos"> 97</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">median_right</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="VectorDie-98"><a href="#VectorDie-98"><span class="linenos"> 98</span></a>    
</span><span id="VectorDie-99"><a href="#VectorDie-99"><span class="linenos"> 99</span></a>    <span class="k">def</span> <span class="nf">median</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="VectorDie-100"><a href="#VectorDie-100"><span class="linenos">100</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">median</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="VectorDie-101"><a href="#VectorDie-101"><span class="linenos">101</span></a>    
</span><span id="VectorDie-102"><a href="#VectorDie-102"><span class="linenos">102</span></a>    <span class="k">def</span> <span class="nf">ppf_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="VectorDie-103"><a href="#VectorDie-103"><span class="linenos">103</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">ppf_left</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="VectorDie-104"><a href="#VectorDie-104"><span class="linenos">104</span></a>        
</span><span id="VectorDie-105"><a href="#VectorDie-105"><span class="linenos">105</span></a>    <span class="k">def</span> <span class="nf">ppf_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="VectorDie-106"><a href="#VectorDie-106"><span class="linenos">106</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">ppf_right</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="VectorDie-107"><a href="#VectorDie-107"><span class="linenos">107</span></a>    
</span><span id="VectorDie-108"><a href="#VectorDie-108"><span class="linenos">108</span></a>    <span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="VectorDie-109"><a href="#VectorDie-109"><span class="linenos">109</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">ppf</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="VectorDie-110"><a href="#VectorDie-110"><span class="linenos">110</span></a>        
</span><span id="VectorDie-111"><a href="#VectorDie-111"><span class="linenos">111</span></a>    <span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="VectorDie-112"><a href="#VectorDie-112"><span class="linenos">112</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="VectorDie-113"><a href="#VectorDie-113"><span class="linenos">113</span></a>    
</span><span id="VectorDie-114"><a href="#VectorDie-114"><span class="linenos">114</span></a>    <span class="k">def</span> <span class="nf">variance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="VectorDie-115"><a href="#VectorDie-115"><span class="linenos">115</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">variance</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="VectorDie-116"><a href="#VectorDie-116"><span class="linenos">116</span></a>    
</span><span id="VectorDie-117"><a href="#VectorDie-117"><span class="linenos">117</span></a>    <span class="k">def</span> <span class="nf">standard_deviation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="VectorDie-118"><a href="#VectorDie-118"><span class="linenos">118</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="VectorDie-119"><a href="#VectorDie-119"><span class="linenos">119</span></a>    
</span><span id="VectorDie-120"><a href="#VectorDie-120"><span class="linenos">120</span></a>    <span class="n">sd</span> <span class="o">=</span> <span class="n">standard_deviation</span>
</span><span id="VectorDie-121"><a href="#VectorDie-121"><span class="linenos">121</span></a>    
</span><span id="VectorDie-122"><a href="#VectorDie-122"><span class="linenos">122</span></a>    <span class="k">def</span> <span class="nf">standardized_moment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span id="VectorDie-123"><a href="#VectorDie-123"><span class="linenos">123</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">standardized_moment</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</span><span id="VectorDie-124"><a href="#VectorDie-124"><span class="linenos">124</span></a>    
</span><span id="VectorDie-125"><a href="#VectorDie-125"><span class="linenos">125</span></a>    <span class="k">def</span> <span class="nf">skewness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="VectorDie-126"><a href="#VectorDie-126"><span class="linenos">126</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">skewness</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="VectorDie-127"><a href="#VectorDie-127"><span class="linenos">127</span></a>        
</span><span id="VectorDie-128"><a href="#VectorDie-128"><span class="linenos">128</span></a>    <span class="k">def</span> <span class="nf">excess_kurtosis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="VectorDie-129"><a href="#VectorDie-129"><span class="linenos">129</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">excess_kurtosis</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="VectorDie-130"><a href="#VectorDie-130"><span class="linenos">130</span></a>    
</span><span id="VectorDie-131"><a href="#VectorDie-131"><span class="linenos">131</span></a>    <span class="c1"># Joint statistics.</span>
</span><span id="VectorDie-132"><a href="#VectorDie-132"><span class="linenos">132</span></a>    
</span><span id="VectorDie-133"><a href="#VectorDie-133"><span class="linenos">133</span></a>    <span class="k">def</span> <span class="nf">covariance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
</span><span id="VectorDie-134"><a href="#VectorDie-134"><span class="linenos">134</span></a>        <span class="n">mean_i</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span><span id="VectorDie-135"><a href="#VectorDie-135"><span class="linenos">135</span></a>        <span class="n">mean_j</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span><span id="VectorDie-136"><a href="#VectorDie-136"><span class="linenos">136</span></a>        <span class="k">return</span> <span class="nb">sum</span><span class="p">((</span><span class="n">outcome</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">mean_i</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">outcome</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">mean_j</span><span class="p">)</span> <span class="o">*</span> <span class="n">weight</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">())</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
</span><span id="VectorDie-137"><a href="#VectorDie-137"><span class="linenos">137</span></a>    
</span><span id="VectorDie-138"><a href="#VectorDie-138"><span class="linenos">138</span></a>    <span class="k">def</span> <span class="nf">correlation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
</span><span id="VectorDie-139"><a href="#VectorDie-139"><span class="linenos">139</span></a>        <span class="n">sd_i</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">()</span>
</span><span id="VectorDie-140"><a href="#VectorDie-140"><span class="linenos">140</span></a>        <span class="n">sd_j</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">()</span>
</span><span id="VectorDie-141"><a href="#VectorDie-141"><span class="linenos">141</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sd_i</span> <span class="o">*</span> <span class="n">sd_j</span><span class="p">)</span>
</span><span id="VectorDie-142"><a href="#VectorDie-142"><span class="linenos">142</span></a>    
</span><span id="VectorDie-143"><a href="#VectorDie-143"><span class="linenos">143</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VectorDie-144"><a href="#VectorDie-144"><span class="linenos">144</span></a>        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__qualname__</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span><span class="si">}</span><span class="s1">, ndim=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">()</span><span class="si">}</span><span class="s1">)&#39;</span>
</span><span id="VectorDie-145"><a href="#VectorDie-145"><span class="linenos">145</span></a>    
</span><span id="VectorDie-146"><a href="#VectorDie-146"><span class="linenos">146</span></a>    <span class="k">def</span> <span class="nf">markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="VectorDie-147"><a href="#VectorDie-147"><span class="linenos">147</span></a>        <span class="sd">&quot;&quot;&quot; Formats the die as a Markdown table. &quot;&quot;&quot;</span>
</span><span id="VectorDie-148"><a href="#VectorDie-148"><span class="linenos">148</span></a>        <span class="n">outcome_lengths</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="VectorDie-149"><a href="#VectorDie-149"><span class="linenos">149</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">()):</span>
</span><span id="VectorDie-150"><a href="#VectorDie-150"><span class="linenos">150</span></a>            <span class="n">outcome_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">outcome</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">())</span> <span class="o">+</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Outcome[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">),))</span>
</span><span id="VectorDie-151"><a href="#VectorDie-151"><span class="linenos">151</span></a>            <span class="n">outcome_lengths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">outcome_length</span><span class="p">)</span>
</span><span id="VectorDie-152"><a href="#VectorDie-152"><span class="linenos">152</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="VectorDie-153"><a href="#VectorDie-153"><span class="linenos">153</span></a>        <span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;Denominator: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">&#39;</span>
</span><span id="VectorDie-154"><a href="#VectorDie-154"><span class="linenos">154</span></a>        <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;|&#39;</span>
</span><span id="VectorDie-155"><a href="#VectorDie-155"><span class="linenos">155</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">()):</span>
</span><span id="VectorDie-156"><a href="#VectorDie-156"><span class="linenos">156</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="n">outcome_lengths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Outcome[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;Outcome[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]&#39;</span> <span class="o">+</span> <span class="s1">&#39; |&#39;</span>
</span><span id="VectorDie-157"><a href="#VectorDie-157"><span class="linenos">157</span></a>        <span class="k">if</span> <span class="n">include_weights</span><span class="p">:</span>
</span><span id="VectorDie-158"><a href="#VectorDie-158"><span class="linenos">158</span></a>            <span class="n">weight_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">weight</span><span class="p">))</span> <span class="k">for</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">())</span> <span class="o">+</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;Weight&#39;</span><span class="p">),))</span>
</span><span id="VectorDie-159"><a href="#VectorDie-159"><span class="linenos">159</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="n">weight_length</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="s1">&#39;Weight&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;Weight |&#39;</span>
</span><span id="VectorDie-160"><a href="#VectorDie-160"><span class="linenos">160</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="VectorDie-161"><a href="#VectorDie-161"><span class="linenos">161</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39; Probability |&#39;</span>
</span><span id="VectorDie-162"><a href="#VectorDie-162"><span class="linenos">162</span></a>        <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="VectorDie-163"><a href="#VectorDie-163"><span class="linenos">163</span></a>        <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;|&#39;</span>
</span><span id="VectorDie-164"><a href="#VectorDie-164"><span class="linenos">164</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">()):</span>
</span><span id="VectorDie-165"><a href="#VectorDie-165"><span class="linenos">165</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="n">outcome_lengths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;:|&#39;</span>
</span><span id="VectorDie-166"><a href="#VectorDie-166"><span class="linenos">166</span></a>        <span class="k">if</span> <span class="n">include_weights</span><span class="p">:</span>
</span><span id="VectorDie-167"><a href="#VectorDie-167"><span class="linenos">167</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="n">weight_length</span> <span class="o">+</span> <span class="s1">&#39;:|&#39;</span>
</span><span id="VectorDie-168"><a href="#VectorDie-168"><span class="linenos">168</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="VectorDie-169"><a href="#VectorDie-169"><span class="linenos">169</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;------------:|&#39;</span>
</span><span id="VectorDie-170"><a href="#VectorDie-170"><span class="linenos">170</span></a>        <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="VectorDie-171"><a href="#VectorDie-171"><span class="linenos">171</span></a>        <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">pmf</span><span class="p">()):</span>
</span><span id="VectorDie-172"><a href="#VectorDie-172"><span class="linenos">172</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;|&#39;</span>
</span><span id="VectorDie-173"><a href="#VectorDie-173"><span class="linenos">173</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">outcome</span><span class="p">):</span>
</span><span id="VectorDie-174"><a href="#VectorDie-174"><span class="linenos">174</span></a>                <span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">:</span><span class="s1">&gt;</span><span class="si">{</span><span class="n">outcome_lengths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}}</span><span class="s1"> |&#39;</span>
</span><span id="VectorDie-175"><a href="#VectorDie-175"><span class="linenos">175</span></a>            <span class="k">if</span> <span class="n">include_weights</span><span class="p">:</span>
</span><span id="VectorDie-176"><a href="#VectorDie-176"><span class="linenos">176</span></a>                <span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">weight</span><span class="si">:</span><span class="s1">&gt;</span><span class="si">{</span><span class="n">weight_length</span><span class="si">}}</span><span class="s1"> |&#39;</span>
</span><span id="VectorDie-177"><a href="#VectorDie-177"><span class="linenos">177</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="VectorDie-178"><a href="#VectorDie-178"><span class="linenos">178</span></a>                <span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s1">11.6%</span><span class="si">}</span><span class="s1"> |&#39;</span>
</span><span id="VectorDie-179"><a href="#VectorDie-179"><span class="linenos">179</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="VectorDie-180"><a href="#VectorDie-180"><span class="linenos">180</span></a>        <span class="k">return</span> <span class="n">result</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Multivariate die.</p>

<p>Outcomes are tuples. Most methods and operators are performed elementwise.
Methods that depend on a flat outcome order use tuple order.</p>

<p>Statistical methods other than <code><a href="#VectorDie.mode">mode()</a></code> take in an argument <code>i</code> specifying which dimension to take the statistic over.</p>
</div>


                            <div id="VectorDie.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#VectorDie.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">VectorDie</span><span class="signature">(data, ndim)</span>
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VectorDie.__init__-23"><a href="#VectorDie.__init__-23"><span class="linenos">23</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="p">):</span>
</span><span id="VectorDie.__init__-24"><a href="#VectorDie.__init__-24"><span class="linenos">24</span></a>        <span class="sd">&quot;&quot;&quot; Constructor.</span>
</span><span id="VectorDie.__init__-25"><a href="#VectorDie.__init__-25"><span class="linenos">25</span></a><span class="sd">        </span>
</span><span id="VectorDie.__init__-26"><a href="#VectorDie.__init__-26"><span class="linenos">26</span></a><span class="sd">        Dice should not be constructed directly;</span>
</span><span id="VectorDie.__init__-27"><a href="#VectorDie.__init__-27"><span class="linenos">27</span></a><span class="sd">        instead, use one of the methods defined in `icepool.die.func` </span>
</span><span id="VectorDie.__init__-28"><a href="#VectorDie.__init__-28"><span class="linenos">28</span></a><span class="sd">        (which are imported into the top-level `icepool` module).</span>
</span><span id="VectorDie.__init__-29"><a href="#VectorDie.__init__-29"><span class="linenos">29</span></a><span class="sd">        </span>
</span><span id="VectorDie.__init__-30"><a href="#VectorDie.__init__-30"><span class="linenos">30</span></a><span class="sd">        Args:</span>
</span><span id="VectorDie.__init__-31"><a href="#VectorDie.__init__-31"><span class="linenos">31</span></a><span class="sd">            data: A `Counts` mapping outcomes to weights.</span>
</span><span id="VectorDie.__init__-32"><a href="#VectorDie.__init__-32"><span class="linenos">32</span></a><span class="sd">            ndim: The number of dimensions of this die.</span>
</span><span id="VectorDie.__init__-33"><a href="#VectorDie.__init__-33"><span class="linenos">33</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="VectorDie.__init__-34"><a href="#VectorDie.__init__-34"><span class="linenos">34</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">data</span>
</span><span id="VectorDie.__init__-35"><a href="#VectorDie.__init__-35"><span class="linenos">35</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ndim</span> <span class="o">=</span> <span class="n">ndim</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Constructor.</p>

<p>Dice should not be constructed directly;
instead, use one of the methods defined in <code>icepool.die.func</code> 
(which are imported into the top-level <code><a href="">icepool</a></code> module).</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>data:</strong>  A <code>Counts</code> mapping outcomes to weights.</li>
<li><strong>ndim:</strong>  The number of dimensions of this die.</li>
</ul>
</div>


                            </div>
                            <div id="VectorDie.ndim" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#VectorDie.ndim">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">ndim</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VectorDie.ndim-20"><a href="#VectorDie.ndim-20"><span class="linenos">20</span></a>    <span class="k">def</span> <span class="nf">ndim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VectorDie.ndim-21"><a href="#VectorDie.ndim-21"><span class="linenos">21</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ndim</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns the number of dimensions if this is a <code><a href="#VectorDie">VectorDie</a></code>.</p>

<p>Otherwise, returns <code>'scalar'</code> for a <code><a href="#ScalarDie">ScalarDie</a></code> and <code>'empty'</code> for an <code><a href="#EmptyDie">EmptyDie</a></code>.</p>
</div>


                            </div>
                            <div id="VectorDie.marginal" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#VectorDie.marginal">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">marginal</span><span class="signature">(self, select)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VectorDie.marginal-59"><a href="#VectorDie.marginal-59"><span class="linenos">59</span></a>    <span class="k">def</span> <span class="nf">marginal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select</span><span class="p">):</span>
</span><span id="VectorDie.marginal-60"><a href="#VectorDie.marginal-60"><span class="linenos">60</span></a>        <span class="sd">&quot;&quot;&quot; Returns the marginal distribution over selected dimensions of the die. &quot;&quot;&quot;</span>
</span><span id="VectorDie.marginal-61"><a href="#VectorDie.marginal-61"><span class="linenos">61</span></a>        <span class="n">test_select</span> <span class="o">=</span> <span class="p">([</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">())[</span><span class="n">select</span><span class="p">]</span>
</span><span id="VectorDie.marginal-62"><a href="#VectorDie.marginal-62"><span class="linenos">62</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">test_select</span><span class="p">,</span> <span class="s1">&#39;__len__&#39;</span><span class="p">):</span>
</span><span id="VectorDie.marginal-63"><a href="#VectorDie.marginal-63"><span class="linenos">63</span></a>            <span class="n">ndim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_select</span><span class="p">)</span>
</span><span id="VectorDie.marginal-64"><a href="#VectorDie.marginal-64"><span class="linenos">64</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="VectorDie.marginal-65"><a href="#VectorDie.marginal-65"><span class="linenos">65</span></a>            <span class="n">ndim</span> <span class="o">=</span> <span class="s1">&#39;scalar&#39;</span>
</span><span id="VectorDie.marginal-66"><a href="#VectorDie.marginal-66"><span class="linenos">66</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="VectorDie.marginal-67"><a href="#VectorDie.marginal-67"><span class="linenos">67</span></a>        <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="VectorDie.marginal-68"><a href="#VectorDie.marginal-68"><span class="linenos">68</span></a>            <span class="n">data</span><span class="p">[</span><span class="n">outcome</span><span class="p">[</span><span class="n">select</span><span class="p">]]</span> <span class="o">+=</span> <span class="n">weight</span>
</span><span id="VectorDie.marginal-69"><a href="#VectorDie.marginal-69"><span class="linenos">69</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns the marginal distribution over selected dimensions of the die.</p>
</div>


                            </div>
                            <div id="VectorDie.dim" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#VectorDie.dim">#&nbsp;&nbsp</a>

        <span class="name">dim</span>
    </div>

    
            <div class="docstring"><p>Subscript this to produce a marginal distribution.</p>

<p>For example, <code>die.dim[0]</code> will extract the 0th dimension.</p>
</div>


                            </div>
                            <div id="VectorDie.all" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#VectorDie.all">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">all</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VectorDie.all-79"><a href="#VectorDie.all-79"><span class="linenos">79</span></a>    <span class="k">def</span> <span class="nf">all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VectorDie.all-80"><a href="#VectorDie.all-80"><span class="linenos">80</span></a>        <span class="sd">&quot;&quot;&quot; Returns a die representing whether all dimensions are true. &quot;&quot;&quot;</span>
</span><span id="VectorDie.all-81"><a href="#VectorDie.all-81"><span class="linenos">81</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="k">lambda</span> <span class="o">*</span><span class="n">outcome</span><span class="p">:</span> <span class="nb">all</span><span class="p">(</span><span class="n">outcome</span><span class="p">),</span> <span class="n">ndim</span><span class="o">=</span><span class="s1">&#39;scalar&#39;</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns a die representing whether all dimensions are true.</p>
</div>


                            </div>
                            <div id="VectorDie.any" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#VectorDie.any">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">any</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VectorDie.any-83"><a href="#VectorDie.any-83"><span class="linenos">83</span></a>    <span class="k">def</span> <span class="nf">any</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VectorDie.any-84"><a href="#VectorDie.any-84"><span class="linenos">84</span></a>        <span class="sd">&quot;&quot;&quot; Returns a die representing whether any dimension is true. &quot;&quot;&quot;</span>
</span><span id="VectorDie.any-85"><a href="#VectorDie.any-85"><span class="linenos">85</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="k">lambda</span> <span class="o">*</span><span class="n">outcome</span><span class="p">:</span> <span class="nb">any</span><span class="p">(</span><span class="n">outcome</span><span class="p">),</span> <span class="n">ndim</span><span class="o">=</span><span class="s1">&#39;scalar&#39;</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns a die representing whether any dimension is true.</p>
</div>


                            </div>
                            <div id="VectorDie.median_left" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#VectorDie.median_left">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">median_left</span><span class="signature">(self, i)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VectorDie.median_left-93"><a href="#VectorDie.median_left-93"><span class="linenos">93</span></a>    <span class="k">def</span> <span class="nf">median_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="VectorDie.median_left-94"><a href="#VectorDie.median_left-94"><span class="linenos">94</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">median_left</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="VectorDie.median_right" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#VectorDie.median_right">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">median_right</span><span class="signature">(self, i)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VectorDie.median_right-96"><a href="#VectorDie.median_right-96"><span class="linenos">96</span></a>    <span class="k">def</span> <span class="nf">median_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="VectorDie.median_right-97"><a href="#VectorDie.median_right-97"><span class="linenos">97</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">median_right</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="VectorDie.median" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#VectorDie.median">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">median</span><span class="signature">(self, i)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VectorDie.median-99"><a href="#VectorDie.median-99"><span class="linenos"> 99</span></a>    <span class="k">def</span> <span class="nf">median</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="VectorDie.median-100"><a href="#VectorDie.median-100"><span class="linenos">100</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">median</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="VectorDie.ppf_left" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#VectorDie.ppf_left">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">ppf_left</span><span class="signature">(self, i)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VectorDie.ppf_left-102"><a href="#VectorDie.ppf_left-102"><span class="linenos">102</span></a>    <span class="k">def</span> <span class="nf">ppf_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="VectorDie.ppf_left-103"><a href="#VectorDie.ppf_left-103"><span class="linenos">103</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">ppf_left</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="VectorDie.ppf_right" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#VectorDie.ppf_right">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">ppf_right</span><span class="signature">(self, i)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VectorDie.ppf_right-105"><a href="#VectorDie.ppf_right-105"><span class="linenos">105</span></a>    <span class="k">def</span> <span class="nf">ppf_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="VectorDie.ppf_right-106"><a href="#VectorDie.ppf_right-106"><span class="linenos">106</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">ppf_right</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="VectorDie.ppf" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#VectorDie.ppf">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">ppf</span><span class="signature">(self, i)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VectorDie.ppf-108"><a href="#VectorDie.ppf-108"><span class="linenos">108</span></a>    <span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="VectorDie.ppf-109"><a href="#VectorDie.ppf-109"><span class="linenos">109</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">ppf</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="VectorDie.mean" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#VectorDie.mean">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">mean</span><span class="signature">(self, i)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VectorDie.mean-111"><a href="#VectorDie.mean-111"><span class="linenos">111</span></a>    <span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="VectorDie.mean-112"><a href="#VectorDie.mean-112"><span class="linenos">112</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="VectorDie.variance" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#VectorDie.variance">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">variance</span><span class="signature">(self, i)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VectorDie.variance-114"><a href="#VectorDie.variance-114"><span class="linenos">114</span></a>    <span class="k">def</span> <span class="nf">variance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="VectorDie.variance-115"><a href="#VectorDie.variance-115"><span class="linenos">115</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">variance</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="VectorDie.standard_deviation" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#VectorDie.standard_deviation">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">standard_deviation</span><span class="signature">(self, i)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VectorDie.standard_deviation-117"><a href="#VectorDie.standard_deviation-117"><span class="linenos">117</span></a>    <span class="k">def</span> <span class="nf">standard_deviation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="VectorDie.standard_deviation-118"><a href="#VectorDie.standard_deviation-118"><span class="linenos">118</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="VectorDie.sd" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#VectorDie.sd">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">sd</span><span class="signature">(self, i)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VectorDie.sd-117"><a href="#VectorDie.sd-117"><span class="linenos">117</span></a>    <span class="k">def</span> <span class="nf">standard_deviation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="VectorDie.sd-118"><a href="#VectorDie.sd-118"><span class="linenos">118</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="VectorDie.standardized_moment" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#VectorDie.standardized_moment">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">standardized_moment</span><span class="signature">(self, i, k)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VectorDie.standardized_moment-122"><a href="#VectorDie.standardized_moment-122"><span class="linenos">122</span></a>    <span class="k">def</span> <span class="nf">standardized_moment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span id="VectorDie.standardized_moment-123"><a href="#VectorDie.standardized_moment-123"><span class="linenos">123</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">standardized_moment</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="VectorDie.skewness" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#VectorDie.skewness">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">skewness</span><span class="signature">(self, i)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VectorDie.skewness-125"><a href="#VectorDie.skewness-125"><span class="linenos">125</span></a>    <span class="k">def</span> <span class="nf">skewness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="VectorDie.skewness-126"><a href="#VectorDie.skewness-126"><span class="linenos">126</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">skewness</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="VectorDie.excess_kurtosis" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#VectorDie.excess_kurtosis">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">excess_kurtosis</span><span class="signature">(self, i)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VectorDie.excess_kurtosis-128"><a href="#VectorDie.excess_kurtosis-128"><span class="linenos">128</span></a>    <span class="k">def</span> <span class="nf">excess_kurtosis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="VectorDie.excess_kurtosis-129"><a href="#VectorDie.excess_kurtosis-129"><span class="linenos">129</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_dim</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">ScalarDie</span><span class="o">.</span><span class="n">excess_kurtosis</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="VectorDie.covariance" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#VectorDie.covariance">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">covariance</span><span class="signature">(self, i, j)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VectorDie.covariance-133"><a href="#VectorDie.covariance-133"><span class="linenos">133</span></a>    <span class="k">def</span> <span class="nf">covariance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
</span><span id="VectorDie.covariance-134"><a href="#VectorDie.covariance-134"><span class="linenos">134</span></a>        <span class="n">mean_i</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span><span id="VectorDie.covariance-135"><a href="#VectorDie.covariance-135"><span class="linenos">135</span></a>        <span class="n">mean_j</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span><span id="VectorDie.covariance-136"><a href="#VectorDie.covariance-136"><span class="linenos">136</span></a>        <span class="k">return</span> <span class="nb">sum</span><span class="p">((</span><span class="n">outcome</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">mean_i</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">outcome</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">mean_j</span><span class="p">)</span> <span class="o">*</span> <span class="n">weight</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">())</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="VectorDie.correlation" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#VectorDie.correlation">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">correlation</span><span class="signature">(self, i, j)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VectorDie.correlation-138"><a href="#VectorDie.correlation-138"><span class="linenos">138</span></a>    <span class="k">def</span> <span class="nf">correlation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
</span><span id="VectorDie.correlation-139"><a href="#VectorDie.correlation-139"><span class="linenos">139</span></a>        <span class="n">sd_i</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">()</span>
</span><span id="VectorDie.correlation-140"><a href="#VectorDie.correlation-140"><span class="linenos">140</span></a>        <span class="n">sd_j</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">()</span>
</span><span id="VectorDie.correlation-141"><a href="#VectorDie.correlation-141"><span class="linenos">141</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sd_i</span> <span class="o">*</span> <span class="n">sd_j</span><span class="p">)</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="VectorDie.markdown" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#VectorDie.markdown">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">markdown</span><span class="signature">(self, include_weights=True)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VectorDie.markdown-146"><a href="#VectorDie.markdown-146"><span class="linenos">146</span></a>    <span class="k">def</span> <span class="nf">markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="VectorDie.markdown-147"><a href="#VectorDie.markdown-147"><span class="linenos">147</span></a>        <span class="sd">&quot;&quot;&quot; Formats the die as a Markdown table. &quot;&quot;&quot;</span>
</span><span id="VectorDie.markdown-148"><a href="#VectorDie.markdown-148"><span class="linenos">148</span></a>        <span class="n">outcome_lengths</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="VectorDie.markdown-149"><a href="#VectorDie.markdown-149"><span class="linenos">149</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">()):</span>
</span><span id="VectorDie.markdown-150"><a href="#VectorDie.markdown-150"><span class="linenos">150</span></a>            <span class="n">outcome_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">outcome</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">())</span> <span class="o">+</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Outcome[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">),))</span>
</span><span id="VectorDie.markdown-151"><a href="#VectorDie.markdown-151"><span class="linenos">151</span></a>            <span class="n">outcome_lengths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">outcome_length</span><span class="p">)</span>
</span><span id="VectorDie.markdown-152"><a href="#VectorDie.markdown-152"><span class="linenos">152</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="VectorDie.markdown-153"><a href="#VectorDie.markdown-153"><span class="linenos">153</span></a>        <span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;Denominator: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">&#39;</span>
</span><span id="VectorDie.markdown-154"><a href="#VectorDie.markdown-154"><span class="linenos">154</span></a>        <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;|&#39;</span>
</span><span id="VectorDie.markdown-155"><a href="#VectorDie.markdown-155"><span class="linenos">155</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">()):</span>
</span><span id="VectorDie.markdown-156"><a href="#VectorDie.markdown-156"><span class="linenos">156</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="n">outcome_lengths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Outcome[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;Outcome[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">]&#39;</span> <span class="o">+</span> <span class="s1">&#39; |&#39;</span>
</span><span id="VectorDie.markdown-157"><a href="#VectorDie.markdown-157"><span class="linenos">157</span></a>        <span class="k">if</span> <span class="n">include_weights</span><span class="p">:</span>
</span><span id="VectorDie.markdown-158"><a href="#VectorDie.markdown-158"><span class="linenos">158</span></a>            <span class="n">weight_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">weight</span><span class="p">))</span> <span class="k">for</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">())</span> <span class="o">+</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;Weight&#39;</span><span class="p">),))</span>
</span><span id="VectorDie.markdown-159"><a href="#VectorDie.markdown-159"><span class="linenos">159</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="n">weight_length</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="s1">&#39;Weight&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;Weight |&#39;</span>
</span><span id="VectorDie.markdown-160"><a href="#VectorDie.markdown-160"><span class="linenos">160</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="VectorDie.markdown-161"><a href="#VectorDie.markdown-161"><span class="linenos">161</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39; Probability |&#39;</span>
</span><span id="VectorDie.markdown-162"><a href="#VectorDie.markdown-162"><span class="linenos">162</span></a>        <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="VectorDie.markdown-163"><a href="#VectorDie.markdown-163"><span class="linenos">163</span></a>        <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;|&#39;</span>
</span><span id="VectorDie.markdown-164"><a href="#VectorDie.markdown-164"><span class="linenos">164</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">()):</span>
</span><span id="VectorDie.markdown-165"><a href="#VectorDie.markdown-165"><span class="linenos">165</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="n">outcome_lengths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;:|&#39;</span>
</span><span id="VectorDie.markdown-166"><a href="#VectorDie.markdown-166"><span class="linenos">166</span></a>        <span class="k">if</span> <span class="n">include_weights</span><span class="p">:</span>
</span><span id="VectorDie.markdown-167"><a href="#VectorDie.markdown-167"><span class="linenos">167</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="n">weight_length</span> <span class="o">+</span> <span class="s1">&#39;:|&#39;</span>
</span><span id="VectorDie.markdown-168"><a href="#VectorDie.markdown-168"><span class="linenos">168</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="VectorDie.markdown-169"><a href="#VectorDie.markdown-169"><span class="linenos">169</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;------------:|&#39;</span>
</span><span id="VectorDie.markdown-170"><a href="#VectorDie.markdown-170"><span class="linenos">170</span></a>        <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="VectorDie.markdown-171"><a href="#VectorDie.markdown-171"><span class="linenos">171</span></a>        <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">pmf</span><span class="p">()):</span>
</span><span id="VectorDie.markdown-172"><a href="#VectorDie.markdown-172"><span class="linenos">172</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;|&#39;</span>
</span><span id="VectorDie.markdown-173"><a href="#VectorDie.markdown-173"><span class="linenos">173</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">outcome</span><span class="p">):</span>
</span><span id="VectorDie.markdown-174"><a href="#VectorDie.markdown-174"><span class="linenos">174</span></a>                <span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">:</span><span class="s1">&gt;</span><span class="si">{</span><span class="n">outcome_lengths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}}</span><span class="s1"> |&#39;</span>
</span><span id="VectorDie.markdown-175"><a href="#VectorDie.markdown-175"><span class="linenos">175</span></a>            <span class="k">if</span> <span class="n">include_weights</span><span class="p">:</span>
</span><span id="VectorDie.markdown-176"><a href="#VectorDie.markdown-176"><span class="linenos">176</span></a>                <span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">weight</span><span class="si">:</span><span class="s1">&gt;</span><span class="si">{</span><span class="n">weight_length</span><span class="si">}}</span><span class="s1"> |&#39;</span>
</span><span id="VectorDie.markdown-177"><a href="#VectorDie.markdown-177"><span class="linenos">177</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="VectorDie.markdown-178"><a href="#VectorDie.markdown-178"><span class="linenos">178</span></a>                <span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s1">11.6%</span><span class="si">}</span><span class="s1"> |&#39;</span>
</span><span id="VectorDie.markdown-179"><a href="#VectorDie.markdown-179"><span class="linenos">179</span></a>            <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="VectorDie.markdown-180"><a href="#VectorDie.markdown-180"><span class="linenos">180</span></a>        <span class="k">return</span> <span class="n">result</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Formats the die as a Markdown table.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#BaseDie">BaseDie</a></dt>
                                <dd id="VectorDie.outcomes" class="function"><a href="#BaseDie.outcomes">outcomes</a></dd>
                <dd id="VectorDie.num_outcomes" class="function"><a href="#BaseDie.num_outcomes">num_outcomes</a></dd>
                <dd id="VectorDie.is_empty" class="function"><a href="#BaseDie.is_empty">is_empty</a></dd>
                <dd id="VectorDie.weights" class="function"><a href="#BaseDie.weights">weights</a></dd>
                <dd id="VectorDie.has_zero_weights" class="function"><a href="#BaseDie.has_zero_weights">has_zero_weights</a></dd>
                <dd id="VectorDie.items" class="function"><a href="#BaseDie.items">items</a></dd>
                <dd id="VectorDie.denominator" class="function"><a href="#BaseDie.denominator">denominator</a></dd>
                <dd id="VectorDie.total_weight" class="function"><a href="#BaseDie.total_weight">total_weight</a></dd>
                <dd id="VectorDie.pmf" class="function"><a href="#BaseDie.pmf">pmf</a></dd>
                <dd id="VectorDie.cweights" class="function"><a href="#BaseDie.cweights">cweights</a></dd>
                <dd id="VectorDie.sweights" class="function"><a href="#BaseDie.sweights">sweights</a></dd>
                <dd id="VectorDie.cdf" class="function"><a href="#BaseDie.cdf">cdf</a></dd>
                <dd id="VectorDie.sf" class="function"><a href="#BaseDie.sf">sf</a></dd>
                <dd id="VectorDie.weight_eq" class="function"><a href="#BaseDie.weight_eq">weight_eq</a></dd>
                <dd id="VectorDie.weight_ne" class="function"><a href="#BaseDie.weight_ne">weight_ne</a></dd>
                <dd id="VectorDie.weight_le" class="function"><a href="#BaseDie.weight_le">weight_le</a></dd>
                <dd id="VectorDie.weight_lt" class="function"><a href="#BaseDie.weight_lt">weight_lt</a></dd>
                <dd id="VectorDie.weight_ge" class="function"><a href="#BaseDie.weight_ge">weight_ge</a></dd>
                <dd id="VectorDie.weight_gt" class="function"><a href="#BaseDie.weight_gt">weight_gt</a></dd>
                <dd id="VectorDie.probability" class="function"><a href="#BaseDie.probability">probability</a></dd>
                <dd id="VectorDie.mode" class="function"><a href="#BaseDie.mode">mode</a></dd>
                <dd id="VectorDie.modal_weight" class="function"><a href="#BaseDie.modal_weight">modal_weight</a></dd>
                <dd id="VectorDie.ks_stat" class="function"><a href="#BaseDie.ks_stat">ks_stat</a></dd>
                <dd id="VectorDie.cvm_stat" class="function"><a href="#BaseDie.cvm_stat">cvm_stat</a></dd>
                <dd id="VectorDie.reduce" class="function"><a href="#BaseDie.reduce">reduce</a></dd>
                <dd id="VectorDie.scale_weights" class="function"><a href="#BaseDie.scale_weights">scale_weights</a></dd>
                <dd id="VectorDie.min_outcome" class="function"><a href="#BaseDie.min_outcome">min_outcome</a></dd>
                <dd id="VectorDie.max_outcome" class="function"><a href="#BaseDie.max_outcome">max_outcome</a></dd>
                <dd id="VectorDie.nearest_le" class="function"><a href="#BaseDie.nearest_le">nearest_le</a></dd>
                <dd id="VectorDie.nearest_ge" class="function"><a href="#BaseDie.nearest_ge">nearest_ge</a></dd>
                <dd id="VectorDie.reroll" class="function"><a href="#BaseDie.reroll">reroll</a></dd>
                <dd id="VectorDie.reroll_until" class="function"><a href="#BaseDie.reroll_until">reroll_until</a></dd>
                <dd id="VectorDie.truncate" class="function"><a href="#BaseDie.truncate">truncate</a></dd>
                <dd id="VectorDie.clip" class="function"><a href="#BaseDie.clip">clip</a></dd>
                <dd id="VectorDie.cond" class="function"><a href="#BaseDie.cond">cond</a></dd>
                <dd id="VectorDie.set_outcomes" class="function"><a href="#BaseDie.set_outcomes">set_outcomes</a></dd>
                <dd id="VectorDie.trim" class="function"><a href="#BaseDie.trim">trim</a></dd>
                <dd id="VectorDie.sub" class="function"><a href="#BaseDie.sub">sub</a></dd>
                <dd id="VectorDie.explode" class="function"><a href="#BaseDie.explode">explode</a></dd>
                <dd id="VectorDie.lowest" class="function"><a href="#BaseDie.lowest">lowest</a></dd>
                <dd id="VectorDie.highest" class="function"><a href="#BaseDie.highest">highest</a></dd>
                <dd id="VectorDie.repeat_and_sum" class="function"><a href="#BaseDie.repeat_and_sum">repeat_and_sum</a></dd>
                <dd id="VectorDie.pool" class="function"><a href="#BaseDie.pool">pool</a></dd>
                <dd id="VectorDie.keep" class="function"><a href="#BaseDie.keep">keep</a></dd>
                <dd id="VectorDie.keep_highest" class="function"><a href="#BaseDie.keep_highest">keep_highest</a></dd>
                <dd id="VectorDie.keep_highest_single" class="function"><a href="#BaseDie.keep_highest_single">keep_highest_single</a></dd>
                <dd id="VectorDie.keep_lowest" class="function"><a href="#BaseDie.keep_lowest">keep_lowest</a></dd>
                <dd id="VectorDie.keep_lowest_single" class="function"><a href="#BaseDie.keep_lowest_single">keep_lowest_single</a></dd>
                <dd id="VectorDie.abs" class="function"><a href="#BaseDie.abs">abs</a></dd>
                <dd id="VectorDie.zero" class="function"><a href="#BaseDie.zero">zero</a></dd>
                <dd id="VectorDie.zero_outcome" class="function"><a href="#BaseDie.zero_outcome">zero_outcome</a></dd>
                <dd id="VectorDie.bool" class="function"><a href="#BaseDie.bool">bool</a></dd>
                <dd id="VectorDie.sign" class="function"><a href="#BaseDie.sign">sign</a></dd>
                <dd id="VectorDie.cmp" class="function"><a href="#BaseDie.cmp">cmp</a></dd>
                <dd id="VectorDie.sample" class="function"><a href="#BaseDie.sample">sample</a></dd>
                <dd id="VectorDie.key_tuple" class="function"><a href="#BaseDie.key_tuple">key_tuple</a></dd>
                <dd id="VectorDie.hash" class="function"><a href="#BaseDie.hash">hash</a></dd>
                <dd id="VectorDie.equals" class="function"><a href="#BaseDie.equals">equals</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="from_cweights">
                            <div class="attr function"><a class="headerlink" href="#from_cweights">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">from_cweights</span><span class="signature">(outcomes, cweights, *, ndim=None)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="from_cweights-61"><a href="#from_cweights-61"><span class="linenos">61</span></a><span class="k">def</span> <span class="nf">from_cweights</span><span class="p">(</span><span class="n">outcomes</span><span class="p">,</span> <span class="n">cweights</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="from_cweights-62"><a href="#from_cweights-62"><span class="linenos">62</span></a>    <span class="sd">&quot;&quot;&quot; Constructs a die from cumulative weights. &quot;&quot;&quot;</span>
</span><span id="from_cweights-63"><a href="#from_cweights-63"><span class="linenos">63</span></a>    <span class="n">prev</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="from_cweights-64"><a href="#from_cweights-64"><span class="linenos">64</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="from_cweights-65"><a href="#from_cweights-65"><span class="linenos">65</span></a>    <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">outcomes</span><span class="p">,</span> <span class="n">cweights</span><span class="p">):</span>
</span><span id="from_cweights-66"><a href="#from_cweights-66"><span class="linenos">66</span></a>        <span class="n">d</span><span class="p">[</span><span class="n">outcome</span><span class="p">]</span> <span class="o">=</span> <span class="n">weight</span> <span class="o">-</span> <span class="n">prev</span>
</span><span id="from_cweights-67"><a href="#from_cweights-67"><span class="linenos">67</span></a>        <span class="n">prev</span> <span class="o">=</span> <span class="n">weight</span>
</span><span id="from_cweights-68"><a href="#from_cweights-68"><span class="linenos">68</span></a>    <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Constructs a die from cumulative weights.</p>
</div>


                </section>
                <section id="from_sweights">
                            <div class="attr function"><a class="headerlink" href="#from_sweights">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">from_sweights</span><span class="signature">(outcomes, sweights, *, ndim=None)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="from_sweights-70"><a href="#from_sweights-70"><span class="linenos">70</span></a><span class="k">def</span> <span class="nf">from_sweights</span><span class="p">(</span><span class="n">outcomes</span><span class="p">,</span> <span class="n">sweights</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="from_sweights-71"><a href="#from_sweights-71"><span class="linenos">71</span></a>    <span class="sd">&quot;&quot;&quot; Constructs a die from survival weights. &quot;&quot;&quot;</span>
</span><span id="from_sweights-72"><a href="#from_sweights-72"><span class="linenos">72</span></a>    <span class="n">prev</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="from_sweights-73"><a href="#from_sweights-73"><span class="linenos">73</span></a>    <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="from_sweights-74"><a href="#from_sweights-74"><span class="linenos">74</span></a>    <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">outcomes</span><span class="p">),</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">sweights</span><span class="p">))):</span>
</span><span id="from_sweights-75"><a href="#from_sweights-75"><span class="linenos">75</span></a>        <span class="n">d</span><span class="p">[</span><span class="n">outcome</span><span class="p">]</span> <span class="o">=</span> <span class="n">weight</span> <span class="o">-</span> <span class="n">prev</span>
</span><span id="from_sweights-76"><a href="#from_sweights-76"><span class="linenos">76</span></a>        <span class="n">prev</span> <span class="o">=</span> <span class="n">weight</span>
</span><span id="from_sweights-77"><a href="#from_sweights-77"><span class="linenos">77</span></a>    <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Constructs a die from survival weights.</p>
</div>


                </section>
                <section id="from_rv">
                            <div class="attr function"><a class="headerlink" href="#from_rv">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">from_rv</span><span class="signature">(rv, outcomes, denominator, **kwargs)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="from_rv-79"><a href="#from_rv-79"><span class="linenos">79</span></a><span class="k">def</span> <span class="nf">from_rv</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="n">outcomes</span><span class="p">,</span> <span class="n">denominator</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="from_rv-80"><a href="#from_rv-80"><span class="linenos">80</span></a>    <span class="sd">&quot;&quot;&quot; Constructs a die from a rv object (as `scipy.stats`).</span>
</span><span id="from_rv-81"><a href="#from_rv-81"><span class="linenos">81</span></a><span class="sd">    Args:</span>
</span><span id="from_rv-82"><a href="#from_rv-82"><span class="linenos">82</span></a><span class="sd">        rv: A rv object (as `scipy.stats`).</span>
</span><span id="from_rv-83"><a href="#from_rv-83"><span class="linenos">83</span></a><span class="sd">        outcomes: An iterable of `int`s or `float`s that will be the outcomes of the resulting die.</span>
</span><span id="from_rv-84"><a href="#from_rv-84"><span class="linenos">84</span></a><span class="sd">            If the distribution is discrete, outcomes must be `int`s.</span>
</span><span id="from_rv-85"><a href="#from_rv-85"><span class="linenos">85</span></a><span class="sd">        denominator: The denominator of the resulting die will be set to this.</span>
</span><span id="from_rv-86"><a href="#from_rv-86"><span class="linenos">86</span></a><span class="sd">        **kwargs: These will be provided to `rv.cdf()`.</span>
</span><span id="from_rv-87"><a href="#from_rv-87"><span class="linenos">87</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="from_rv-88"><a href="#from_rv-88"><span class="linenos">88</span></a>    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="s1">&#39;pdf&#39;</span><span class="p">):</span>
</span><span id="from_rv-89"><a href="#from_rv-89"><span class="linenos">89</span></a>        <span class="c1"># Continuous distributions use midpoints.</span>
</span><span id="from_rv-90"><a href="#from_rv-90"><span class="linenos">90</span></a>        <span class="n">midpoints</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">outcomes</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">outcomes</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>
</span><span id="from_rv-91"><a href="#from_rv-91"><span class="linenos">91</span></a>        <span class="n">cdf</span> <span class="o">=</span> <span class="n">rv</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">midpoints</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="from_rv-92"><a href="#from_rv-92"><span class="linenos">92</span></a>        <span class="n">cweights</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">denominator</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cdf</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">denominator</span><span class="p">,)</span>
</span><span id="from_rv-93"><a href="#from_rv-93"><span class="linenos">93</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="from_rv-94"><a href="#from_rv-94"><span class="linenos">94</span></a>        <span class="n">cdf</span> <span class="o">=</span> <span class="n">rv</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">outcomes</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="from_rv-95"><a href="#from_rv-95"><span class="linenos">95</span></a>        <span class="n">cweights</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">denominator</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cdf</span><span class="p">)</span>
</span><span id="from_rv-96"><a href="#from_rv-96"><span class="linenos">96</span></a>    <span class="k">return</span> <span class="n">from_cweights</span><span class="p">(</span><span class="n">outcomes</span><span class="p">,</span> <span class="n">cweights</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Constructs a die from a rv object (as <code>scipy.stats</code>).</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>rv:</strong>  A rv object (as <code>scipy.stats</code>).</li>
<li><strong>outcomes:</strong>  An iterable of <code>int</code>s or <code>float</code>s that will be the outcomes of the resulting die.
If the distribution is discrete, outcomes must be <code>int</code>s.</li>
<li><strong>denominator:</strong>  The denominator of the resulting die will be set to this.</li>
<li><strong>**kwargs:</strong>  These will be provided to <code>rv.cdf()</code>.</li>
</ul>
</div>


                </section>
                <section id="align">
                            <div class="attr function"><a class="headerlink" href="#align">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">align</span><span class="signature">(*dice, ndim=None)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="align-98"><a href="#align-98"><span class="linenos"> 98</span></a><span class="k">def</span> <span class="nf">align</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="align-99"><a href="#align-99"><span class="linenos"> 99</span></a>    <span class="sd">&quot;&quot;&quot;Pads all the dice with zero weights so that all have the same set of outcomes.</span>
</span><span id="align-100"><a href="#align-100"><span class="linenos">100</span></a><span class="sd">    </span>
</span><span id="align-101"><a href="#align-101"><span class="linenos">101</span></a><span class="sd">    Args:</span>
</span><span id="align-102"><a href="#align-102"><span class="linenos">102</span></a><span class="sd">        *dice: Multiple dice or a single iterable of dice.</span>
</span><span id="align-103"><a href="#align-103"><span class="linenos">103</span></a><span class="sd">        ndim: The number of dimensions of the result.</span>
</span><span id="align-104"><a href="#align-104"><span class="linenos">104</span></a><span class="sd">    </span>
</span><span id="align-105"><a href="#align-105"><span class="linenos">105</span></a><span class="sd">    Returns:</span>
</span><span id="align-106"><a href="#align-106"><span class="linenos">106</span></a><span class="sd">        A tuple of aligned dice.</span>
</span><span id="align-107"><a href="#align-107"><span class="linenos">107</span></a><span class="sd">    </span>
</span><span id="align-108"><a href="#align-108"><span class="linenos">108</span></a><span class="sd">    Raises:</span>
</span><span id="align-109"><a href="#align-109"><span class="linenos">109</span></a><span class="sd">        `ValueError` if the dice are of mixed ndims.</span>
</span><span id="align-110"><a href="#align-110"><span class="linenos">110</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="align-111"><a href="#align-111"><span class="linenos">111</span></a>    <span class="n">dice</span><span class="p">,</span> <span class="n">ndim</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">dice_with_common_ndim</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">)</span>
</span><span id="align-112"><a href="#align-112"><span class="linenos">112</span></a>    <span class="n">outcomes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">))</span>
</span><span id="align-113"><a href="#align-113"><span class="linenos">113</span></a>    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">set_outcomes</span><span class="p">(</span><span class="n">outcomes</span><span class="p">)</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Pads all the dice with zero weights so that all have the same set of outcomes.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>*dice:</strong>  Multiple dice or a single iterable of dice.</li>
<li><strong>ndim:</strong>  The number of dimensions of the result.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A tuple of aligned dice.</p>
</blockquote>

<h6 id="raises">Raises</h6>

<ul>
<li><code>ValueError</code> if the dice are of mixed ndims.</li>
</ul>
</div>


                </section>
                <section id="align_range">
                            <div class="attr function"><a class="headerlink" href="#align_range">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">align_range</span><span class="signature">(*dice)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="align_range-115"><a href="#align_range-115"><span class="linenos">115</span></a><span class="k">def</span> <span class="nf">align_range</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">):</span>
</span><span id="align_range-116"><a href="#align_range-116"><span class="linenos">116</span></a>    <span class="sd">&quot;&quot;&quot;Pads all the dice with zero weights so that all have the same set of consecutive `int` outcomes. &quot;&quot;&quot;</span>
</span><span id="align_range-117"><a href="#align_range-117"><span class="linenos">117</span></a>    <span class="n">dice</span><span class="p">,</span> <span class="n">ndim</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">dice_with_common_ndim</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="s1">&#39;scalar&#39;</span><span class="p">)</span>
</span><span id="align_range-118"><a href="#align_range-118"><span class="linenos">118</span></a>    <span class="n">outcomes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">min_outcome</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">),</span> <span class="n">icepool</span><span class="o">.</span><span class="n">max_outcome</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="align_range-119"><a href="#align_range-119"><span class="linenos">119</span></a>    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">set_outcomes</span><span class="p">(</span><span class="n">outcomes</span><span class="p">)</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Pads all the dice with zero weights so that all have the same set of consecutive <code>int</code> outcomes.</p>
</div>


                </section>
                <section id="lowest">
                            <div class="attr function"><a class="headerlink" href="#lowest">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">lowest</span><span class="signature">(*dice)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="lowest-529"><a href="#lowest-529"><span class="linenos">529</span></a>    <span class="k">def</span> <span class="nf">lowest</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">):</span>
</span><span id="lowest-530"><a href="#lowest-530"><span class="linenos">530</span></a>        <span class="sd">&quot;&quot;&quot; Roll all the dice and take the lowest.</span>
</span><span id="lowest-531"><a href="#lowest-531"><span class="linenos">531</span></a><span class="sd">        </span>
</span><span id="lowest-532"><a href="#lowest-532"><span class="linenos">532</span></a><span class="sd">        The maximum outcome is equal to the highest maximum outcome among all input dice.</span>
</span><span id="lowest-533"><a href="#lowest-533"><span class="linenos">533</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="lowest-534"><a href="#lowest-534"><span class="linenos">534</span></a>        <span class="n">dice</span><span class="p">,</span> <span class="n">ndim</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">dice_with_common_ndim</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">)</span>
</span><span id="lowest-535"><a href="#lowest-535"><span class="linenos">535</span></a>        <span class="n">max_outcome</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">max_outcome</span><span class="p">()</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">)</span>
</span><span id="lowest-536"><a href="#lowest-536"><span class="linenos">536</span></a>        <span class="n">dice</span> <span class="o">=</span> <span class="p">[</span><span class="n">die</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">max_outcome</span><span class="o">=</span><span class="n">max_outcome</span><span class="p">)</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">]</span>
</span><span id="lowest-537"><a href="#lowest-537"><span class="linenos">537</span></a>        <span class="n">dice</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">)</span>
</span><span id="lowest-538"><a href="#lowest-538"><span class="linenos">538</span></a>        <span class="n">sweights</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">sweights</span><span class="p">()</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">)))</span>
</span><span id="lowest-539"><a href="#lowest-539"><span class="linenos">539</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">from_sweights</span><span class="p">(</span><span class="n">dice</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="n">sweights</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Roll all the dice and take the lowest.</p>

<p>The maximum outcome is equal to the highest maximum outcome among all input dice.</p>
</div>


                </section>
                <section id="highest">
                            <div class="attr function"><a class="headerlink" href="#highest">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">highest</span><span class="signature">(*dice)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="highest-541"><a href="#highest-541"><span class="linenos">541</span></a>    <span class="k">def</span> <span class="nf">highest</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">):</span>
</span><span id="highest-542"><a href="#highest-542"><span class="linenos">542</span></a>        <span class="sd">&quot;&quot;&quot; Roll all the dice and take the highest.</span>
</span><span id="highest-543"><a href="#highest-543"><span class="linenos">543</span></a><span class="sd">        </span>
</span><span id="highest-544"><a href="#highest-544"><span class="linenos">544</span></a><span class="sd">        The minimum outcome is equal to the highest minimum outcome among all input dice.</span>
</span><span id="highest-545"><a href="#highest-545"><span class="linenos">545</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="highest-546"><a href="#highest-546"><span class="linenos">546</span></a>        <span class="n">dice</span><span class="p">,</span> <span class="n">ndim</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">dice_with_common_ndim</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">)</span>
</span><span id="highest-547"><a href="#highest-547"><span class="linenos">547</span></a>        <span class="n">min_outcome</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">min_outcome</span><span class="p">()</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">)</span>
</span><span id="highest-548"><a href="#highest-548"><span class="linenos">548</span></a>        <span class="n">dice</span> <span class="o">=</span> <span class="p">[</span><span class="n">die</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">min_outcome</span><span class="o">=</span><span class="n">min_outcome</span><span class="p">)</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">]</span>
</span><span id="highest-549"><a href="#highest-549"><span class="linenos">549</span></a>        <span class="n">dice</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">)</span>
</span><span id="highest-550"><a href="#highest-550"><span class="linenos">550</span></a>        <span class="n">cweights</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">cweights</span><span class="p">()</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">)))</span>
</span><span id="highest-551"><a href="#highest-551"><span class="linenos">551</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">from_cweights</span><span class="p">(</span><span class="n">dice</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">outcomes</span><span class="p">(),</span> <span class="n">cweights</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Roll all the dice and take the highest.</p>

<p>The minimum outcome is equal to the highest minimum outcome among all input dice.</p>
</div>


                </section>
                <section id="max_outcome">
                            <div class="attr function"><a class="headerlink" href="#max_outcome">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">max_outcome</span><span class="signature">(*dice)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="max_outcome-276"><a href="#max_outcome-276"><span class="linenos">276</span></a>    <span class="k">def</span> <span class="nf">max_outcome</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">):</span>
</span><span id="max_outcome-277"><a href="#max_outcome-277"><span class="linenos">277</span></a>        <span class="sd">&quot;&quot;&quot; Returns the maximum possible outcome among the dice. &quot;&quot;&quot;</span>
</span><span id="max_outcome-278"><a href="#max_outcome-278"><span class="linenos">278</span></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns the maximum possible outcome among the dice.</p>
</div>


                </section>
                <section id="min_outcome">
                            <div class="attr function"><a class="headerlink" href="#min_outcome">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">min_outcome</span><span class="signature">(*dice)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="min_outcome-272"><a href="#min_outcome-272"><span class="linenos">272</span></a>    <span class="k">def</span> <span class="nf">min_outcome</span><span class="p">(</span><span class="o">*</span><span class="n">dice</span><span class="p">):</span>
</span><span id="min_outcome-273"><a href="#min_outcome-273"><span class="linenos">273</span></a>        <span class="sd">&quot;&quot;&quot; Returns the minimum possible outcome among the dice. &quot;&quot;&quot;</span>
</span><span id="min_outcome-274"><a href="#min_outcome-274"><span class="linenos">274</span></a>        <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns the minimum possible outcome among the dice.</p>
</div>


                </section>
                <section id="apply">
                            <div class="attr function"><a class="headerlink" href="#apply">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">apply</span><span class="signature">(func, *dice, ndim=None)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="apply-121"><a href="#apply-121"><span class="linenos">121</span></a><span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">dice</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="apply-122"><a href="#apply-122"><span class="linenos">122</span></a>    <span class="sd">&quot;&quot;&quot; Applies `func(outcome_of_die_0, outcome_of_die_1, ...)` for all possible outcomes of the dice.</span>
</span><span id="apply-123"><a href="#apply-123"><span class="linenos">123</span></a><span class="sd">    </span>
</span><span id="apply-124"><a href="#apply-124"><span class="linenos">124</span></a><span class="sd">    This is flexible but not very efficient for large numbers of dice.</span>
</span><span id="apply-125"><a href="#apply-125"><span class="linenos">125</span></a><span class="sd">    In particular, for pools use `icepool.Pool` and `icepool.EvalPool` instead if possible.</span>
</span><span id="apply-126"><a href="#apply-126"><span class="linenos">126</span></a><span class="sd">    </span>
</span><span id="apply-127"><a href="#apply-127"><span class="linenos">127</span></a><span class="sd">    Args:</span>
</span><span id="apply-128"><a href="#apply-128"><span class="linenos">128</span></a><span class="sd">        func: A function that takes one argument per input die and returns an argument to `Die()`.</span>
</span><span id="apply-129"><a href="#apply-129"><span class="linenos">129</span></a><span class="sd">        ndim: If supplied, the result will have this many dimensions.</span>
</span><span id="apply-130"><a href="#apply-130"><span class="linenos">130</span></a><span class="sd">    </span>
</span><span id="apply-131"><a href="#apply-131"><span class="linenos">131</span></a><span class="sd">    Returns:</span>
</span><span id="apply-132"><a href="#apply-132"><span class="linenos">132</span></a><span class="sd">        A die constructed from the outputs of `func` and the product of the weights of the dice.</span>
</span><span id="apply-133"><a href="#apply-133"><span class="linenos">133</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="apply-134"><a href="#apply-134"><span class="linenos">134</span></a>    <span class="c1"># No common ndim required for the inputs in this case.</span>
</span><span id="apply-135"><a href="#apply-135"><span class="linenos">135</span></a>    <span class="n">dice</span> <span class="o">=</span> <span class="p">[</span><span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="n">die</span><span class="p">)</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">]</span>
</span><span id="apply-136"><a href="#apply-136"><span class="linenos">136</span></a>    <span class="n">final_outcomes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="apply-137"><a href="#apply-137"><span class="linenos">137</span></a>    <span class="n">final_weights</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="apply-138"><a href="#apply-138"><span class="linenos">138</span></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="apply-139"><a href="#apply-139"><span class="linenos">139</span></a>    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">for</span> <span class="n">die</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">)):</span>
</span><span id="apply-140"><a href="#apply-140"><span class="linenos">140</span></a>        <span class="n">outcomes</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
</span><span id="apply-141"><a href="#apply-141"><span class="linenos">141</span></a>        <span class="n">final_outcome</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">outcomes</span><span class="p">)</span>
</span><span id="apply-142"><a href="#apply-142"><span class="linenos">142</span></a>        <span class="n">final_weight</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
</span><span id="apply-143"><a href="#apply-143"><span class="linenos">143</span></a>        <span class="k">if</span> <span class="n">final_outcome</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Reroll</span><span class="p">:</span>
</span><span id="apply-144"><a href="#apply-144"><span class="linenos">144</span></a>            <span class="n">final_outcomes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">final_outcome</span><span class="p">)</span>
</span><span id="apply-145"><a href="#apply-145"><span class="linenos">145</span></a>            <span class="n">final_weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">final_weight</span><span class="p">)</span>
</span><span id="apply-146"><a href="#apply-146"><span class="linenos">146</span></a>    
</span><span id="apply-147"><a href="#apply-147"><span class="linenos">147</span></a>    <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="o">*</span><span class="n">final_outcomes</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">final_weights</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Applies <code>func(outcome_of_die_0, outcome_of_die_1, ...)</code> for all possible outcomes of the dice.</p>

<p>This is flexible but not very efficient for large numbers of dice.
In particular, for pools use <code><a href="#Pool">icepool.Pool</a></code> and <code><a href="#EvalPool">icepool.EvalPool</a></code> instead if possible.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>func:</strong>  A function that takes one argument per input die and returns an argument to <code><a href="#Die">Die()</a></code>.</li>
<li><strong>ndim:</strong>  If supplied, the result will have this many dimensions.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A die constructed from the outputs of <code>func</code> and the product of the weights of the dice.</p>
</blockquote>
</div>


                </section>
                <section id="dice_with_common_ndim">
                            <div class="attr function"><a class="headerlink" href="#dice_with_common_ndim">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">dice_with_common_ndim</span><span class="signature">(*args, ndim=None)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="dice_with_common_ndim-228"><a href="#dice_with_common_ndim-228"><span class="linenos">228</span></a><span class="k">def</span> <span class="nf">dice_with_common_ndim</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="dice_with_common_ndim-229"><a href="#dice_with_common_ndim-229"><span class="linenos">229</span></a>    <span class="sd">&quot;&quot;&quot; Converts the arguments to dice with a common `ndim`.</span>
</span><span id="dice_with_common_ndim-230"><a href="#dice_with_common_ndim-230"><span class="linenos">230</span></a><span class="sd">    </span>
</span><span id="dice_with_common_ndim-231"><a href="#dice_with_common_ndim-231"><span class="linenos">231</span></a><span class="sd">    Args:</span>
</span><span id="dice_with_common_ndim-232"><a href="#dice_with_common_ndim-232"><span class="linenos">232</span></a><span class="sd">        *args: Args to be converted to dice.</span>
</span><span id="dice_with_common_ndim-233"><a href="#dice_with_common_ndim-233"><span class="linenos">233</span></a><span class="sd">        ndim: The required `ndim` of the results.</span>
</span><span id="dice_with_common_ndim-234"><a href="#dice_with_common_ndim-234"><span class="linenos">234</span></a><span class="sd">    </span>
</span><span id="dice_with_common_ndim-235"><a href="#dice_with_common_ndim-235"><span class="linenos">235</span></a><span class="sd">    Returns:</span>
</span><span id="dice_with_common_ndim-236"><a href="#dice_with_common_ndim-236"><span class="linenos">236</span></a><span class="sd">        dice, ndim: A tuple containing one die per arg, and the common `ndim`,</span>
</span><span id="dice_with_common_ndim-237"><a href="#dice_with_common_ndim-237"><span class="linenos">237</span></a><span class="sd">    </span>
</span><span id="dice_with_common_ndim-238"><a href="#dice_with_common_ndim-238"><span class="linenos">238</span></a><span class="sd">    Raises:</span>
</span><span id="dice_with_common_ndim-239"><a href="#dice_with_common_ndim-239"><span class="linenos">239</span></a><span class="sd">        `ValueError` if the arguments include conflicting `ndim`s.</span>
</span><span id="dice_with_common_ndim-240"><a href="#dice_with_common_ndim-240"><span class="linenos">240</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="dice_with_common_ndim-241"><a href="#dice_with_common_ndim-241"><span class="linenos">241</span></a>    <span class="n">ndim</span> <span class="o">=</span> <span class="n">_calc_ndim</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">)</span>
</span><span id="dice_with_common_ndim-242"><a href="#dice_with_common_ndim-242"><span class="linenos">242</span></a>    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">Die</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="n">ndim</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">),</span> <span class="n">ndim</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Converts the arguments to dice with a common <code>ndim</code>.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>*args:</strong>  Args to be converted to dice.</li>
<li><strong>ndim:</strong>  The required <code>ndim</code> of the results.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>dice, ndim: A tuple containing one die per arg, and the common <code>ndim</code>,</p>
</blockquote>

<h6 id="raises">Raises</h6>

<ul>
<li><code>ValueError</code> if the arguments include conflicting <code>ndim</code>s.</li>
</ul>
</div>


                </section>
                <section id="Reroll">
                                <div class="attr variable"><a class="headerlink" href="#Reroll">#&nbsp;&nbsp</a>

        <span class="name">Reroll</span><span class="default_value"> = &lt;SpecialValue.Reroll: &#39;Reroll&#39;&gt;</span>
    </div>

    
    

                </section>
                <section id="BasePool">
                                <div class="attr class">
        <a class="headerlink" href="#BasePool">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">BasePool</span><wbr>(<span class="base">abc.ABC</span>):
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BasePool-7"><a href="#BasePool-7"><span class="linenos">  7</span></a><span class="k">class</span> <span class="nc">BasePool</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="BasePool-8"><a href="#BasePool-8"><span class="linenos">  8</span></a>    <span class="sd">&quot;&quot;&quot; Abstract base class for dice pools.</span>
</span><span id="BasePool-9"><a href="#BasePool-9"><span class="linenos">  9</span></a><span class="sd">    </span>
</span><span id="BasePool-10"><a href="#BasePool-10"><span class="linenos"> 10</span></a><span class="sd">    This provides the methods needed to run the dice pool algorithm.</span>
</span><span id="BasePool-11"><a href="#BasePool-11"><span class="linenos"> 11</span></a><span class="sd">    </span>
</span><span id="BasePool-12"><a href="#BasePool-12"><span class="linenos"> 12</span></a><span class="sd">    There are two subclasses:</span>
</span><span id="BasePool-13"><a href="#BasePool-13"><span class="linenos"> 13</span></a><span class="sd">    </span>
</span><span id="BasePool-14"><a href="#BasePool-14"><span class="linenos"> 14</span></a><span class="sd">    * `DicePool`, which represents a pool of dice with random results.</span>
</span><span id="BasePool-15"><a href="#BasePool-15"><span class="linenos"> 15</span></a><span class="sd">    * `PoolRoll`, which represents a single, fixed roll of a pool.</span>
</span><span id="BasePool-16"><a href="#BasePool-16"><span class="linenos"> 16</span></a><span class="sd">        `PoolRoll` is only needed internally, as external dicts and sequences </span>
</span><span id="BasePool-17"><a href="#BasePool-17"><span class="linenos"> 17</span></a><span class="sd">        will be implicitly cast to `PoolRoll` in `EvalPool.eval()`.</span>
</span><span id="BasePool-18"><a href="#BasePool-18"><span class="linenos"> 18</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="BasePool-19"><a href="#BasePool-19"><span class="linenos"> 19</span></a>    
</span><span id="BasePool-20"><a href="#BasePool-20"><span class="linenos"> 20</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BasePool-21"><a href="#BasePool-21"><span class="linenos"> 21</span></a>    <span class="k">def</span> <span class="nf">_is_single_roll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BasePool-22"><a href="#BasePool-22"><span class="linenos"> 22</span></a>        <span class="sd">&quot;&quot;&quot; Returns `True` iff this is a single, fixed roll of a pool. &quot;&quot;&quot;</span>
</span><span id="BasePool-23"><a href="#BasePool-23"><span class="linenos"> 23</span></a>    
</span><span id="BasePool-24"><a href="#BasePool-24"><span class="linenos"> 24</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BasePool-25"><a href="#BasePool-25"><span class="linenos"> 25</span></a>    <span class="k">def</span> <span class="nf">_has_truncate_min</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BasePool-26"><a href="#BasePool-26"><span class="linenos"> 26</span></a>        <span class="sd">&quot;&quot;&quot; Returns `True` iff the pool has truncated min outcomes. &quot;&quot;&quot;</span>
</span><span id="BasePool-27"><a href="#BasePool-27"><span class="linenos"> 27</span></a>    
</span><span id="BasePool-28"><a href="#BasePool-28"><span class="linenos"> 28</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BasePool-29"><a href="#BasePool-29"><span class="linenos"> 29</span></a>    <span class="k">def</span> <span class="nf">_has_truncate_max</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BasePool-30"><a href="#BasePool-30"><span class="linenos"> 30</span></a>        <span class="sd">&quot;&quot;&quot; Returns `True` iff the pool has truncated max outcomes. &quot;&quot;&quot;</span>
</span><span id="BasePool-31"><a href="#BasePool-31"><span class="linenos"> 31</span></a>    
</span><span id="BasePool-32"><a href="#BasePool-32"><span class="linenos"> 32</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BasePool-33"><a href="#BasePool-33"><span class="linenos"> 33</span></a>    <span class="k">def</span> <span class="nf">outcomes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BasePool-34"><a href="#BasePool-34"><span class="linenos"> 34</span></a>        <span class="sd">&quot;&quot;&quot; The outcomes of the fundamental die (including those with zero weight). &quot;&quot;&quot;</span>
</span><span id="BasePool-35"><a href="#BasePool-35"><span class="linenos"> 35</span></a>    
</span><span id="BasePool-36"><a href="#BasePool-36"><span class="linenos"> 36</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BasePool-37"><a href="#BasePool-37"><span class="linenos"> 37</span></a>    <span class="k">def</span> <span class="nf">_min_outcome</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BasePool-38"><a href="#BasePool-38"><span class="linenos"> 38</span></a>        <span class="sd">&quot;&quot;&quot; The minimum outcome of the fundamental die. &quot;&quot;&quot;</span>
</span><span id="BasePool-39"><a href="#BasePool-39"><span class="linenos"> 39</span></a>    
</span><span id="BasePool-40"><a href="#BasePool-40"><span class="linenos"> 40</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BasePool-41"><a href="#BasePool-41"><span class="linenos"> 41</span></a>    <span class="k">def</span> <span class="nf">_max_outcome</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BasePool-42"><a href="#BasePool-42"><span class="linenos"> 42</span></a>        <span class="sd">&quot;&quot;&quot; The maximum outcome of the fundamental die. &quot;&quot;&quot;</span>
</span><span id="BasePool-43"><a href="#BasePool-43"><span class="linenos"> 43</span></a>        
</span><span id="BasePool-44"><a href="#BasePool-44"><span class="linenos"> 44</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BasePool-45"><a href="#BasePool-45"><span class="linenos"> 45</span></a>    <span class="k">def</span> <span class="nf">_direction_score_ascending</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BasePool-46"><a href="#BasePool-46"><span class="linenos"> 46</span></a>        <span class="sd">&quot;&quot;&quot; Returns a number indicating how preferred iterating in the ascending direction is.</span>
</span><span id="BasePool-47"><a href="#BasePool-47"><span class="linenos"> 47</span></a><span class="sd">        </span>
</span><span id="BasePool-48"><a href="#BasePool-48"><span class="linenos"> 48</span></a><span class="sd">        This is only called when there is no truncation.</span>
</span><span id="BasePool-49"><a href="#BasePool-49"><span class="linenos"> 49</span></a><span class="sd">        </span>
</span><span id="BasePool-50"><a href="#BasePool-50"><span class="linenos"> 50</span></a><span class="sd">        If the pool does not care at all about direction, the result is 0.</span>
</span><span id="BasePool-51"><a href="#BasePool-51"><span class="linenos"> 51</span></a><span class="sd">        </span>
</span><span id="BasePool-52"><a href="#BasePool-52"><span class="linenos"> 52</span></a><span class="sd">        The collective score is summed.</span>
</span><span id="BasePool-53"><a href="#BasePool-53"><span class="linenos"> 53</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BasePool-54"><a href="#BasePool-54"><span class="linenos"> 54</span></a>    
</span><span id="BasePool-55"><a href="#BasePool-55"><span class="linenos"> 55</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BasePool-56"><a href="#BasePool-56"><span class="linenos"> 56</span></a>    <span class="k">def</span> <span class="nf">_direction_score_descending</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BasePool-57"><a href="#BasePool-57"><span class="linenos"> 57</span></a>        <span class="sd">&quot;&quot;&quot; Returns a number indicating how preferred iterating in the descending direction is.</span>
</span><span id="BasePool-58"><a href="#BasePool-58"><span class="linenos"> 58</span></a><span class="sd">        </span>
</span><span id="BasePool-59"><a href="#BasePool-59"><span class="linenos"> 59</span></a><span class="sd">        This is only called when there is no truncation.</span>
</span><span id="BasePool-60"><a href="#BasePool-60"><span class="linenos"> 60</span></a><span class="sd">        </span>
</span><span id="BasePool-61"><a href="#BasePool-61"><span class="linenos"> 61</span></a><span class="sd">        If the pool does not care at all about direction, the result is 0.</span>
</span><span id="BasePool-62"><a href="#BasePool-62"><span class="linenos"> 62</span></a><span class="sd">        </span>
</span><span id="BasePool-63"><a href="#BasePool-63"><span class="linenos"> 63</span></a><span class="sd">        The collective score is summed.</span>
</span><span id="BasePool-64"><a href="#BasePool-64"><span class="linenos"> 64</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BasePool-65"><a href="#BasePool-65"><span class="linenos"> 65</span></a>    
</span><span id="BasePool-66"><a href="#BasePool-66"><span class="linenos"> 66</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BasePool-67"><a href="#BasePool-67"><span class="linenos"> 67</span></a>    <span class="k">def</span> <span class="nf">_pop_min</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BasePool-68"><a href="#BasePool-68"><span class="linenos"> 68</span></a>        <span class="sd">&quot;&quot;&quot; Returns a sequence of pool, count, weight corresponding to removing the min outcome,</span>
</span><span id="BasePool-69"><a href="#BasePool-69"><span class="linenos"> 69</span></a><span class="sd">        with count and weight corresponding to various numbers of dice rolling that outcome.</span>
</span><span id="BasePool-70"><a href="#BasePool-70"><span class="linenos"> 70</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BasePool-71"><a href="#BasePool-71"><span class="linenos"> 71</span></a>    
</span><span id="BasePool-72"><a href="#BasePool-72"><span class="linenos"> 72</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BasePool-73"><a href="#BasePool-73"><span class="linenos"> 73</span></a>    <span class="k">def</span> <span class="nf">_pop_max</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BasePool-74"><a href="#BasePool-74"><span class="linenos"> 74</span></a>        <span class="sd">&quot;&quot;&quot; Returns a sequence of pool, count, weight corresponding to removing the max outcome,</span>
</span><span id="BasePool-75"><a href="#BasePool-75"><span class="linenos"> 75</span></a><span class="sd">        with count and weight corresponding to various numbers of dice rolling that outcome.</span>
</span><span id="BasePool-76"><a href="#BasePool-76"><span class="linenos"> 76</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BasePool-77"><a href="#BasePool-77"><span class="linenos"> 77</span></a>    
</span><span id="BasePool-78"><a href="#BasePool-78"><span class="linenos"> 78</span></a>    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eval_or_func</span><span class="p">,</span> <span class="o">/</span><span class="p">):</span>
</span><span id="BasePool-79"><a href="#BasePool-79"><span class="linenos"> 79</span></a>        <span class="sd">&quot;&quot;&quot; Evaluates this pool using the given `EvalPool` or function.</span>
</span><span id="BasePool-80"><a href="#BasePool-80"><span class="linenos"> 80</span></a><span class="sd">        </span>
</span><span id="BasePool-81"><a href="#BasePool-81"><span class="linenos"> 81</span></a><span class="sd">        Note that each `EvalPool` instance carries its own cache;</span>
</span><span id="BasePool-82"><a href="#BasePool-82"><span class="linenos"> 82</span></a><span class="sd">        if you plan to use an evaluation multiple times,</span>
</span><span id="BasePool-83"><a href="#BasePool-83"><span class="linenos"> 83</span></a><span class="sd">        you may want to explicitly create an `EvalPool` instance</span>
</span><span id="BasePool-84"><a href="#BasePool-84"><span class="linenos"> 84</span></a><span class="sd">        rather than passing a function to this method directly.</span>
</span><span id="BasePool-85"><a href="#BasePool-85"><span class="linenos"> 85</span></a><span class="sd">        </span>
</span><span id="BasePool-86"><a href="#BasePool-86"><span class="linenos"> 86</span></a><span class="sd">        Args:</span>
</span><span id="BasePool-87"><a href="#BasePool-87"><span class="linenos"> 87</span></a><span class="sd">            func: This can be an `EvalPool`, in which case it evaluates the pool directly.</span>
</span><span id="BasePool-88"><a href="#BasePool-88"><span class="linenos"> 88</span></a><span class="sd">                Or it can be a `EvalPool.next_state()`-like function,</span>
</span><span id="BasePool-89"><a href="#BasePool-89"><span class="linenos"> 89</span></a><span class="sd">                taking in `state, outcome, *counts` and returning the next state.</span>
</span><span id="BasePool-90"><a href="#BasePool-90"><span class="linenos"> 90</span></a><span class="sd">                In this case a temporary `WrapFuncEval` is constructed and used to evaluate this pool.</span>
</span><span id="BasePool-91"><a href="#BasePool-91"><span class="linenos"> 91</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BasePool-92"><a href="#BasePool-92"><span class="linenos"> 92</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eval_or_func</span><span class="p">,</span> <span class="n">icepool</span><span class="o">.</span><span class="n">EvalPool</span><span class="p">):</span>
</span><span id="BasePool-93"><a href="#BasePool-93"><span class="linenos"> 93</span></a>            <span class="n">eval_or_func</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">WrapFuncEval</span><span class="p">(</span><span class="n">eval_or_func</span><span class="p">)</span>
</span><span id="BasePool-94"><a href="#BasePool-94"><span class="linenos"> 94</span></a>        <span class="k">return</span> <span class="n">eval_or_func</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="BasePool-95"><a href="#BasePool-95"><span class="linenos"> 95</span></a>
</span><span id="BasePool-96"><a href="#BasePool-96"><span class="linenos"> 96</span></a>    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BasePool-97"><a href="#BasePool-97"><span class="linenos"> 97</span></a>        <span class="sd">&quot;&quot;&quot; Convenience method to simply sum the dice in this pool.</span>
</span><span id="BasePool-98"><a href="#BasePool-98"><span class="linenos"> 98</span></a><span class="sd">        </span>
</span><span id="BasePool-99"><a href="#BasePool-99"><span class="linenos"> 99</span></a><span class="sd">        This uses `icepool.sum_pool`.</span>
</span><span id="BasePool-100"><a href="#BasePool-100"><span class="linenos">100</span></a><span class="sd">        </span>
</span><span id="BasePool-101"><a href="#BasePool-101"><span class="linenos">101</span></a><span class="sd">        Returns:</span>
</span><span id="BasePool-102"><a href="#BasePool-102"><span class="linenos">102</span></a><span class="sd">            A die representing the sum.</span>
</span><span id="BasePool-103"><a href="#BasePool-103"><span class="linenos">103</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BasePool-104"><a href="#BasePool-104"><span class="linenos">104</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">sum_pool</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Abstract base class for dice pools.</p>

<p>This provides the methods needed to run the dice pool algorithm.</p>

<p>There are two subclasses:</p>

<ul>
<li><code><a href="#DicePool">DicePool</a></code>, which represents a pool of dice with random results.</li>
<li><code>PoolRoll</code>, which represents a single, fixed roll of a pool.
<code>PoolRoll</code> is only needed internally, as external dicts and sequences 
will be implicitly cast to <code>PoolRoll</code> in <code><a href="#EvalPool.eval">EvalPool.eval()</a></code>.</li>
</ul>
</div>


                            <div id="BasePool.outcomes" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BasePool.outcomes">#&nbsp;&nbsp</a>

                <div class="decorator">@abstractmethod</div>

            <span class="def">def</span>
            <span class="name">outcomes</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BasePool.outcomes-32"><a href="#BasePool.outcomes-32"><span class="linenos">32</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BasePool.outcomes-33"><a href="#BasePool.outcomes-33"><span class="linenos">33</span></a>    <span class="k">def</span> <span class="nf">outcomes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BasePool.outcomes-34"><a href="#BasePool.outcomes-34"><span class="linenos">34</span></a>        <span class="sd">&quot;&quot;&quot; The outcomes of the fundamental die (including those with zero weight). &quot;&quot;&quot;</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>The outcomes of the fundamental die (including those with zero weight).</p>
</div>


                            </div>
                            <div id="BasePool.eval" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BasePool.eval">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">eval</span><span class="signature">(self, eval_or_func, /)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BasePool.eval-78"><a href="#BasePool.eval-78"><span class="linenos">78</span></a>    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eval_or_func</span><span class="p">,</span> <span class="o">/</span><span class="p">):</span>
</span><span id="BasePool.eval-79"><a href="#BasePool.eval-79"><span class="linenos">79</span></a>        <span class="sd">&quot;&quot;&quot; Evaluates this pool using the given `EvalPool` or function.</span>
</span><span id="BasePool.eval-80"><a href="#BasePool.eval-80"><span class="linenos">80</span></a><span class="sd">        </span>
</span><span id="BasePool.eval-81"><a href="#BasePool.eval-81"><span class="linenos">81</span></a><span class="sd">        Note that each `EvalPool` instance carries its own cache;</span>
</span><span id="BasePool.eval-82"><a href="#BasePool.eval-82"><span class="linenos">82</span></a><span class="sd">        if you plan to use an evaluation multiple times,</span>
</span><span id="BasePool.eval-83"><a href="#BasePool.eval-83"><span class="linenos">83</span></a><span class="sd">        you may want to explicitly create an `EvalPool` instance</span>
</span><span id="BasePool.eval-84"><a href="#BasePool.eval-84"><span class="linenos">84</span></a><span class="sd">        rather than passing a function to this method directly.</span>
</span><span id="BasePool.eval-85"><a href="#BasePool.eval-85"><span class="linenos">85</span></a><span class="sd">        </span>
</span><span id="BasePool.eval-86"><a href="#BasePool.eval-86"><span class="linenos">86</span></a><span class="sd">        Args:</span>
</span><span id="BasePool.eval-87"><a href="#BasePool.eval-87"><span class="linenos">87</span></a><span class="sd">            func: This can be an `EvalPool`, in which case it evaluates the pool directly.</span>
</span><span id="BasePool.eval-88"><a href="#BasePool.eval-88"><span class="linenos">88</span></a><span class="sd">                Or it can be a `EvalPool.next_state()`-like function,</span>
</span><span id="BasePool.eval-89"><a href="#BasePool.eval-89"><span class="linenos">89</span></a><span class="sd">                taking in `state, outcome, *counts` and returning the next state.</span>
</span><span id="BasePool.eval-90"><a href="#BasePool.eval-90"><span class="linenos">90</span></a><span class="sd">                In this case a temporary `WrapFuncEval` is constructed and used to evaluate this pool.</span>
</span><span id="BasePool.eval-91"><a href="#BasePool.eval-91"><span class="linenos">91</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BasePool.eval-92"><a href="#BasePool.eval-92"><span class="linenos">92</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eval_or_func</span><span class="p">,</span> <span class="n">icepool</span><span class="o">.</span><span class="n">EvalPool</span><span class="p">):</span>
</span><span id="BasePool.eval-93"><a href="#BasePool.eval-93"><span class="linenos">93</span></a>            <span class="n">eval_or_func</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">WrapFuncEval</span><span class="p">(</span><span class="n">eval_or_func</span><span class="p">)</span>
</span><span id="BasePool.eval-94"><a href="#BasePool.eval-94"><span class="linenos">94</span></a>        <span class="k">return</span> <span class="n">eval_or_func</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Evaluates this pool using the given <code><a href="#EvalPool">EvalPool</a></code> or function.</p>

<p>Note that each <code><a href="#EvalPool">EvalPool</a></code> instance carries its own cache;
if you plan to use an evaluation multiple times,
you may want to explicitly create an <code><a href="#EvalPool">EvalPool</a></code> instance
rather than passing a function to this method directly.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>func:</strong>  This can be an <code><a href="#EvalPool">EvalPool</a></code>, in which case it evaluates the pool directly.
Or it can be a <code><a href="#EvalPool.next_state">EvalPool.next_state()</a></code>-like function,
taking in <code>state, outcome, *counts</code> and returning the next state.
In this case a temporary <code><a href="#WrapFuncEval">WrapFuncEval</a></code> is constructed and used to evaluate this pool.</li>
</ul>
</div>


                            </div>
                            <div id="BasePool.sum" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BasePool.sum">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">sum</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BasePool.sum-96"><a href="#BasePool.sum-96"><span class="linenos"> 96</span></a>    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BasePool.sum-97"><a href="#BasePool.sum-97"><span class="linenos"> 97</span></a>        <span class="sd">&quot;&quot;&quot; Convenience method to simply sum the dice in this pool.</span>
</span><span id="BasePool.sum-98"><a href="#BasePool.sum-98"><span class="linenos"> 98</span></a><span class="sd">        </span>
</span><span id="BasePool.sum-99"><a href="#BasePool.sum-99"><span class="linenos"> 99</span></a><span class="sd">        This uses `icepool.sum_pool`.</span>
</span><span id="BasePool.sum-100"><a href="#BasePool.sum-100"><span class="linenos">100</span></a><span class="sd">        </span>
</span><span id="BasePool.sum-101"><a href="#BasePool.sum-101"><span class="linenos">101</span></a><span class="sd">        Returns:</span>
</span><span id="BasePool.sum-102"><a href="#BasePool.sum-102"><span class="linenos">102</span></a><span class="sd">            A die representing the sum.</span>
</span><span id="BasePool.sum-103"><a href="#BasePool.sum-103"><span class="linenos">103</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BasePool.sum-104"><a href="#BasePool.sum-104"><span class="linenos">104</span></a>        <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">sum_pool</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Convenience method to simply sum the dice in this pool.</p>

<p>This uses <code><a href="#sum_pool">icepool.sum_pool</a></code>.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A die representing the sum.</p>
</blockquote>
</div>


                            </div>
                </section>
                <section id="Pool">
                            <div class="attr function"><a class="headerlink" href="#Pool">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">Pool</span><span class="signature">(
    die,
    num_dice=None,
    count_dice=None,
    *,
    truncate_min=None,
    truncate_max=None
)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pool-11"><a href="#Pool-11"><span class="linenos"> 11</span></a><span class="k">def</span> <span class="nf">Pool</span><span class="p">(</span><span class="n">die</span><span class="p">,</span> <span class="n">num_dice</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">count_dice</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">truncate_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">truncate_max</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Pool-12"><a href="#Pool-12"><span class="linenos"> 12</span></a>    <span class="sd">&quot;&quot;&quot; Factory function for `DicePool`.</span>
</span><span id="Pool-13"><a href="#Pool-13"><span class="linenos"> 13</span></a><span class="sd">    </span>
</span><span id="Pool-14"><a href="#Pool-14"><span class="linenos"> 14</span></a><span class="sd">    This should be used in conjunction with `EvalPool` to generate a result.</span>
</span><span id="Pool-15"><a href="#Pool-15"><span class="linenos"> 15</span></a><span class="sd">    </span>
</span><span id="Pool-16"><a href="#Pool-16"><span class="linenos"> 16</span></a><span class="sd">    You can use `die.pool(num_dice=None, ...)` for the same effect as this function.</span>
</span><span id="Pool-17"><a href="#Pool-17"><span class="linenos"> 17</span></a><span class="sd">    </span>
</span><span id="Pool-18"><a href="#Pool-18"><span class="linenos"> 18</span></a><span class="sd">    All instances are cached. The members of the actual instance may not match the arguments exactly;</span>
</span><span id="Pool-19"><a href="#Pool-19"><span class="linenos"> 19</span></a><span class="sd">    instead, they may be optimized to values that give the same result as far as `EvalPool` is concerned.</span>
</span><span id="Pool-20"><a href="#Pool-20"><span class="linenos"> 20</span></a><span class="sd">    </span>
</span><span id="Pool-21"><a href="#Pool-21"><span class="linenos"> 21</span></a><span class="sd">    This is capitalized because it is the preferred way of getting a new instance,</span>
</span><span id="Pool-22"><a href="#Pool-22"><span class="linenos"> 22</span></a><span class="sd">    and so that you can use `from icepool import Pool` while leaving the name `pool` free.</span>
</span><span id="Pool-23"><a href="#Pool-23"><span class="linenos"> 23</span></a><span class="sd">    The name of the actual class is `DicePool`.</span>
</span><span id="Pool-24"><a href="#Pool-24"><span class="linenos"> 24</span></a><span class="sd">    </span>
</span><span id="Pool-25"><a href="#Pool-25"><span class="linenos"> 25</span></a><span class="sd">    Args:</span>
</span><span id="Pool-26"><a href="#Pool-26"><span class="linenos"> 26</span></a><span class="sd">        die: The fundamental die of the pool.</span>
</span><span id="Pool-27"><a href="#Pool-27"><span class="linenos"> 27</span></a><span class="sd">            If outcomes are not reachable by any die due to `truncate_min` or `truncate_max`,</span>
</span><span id="Pool-28"><a href="#Pool-28"><span class="linenos"> 28</span></a><span class="sd">            they will have 0 count. Zero-weight outcomes will appear with zero weight,</span>
</span><span id="Pool-29"><a href="#Pool-29"><span class="linenos"> 29</span></a><span class="sd">            but can still generate nonzero counts.</span>
</span><span id="Pool-30"><a href="#Pool-30"><span class="linenos"> 30</span></a><span class="sd">        num_dice: An `int` that sets the number of dice in the pool.</span>
</span><span id="Pool-31"><a href="#Pool-31"><span class="linenos"> 31</span></a><span class="sd">            If not provided, the number of dice will be inferred from the other arguments.</span>
</span><span id="Pool-32"><a href="#Pool-32"><span class="linenos"> 32</span></a><span class="sd">            If no arguments are provided at all, this defaults to 0.</span>
</span><span id="Pool-33"><a href="#Pool-33"><span class="linenos"> 33</span></a><span class="sd">        count_dice: Determines which of the **sorted** dice will be counted, and how many times.</span>
</span><span id="Pool-34"><a href="#Pool-34"><span class="linenos"> 34</span></a><span class="sd">            Prefer to use the `DicePool`&#39;s `[]` operator after the fact rather than providing an argument here.</span>
</span><span id="Pool-35"><a href="#Pool-35"><span class="linenos"> 35</span></a><span class="sd">            This operator is an alias for `DicePool.set_count_dice()`.</span>
</span><span id="Pool-36"><a href="#Pool-36"><span class="linenos"> 36</span></a><span class="sd">            See that method&#39;s docstring for details.</span>
</span><span id="Pool-37"><a href="#Pool-37"><span class="linenos"> 37</span></a><span class="sd">        truncate_max: A sequence of one outcome per die in the pool.</span>
</span><span id="Pool-38"><a href="#Pool-38"><span class="linenos"> 38</span></a><span class="sd">            That die will be truncated to that maximum outcome, with all greater outcomes having 0 count.</span>
</span><span id="Pool-39"><a href="#Pool-39"><span class="linenos"> 39</span></a><span class="sd">            Values cannot be &gt; the `max_outcome` of the fundamental die.</span>
</span><span id="Pool-40"><a href="#Pool-40"><span class="linenos"> 40</span></a><span class="sd">            A pool cannot have both `truncate_min` and `truncate_max`.</span>
</span><span id="Pool-41"><a href="#Pool-41"><span class="linenos"> 41</span></a><span class="sd">            This can be used to efficiently roll a set of mixed standard dice.</span>
</span><span id="Pool-42"><a href="#Pool-42"><span class="linenos"> 42</span></a><span class="sd">            For example, `Pool(icepool.d12, truncate_max=[6, 6, 6, 8, 8])` would be a pool of 3d6 and 2d8.</span>
</span><span id="Pool-43"><a href="#Pool-43"><span class="linenos"> 43</span></a><span class="sd">        truncate_min: A sequence of one outcome per die in the pool.</span>
</span><span id="Pool-44"><a href="#Pool-44"><span class="linenos"> 44</span></a><span class="sd">            That die will be truncated to that minimum outcome, with all lesser outcomes having 0 count.</span>
</span><span id="Pool-45"><a href="#Pool-45"><span class="linenos"> 45</span></a><span class="sd">            Values cannot be &lt; the `min_outcome` of the fundamental die.</span>
</span><span id="Pool-46"><a href="#Pool-46"><span class="linenos"> 46</span></a><span class="sd">            A pool cannot have both `truncate_min` and `truncate_max`.</span>
</span><span id="Pool-47"><a href="#Pool-47"><span class="linenos"> 47</span></a><span class="sd">    </span>
</span><span id="Pool-48"><a href="#Pool-48"><span class="linenos"> 48</span></a><span class="sd">    Raises:</span>
</span><span id="Pool-49"><a href="#Pool-49"><span class="linenos"> 49</span></a><span class="sd">        `ValueError` if arguments result in a conflicting number of dice,</span>
</span><span id="Pool-50"><a href="#Pool-50"><span class="linenos"> 50</span></a><span class="sd">        if both `truncate_min` and `truncate_max` are provided,</span>
</span><span id="Pool-51"><a href="#Pool-51"><span class="linenos"> 51</span></a><span class="sd">        or if truncation would produce an empty die.</span>
</span><span id="Pool-52"><a href="#Pool-52"><span class="linenos"> 52</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Pool-53"><a href="#Pool-53"><span class="linenos"> 53</span></a>    
</span><span id="Pool-54"><a href="#Pool-54"><span class="linenos"> 54</span></a>    <span class="k">if</span> <span class="n">truncate_min</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">truncate_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Pool-55"><a href="#Pool-55"><span class="linenos"> 55</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;A pool cannot have both truncate_min and truncate_max.&#39;</span><span class="p">)</span>
</span><span id="Pool-56"><a href="#Pool-56"><span class="linenos"> 56</span></a>    
</span><span id="Pool-57"><a href="#Pool-57"><span class="linenos"> 57</span></a>    <span class="c1"># Compute num_dice and count_dice.</span>
</span><span id="Pool-58"><a href="#Pool-58"><span class="linenos"> 58</span></a>    
</span><span id="Pool-59"><a href="#Pool-59"><span class="linenos"> 59</span></a>    <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="p">(</span><span class="n">truncate_min</span><span class="p">,</span> <span class="n">truncate_max</span><span class="p">):</span>
</span><span id="Pool-60"><a href="#Pool-60"><span class="linenos"> 60</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="s1">&#39;__len__&#39;</span><span class="p">):</span>
</span><span id="Pool-61"><a href="#Pool-61"><span class="linenos"> 61</span></a>            <span class="k">if</span> <span class="n">num_dice</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">num_dice</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
</span><span id="Pool-62"><a href="#Pool-62"><span class="linenos"> 62</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Conflicting values for the number of dice: &#39;</span> <span class="o">+</span>
</span><span id="Pool-63"><a href="#Pool-63"><span class="linenos"> 63</span></a>                    <span class="sa">f</span><span class="s1">&#39;num_dice=</span><span class="si">{</span><span class="n">num_dice</span><span class="si">}</span><span class="s1">, truncate_min=</span><span class="si">{</span><span class="n">truncate_min</span><span class="si">}</span><span class="s1">, truncate_max=</span><span class="si">{</span><span class="n">truncate_max</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Pool-64"><a href="#Pool-64"><span class="linenos"> 64</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Pool-65"><a href="#Pool-65"><span class="linenos"> 65</span></a>                <span class="n">num_dice</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
</span><span id="Pool-66"><a href="#Pool-66"><span class="linenos"> 66</span></a>    
</span><span id="Pool-67"><a href="#Pool-67"><span class="linenos"> 67</span></a>    <span class="n">convert_to_die</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">count_dice</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="Pool-68"><a href="#Pool-68"><span class="linenos"> 68</span></a>    
</span><span id="Pool-69"><a href="#Pool-69"><span class="linenos"> 69</span></a>    <span class="k">if</span> <span class="n">num_dice</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Pool-70"><a href="#Pool-70"><span class="linenos"> 70</span></a>        <span class="c1"># Default to zero dice, unless count_dice has something to say.</span>
</span><span id="Pool-71"><a href="#Pool-71"><span class="linenos"> 71</span></a>        <span class="n">count_dice</span> <span class="o">=</span> <span class="n">count_dice_tuple</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count_dice</span><span class="p">)</span>
</span><span id="Pool-72"><a href="#Pool-72"><span class="linenos"> 72</span></a>        <span class="n">num_dice</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">count_dice</span><span class="p">)</span>
</span><span id="Pool-73"><a href="#Pool-73"><span class="linenos"> 73</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Pool-74"><a href="#Pool-74"><span class="linenos"> 74</span></a>        <span class="c1"># Must match num_dice.</span>
</span><span id="Pool-75"><a href="#Pool-75"><span class="linenos"> 75</span></a>        <span class="n">count_dice</span> <span class="o">=</span> <span class="n">count_dice_tuple</span><span class="p">(</span><span class="n">num_dice</span><span class="p">,</span> <span class="n">count_dice</span><span class="p">)</span>
</span><span id="Pool-76"><a href="#Pool-76"><span class="linenos"> 76</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">count_dice</span><span class="p">)</span> <span class="o">!=</span> <span class="n">num_dice</span><span class="p">:</span>
</span><span id="Pool-77"><a href="#Pool-77"><span class="linenos"> 77</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The length of count_dice=</span><span class="si">{</span><span class="n">count_dice</span><span class="si">}</span><span class="s1"> conflicts with num_dice=</span><span class="si">{</span><span class="n">num_dice</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
</span><span id="Pool-78"><a href="#Pool-78"><span class="linenos"> 78</span></a>    
</span><span id="Pool-79"><a href="#Pool-79"><span class="linenos"> 79</span></a>    <span class="c1"># Put truncation into standard form.</span>
</span><span id="Pool-80"><a href="#Pool-80"><span class="linenos"> 80</span></a>    <span class="c1"># This is either a sorted tuple, or `None` if there is no (effective) limit to the die size on that side.</span>
</span><span id="Pool-81"><a href="#Pool-81"><span class="linenos"> 81</span></a>    <span class="c1"># Values will also be clipped to the range of the fundamental die.</span>
</span><span id="Pool-82"><a href="#Pool-82"><span class="linenos"> 82</span></a>    
</span><span id="Pool-83"><a href="#Pool-83"><span class="linenos"> 83</span></a>    <span class="k">if</span> <span class="n">num_dice</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Pool-84"><a href="#Pool-84"><span class="linenos"> 84</span></a>        <span class="n">truncate_min</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Pool-85"><a href="#Pool-85"><span class="linenos"> 85</span></a>        <span class="n">truncate_max</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Pool-86"><a href="#Pool-86"><span class="linenos"> 86</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Pool-87"><a href="#Pool-87"><span class="linenos"> 87</span></a>        <span class="k">if</span> <span class="n">truncate_min</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Pool-88"><a href="#Pool-88"><span class="linenos"> 88</span></a>            <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">truncate_min</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">die</span><span class="o">.</span><span class="n">min_outcome</span><span class="p">():</span>
</span><span id="Pool-89"><a href="#Pool-89"><span class="linenos"> 89</span></a>                <span class="k">if</span> <span class="nb">min</span><span class="p">(</span><span class="n">truncate_min</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">die</span><span class="o">.</span><span class="n">min_outcome</span><span class="p">():</span>
</span><span id="Pool-90"><a href="#Pool-90"><span class="linenos"> 90</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;truncate_min cannot be &lt; the min_outcome of the die.&#39;</span><span class="p">)</span>
</span><span id="Pool-91"><a href="#Pool-91"><span class="linenos"> 91</span></a>                <span class="c1"># We can&#39;t truncate the die to truncate_min since it may upset the iteration order.</span>
</span><span id="Pool-92"><a href="#Pool-92"><span class="linenos"> 92</span></a>                <span class="n">truncate_min</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">nearest_ge</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span> <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="n">truncate_min</span><span class="p">))</span>
</span><span id="Pool-93"><a href="#Pool-93"><span class="linenos"> 93</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Pool-94"><a href="#Pool-94"><span class="linenos"> 94</span></a>                <span class="c1"># In this case, the truncate_min don&#39;t actually do anything.</span>
</span><span id="Pool-95"><a href="#Pool-95"><span class="linenos"> 95</span></a>                <span class="n">truncate_min</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Pool-96"><a href="#Pool-96"><span class="linenos"> 96</span></a>        <span class="k">if</span> <span class="n">truncate_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Pool-97"><a href="#Pool-97"><span class="linenos"> 97</span></a>            <span class="k">if</span> <span class="nb">min</span><span class="p">(</span><span class="n">truncate_max</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">die</span><span class="o">.</span><span class="n">max_outcome</span><span class="p">():</span>
</span><span id="Pool-98"><a href="#Pool-98"><span class="linenos"> 98</span></a>                <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">truncate_max</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">die</span><span class="o">.</span><span class="n">max_outcome</span><span class="p">():</span>
</span><span id="Pool-99"><a href="#Pool-99"><span class="linenos"> 99</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;truncate_max cannot be &gt; the max_outcome of the die.&#39;</span><span class="p">)</span>
</span><span id="Pool-100"><a href="#Pool-100"><span class="linenos">100</span></a>                <span class="c1"># We can&#39;t truncate the die to truncate_max since it may upset the iteration order.</span>
</span><span id="Pool-101"><a href="#Pool-101"><span class="linenos">101</span></a>                <span class="n">truncate_max</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">nearest_le</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span> <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="n">truncate_max</span><span class="p">))</span>
</span><span id="Pool-102"><a href="#Pool-102"><span class="linenos">102</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Pool-103"><a href="#Pool-103"><span class="linenos">103</span></a>                <span class="c1"># In this case, the truncate_max don&#39;t actually do anything.</span>
</span><span id="Pool-104"><a href="#Pool-104"><span class="linenos">104</span></a>                <span class="n">truncate_max</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Pool-105"><a href="#Pool-105"><span class="linenos">105</span></a>    
</span><span id="Pool-106"><a href="#Pool-106"><span class="linenos">106</span></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">_pool_cached_unchecked</span><span class="p">(</span><span class="n">die</span><span class="p">,</span> <span class="n">count_dice</span><span class="p">,</span> <span class="n">truncate_min</span><span class="p">,</span> <span class="n">truncate_max</span><span class="p">)</span>
</span><span id="Pool-107"><a href="#Pool-107"><span class="linenos">107</span></a>    <span class="k">if</span> <span class="n">convert_to_die</span><span class="p">:</span>
</span><span id="Pool-108"><a href="#Pool-108"><span class="linenos">108</span></a>        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="k">lambda</span> <span class="n">state</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="n">outcome</span> <span class="k">if</span> <span class="n">count</span> <span class="k">else</span> <span class="n">state</span><span class="p">)</span>
</span><span id="Pool-109"><a href="#Pool-109"><span class="linenos">109</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Pool-110"><a href="#Pool-110"><span class="linenos">110</span></a>        <span class="k">return</span> <span class="n">result</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Factory function for <code><a href="#DicePool">DicePool</a></code>.</p>

<p>This should be used in conjunction with <code><a href="#EvalPool">EvalPool</a></code> to generate a result.</p>

<p>You can use <code>die.pool(num_dice=None, ...)</code> for the same effect as this function.</p>

<p>All instances are cached. The members of the actual instance may not match the arguments exactly;
instead, they may be optimized to values that give the same result as far as <code><a href="#EvalPool">EvalPool</a></code> is concerned.</p>

<p>This is capitalized because it is the preferred way of getting a new instance,
and so that you can use <code>from icepool import Pool</code> while leaving the name <code>pool</code> free.
The name of the actual class is <code><a href="#DicePool">DicePool</a></code>.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>die:</strong>  The fundamental die of the pool.
If outcomes are not reachable by any die due to <code>truncate_min</code> or <code>truncate_max</code>,
they will have 0 count. Zero-weight outcomes will appear with zero weight,
but can still generate nonzero counts.</li>
<li><strong>num_dice:</strong>  An <code>int</code> that sets the number of dice in the pool.
If not provided, the number of dice will be inferred from the other arguments.
If no arguments are provided at all, this defaults to 0.</li>
<li><strong>count_dice:</strong>  Determines which of the <strong>sorted</strong> dice will be counted, and how many times.
Prefer to use the <code><a href="#DicePool">DicePool</a></code>'s <code>[]</code> operator after the fact rather than providing an argument here.
This operator is an alias for <code><a href="#DicePool.set_count_dice">DicePool.set_count_dice()</a></code>.
See that method's docstring for details.</li>
<li><strong>truncate_max:</strong>  A sequence of one outcome per die in the pool.
That die will be truncated to that maximum outcome, with all greater outcomes having 0 count.
Values cannot be &gt; the <code><a href="#max_outcome">max_outcome</a></code> of the fundamental die.
A pool cannot have both <code>truncate_min</code> and <code>truncate_max</code>.
This can be used to efficiently roll a set of mixed standard dice.
For example, <code>Pool(<a href="#d12">icepool.d12</a>, truncate_max=[6, 6, 6, 8, 8])</code> would be a pool of 3d6 and 2d8.</li>
<li><strong>truncate_min:</strong>  A sequence of one outcome per die in the pool.
That die will be truncated to that minimum outcome, with all lesser outcomes having 0 count.
Values cannot be &lt; the <code><a href="#min_outcome">min_outcome</a></code> of the fundamental die.
A pool cannot have both <code>truncate_min</code> and <code>truncate_max</code>.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><code>ValueError</code> if arguments result in a conflicting number of dice,</li>
<li>if both <code>truncate_min</code> and <code>truncate_max</code> are provided,</li>
<li>or if truncation would produce an empty die.</li>
</ul>
</div>


                </section>
                <section id="standard_pool">
                            <div class="attr function"><a class="headerlink" href="#standard_pool">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">standard_pool</span><span class="signature">(*die_sizes, count_dice=None)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="standard_pool-195"><a href="#standard_pool-195"><span class="linenos">195</span></a><span class="k">def</span> <span class="nf">standard_pool</span><span class="p">(</span><span class="o">*</span><span class="n">die_sizes</span><span class="p">,</span> <span class="n">count_dice</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="standard_pool-196"><a href="#standard_pool-196"><span class="linenos">196</span></a>    <span class="sd">&quot;&quot;&quot; Creates a pool of standard dice.</span>
</span><span id="standard_pool-197"><a href="#standard_pool-197"><span class="linenos">197</span></a><span class="sd">    </span>
</span><span id="standard_pool-198"><a href="#standard_pool-198"><span class="linenos">198</span></a><span class="sd">    For example, `standard_pool(8, 8, 6, 6, 6)` would be a pool of 2 d8s and 3 d6s.</span>
</span><span id="standard_pool-199"><a href="#standard_pool-199"><span class="linenos">199</span></a><span class="sd">    </span>
</span><span id="standard_pool-200"><a href="#standard_pool-200"><span class="linenos">200</span></a><span class="sd">    If no die sizes are given, the pool will consist of zero d1s.</span>
</span><span id="standard_pool-201"><a href="#standard_pool-201"><span class="linenos">201</span></a><span class="sd">    </span>
</span><span id="standard_pool-202"><a href="#standard_pool-202"><span class="linenos">202</span></a><span class="sd">    Args:</span>
</span><span id="standard_pool-203"><a href="#standard_pool-203"><span class="linenos">203</span></a><span class="sd">        *die_sizes: The size of each die in the pool.</span>
</span><span id="standard_pool-204"><a href="#standard_pool-204"><span class="linenos">204</span></a><span class="sd">        count_dice: Which dice will be counted, as `Pool()`.</span>
</span><span id="standard_pool-205"><a href="#standard_pool-205"><span class="linenos">205</span></a><span class="sd">            As with `Pool()`, you can also use the `[]` operator after the fact.</span>
</span><span id="standard_pool-206"><a href="#standard_pool-206"><span class="linenos">206</span></a><span class="sd">            For example, `standard_pool(8, 8, 6, 6, 6)[-2:]` would keep the highest two dice</span>
</span><span id="standard_pool-207"><a href="#standard_pool-207"><span class="linenos">207</span></a><span class="sd">            of 2 d8s and 3 d6s.</span>
</span><span id="standard_pool-208"><a href="#standard_pool-208"><span class="linenos">208</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="standard_pool-209"><a href="#standard_pool-209"><span class="linenos">209</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">die_sizes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="standard_pool-210"><a href="#standard_pool-210"><span class="linenos">210</span></a>        <span class="k">return</span> <span class="n">Pool</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">d1</span><span class="p">,</span> <span class="n">num_dice</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="standard_pool-211"><a href="#standard_pool-211"><span class="linenos">211</span></a>    <span class="k">return</span> <span class="n">Pool</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">d</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">die_sizes</span><span class="p">)),</span> <span class="n">count_dice</span><span class="o">=</span><span class="n">count_dice</span><span class="p">,</span> <span class="n">truncate_max</span><span class="o">=</span><span class="n">die_sizes</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Creates a pool of standard dice.</p>

<p>For example, <code>standard_pool(8, 8, 6, 6, 6)</code> would be a pool of 2 d8s and 3 d6s.</p>

<p>If no die sizes are given, the pool will consist of zero d1s.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>*die_sizes:</strong>  The size of each die in the pool.</li>
<li><strong>count_dice:</strong>  Which dice will be counted, as <code><a href="#Pool">Pool()</a></code>.
As with <code><a href="#Pool">Pool()</a></code>, you can also use the <code>[]</code> operator after the fact.
For example, <code>standard_pool(8, 8, 6, 6, 6)[-2:]</code> would keep the highest two dice
of 2 d8s and 3 d6s.</li>
</ul>
</div>


                </section>
                <section id="DicePool">
                                <div class="attr class">
        <a class="headerlink" href="#DicePool">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">DicePool</span><wbr>(<span class="base"><a href="#BasePool">icepool.BasePool</a></span>):
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DicePool-213"><a href="#DicePool-213"><span class="linenos">213</span></a><span class="k">class</span> <span class="nc">DicePool</span><span class="p">(</span><span class="n">icepool</span><span class="o">.</span><span class="n">BasePool</span><span class="p">):</span>
</span><span id="DicePool-214"><a href="#DicePool-214"><span class="linenos">214</span></a>    <span class="sd">&quot;&quot;&quot; A pool is a set of (semi-)identical dice that are rolled in no particular order</span>
</span><span id="DicePool-215"><a href="#DicePool-215"><span class="linenos">215</span></a><span class="sd">    and sorted only after the fact.</span>
</span><span id="DicePool-216"><a href="#DicePool-216"><span class="linenos">216</span></a><span class="sd">    </span>
</span><span id="DicePool-217"><a href="#DicePool-217"><span class="linenos">217</span></a><span class="sd">    A pool is defined by:</span>
</span><span id="DicePool-218"><a href="#DicePool-218"><span class="linenos">218</span></a>
</span><span id="DicePool-219"><a href="#DicePool-219"><span class="linenos">219</span></a><span class="sd">    * A fundamental die.</span>
</span><span id="DicePool-220"><a href="#DicePool-220"><span class="linenos">220</span></a><span class="sd">    * The number of dice in the pool.</span>
</span><span id="DicePool-221"><a href="#DicePool-221"><span class="linenos">221</span></a><span class="sd">    * Which of the sorted positions are counted (possibly multiple or negative times).</span>
</span><span id="DicePool-222"><a href="#DicePool-222"><span class="linenos">222</span></a><span class="sd">    * Possibly limiting the max or min outcomes of dice in the pool (but not both)</span>
</span><span id="DicePool-223"><a href="#DicePool-223"><span class="linenos">223</span></a><span class="sd">        relative to the fundamental die.</span>
</span><span id="DicePool-224"><a href="#DicePool-224"><span class="linenos">224</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DicePool-225"><a href="#DicePool-225"><span class="linenos">225</span></a>    
</span><span id="DicePool-226"><a href="#DicePool-226"><span class="linenos">226</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">die</span><span class="p">,</span> <span class="n">count_dice</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">truncate_min</span><span class="p">,</span> <span class="n">truncate_max</span><span class="p">):</span>
</span><span id="DicePool-227"><a href="#DicePool-227"><span class="linenos">227</span></a>        <span class="sd">&quot;&quot;&quot; Unchecked constructor.</span>
</span><span id="DicePool-228"><a href="#DicePool-228"><span class="linenos">228</span></a><span class="sd">        </span>
</span><span id="DicePool-229"><a href="#DicePool-229"><span class="linenos">229</span></a><span class="sd">        This should not be used directly. Use the `Pool()` factory function instead.</span>
</span><span id="DicePool-230"><a href="#DicePool-230"><span class="linenos">230</span></a><span class="sd">        </span>
</span><span id="DicePool-231"><a href="#DicePool-231"><span class="linenos">231</span></a><span class="sd">        Args:</span>
</span><span id="DicePool-232"><a href="#DicePool-232"><span class="linenos">232</span></a><span class="sd">            die: The fundamental die of the pool.</span>
</span><span id="DicePool-233"><a href="#DicePool-233"><span class="linenos">233</span></a><span class="sd">            count_dice: At this point, this should be a tuple the length of the pool.</span>
</span><span id="DicePool-234"><a href="#DicePool-234"><span class="linenos">234</span></a><span class="sd">            truncate_max: At this point this should be a tuple the length of the pool or `None`.</span>
</span><span id="DicePool-235"><a href="#DicePool-235"><span class="linenos">235</span></a><span class="sd">            truncate_min: At this point this should be a tuple the length of the pool or `None`.</span>
</span><span id="DicePool-236"><a href="#DicePool-236"><span class="linenos">236</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DicePool-237"><a href="#DicePool-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_die</span> <span class="o">=</span> <span class="n">die</span>
</span><span id="DicePool-238"><a href="#DicePool-238"><span class="linenos">238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_count_dice</span> <span class="o">=</span> <span class="n">count_dice</span>
</span><span id="DicePool-239"><a href="#DicePool-239"><span class="linenos">239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_truncate_max</span> <span class="o">=</span> <span class="n">truncate_max</span>
</span><span id="DicePool-240"><a href="#DicePool-240"><span class="linenos">240</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_truncate_min</span> <span class="o">=</span> <span class="n">truncate_min</span>
</span><span id="DicePool-241"><a href="#DicePool-241"><span class="linenos">241</span></a>    
</span><span id="DicePool-242"><a href="#DicePool-242"><span class="linenos">242</span></a>    <span class="k">def</span> <span class="nf">_is_single_roll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-243"><a href="#DicePool-243"><span class="linenos">243</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="DicePool-244"><a href="#DicePool-244"><span class="linenos">244</span></a>    
</span><span id="DicePool-245"><a href="#DicePool-245"><span class="linenos">245</span></a>    <span class="k">def</span> <span class="nf">die</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-246"><a href="#DicePool-246"><span class="linenos">246</span></a>        <span class="sd">&quot;&quot;&quot; The fundamental die of the pool. &quot;&quot;&quot;</span>
</span><span id="DicePool-247"><a href="#DicePool-247"><span class="linenos">247</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_die</span>
</span><span id="DicePool-248"><a href="#DicePool-248"><span class="linenos">248</span></a>    
</span><span id="DicePool-249"><a href="#DicePool-249"><span class="linenos">249</span></a>    <span class="k">def</span> <span class="nf">outcomes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-250"><a href="#DicePool-250"><span class="linenos">250</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">die</span><span class="p">()</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()</span>
</span><span id="DicePool-251"><a href="#DicePool-251"><span class="linenos">251</span></a>        
</span><span id="DicePool-252"><a href="#DicePool-252"><span class="linenos">252</span></a>    <span class="k">def</span> <span class="nf">_min_outcome</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-253"><a href="#DicePool-253"><span class="linenos">253</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">die</span><span class="p">()</span><span class="o">.</span><span class="n">min_outcome</span><span class="p">()</span>
</span><span id="DicePool-254"><a href="#DicePool-254"><span class="linenos">254</span></a>    
</span><span id="DicePool-255"><a href="#DicePool-255"><span class="linenos">255</span></a>    <span class="k">def</span> <span class="nf">_max_outcome</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-256"><a href="#DicePool-256"><span class="linenos">256</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">die</span><span class="p">()</span><span class="o">.</span><span class="n">max_outcome</span><span class="p">()</span>
</span><span id="DicePool-257"><a href="#DicePool-257"><span class="linenos">257</span></a>        
</span><span id="DicePool-258"><a href="#DicePool-258"><span class="linenos">258</span></a>    <span class="k">def</span> <span class="nf">count_dice</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-259"><a href="#DicePool-259"><span class="linenos">259</span></a>        <span class="sd">&quot;&quot;&quot; A tuple indicating how many times each of the dice, sorted from lowest to highest, counts. &quot;&quot;&quot;</span>
</span><span id="DicePool-260"><a href="#DicePool-260"><span class="linenos">260</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_count_dice</span>
</span><span id="DicePool-261"><a href="#DicePool-261"><span class="linenos">261</span></a>    
</span><span id="DicePool-262"><a href="#DicePool-262"><span class="linenos">262</span></a>    <span class="k">def</span> <span class="nf">num_dice</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-263"><a href="#DicePool-263"><span class="linenos">263</span></a>        <span class="sd">&quot;&quot;&quot; The number of dice in this pool (before dropping or counting multiple times). &quot;&quot;&quot;</span>
</span><span id="DicePool-264"><a href="#DicePool-264"><span class="linenos">264</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_count_dice</span><span class="p">)</span>
</span><span id="DicePool-265"><a href="#DicePool-265"><span class="linenos">265</span></a>    
</span><span id="DicePool-266"><a href="#DicePool-266"><span class="linenos">266</span></a>    <span class="k">def</span> <span class="nf">set_count_dice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">count_dice</span><span class="p">):</span>
</span><span id="DicePool-267"><a href="#DicePool-267"><span class="linenos">267</span></a>        <span class="sd">&quot;&quot;&quot; Returns a pool with the selected dice counted.</span>
</span><span id="DicePool-268"><a href="#DicePool-268"><span class="linenos">268</span></a><span class="sd">        </span>
</span><span id="DicePool-269"><a href="#DicePool-269"><span class="linenos">269</span></a><span class="sd">        You can use `pool[count_dice]` for the same effect as this method.</span>
</span><span id="DicePool-270"><a href="#DicePool-270"><span class="linenos">270</span></a><span class="sd">        </span>
</span><span id="DicePool-271"><a href="#DicePool-271"><span class="linenos">271</span></a><span class="sd">        The dice are sorted in ascending order for this purpose,</span>
</span><span id="DicePool-272"><a href="#DicePool-272"><span class="linenos">272</span></a><span class="sd">        regardless of which order the outcomes are evaluated in.</span>
</span><span id="DicePool-273"><a href="#DicePool-273"><span class="linenos">273</span></a><span class="sd">        </span>
</span><span id="DicePool-274"><a href="#DicePool-274"><span class="linenos">274</span></a><span class="sd">        This is always an absolute selection on all `num_dice`,</span>
</span><span id="DicePool-275"><a href="#DicePool-275"><span class="linenos">275</span></a><span class="sd">        not a relative selection on already-selected dice,</span>
</span><span id="DicePool-276"><a href="#DicePool-276"><span class="linenos">276</span></a><span class="sd">        which would be ambiguous in the presence of multiple or negative counts.</span>
</span><span id="DicePool-277"><a href="#DicePool-277"><span class="linenos">277</span></a><span class="sd">        </span>
</span><span id="DicePool-278"><a href="#DicePool-278"><span class="linenos">278</span></a><span class="sd">        Args:</span>
</span><span id="DicePool-279"><a href="#DicePool-279"><span class="linenos">279</span></a><span class="sd">            `None`: All dice will be counted once.</span>
</span><span id="DicePool-280"><a href="#DicePool-280"><span class="linenos">280</span></a><span class="sd">            An `int`. This will count only the die at the specified index (once).</span>
</span><span id="DicePool-281"><a href="#DicePool-281"><span class="linenos">281</span></a><span class="sd">                In this case, the result will be a die, not a pool.</span>
</span><span id="DicePool-282"><a href="#DicePool-282"><span class="linenos">282</span></a><span class="sd">            A `slice`. The selected dice are counted once each.</span>
</span><span id="DicePool-283"><a href="#DicePool-283"><span class="linenos">283</span></a><span class="sd">                If provided, the third argument resizes the pool,</span>
</span><span id="DicePool-284"><a href="#DicePool-284"><span class="linenos">284</span></a><span class="sd">                rather than being a step,</span>
</span><span id="DicePool-285"><a href="#DicePool-285"><span class="linenos">285</span></a><span class="sd">                but only if the pool does not have `truncate_max` or `truncate_min`.</span>
</span><span id="DicePool-286"><a href="#DicePool-286"><span class="linenos">286</span></a><span class="sd">            A sequence of one `int`s for each die.</span>
</span><span id="DicePool-287"><a href="#DicePool-287"><span class="linenos">287</span></a><span class="sd">                Each die is counted that many times, which could be multiple or negative times.</span>
</span><span id="DicePool-288"><a href="#DicePool-288"><span class="linenos">288</span></a><span class="sd">                This may resize the pool, but only if the pool does not have `truncate_max` or `truncate_min`.</span>
</span><span id="DicePool-289"><a href="#DicePool-289"><span class="linenos">289</span></a><span class="sd">                </span>
</span><span id="DicePool-290"><a href="#DicePool-290"><span class="linenos">290</span></a><span class="sd">                Up to one `Ellipsis` (`...`) may be used.</span>
</span><span id="DicePool-291"><a href="#DicePool-291"><span class="linenos">291</span></a><span class="sd">                If an `Ellipsis` is used, the size of the pool won&#39;t change. Instead:</span>
</span><span id="DicePool-292"><a href="#DicePool-292"><span class="linenos">292</span></a><span class="sd">                </span>
</span><span id="DicePool-293"><a href="#DicePool-293"><span class="linenos">293</span></a><span class="sd">                * If `count_dice` is shorter than `num_dice`, the `Ellipsis`</span>
</span><span id="DicePool-294"><a href="#DicePool-294"><span class="linenos">294</span></a><span class="sd">                    acts as enough zero counts to make up the difference.</span>
</span><span id="DicePool-295"><a href="#DicePool-295"><span class="linenos">295</span></a><span class="sd">                    For example, `pool[1, ..., 1]` on five dice would act as `pool[1, 0, 0, 0, 1]`.</span>
</span><span id="DicePool-296"><a href="#DicePool-296"><span class="linenos">296</span></a><span class="sd">                * If `count_dice` has length equal to `num_dice`, the `Ellipsis` has no effect.</span>
</span><span id="DicePool-297"><a href="#DicePool-297"><span class="linenos">297</span></a><span class="sd">                    For example, `pool[1, ..., 1]` on two dice would act as `pool[1, 1]`.</span>
</span><span id="DicePool-298"><a href="#DicePool-298"><span class="linenos">298</span></a><span class="sd">                * If `count_dice` is longer than `num_dice` and the `Ellipsis` is on one side,</span>
</span><span id="DicePool-299"><a href="#DicePool-299"><span class="linenos">299</span></a><span class="sd">                    elements will be dropped from `count_dice` on the side with the `Ellipsis`.</span>
</span><span id="DicePool-300"><a href="#DicePool-300"><span class="linenos">300</span></a><span class="sd">                    For example, `pool[..., 1, 2, 3]` on two dice would act as `pool[2, 3]`.</span>
</span><span id="DicePool-301"><a href="#DicePool-301"><span class="linenos">301</span></a><span class="sd">                * If `count_dice` is longer than `num_dice` and the `Ellipsis` is in the middle,</span>
</span><span id="DicePool-302"><a href="#DicePool-302"><span class="linenos">302</span></a><span class="sd">                    the counts will be as the sum of two one-sided `Ellipsis`.</span>
</span><span id="DicePool-303"><a href="#DicePool-303"><span class="linenos">303</span></a><span class="sd">                    For example, `pool[-1, ..., 1]` acts like `[-1, ...]` plus `[..., 1]`.</span>
</span><span id="DicePool-304"><a href="#DicePool-304"><span class="linenos">304</span></a><span class="sd">                    On a pool consisting of a single single die this would have the -1 and 1 cancel each other out.</span>
</span><span id="DicePool-305"><a href="#DicePool-305"><span class="linenos">305</span></a><span class="sd">        </span>
</span><span id="DicePool-306"><a href="#DicePool-306"><span class="linenos">306</span></a><span class="sd">        Raises:</span>
</span><span id="DicePool-307"><a href="#DicePool-307"><span class="linenos">307</span></a><span class="sd">            ValueError:</span>
</span><span id="DicePool-308"><a href="#DicePool-308"><span class="linenos">308</span></a><span class="sd">            </span>
</span><span id="DicePool-309"><a href="#DicePool-309"><span class="linenos">309</span></a><span class="sd">                * If `count_dice` would change the size of a pool with `truncate_max` or `truncate_min`.</span>
</span><span id="DicePool-310"><a href="#DicePool-310"><span class="linenos">310</span></a><span class="sd">                * If more than one `Ellipsis` is used.</span>
</span><span id="DicePool-311"><a href="#DicePool-311"><span class="linenos">311</span></a><span class="sd">        </span>
</span><span id="DicePool-312"><a href="#DicePool-312"><span class="linenos">312</span></a><span class="sd">        For example, here are some ways of selecting the two highest dice out of 5:</span>
</span><span id="DicePool-313"><a href="#DicePool-313"><span class="linenos">313</span></a><span class="sd">        </span>
</span><span id="DicePool-314"><a href="#DicePool-314"><span class="linenos">314</span></a><span class="sd">        * `pool[3:5]`</span>
</span><span id="DicePool-315"><a href="#DicePool-315"><span class="linenos">315</span></a><span class="sd">        * `pool[3:]`</span>
</span><span id="DicePool-316"><a href="#DicePool-316"><span class="linenos">316</span></a><span class="sd">        * `pool[-2:]`</span>
</span><span id="DicePool-317"><a href="#DicePool-317"><span class="linenos">317</span></a><span class="sd">        * `pool[..., 1, 1]`</span>
</span><span id="DicePool-318"><a href="#DicePool-318"><span class="linenos">318</span></a><span class="sd">        </span>
</span><span id="DicePool-319"><a href="#DicePool-319"><span class="linenos">319</span></a><span class="sd">        These will also select the two highest dice out of 5, and will also resize the pool to 5 dice first:</span>
</span><span id="DicePool-320"><a href="#DicePool-320"><span class="linenos">320</span></a><span class="sd">        </span>
</span><span id="DicePool-321"><a href="#DicePool-321"><span class="linenos">321</span></a><span class="sd">        * `pool[3::5]`</span>
</span><span id="DicePool-322"><a href="#DicePool-322"><span class="linenos">322</span></a><span class="sd">        * `pool[3:5:5]`</span>
</span><span id="DicePool-323"><a href="#DicePool-323"><span class="linenos">323</span></a><span class="sd">        * `pool[-2::5]`</span>
</span><span id="DicePool-324"><a href="#DicePool-324"><span class="linenos">324</span></a><span class="sd">        * `pool[0, 0, 0, 1, 1]`</span>
</span><span id="DicePool-325"><a href="#DicePool-325"><span class="linenos">325</span></a><span class="sd">        </span>
</span><span id="DicePool-326"><a href="#DicePool-326"><span class="linenos">326</span></a><span class="sd">        These will count the highest as a positive and the lowest as a negative:</span>
</span><span id="DicePool-327"><a href="#DicePool-327"><span class="linenos">327</span></a><span class="sd">        </span>
</span><span id="DicePool-328"><a href="#DicePool-328"><span class="linenos">328</span></a><span class="sd">        * `pool[-1, 0, 0, 0, 1]`</span>
</span><span id="DicePool-329"><a href="#DicePool-329"><span class="linenos">329</span></a><span class="sd">        * `pool[-1, ..., 1]`</span>
</span><span id="DicePool-330"><a href="#DicePool-330"><span class="linenos">330</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DicePool-331"><a href="#DicePool-331"><span class="linenos">331</span></a>        <span class="n">convert_to_die</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">count_dice</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="DicePool-332"><a href="#DicePool-332"><span class="linenos">332</span></a>        <span class="n">count_dice</span> <span class="o">=</span> <span class="n">count_dice_tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_dice</span><span class="p">(),</span> <span class="n">count_dice</span><span class="p">)</span>
</span><span id="DicePool-333"><a href="#DicePool-333"><span class="linenos">333</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">count_dice</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_dice</span><span class="p">():</span>
</span><span id="DicePool-334"><a href="#DicePool-334"><span class="linenos">334</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncate_max</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DicePool-335"><a href="#DicePool-335"><span class="linenos">335</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot change the size of a pool with truncate_max.&#39;</span><span class="p">)</span>
</span><span id="DicePool-336"><a href="#DicePool-336"><span class="linenos">336</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncate_min</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DicePool-337"><a href="#DicePool-337"><span class="linenos">337</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot change the size of a pool with truncate_min.&#39;</span><span class="p">)</span>
</span><span id="DicePool-338"><a href="#DicePool-338"><span class="linenos">338</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">_pool_cached_unchecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">die</span><span class="p">(),</span> <span class="n">count_dice</span><span class="o">=</span><span class="n">count_dice</span><span class="p">,</span> <span class="n">truncate_max</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_max</span><span class="p">(),</span> <span class="n">truncate_min</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_min</span><span class="p">())</span>
</span><span id="DicePool-339"><a href="#DicePool-339"><span class="linenos">339</span></a>        <span class="k">if</span> <span class="n">convert_to_die</span><span class="p">:</span>
</span><span id="DicePool-340"><a href="#DicePool-340"><span class="linenos">340</span></a>            <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="k">lambda</span> <span class="n">state</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="n">outcome</span> <span class="k">if</span> <span class="n">count</span> <span class="k">else</span> <span class="n">state</span><span class="p">)</span>
</span><span id="DicePool-341"><a href="#DicePool-341"><span class="linenos">341</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DicePool-342"><a href="#DicePool-342"><span class="linenos">342</span></a>            <span class="k">return</span> <span class="n">result</span>
</span><span id="DicePool-343"><a href="#DicePool-343"><span class="linenos">343</span></a>    
</span><span id="DicePool-344"><a href="#DicePool-344"><span class="linenos">344</span></a>    <span class="fm">__getitem__</span> <span class="o">=</span> <span class="n">set_count_dice</span>
</span><span id="DicePool-345"><a href="#DicePool-345"><span class="linenos">345</span></a>    
</span><span id="DicePool-346"><a href="#DicePool-346"><span class="linenos">346</span></a>    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-347"><a href="#DicePool-347"><span class="linenos">347</span></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;DicePool&#39; object is not iterable&quot;</span><span class="p">)</span>
</span><span id="DicePool-348"><a href="#DicePool-348"><span class="linenos">348</span></a>    
</span><span id="DicePool-349"><a href="#DicePool-349"><span class="linenos">349</span></a>    <span class="nd">@cached_property</span>
</span><span id="DicePool-350"><a href="#DicePool-350"><span class="linenos">350</span></a>    <span class="k">def</span> <span class="nf">_num_drop_lowest</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-351"><a href="#DicePool-351"><span class="linenos">351</span></a>        <span class="sd">&quot;&quot;&quot; How many elements of count_dice on the low side are falsy. &quot;&quot;&quot;</span>
</span><span id="DicePool-352"><a href="#DicePool-352"><span class="linenos">352</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count_dice</span><span class="p">()):</span>
</span><span id="DicePool-353"><a href="#DicePool-353"><span class="linenos">353</span></a>            <span class="k">if</span> <span class="n">count</span><span class="p">:</span>
</span><span id="DicePool-354"><a href="#DicePool-354"><span class="linenos">354</span></a>                <span class="k">return</span> <span class="n">i</span>
</span><span id="DicePool-355"><a href="#DicePool-355"><span class="linenos">355</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_dice</span><span class="p">()</span>
</span><span id="DicePool-356"><a href="#DicePool-356"><span class="linenos">356</span></a>    
</span><span id="DicePool-357"><a href="#DicePool-357"><span class="linenos">357</span></a>    <span class="k">def</span> <span class="nf">_direction_score_ascending</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-358"><a href="#DicePool-358"><span class="linenos">358</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_drop_lowest</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">())</span>
</span><span id="DicePool-359"><a href="#DicePool-359"><span class="linenos">359</span></a>    
</span><span id="DicePool-360"><a href="#DicePool-360"><span class="linenos">360</span></a>    <span class="nd">@cached_property</span>
</span><span id="DicePool-361"><a href="#DicePool-361"><span class="linenos">361</span></a>    <span class="k">def</span> <span class="nf">_num_drop_highest</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-362"><a href="#DicePool-362"><span class="linenos">362</span></a>        <span class="sd">&quot;&quot;&quot; How many elements of count_dice on the high side are falsy. &quot;&quot;&quot;</span>
</span><span id="DicePool-363"><a href="#DicePool-363"><span class="linenos">363</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count_dice</span><span class="p">())):</span>
</span><span id="DicePool-364"><a href="#DicePool-364"><span class="linenos">364</span></a>            <span class="k">if</span> <span class="n">count</span><span class="p">:</span>
</span><span id="DicePool-365"><a href="#DicePool-365"><span class="linenos">365</span></a>                <span class="k">return</span> <span class="n">i</span>
</span><span id="DicePool-366"><a href="#DicePool-366"><span class="linenos">366</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_dice</span><span class="p">()</span>
</span><span id="DicePool-367"><a href="#DicePool-367"><span class="linenos">367</span></a>    
</span><span id="DicePool-368"><a href="#DicePool-368"><span class="linenos">368</span></a>    <span class="k">def</span> <span class="nf">_direction_score_descending</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-369"><a href="#DicePool-369"><span class="linenos">369</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_drop_highest</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">())</span>
</span><span id="DicePool-370"><a href="#DicePool-370"><span class="linenos">370</span></a>    
</span><span id="DicePool-371"><a href="#DicePool-371"><span class="linenos">371</span></a>    <span class="k">def</span> <span class="nf">truncate_min</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">always_tuple</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="DicePool-372"><a href="#DicePool-372"><span class="linenos">372</span></a>        <span class="sd">&quot;&quot;&quot; A sorted tuple of thresholds below which outcomes are truncated, one for each die in the pool. </span>
</span><span id="DicePool-373"><a href="#DicePool-373"><span class="linenos">373</span></a><span class="sd">        </span>
</span><span id="DicePool-374"><a href="#DicePool-374"><span class="linenos">374</span></a><span class="sd">        Args:</span>
</span><span id="DicePool-375"><a href="#DicePool-375"><span class="linenos">375</span></a><span class="sd">            always_tuple: If `False`, this will return `None` if there are no die-specific `truncate_min`.</span>
</span><span id="DicePool-376"><a href="#DicePool-376"><span class="linenos">376</span></a><span class="sd">                If `True` this will return a `tuple` even in this case.</span>
</span><span id="DicePool-377"><a href="#DicePool-377"><span class="linenos">377</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DicePool-378"><a href="#DicePool-378"><span class="linenos">378</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_truncate_min</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">always_tuple</span><span class="p">:</span>
</span><span id="DicePool-379"><a href="#DicePool-379"><span class="linenos">379</span></a>            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">die</span><span class="p">()</span><span class="o">.</span><span class="n">min_outcome</span><span class="p">(),)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_dice</span><span class="p">()</span>
</span><span id="DicePool-380"><a href="#DicePool-380"><span class="linenos">380</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_truncate_min</span>
</span><span id="DicePool-381"><a href="#DicePool-381"><span class="linenos">381</span></a>    
</span><span id="DicePool-382"><a href="#DicePool-382"><span class="linenos">382</span></a>    <span class="k">def</span> <span class="nf">_has_truncate_min</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-383"><a href="#DicePool-383"><span class="linenos">383</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_truncate_min</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="DicePool-384"><a href="#DicePool-384"><span class="linenos">384</span></a>    
</span><span id="DicePool-385"><a href="#DicePool-385"><span class="linenos">385</span></a>    <span class="k">def</span> <span class="nf">truncate_max</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">always_tuple</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="DicePool-386"><a href="#DicePool-386"><span class="linenos">386</span></a>        <span class="sd">&quot;&quot;&quot; A sorted tuple of thresholds above which outcomes are truncated, one for each die in the pool. </span>
</span><span id="DicePool-387"><a href="#DicePool-387"><span class="linenos">387</span></a><span class="sd">        </span>
</span><span id="DicePool-388"><a href="#DicePool-388"><span class="linenos">388</span></a><span class="sd">        Args:</span>
</span><span id="DicePool-389"><a href="#DicePool-389"><span class="linenos">389</span></a><span class="sd">            always_tuple: If `False`, this will return `None` if there are no die-specific `truncate_max`.</span>
</span><span id="DicePool-390"><a href="#DicePool-390"><span class="linenos">390</span></a><span class="sd">                If `True` this will return a `tuple` even in this case.</span>
</span><span id="DicePool-391"><a href="#DicePool-391"><span class="linenos">391</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DicePool-392"><a href="#DicePool-392"><span class="linenos">392</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_truncate_max</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">always_tuple</span><span class="p">:</span>
</span><span id="DicePool-393"><a href="#DicePool-393"><span class="linenos">393</span></a>            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">die</span><span class="p">()</span><span class="o">.</span><span class="n">max_outcome</span><span class="p">(),)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_dice</span><span class="p">()</span>
</span><span id="DicePool-394"><a href="#DicePool-394"><span class="linenos">394</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_truncate_max</span>
</span><span id="DicePool-395"><a href="#DicePool-395"><span class="linenos">395</span></a>    
</span><span id="DicePool-396"><a href="#DicePool-396"><span class="linenos">396</span></a>    <span class="k">def</span> <span class="nf">_has_truncate_max</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-397"><a href="#DicePool-397"><span class="linenos">397</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_truncate_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="DicePool-398"><a href="#DicePool-398"><span class="linenos">398</span></a>    
</span><span id="DicePool-399"><a href="#DicePool-399"><span class="linenos">399</span></a>    <span class="k">def</span> <span class="nf">_iter_pop_min</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-400"><a href="#DicePool-400"><span class="linenos">400</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DicePool-401"><a href="#DicePool-401"><span class="linenos">401</span></a><span class="sd">        Yields:</span>
</span><span id="DicePool-402"><a href="#DicePool-402"><span class="linenos">402</span></a><span class="sd">            From 0 to the number of dice that can roll this outcome inclusive:</span>
</span><span id="DicePool-403"><a href="#DicePool-403"><span class="linenos">403</span></a><span class="sd">            * pool: A `DicePool` resulting from removing that many dice from this `DicePool`, while also removing the min outcome.</span>
</span><span id="DicePool-404"><a href="#DicePool-404"><span class="linenos">404</span></a><span class="sd">                If there is only one outcome with weight remaining, only one result will be yielded, corresponding to all dice rolling that outcome.</span>
</span><span id="DicePool-405"><a href="#DicePool-405"><span class="linenos">405</span></a><span class="sd">                If the outcome has zero weight, only one result will be yielded, corresponding to zero dice rolling that outcome.</span>
</span><span id="DicePool-406"><a href="#DicePool-406"><span class="linenos">406</span></a><span class="sd">                If there are no outcomes remaining, this will be `None`.</span>
</span><span id="DicePool-407"><a href="#DicePool-407"><span class="linenos">407</span></a><span class="sd">            * count: An `int` indicating the number of selected dice that rolled the removed outcome.</span>
</span><span id="DicePool-408"><a href="#DicePool-408"><span class="linenos">408</span></a><span class="sd">            * weight: An `int` indicating the weight of that many dice rolling the removed outcome.</span>
</span><span id="DicePool-409"><a href="#DicePool-409"><span class="linenos">409</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DicePool-410"><a href="#DicePool-410"><span class="linenos">410</span></a>        
</span><span id="DicePool-411"><a href="#DicePool-411"><span class="linenos">411</span></a>        <span class="c1"># The near-duplication of code with pop_max is unfortunate.</span>
</span><span id="DicePool-412"><a href="#DicePool-412"><span class="linenos">412</span></a>        <span class="c1"># However, the alternative of reversing the storage order of die_counts and truncate_min seems even worse.</span>
</span><span id="DicePool-413"><a href="#DicePool-413"><span class="linenos">413</span></a>        
</span><span id="DicePool-414"><a href="#DicePool-414"><span class="linenos">414</span></a>        <span class="n">truncate_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncate_min</span><span class="p">(</span><span class="n">always_tuple</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DicePool-415"><a href="#DicePool-415"><span class="linenos">415</span></a>        <span class="n">num_possible_dice</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_right</span><span class="p">(</span><span class="n">truncate_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">die</span><span class="p">()</span><span class="o">.</span><span class="n">min_outcome</span><span class="p">())</span>
</span><span id="DicePool-416"><a href="#DicePool-416"><span class="linenos">416</span></a>        <span class="n">popped_die</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">single_weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">die</span><span class="p">()</span><span class="o">.</span><span class="n">_pop_min</span><span class="p">()</span>
</span><span id="DicePool-417"><a href="#DicePool-417"><span class="linenos">417</span></a>        
</span><span id="DicePool-418"><a href="#DicePool-418"><span class="linenos">418</span></a>        <span class="k">if</span> <span class="n">popped_die</span><span class="o">.</span><span class="n">is_empty</span><span class="p">():</span>
</span><span id="DicePool-419"><a href="#DicePool-419"><span class="linenos">419</span></a>            <span class="c1"># This is the last outcome. All dice must roll this outcome.</span>
</span><span id="DicePool-420"><a href="#DicePool-420"><span class="linenos">420</span></a>            <span class="n">pool</span> <span class="o">=</span> <span class="n">_pool_cached_unchecked</span><span class="p">(</span><span class="n">popped_die</span><span class="p">,</span> <span class="n">count_dice</span><span class="o">=</span><span class="p">())</span>
</span><span id="DicePool-421"><a href="#DicePool-421"><span class="linenos">421</span></a>            <span class="n">remaining_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count_dice</span><span class="p">())</span>
</span><span id="DicePool-422"><a href="#DicePool-422"><span class="linenos">422</span></a>            <span class="n">weight</span> <span class="o">=</span> <span class="n">single_weight</span> <span class="o">**</span> <span class="n">num_possible_dice</span>
</span><span id="DicePool-423"><a href="#DicePool-423"><span class="linenos">423</span></a>            <span class="k">yield</span> <span class="n">pool</span><span class="p">,</span> <span class="n">remaining_count</span><span class="p">,</span> <span class="n">weight</span>
</span><span id="DicePool-424"><a href="#DicePool-424"><span class="linenos">424</span></a>            <span class="k">return</span>
</span><span id="DicePool-425"><a href="#DicePool-425"><span class="linenos">425</span></a>        
</span><span id="DicePool-426"><a href="#DicePool-426"><span class="linenos">426</span></a>        <span class="c1"># Consider various numbers of dice rolling this outcome.</span>
</span><span id="DicePool-427"><a href="#DicePool-427"><span class="linenos">427</span></a>        <span class="n">popped_truncate_min</span> <span class="o">=</span> <span class="p">(</span><span class="n">popped_die</span><span class="o">.</span><span class="n">min_outcome</span><span class="p">(),)</span> <span class="o">*</span> <span class="n">num_possible_dice</span> <span class="o">+</span> <span class="n">truncate_min</span><span class="p">[</span><span class="n">num_possible_dice</span><span class="p">:]</span>
</span><span id="DicePool-428"><a href="#DicePool-428"><span class="linenos">428</span></a>        <span class="n">popped_count_dice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">count_dice</span><span class="p">()</span>
</span><span id="DicePool-429"><a href="#DicePool-429"><span class="linenos">429</span></a>        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DicePool-430"><a href="#DicePool-430"><span class="linenos">430</span></a>        
</span><span id="DicePool-431"><a href="#DicePool-431"><span class="linenos">431</span></a>        <span class="n">comb_row</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">comb_row</span><span class="p">(</span><span class="n">num_possible_dice</span><span class="p">,</span> <span class="n">single_weight</span><span class="p">)</span>
</span><span id="DicePool-432"><a href="#DicePool-432"><span class="linenos">432</span></a>        <span class="n">end_counted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_dice</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_drop_highest</span>
</span><span id="DicePool-433"><a href="#DicePool-433"><span class="linenos">433</span></a>        <span class="k">for</span> <span class="n">weight</span> <span class="ow">in</span> <span class="n">comb_row</span><span class="p">[:</span><span class="nb">min</span><span class="p">(</span><span class="n">num_possible_dice</span><span class="p">,</span> <span class="n">end_counted</span><span class="p">)]:</span>
</span><span id="DicePool-434"><a href="#DicePool-434"><span class="linenos">434</span></a>            <span class="n">pool</span> <span class="o">=</span> <span class="n">_pool_cached_unchecked</span><span class="p">(</span><span class="n">popped_die</span><span class="p">,</span> <span class="n">count_dice</span><span class="o">=</span><span class="n">popped_count_dice</span><span class="p">,</span> <span class="n">truncate_min</span><span class="o">=</span><span class="n">popped_truncate_min</span><span class="p">)</span>
</span><span id="DicePool-435"><a href="#DicePool-435"><span class="linenos">435</span></a>            <span class="k">yield</span> <span class="n">pool</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">weight</span>
</span><span id="DicePool-436"><a href="#DicePool-436"><span class="linenos">436</span></a>            <span class="n">count</span> <span class="o">+=</span> <span class="n">popped_count_dice</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="DicePool-437"><a href="#DicePool-437"><span class="linenos">437</span></a>            <span class="n">popped_truncate_min</span> <span class="o">=</span> <span class="n">popped_truncate_min</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="DicePool-438"><a href="#DicePool-438"><span class="linenos">438</span></a>            <span class="n">popped_count_dice</span> <span class="o">=</span> <span class="n">popped_count_dice</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="DicePool-439"><a href="#DicePool-439"><span class="linenos">439</span></a>        
</span><span id="DicePool-440"><a href="#DicePool-440"><span class="linenos">440</span></a>        <span class="k">if</span> <span class="n">end_counted</span> <span class="o">&gt;</span> <span class="n">num_possible_dice</span><span class="p">:</span>
</span><span id="DicePool-441"><a href="#DicePool-441"><span class="linenos">441</span></a>            <span class="n">pool</span> <span class="o">=</span> <span class="n">_pool_cached_unchecked</span><span class="p">(</span><span class="n">popped_die</span><span class="p">,</span> <span class="n">count_dice</span><span class="o">=</span><span class="n">popped_count_dice</span><span class="p">,</span> <span class="n">truncate_min</span><span class="o">=</span><span class="n">popped_truncate_min</span><span class="p">)</span>
</span><span id="DicePool-442"><a href="#DicePool-442"><span class="linenos">442</span></a>            <span class="k">yield</span> <span class="n">pool</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">comb_row</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="DicePool-443"><a href="#DicePool-443"><span class="linenos">443</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DicePool-444"><a href="#DicePool-444"><span class="linenos">444</span></a>            <span class="c1"># In this case, we ran out of counted dice before running out of dice that could roll the outcome.</span>
</span><span id="DicePool-445"><a href="#DicePool-445"><span class="linenos">445</span></a>            <span class="c1"># We empty the rest of the pool immediately since no more dice can contribute counts.</span>
</span><span id="DicePool-446"><a href="#DicePool-446"><span class="linenos">446</span></a>            <span class="n">skip_weight</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DicePool-447"><a href="#DicePool-447"><span class="linenos">447</span></a>            <span class="k">for</span> <span class="n">weight</span> <span class="ow">in</span> <span class="n">comb_row</span><span class="p">[</span><span class="n">end_counted</span><span class="p">:]:</span>
</span><span id="DicePool-448"><a href="#DicePool-448"><span class="linenos">448</span></a>                <span class="n">skip_weight</span> <span class="o">*=</span> <span class="n">popped_die</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
</span><span id="DicePool-449"><a href="#DicePool-449"><span class="linenos">449</span></a>                <span class="n">skip_weight</span> <span class="o">+=</span> <span class="n">weight</span>
</span><span id="DicePool-450"><a href="#DicePool-450"><span class="linenos">450</span></a>            <span class="n">skip_weight</span> <span class="o">*=</span> <span class="n">math</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">popped_die</span><span class="o">.</span><span class="n">weight_ge</span><span class="p">(</span><span class="n">min_outcome</span><span class="p">)</span> <span class="k">for</span> <span class="n">min_outcome</span> <span class="ow">in</span> <span class="n">truncate_min</span><span class="p">[</span><span class="n">num_possible_dice</span><span class="p">:])</span>
</span><span id="DicePool-451"><a href="#DicePool-451"><span class="linenos">451</span></a>            <span class="n">pool</span> <span class="o">=</span> <span class="n">_pool_cached_unchecked</span><span class="p">(</span><span class="n">popped_die</span><span class="p">,</span> <span class="n">count_dice</span><span class="o">=</span><span class="p">())</span>
</span><span id="DicePool-452"><a href="#DicePool-452"><span class="linenos">452</span></a>            <span class="k">yield</span> <span class="n">pool</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">skip_weight</span>
</span><span id="DicePool-453"><a href="#DicePool-453"><span class="linenos">453</span></a>    
</span><span id="DicePool-454"><a href="#DicePool-454"><span class="linenos">454</span></a>    <span class="k">def</span> <span class="nf">_iter_pop_max</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-455"><a href="#DicePool-455"><span class="linenos">455</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DicePool-456"><a href="#DicePool-456"><span class="linenos">456</span></a><span class="sd">        Yields:</span>
</span><span id="DicePool-457"><a href="#DicePool-457"><span class="linenos">457</span></a><span class="sd">            From 0 to the number of dice that can roll this outcome inclusive:</span>
</span><span id="DicePool-458"><a href="#DicePool-458"><span class="linenos">458</span></a><span class="sd">            * pool: A `DicePool` resulting from removing that many dice from this `DicePool`, while also removing the max outcome.</span>
</span><span id="DicePool-459"><a href="#DicePool-459"><span class="linenos">459</span></a><span class="sd">                If there is only one outcome with weight remaining, only one result will be yielded, corresponding to all dice rolling that outcome.</span>
</span><span id="DicePool-460"><a href="#DicePool-460"><span class="linenos">460</span></a><span class="sd">                If the outcome has zero weight, only one result will be yielded, corresponding to zero dice rolling that outcome.</span>
</span><span id="DicePool-461"><a href="#DicePool-461"><span class="linenos">461</span></a><span class="sd">                If there are no outcomes remaining, this will be `None`.</span>
</span><span id="DicePool-462"><a href="#DicePool-462"><span class="linenos">462</span></a><span class="sd">            * count: An `int` indicating the number of selected dice that rolled the removed outcome.</span>
</span><span id="DicePool-463"><a href="#DicePool-463"><span class="linenos">463</span></a><span class="sd">            * weight: An `int` indicating the weight of that many dice rolling the removed outcome.</span>
</span><span id="DicePool-464"><a href="#DicePool-464"><span class="linenos">464</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DicePool-465"><a href="#DicePool-465"><span class="linenos">465</span></a>        <span class="n">truncate_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncate_max</span><span class="p">(</span><span class="n">always_tuple</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DicePool-466"><a href="#DicePool-466"><span class="linenos">466</span></a>        <span class="n">num_possible_dice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_dice</span><span class="p">()</span> <span class="o">-</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_left</span><span class="p">(</span><span class="n">truncate_max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">die</span><span class="p">()</span><span class="o">.</span><span class="n">max_outcome</span><span class="p">())</span>
</span><span id="DicePool-467"><a href="#DicePool-467"><span class="linenos">467</span></a>        <span class="n">num_unused_dice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_dice</span><span class="p">()</span> <span class="o">-</span> <span class="n">num_possible_dice</span>
</span><span id="DicePool-468"><a href="#DicePool-468"><span class="linenos">468</span></a>        <span class="n">popped_die</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">single_weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">die</span><span class="p">()</span><span class="o">.</span><span class="n">_pop_max</span><span class="p">()</span>
</span><span id="DicePool-469"><a href="#DicePool-469"><span class="linenos">469</span></a>        
</span><span id="DicePool-470"><a href="#DicePool-470"><span class="linenos">470</span></a>        <span class="k">if</span> <span class="n">popped_die</span><span class="o">.</span><span class="n">is_empty</span><span class="p">():</span>
</span><span id="DicePool-471"><a href="#DicePool-471"><span class="linenos">471</span></a>            <span class="c1"># This is the last outcome. All dice must roll this outcome.</span>
</span><span id="DicePool-472"><a href="#DicePool-472"><span class="linenos">472</span></a>            <span class="n">pool</span> <span class="o">=</span> <span class="n">_pool_cached_unchecked</span><span class="p">(</span><span class="n">popped_die</span><span class="p">,</span> <span class="n">count_dice</span><span class="o">=</span><span class="p">())</span>
</span><span id="DicePool-473"><a href="#DicePool-473"><span class="linenos">473</span></a>            <span class="n">remaining_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count_dice</span><span class="p">())</span>
</span><span id="DicePool-474"><a href="#DicePool-474"><span class="linenos">474</span></a>            <span class="n">weight</span> <span class="o">=</span> <span class="n">single_weight</span> <span class="o">**</span> <span class="n">num_possible_dice</span>
</span><span id="DicePool-475"><a href="#DicePool-475"><span class="linenos">475</span></a>            <span class="k">yield</span> <span class="n">pool</span><span class="p">,</span> <span class="n">remaining_count</span><span class="p">,</span> <span class="n">weight</span>
</span><span id="DicePool-476"><a href="#DicePool-476"><span class="linenos">476</span></a>            <span class="k">return</span>
</span><span id="DicePool-477"><a href="#DicePool-477"><span class="linenos">477</span></a>        
</span><span id="DicePool-478"><a href="#DicePool-478"><span class="linenos">478</span></a>        <span class="c1"># Consider various numbers of dice rolling this outcome.</span>
</span><span id="DicePool-479"><a href="#DicePool-479"><span class="linenos">479</span></a>        <span class="n">popped_truncate_max</span> <span class="o">=</span> <span class="n">truncate_max</span><span class="p">[:</span><span class="n">num_unused_dice</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">popped_die</span><span class="o">.</span><span class="n">max_outcome</span><span class="p">(),)</span> <span class="o">*</span> <span class="n">num_possible_dice</span>
</span><span id="DicePool-480"><a href="#DicePool-480"><span class="linenos">480</span></a>        <span class="n">popped_count_dice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">count_dice</span><span class="p">()</span>
</span><span id="DicePool-481"><a href="#DicePool-481"><span class="linenos">481</span></a>        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DicePool-482"><a href="#DicePool-482"><span class="linenos">482</span></a>        
</span><span id="DicePool-483"><a href="#DicePool-483"><span class="linenos">483</span></a>        <span class="n">comb_row</span> <span class="o">=</span> <span class="n">icepool</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">comb_row</span><span class="p">(</span><span class="n">num_possible_dice</span><span class="p">,</span> <span class="n">single_weight</span><span class="p">)</span>
</span><span id="DicePool-484"><a href="#DicePool-484"><span class="linenos">484</span></a>        <span class="n">end_counted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_dice</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_drop_lowest</span>
</span><span id="DicePool-485"><a href="#DicePool-485"><span class="linenos">485</span></a>        <span class="k">for</span> <span class="n">weight</span> <span class="ow">in</span> <span class="n">comb_row</span><span class="p">[:</span><span class="nb">min</span><span class="p">(</span><span class="n">num_possible_dice</span><span class="p">,</span> <span class="n">end_counted</span><span class="p">)]:</span>
</span><span id="DicePool-486"><a href="#DicePool-486"><span class="linenos">486</span></a>            <span class="n">pool</span> <span class="o">=</span> <span class="n">_pool_cached_unchecked</span><span class="p">(</span><span class="n">popped_die</span><span class="p">,</span> <span class="n">count_dice</span><span class="o">=</span><span class="n">popped_count_dice</span><span class="p">,</span> <span class="n">truncate_max</span><span class="o">=</span><span class="n">popped_truncate_max</span><span class="p">)</span>
</span><span id="DicePool-487"><a href="#DicePool-487"><span class="linenos">487</span></a>            <span class="k">yield</span> <span class="n">pool</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">weight</span>
</span><span id="DicePool-488"><a href="#DicePool-488"><span class="linenos">488</span></a>            <span class="n">count</span> <span class="o">+=</span> <span class="n">popped_count_dice</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="DicePool-489"><a href="#DicePool-489"><span class="linenos">489</span></a>            <span class="n">popped_truncate_max</span> <span class="o">=</span> <span class="n">popped_truncate_max</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="DicePool-490"><a href="#DicePool-490"><span class="linenos">490</span></a>            <span class="n">popped_count_dice</span> <span class="o">=</span> <span class="n">popped_count_dice</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="DicePool-491"><a href="#DicePool-491"><span class="linenos">491</span></a>        
</span><span id="DicePool-492"><a href="#DicePool-492"><span class="linenos">492</span></a>        <span class="k">if</span> <span class="n">end_counted</span> <span class="o">&gt;</span> <span class="n">num_possible_dice</span><span class="p">:</span>
</span><span id="DicePool-493"><a href="#DicePool-493"><span class="linenos">493</span></a>            <span class="n">pool</span> <span class="o">=</span> <span class="n">_pool_cached_unchecked</span><span class="p">(</span><span class="n">popped_die</span><span class="p">,</span> <span class="n">count_dice</span><span class="o">=</span><span class="n">popped_count_dice</span><span class="p">,</span> <span class="n">truncate_max</span><span class="o">=</span><span class="n">popped_truncate_max</span><span class="p">)</span>
</span><span id="DicePool-494"><a href="#DicePool-494"><span class="linenos">494</span></a>            <span class="k">yield</span> <span class="n">pool</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">comb_row</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="DicePool-495"><a href="#DicePool-495"><span class="linenos">495</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DicePool-496"><a href="#DicePool-496"><span class="linenos">496</span></a>            <span class="c1"># In this case, we ran out of counted dice before running out of dice that could roll the outcome.</span>
</span><span id="DicePool-497"><a href="#DicePool-497"><span class="linenos">497</span></a>            <span class="c1"># We empty the rest of the pool immediately since no more dice can contribute counts.</span>
</span><span id="DicePool-498"><a href="#DicePool-498"><span class="linenos">498</span></a>            <span class="n">skip_weight</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DicePool-499"><a href="#DicePool-499"><span class="linenos">499</span></a>            <span class="k">for</span> <span class="n">weight</span> <span class="ow">in</span> <span class="n">comb_row</span><span class="p">[</span><span class="n">end_counted</span><span class="p">:]:</span>
</span><span id="DicePool-500"><a href="#DicePool-500"><span class="linenos">500</span></a>                <span class="n">skip_weight</span> <span class="o">*=</span> <span class="n">popped_die</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
</span><span id="DicePool-501"><a href="#DicePool-501"><span class="linenos">501</span></a>                <span class="n">skip_weight</span> <span class="o">+=</span> <span class="n">weight</span>
</span><span id="DicePool-502"><a href="#DicePool-502"><span class="linenos">502</span></a>            <span class="n">skip_weight</span> <span class="o">*=</span> <span class="n">math</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">popped_die</span><span class="o">.</span><span class="n">weight_le</span><span class="p">(</span><span class="n">max_outcome</span><span class="p">)</span> <span class="k">for</span> <span class="n">max_outcome</span> <span class="ow">in</span> <span class="n">truncate_max</span><span class="p">[:</span><span class="n">num_unused_dice</span><span class="p">])</span>
</span><span id="DicePool-503"><a href="#DicePool-503"><span class="linenos">503</span></a>            <span class="n">pool</span> <span class="o">=</span> <span class="n">_pool_cached_unchecked</span><span class="p">(</span><span class="n">popped_die</span><span class="p">,</span> <span class="n">count_dice</span><span class="o">=</span><span class="p">())</span>
</span><span id="DicePool-504"><a href="#DicePool-504"><span class="linenos">504</span></a>            <span class="k">yield</span> <span class="n">pool</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">skip_weight</span>
</span><span id="DicePool-505"><a href="#DicePool-505"><span class="linenos">505</span></a>    
</span><span id="DicePool-506"><a href="#DicePool-506"><span class="linenos">506</span></a>    <span class="nd">@cached_property</span>
</span><span id="DicePool-507"><a href="#DicePool-507"><span class="linenos">507</span></a>    <span class="k">def</span> <span class="nf">_popped_min</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-508"><a href="#DicePool-508"><span class="linenos">508</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncate_max</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DicePool-509"><a href="#DicePool-509"><span class="linenos">509</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;pop_min is not valid with truncate_min.&#39;</span><span class="p">)</span>
</span><span id="DicePool-510"><a href="#DicePool-510"><span class="linenos">510</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iter_pop_min</span><span class="p">())</span>
</span><span id="DicePool-511"><a href="#DicePool-511"><span class="linenos">511</span></a>    
</span><span id="DicePool-512"><a href="#DicePool-512"><span class="linenos">512</span></a>    <span class="k">def</span> <span class="nf">_pop_min</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-513"><a href="#DicePool-513"><span class="linenos">513</span></a>        <span class="sd">&quot;&quot;&quot; Returns a sequence of pool, count, weight corresponding to removing the min outcome,</span>
</span><span id="DicePool-514"><a href="#DicePool-514"><span class="linenos">514</span></a><span class="sd">        with count and weight corresponding to various numbers of dice rolling that outcome.</span>
</span><span id="DicePool-515"><a href="#DicePool-515"><span class="linenos">515</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DicePool-516"><a href="#DicePool-516"><span class="linenos">516</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_popped_min</span>
</span><span id="DicePool-517"><a href="#DicePool-517"><span class="linenos">517</span></a>        
</span><span id="DicePool-518"><a href="#DicePool-518"><span class="linenos">518</span></a>    <span class="nd">@cached_property</span>
</span><span id="DicePool-519"><a href="#DicePool-519"><span class="linenos">519</span></a>    <span class="k">def</span> <span class="nf">_popped_max</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-520"><a href="#DicePool-520"><span class="linenos">520</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncate_min</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DicePool-521"><a href="#DicePool-521"><span class="linenos">521</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;pop_max is not valid with truncate_min.&#39;</span><span class="p">)</span>
</span><span id="DicePool-522"><a href="#DicePool-522"><span class="linenos">522</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iter_pop_max</span><span class="p">())</span>
</span><span id="DicePool-523"><a href="#DicePool-523"><span class="linenos">523</span></a>    
</span><span id="DicePool-524"><a href="#DicePool-524"><span class="linenos">524</span></a>    <span class="k">def</span> <span class="nf">_pop_max</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-525"><a href="#DicePool-525"><span class="linenos">525</span></a>        <span class="sd">&quot;&quot;&quot; Returns a sequence of pool, count, weight corresponding to removing the max outcome,</span>
</span><span id="DicePool-526"><a href="#DicePool-526"><span class="linenos">526</span></a><span class="sd">        with count and weight corresponding to various numbers of dice rolling that outcome.</span>
</span><span id="DicePool-527"><a href="#DicePool-527"><span class="linenos">527</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DicePool-528"><a href="#DicePool-528"><span class="linenos">528</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_popped_max</span>
</span><span id="DicePool-529"><a href="#DicePool-529"><span class="linenos">529</span></a>        
</span><span id="DicePool-530"><a href="#DicePool-530"><span class="linenos">530</span></a>    <span class="k">def</span> <span class="nf">has_counted_dice</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-531"><a href="#DicePool-531"><span class="linenos">531</span></a>        <span class="sd">&quot;&quot;&quot; Returns `True` iff any of the remaining dice are counted a nonzero number of times.</span>
</span><span id="DicePool-532"><a href="#DicePool-532"><span class="linenos">532</span></a><span class="sd">        </span>
</span><span id="DicePool-533"><a href="#DicePool-533"><span class="linenos">533</span></a><span class="sd">        This is used to skip to the base case when there are no more dice to consider.</span>
</span><span id="DicePool-534"><a href="#DicePool-534"><span class="linenos">534</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DicePool-535"><a href="#DicePool-535"><span class="linenos">535</span></a>        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count_dice</span><span class="p">())</span>
</span><span id="DicePool-536"><a href="#DicePool-536"><span class="linenos">536</span></a>    
</span><span id="DicePool-537"><a href="#DicePool-537"><span class="linenos">537</span></a>    <span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-538"><a href="#DicePool-538"><span class="linenos">538</span></a>        <span class="sd">&quot;&quot;&quot; Samples a roll from this pool.</span>
</span><span id="DicePool-539"><a href="#DicePool-539"><span class="linenos">539</span></a><span class="sd">        </span>
</span><span id="DicePool-540"><a href="#DicePool-540"><span class="linenos">540</span></a><span class="sd">        Returns:</span>
</span><span id="DicePool-541"><a href="#DicePool-541"><span class="linenos">541</span></a><span class="sd">            A dict mapping outcomes to counts representing a single roll of this pool.</span>
</span><span id="DicePool-542"><a href="#DicePool-542"><span class="linenos">542</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DicePool-543"><a href="#DicePool-543"><span class="linenos">543</span></a>        <span class="n">raw_rolls</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DicePool-544"><a href="#DicePool-544"><span class="linenos">544</span></a>        <span class="k">for</span> <span class="n">min_outcome</span><span class="p">,</span> <span class="n">max_outcome</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_min</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncate_max</span><span class="p">(</span><span class="kc">True</span><span class="p">)):</span>
</span><span id="DicePool-545"><a href="#DicePool-545"><span class="linenos">545</span></a>            <span class="n">die</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">die</span><span class="p">()</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="n">min_outcome</span><span class="p">,</span> <span class="n">max_outcome</span><span class="p">)</span>
</span><span id="DicePool-546"><a href="#DicePool-546"><span class="linenos">546</span></a>            <span class="n">raw_rolls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
</span><span id="DicePool-547"><a href="#DicePool-547"><span class="linenos">547</span></a>        <span class="n">raw_rolls</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">raw_rolls</span><span class="p">)</span>
</span><span id="DicePool-548"><a href="#DicePool-548"><span class="linenos">548</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="DicePool-549"><a href="#DicePool-549"><span class="linenos">549</span></a>        <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">raw_rolls</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">count_dice</span><span class="p">()):</span>
</span><span id="DicePool-550"><a href="#DicePool-550"><span class="linenos">550</span></a>            <span class="n">data</span><span class="p">[</span><span class="n">roll</span><span class="p">]</span> <span class="o">+=</span> <span class="n">count</span>
</span><span id="DicePool-551"><a href="#DicePool-551"><span class="linenos">551</span></a>        <span class="k">return</span> <span class="n">data</span>
</span><span id="DicePool-552"><a href="#DicePool-552"><span class="linenos">552</span></a>    
</span><span id="DicePool-553"><a href="#DicePool-553"><span class="linenos">553</span></a>    <span class="nd">@cached_property</span>
</span><span id="DicePool-554"><a href="#DicePool-554"><span class="linenos">554</span></a>    <span class="k">def</span> <span class="nf">_key_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-555"><a href="#DicePool-555"><span class="linenos">555</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">die</span><span class="p">()</span><span class="o">.</span><span class="n">key_tuple</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">count_dice</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncate_min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncate_max</span><span class="p">()</span>
</span><span id="DicePool-556"><a href="#DicePool-556"><span class="linenos">556</span></a>    
</span><span id="DicePool-557"><a href="#DicePool-557"><span class="linenos">557</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="DicePool-558"><a href="#DicePool-558"><span class="linenos">558</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">DicePool</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
</span><span id="DicePool-559"><a href="#DicePool-559"><span class="linenos">559</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_key_tuple</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_key_tuple</span>
</span><span id="DicePool-560"><a href="#DicePool-560"><span class="linenos">560</span></a>    
</span><span id="DicePool-561"><a href="#DicePool-561"><span class="linenos">561</span></a>    <span class="nd">@cached_property</span>
</span><span id="DicePool-562"><a href="#DicePool-562"><span class="linenos">562</span></a>    <span class="k">def</span> <span class="nf">_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-563"><a href="#DicePool-563"><span class="linenos">563</span></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_key_tuple</span><span class="p">)</span>
</span><span id="DicePool-564"><a href="#DicePool-564"><span class="linenos">564</span></a>        
</span><span id="DicePool-565"><a href="#DicePool-565"><span class="linenos">565</span></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-566"><a href="#DicePool-566"><span class="linenos">566</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hash</span>
</span><span id="DicePool-567"><a href="#DicePool-567"><span class="linenos">567</span></a>
</span><span id="DicePool-568"><a href="#DicePool-568"><span class="linenos">568</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool-569"><a href="#DicePool-569"><span class="linenos">569</span></a>        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">die</span><span class="p">()),</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count_dice</span><span class="p">()),</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_min</span><span class="p">()),</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_max</span><span class="p">())])</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>A pool is a set of (semi-)identical dice that are rolled in no particular order
and sorted only after the fact.</p>

<p>A pool is defined by:</p>

<ul>
<li>A fundamental die.</li>
<li>The number of dice in the pool.</li>
<li>Which of the sorted positions are counted (possibly multiple or negative times).</li>
<li>Possibly limiting the max or min outcomes of dice in the pool (but not both)
relative to the fundamental die.</li>
</ul>
</div>


                            <div id="DicePool.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#DicePool.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">DicePool</span><span class="signature">(die, count_dice, *, truncate_min, truncate_max)</span>
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DicePool.__init__-226"><a href="#DicePool.__init__-226"><span class="linenos">226</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">die</span><span class="p">,</span> <span class="n">count_dice</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">truncate_min</span><span class="p">,</span> <span class="n">truncate_max</span><span class="p">):</span>
</span><span id="DicePool.__init__-227"><a href="#DicePool.__init__-227"><span class="linenos">227</span></a>        <span class="sd">&quot;&quot;&quot; Unchecked constructor.</span>
</span><span id="DicePool.__init__-228"><a href="#DicePool.__init__-228"><span class="linenos">228</span></a><span class="sd">        </span>
</span><span id="DicePool.__init__-229"><a href="#DicePool.__init__-229"><span class="linenos">229</span></a><span class="sd">        This should not be used directly. Use the `Pool()` factory function instead.</span>
</span><span id="DicePool.__init__-230"><a href="#DicePool.__init__-230"><span class="linenos">230</span></a><span class="sd">        </span>
</span><span id="DicePool.__init__-231"><a href="#DicePool.__init__-231"><span class="linenos">231</span></a><span class="sd">        Args:</span>
</span><span id="DicePool.__init__-232"><a href="#DicePool.__init__-232"><span class="linenos">232</span></a><span class="sd">            die: The fundamental die of the pool.</span>
</span><span id="DicePool.__init__-233"><a href="#DicePool.__init__-233"><span class="linenos">233</span></a><span class="sd">            count_dice: At this point, this should be a tuple the length of the pool.</span>
</span><span id="DicePool.__init__-234"><a href="#DicePool.__init__-234"><span class="linenos">234</span></a><span class="sd">            truncate_max: At this point this should be a tuple the length of the pool or `None`.</span>
</span><span id="DicePool.__init__-235"><a href="#DicePool.__init__-235"><span class="linenos">235</span></a><span class="sd">            truncate_min: At this point this should be a tuple the length of the pool or `None`.</span>
</span><span id="DicePool.__init__-236"><a href="#DicePool.__init__-236"><span class="linenos">236</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DicePool.__init__-237"><a href="#DicePool.__init__-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_die</span> <span class="o">=</span> <span class="n">die</span>
</span><span id="DicePool.__init__-238"><a href="#DicePool.__init__-238"><span class="linenos">238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_count_dice</span> <span class="o">=</span> <span class="n">count_dice</span>
</span><span id="DicePool.__init__-239"><a href="#DicePool.__init__-239"><span class="linenos">239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_truncate_max</span> <span class="o">=</span> <span class="n">truncate_max</span>
</span><span id="DicePool.__init__-240"><a href="#DicePool.__init__-240"><span class="linenos">240</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_truncate_min</span> <span class="o">=</span> <span class="n">truncate_min</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Unchecked constructor.</p>

<p>This should not be used directly. Use the <code><a href="#Pool">Pool()</a></code> factory function instead.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>die:</strong>  The fundamental die of the pool.</li>
<li><strong>count_dice:</strong>  At this point, this should be a tuple the length of the pool.</li>
<li><strong>truncate_max:</strong>  At this point this should be a tuple the length of the pool or <code>None</code>.</li>
<li><strong>truncate_min:</strong>  At this point this should be a tuple the length of the pool or <code>None</code>.</li>
</ul>
</div>


                            </div>
                            <div id="DicePool.die" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#DicePool.die">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">die</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DicePool.die-245"><a href="#DicePool.die-245"><span class="linenos">245</span></a>    <span class="k">def</span> <span class="nf">die</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool.die-246"><a href="#DicePool.die-246"><span class="linenos">246</span></a>        <span class="sd">&quot;&quot;&quot; The fundamental die of the pool. &quot;&quot;&quot;</span>
</span><span id="DicePool.die-247"><a href="#DicePool.die-247"><span class="linenos">247</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_die</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>The fundamental die of the pool.</p>
</div>


                            </div>
                            <div id="DicePool.outcomes" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#DicePool.outcomes">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">outcomes</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DicePool.outcomes-249"><a href="#DicePool.outcomes-249"><span class="linenos">249</span></a>    <span class="k">def</span> <span class="nf">outcomes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool.outcomes-250"><a href="#DicePool.outcomes-250"><span class="linenos">250</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">die</span><span class="p">()</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>The outcomes of the fundamental die (including those with zero weight).</p>
</div>


                            </div>
                            <div id="DicePool.count_dice" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#DicePool.count_dice">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">count_dice</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DicePool.count_dice-258"><a href="#DicePool.count_dice-258"><span class="linenos">258</span></a>    <span class="k">def</span> <span class="nf">count_dice</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool.count_dice-259"><a href="#DicePool.count_dice-259"><span class="linenos">259</span></a>        <span class="sd">&quot;&quot;&quot; A tuple indicating how many times each of the dice, sorted from lowest to highest, counts. &quot;&quot;&quot;</span>
</span><span id="DicePool.count_dice-260"><a href="#DicePool.count_dice-260"><span class="linenos">260</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_count_dice</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>A tuple indicating how many times each of the dice, sorted from lowest to highest, counts.</p>
</div>


                            </div>
                            <div id="DicePool.num_dice" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#DicePool.num_dice">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">num_dice</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DicePool.num_dice-262"><a href="#DicePool.num_dice-262"><span class="linenos">262</span></a>    <span class="k">def</span> <span class="nf">num_dice</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool.num_dice-263"><a href="#DicePool.num_dice-263"><span class="linenos">263</span></a>        <span class="sd">&quot;&quot;&quot; The number of dice in this pool (before dropping or counting multiple times). &quot;&quot;&quot;</span>
</span><span id="DicePool.num_dice-264"><a href="#DicePool.num_dice-264"><span class="linenos">264</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_count_dice</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>The number of dice in this pool (before dropping or counting multiple times).</p>
</div>


                            </div>
                            <div id="DicePool.set_count_dice" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#DicePool.set_count_dice">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">set_count_dice</span><span class="signature">(self, count_dice)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DicePool.set_count_dice-266"><a href="#DicePool.set_count_dice-266"><span class="linenos">266</span></a>    <span class="k">def</span> <span class="nf">set_count_dice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">count_dice</span><span class="p">):</span>
</span><span id="DicePool.set_count_dice-267"><a href="#DicePool.set_count_dice-267"><span class="linenos">267</span></a>        <span class="sd">&quot;&quot;&quot; Returns a pool with the selected dice counted.</span>
</span><span id="DicePool.set_count_dice-268"><a href="#DicePool.set_count_dice-268"><span class="linenos">268</span></a><span class="sd">        </span>
</span><span id="DicePool.set_count_dice-269"><a href="#DicePool.set_count_dice-269"><span class="linenos">269</span></a><span class="sd">        You can use `pool[count_dice]` for the same effect as this method.</span>
</span><span id="DicePool.set_count_dice-270"><a href="#DicePool.set_count_dice-270"><span class="linenos">270</span></a><span class="sd">        </span>
</span><span id="DicePool.set_count_dice-271"><a href="#DicePool.set_count_dice-271"><span class="linenos">271</span></a><span class="sd">        The dice are sorted in ascending order for this purpose,</span>
</span><span id="DicePool.set_count_dice-272"><a href="#DicePool.set_count_dice-272"><span class="linenos">272</span></a><span class="sd">        regardless of which order the outcomes are evaluated in.</span>
</span><span id="DicePool.set_count_dice-273"><a href="#DicePool.set_count_dice-273"><span class="linenos">273</span></a><span class="sd">        </span>
</span><span id="DicePool.set_count_dice-274"><a href="#DicePool.set_count_dice-274"><span class="linenos">274</span></a><span class="sd">        This is always an absolute selection on all `num_dice`,</span>
</span><span id="DicePool.set_count_dice-275"><a href="#DicePool.set_count_dice-275"><span class="linenos">275</span></a><span class="sd">        not a relative selection on already-selected dice,</span>
</span><span id="DicePool.set_count_dice-276"><a href="#DicePool.set_count_dice-276"><span class="linenos">276</span></a><span class="sd">        which would be ambiguous in the presence of multiple or negative counts.</span>
</span><span id="DicePool.set_count_dice-277"><a href="#DicePool.set_count_dice-277"><span class="linenos">277</span></a><span class="sd">        </span>
</span><span id="DicePool.set_count_dice-278"><a href="#DicePool.set_count_dice-278"><span class="linenos">278</span></a><span class="sd">        Args:</span>
</span><span id="DicePool.set_count_dice-279"><a href="#DicePool.set_count_dice-279"><span class="linenos">279</span></a><span class="sd">            `None`: All dice will be counted once.</span>
</span><span id="DicePool.set_count_dice-280"><a href="#DicePool.set_count_dice-280"><span class="linenos">280</span></a><span class="sd">            An `int`. This will count only the die at the specified index (once).</span>
</span><span id="DicePool.set_count_dice-281"><a href="#DicePool.set_count_dice-281"><span class="linenos">281</span></a><span class="sd">                In this case, the result will be a die, not a pool.</span>
</span><span id="DicePool.set_count_dice-282"><a href="#DicePool.set_count_dice-282"><span class="linenos">282</span></a><span class="sd">            A `slice`. The selected dice are counted once each.</span>
</span><span id="DicePool.set_count_dice-283"><a href="#DicePool.set_count_dice-283"><span class="linenos">283</span></a><span class="sd">                If provided, the third argument resizes the pool,</span>
</span><span id="DicePool.set_count_dice-284"><a href="#DicePool.set_count_dice-284"><span class="linenos">284</span></a><span class="sd">                rather than being a step,</span>
</span><span id="DicePool.set_count_dice-285"><a href="#DicePool.set_count_dice-285"><span class="linenos">285</span></a><span class="sd">                but only if the pool does not have `truncate_max` or `truncate_min`.</span>
</span><span id="DicePool.set_count_dice-286"><a href="#DicePool.set_count_dice-286"><span class="linenos">286</span></a><span class="sd">            A sequence of one `int`s for each die.</span>
</span><span id="DicePool.set_count_dice-287"><a href="#DicePool.set_count_dice-287"><span class="linenos">287</span></a><span class="sd">                Each die is counted that many times, which could be multiple or negative times.</span>
</span><span id="DicePool.set_count_dice-288"><a href="#DicePool.set_count_dice-288"><span class="linenos">288</span></a><span class="sd">                This may resize the pool, but only if the pool does not have `truncate_max` or `truncate_min`.</span>
</span><span id="DicePool.set_count_dice-289"><a href="#DicePool.set_count_dice-289"><span class="linenos">289</span></a><span class="sd">                </span>
</span><span id="DicePool.set_count_dice-290"><a href="#DicePool.set_count_dice-290"><span class="linenos">290</span></a><span class="sd">                Up to one `Ellipsis` (`...`) may be used.</span>
</span><span id="DicePool.set_count_dice-291"><a href="#DicePool.set_count_dice-291"><span class="linenos">291</span></a><span class="sd">                If an `Ellipsis` is used, the size of the pool won&#39;t change. Instead:</span>
</span><span id="DicePool.set_count_dice-292"><a href="#DicePool.set_count_dice-292"><span class="linenos">292</span></a><span class="sd">                </span>
</span><span id="DicePool.set_count_dice-293"><a href="#DicePool.set_count_dice-293"><span class="linenos">293</span></a><span class="sd">                * If `count_dice` is shorter than `num_dice`, the `Ellipsis`</span>
</span><span id="DicePool.set_count_dice-294"><a href="#DicePool.set_count_dice-294"><span class="linenos">294</span></a><span class="sd">                    acts as enough zero counts to make up the difference.</span>
</span><span id="DicePool.set_count_dice-295"><a href="#DicePool.set_count_dice-295"><span class="linenos">295</span></a><span class="sd">                    For example, `pool[1, ..., 1]` on five dice would act as `pool[1, 0, 0, 0, 1]`.</span>
</span><span id="DicePool.set_count_dice-296"><a href="#DicePool.set_count_dice-296"><span class="linenos">296</span></a><span class="sd">                * If `count_dice` has length equal to `num_dice`, the `Ellipsis` has no effect.</span>
</span><span id="DicePool.set_count_dice-297"><a href="#DicePool.set_count_dice-297"><span class="linenos">297</span></a><span class="sd">                    For example, `pool[1, ..., 1]` on two dice would act as `pool[1, 1]`.</span>
</span><span id="DicePool.set_count_dice-298"><a href="#DicePool.set_count_dice-298"><span class="linenos">298</span></a><span class="sd">                * If `count_dice` is longer than `num_dice` and the `Ellipsis` is on one side,</span>
</span><span id="DicePool.set_count_dice-299"><a href="#DicePool.set_count_dice-299"><span class="linenos">299</span></a><span class="sd">                    elements will be dropped from `count_dice` on the side with the `Ellipsis`.</span>
</span><span id="DicePool.set_count_dice-300"><a href="#DicePool.set_count_dice-300"><span class="linenos">300</span></a><span class="sd">                    For example, `pool[..., 1, 2, 3]` on two dice would act as `pool[2, 3]`.</span>
</span><span id="DicePool.set_count_dice-301"><a href="#DicePool.set_count_dice-301"><span class="linenos">301</span></a><span class="sd">                * If `count_dice` is longer than `num_dice` and the `Ellipsis` is in the middle,</span>
</span><span id="DicePool.set_count_dice-302"><a href="#DicePool.set_count_dice-302"><span class="linenos">302</span></a><span class="sd">                    the counts will be as the sum of two one-sided `Ellipsis`.</span>
</span><span id="DicePool.set_count_dice-303"><a href="#DicePool.set_count_dice-303"><span class="linenos">303</span></a><span class="sd">                    For example, `pool[-1, ..., 1]` acts like `[-1, ...]` plus `[..., 1]`.</span>
</span><span id="DicePool.set_count_dice-304"><a href="#DicePool.set_count_dice-304"><span class="linenos">304</span></a><span class="sd">                    On a pool consisting of a single single die this would have the -1 and 1 cancel each other out.</span>
</span><span id="DicePool.set_count_dice-305"><a href="#DicePool.set_count_dice-305"><span class="linenos">305</span></a><span class="sd">        </span>
</span><span id="DicePool.set_count_dice-306"><a href="#DicePool.set_count_dice-306"><span class="linenos">306</span></a><span class="sd">        Raises:</span>
</span><span id="DicePool.set_count_dice-307"><a href="#DicePool.set_count_dice-307"><span class="linenos">307</span></a><span class="sd">            ValueError:</span>
</span><span id="DicePool.set_count_dice-308"><a href="#DicePool.set_count_dice-308"><span class="linenos">308</span></a><span class="sd">            </span>
</span><span id="DicePool.set_count_dice-309"><a href="#DicePool.set_count_dice-309"><span class="linenos">309</span></a><span class="sd">                * If `count_dice` would change the size of a pool with `truncate_max` or `truncate_min`.</span>
</span><span id="DicePool.set_count_dice-310"><a href="#DicePool.set_count_dice-310"><span class="linenos">310</span></a><span class="sd">                * If more than one `Ellipsis` is used.</span>
</span><span id="DicePool.set_count_dice-311"><a href="#DicePool.set_count_dice-311"><span class="linenos">311</span></a><span class="sd">        </span>
</span><span id="DicePool.set_count_dice-312"><a href="#DicePool.set_count_dice-312"><span class="linenos">312</span></a><span class="sd">        For example, here are some ways of selecting the two highest dice out of 5:</span>
</span><span id="DicePool.set_count_dice-313"><a href="#DicePool.set_count_dice-313"><span class="linenos">313</span></a><span class="sd">        </span>
</span><span id="DicePool.set_count_dice-314"><a href="#DicePool.set_count_dice-314"><span class="linenos">314</span></a><span class="sd">        * `pool[3:5]`</span>
</span><span id="DicePool.set_count_dice-315"><a href="#DicePool.set_count_dice-315"><span class="linenos">315</span></a><span class="sd">        * `pool[3:]`</span>
</span><span id="DicePool.set_count_dice-316"><a href="#DicePool.set_count_dice-316"><span class="linenos">316</span></a><span class="sd">        * `pool[-2:]`</span>
</span><span id="DicePool.set_count_dice-317"><a href="#DicePool.set_count_dice-317"><span class="linenos">317</span></a><span class="sd">        * `pool[..., 1, 1]`</span>
</span><span id="DicePool.set_count_dice-318"><a href="#DicePool.set_count_dice-318"><span class="linenos">318</span></a><span class="sd">        </span>
</span><span id="DicePool.set_count_dice-319"><a href="#DicePool.set_count_dice-319"><span class="linenos">319</span></a><span class="sd">        These will also select the two highest dice out of 5, and will also resize the pool to 5 dice first:</span>
</span><span id="DicePool.set_count_dice-320"><a href="#DicePool.set_count_dice-320"><span class="linenos">320</span></a><span class="sd">        </span>
</span><span id="DicePool.set_count_dice-321"><a href="#DicePool.set_count_dice-321"><span class="linenos">321</span></a><span class="sd">        * `pool[3::5]`</span>
</span><span id="DicePool.set_count_dice-322"><a href="#DicePool.set_count_dice-322"><span class="linenos">322</span></a><span class="sd">        * `pool[3:5:5]`</span>
</span><span id="DicePool.set_count_dice-323"><a href="#DicePool.set_count_dice-323"><span class="linenos">323</span></a><span class="sd">        * `pool[-2::5]`</span>
</span><span id="DicePool.set_count_dice-324"><a href="#DicePool.set_count_dice-324"><span class="linenos">324</span></a><span class="sd">        * `pool[0, 0, 0, 1, 1]`</span>
</span><span id="DicePool.set_count_dice-325"><a href="#DicePool.set_count_dice-325"><span class="linenos">325</span></a><span class="sd">        </span>
</span><span id="DicePool.set_count_dice-326"><a href="#DicePool.set_count_dice-326"><span class="linenos">326</span></a><span class="sd">        These will count the highest as a positive and the lowest as a negative:</span>
</span><span id="DicePool.set_count_dice-327"><a href="#DicePool.set_count_dice-327"><span class="linenos">327</span></a><span class="sd">        </span>
</span><span id="DicePool.set_count_dice-328"><a href="#DicePool.set_count_dice-328"><span class="linenos">328</span></a><span class="sd">        * `pool[-1, 0, 0, 0, 1]`</span>
</span><span id="DicePool.set_count_dice-329"><a href="#DicePool.set_count_dice-329"><span class="linenos">329</span></a><span class="sd">        * `pool[-1, ..., 1]`</span>
</span><span id="DicePool.set_count_dice-330"><a href="#DicePool.set_count_dice-330"><span class="linenos">330</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DicePool.set_count_dice-331"><a href="#DicePool.set_count_dice-331"><span class="linenos">331</span></a>        <span class="n">convert_to_die</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">count_dice</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="DicePool.set_count_dice-332"><a href="#DicePool.set_count_dice-332"><span class="linenos">332</span></a>        <span class="n">count_dice</span> <span class="o">=</span> <span class="n">count_dice_tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_dice</span><span class="p">(),</span> <span class="n">count_dice</span><span class="p">)</span>
</span><span id="DicePool.set_count_dice-333"><a href="#DicePool.set_count_dice-333"><span class="linenos">333</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">count_dice</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_dice</span><span class="p">():</span>
</span><span id="DicePool.set_count_dice-334"><a href="#DicePool.set_count_dice-334"><span class="linenos">334</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncate_max</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DicePool.set_count_dice-335"><a href="#DicePool.set_count_dice-335"><span class="linenos">335</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot change the size of a pool with truncate_max.&#39;</span><span class="p">)</span>
</span><span id="DicePool.set_count_dice-336"><a href="#DicePool.set_count_dice-336"><span class="linenos">336</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncate_min</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DicePool.set_count_dice-337"><a href="#DicePool.set_count_dice-337"><span class="linenos">337</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot change the size of a pool with truncate_min.&#39;</span><span class="p">)</span>
</span><span id="DicePool.set_count_dice-338"><a href="#DicePool.set_count_dice-338"><span class="linenos">338</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">_pool_cached_unchecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">die</span><span class="p">(),</span> <span class="n">count_dice</span><span class="o">=</span><span class="n">count_dice</span><span class="p">,</span> <span class="n">truncate_max</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_max</span><span class="p">(),</span> <span class="n">truncate_min</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_min</span><span class="p">())</span>
</span><span id="DicePool.set_count_dice-339"><a href="#DicePool.set_count_dice-339"><span class="linenos">339</span></a>        <span class="k">if</span> <span class="n">convert_to_die</span><span class="p">:</span>
</span><span id="DicePool.set_count_dice-340"><a href="#DicePool.set_count_dice-340"><span class="linenos">340</span></a>            <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="k">lambda</span> <span class="n">state</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="n">outcome</span> <span class="k">if</span> <span class="n">count</span> <span class="k">else</span> <span class="n">state</span><span class="p">)</span>
</span><span id="DicePool.set_count_dice-341"><a href="#DicePool.set_count_dice-341"><span class="linenos">341</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DicePool.set_count_dice-342"><a href="#DicePool.set_count_dice-342"><span class="linenos">342</span></a>            <span class="k">return</span> <span class="n">result</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns a pool with the selected dice counted.</p>

<p>You can use <code>pool[count_dice]</code> for the same effect as this method.</p>

<p>The dice are sorted in ascending order for this purpose,
regardless of which order the outcomes are evaluated in.</p>

<p>This is always an absolute selection on all <code><a href="#DicePool.num_dice">num_dice</a></code>,
not a relative selection on already-selected dice,
which would be ambiguous in the presence of multiple or negative counts.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong><code>None</code>:</strong>  All dice will be counted once.</li>
<li>An <code>int</code>. This will count only the die at the specified index (once).
In this case, the result will be a die, not a pool.</li>
<li>A <code>slice</code>. The selected dice are counted once each.
If provided, the third argument resizes the pool,
rather than being a step,
but only if the pool does not have <code><a href="#DicePool.truncate_max">truncate_max</a></code> or <code><a href="#DicePool.truncate_min">truncate_min</a></code>.</li>
<li><p>A sequence of one <code>int</code>s for each die.
Each die is counted that many times, which could be multiple or negative times.
This may resize the pool, but only if the pool does not have <code><a href="#DicePool.truncate_max">truncate_max</a></code> or <code><a href="#DicePool.truncate_min">truncate_min</a></code>.</p>

<p>Up to one <code>Ellipsis</code> (<code>...</code>) may be used.
If an <code>Ellipsis</code> is used, the size of the pool won't change. Instead:</p>

<ul>
<li>If <code><a href="#DicePool.count_dice">count_dice</a></code> is shorter than <code><a href="#DicePool.num_dice">num_dice</a></code>, the <code>Ellipsis</code>
acts as enough zero counts to make up the difference.
For example, <code>pool[1, ..., 1]</code> on five dice would act as <code>pool[1, 0, 0, 0, 1]</code>.</li>
<li>If <code><a href="#DicePool.count_dice">count_dice</a></code> has length equal to <code><a href="#DicePool.num_dice">num_dice</a></code>, the <code>Ellipsis</code> has no effect.
For example, <code>pool[1, ..., 1]</code> on two dice would act as <code>pool[1, 1]</code>.</li>
<li>If <code><a href="#DicePool.count_dice">count_dice</a></code> is longer than <code><a href="#DicePool.num_dice">num_dice</a></code> and the <code>Ellipsis</code> is on one side,
elements will be dropped from <code><a href="#DicePool.count_dice">count_dice</a></code> on the side with the <code>Ellipsis</code>.
For example, <code>pool[..., 1, 2, 3]</code> on two dice would act as <code>pool[2, 3]</code>.</li>
<li>If <code><a href="#DicePool.count_dice">count_dice</a></code> is longer than <code><a href="#DicePool.num_dice">num_dice</a></code> and the <code>Ellipsis</code> is in the middle,
the counts will be as the sum of two one-sided <code>Ellipsis</code>.
For example, <code>pool[-1, ..., 1]</code> acts like <code>[-1, ...]</code> plus <code>[..., 1]</code>.
On a pool consisting of a single single die this would have the -1 and 1 cancel each other out.</li>
</ul></li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError:</strong>   * If <code><a href="#DicePool.count_dice">count_dice</a></code> would change the size of a pool with <code><a href="#DicePool.truncate_max">truncate_max</a></code> or <code><a href="#DicePool.truncate_min">truncate_min</a></code>.
<ul>
<li>If more than one <code>Ellipsis</code> is used.</li>
</ul></li>
</ul>

<p>For example, here are some ways of selecting the two highest dice out of 5:</p>

<ul>
<li><code>pool[3:5]</code></li>
<li><code>pool[3:]</code></li>
<li><code>pool[-2:]</code></li>
<li><code>pool[..., 1, 1]</code></li>
</ul>

<p>These will also select the two highest dice out of 5, and will also resize the pool to 5 dice first:</p>

<ul>
<li><code>pool[3::5]</code></li>
<li><code>pool[3:5:5]</code></li>
<li><code>pool[-2::5]</code></li>
<li><code>pool[0, 0, 0, 1, 1]</code></li>
</ul>

<p>These will count the highest as a positive and the lowest as a negative:</p>

<ul>
<li><code>pool[-1, 0, 0, 0, 1]</code></li>
<li><code>pool[-1, ..., 1]</code></li>
</ul>
</div>


                            </div>
                            <div id="DicePool.truncate_min" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#DicePool.truncate_min">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">truncate_min</span><span class="signature">(self, always_tuple=False)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DicePool.truncate_min-371"><a href="#DicePool.truncate_min-371"><span class="linenos">371</span></a>    <span class="k">def</span> <span class="nf">truncate_min</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">always_tuple</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="DicePool.truncate_min-372"><a href="#DicePool.truncate_min-372"><span class="linenos">372</span></a>        <span class="sd">&quot;&quot;&quot; A sorted tuple of thresholds below which outcomes are truncated, one for each die in the pool. </span>
</span><span id="DicePool.truncate_min-373"><a href="#DicePool.truncate_min-373"><span class="linenos">373</span></a><span class="sd">        </span>
</span><span id="DicePool.truncate_min-374"><a href="#DicePool.truncate_min-374"><span class="linenos">374</span></a><span class="sd">        Args:</span>
</span><span id="DicePool.truncate_min-375"><a href="#DicePool.truncate_min-375"><span class="linenos">375</span></a><span class="sd">            always_tuple: If `False`, this will return `None` if there are no die-specific `truncate_min`.</span>
</span><span id="DicePool.truncate_min-376"><a href="#DicePool.truncate_min-376"><span class="linenos">376</span></a><span class="sd">                If `True` this will return a `tuple` even in this case.</span>
</span><span id="DicePool.truncate_min-377"><a href="#DicePool.truncate_min-377"><span class="linenos">377</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DicePool.truncate_min-378"><a href="#DicePool.truncate_min-378"><span class="linenos">378</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_truncate_min</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">always_tuple</span><span class="p">:</span>
</span><span id="DicePool.truncate_min-379"><a href="#DicePool.truncate_min-379"><span class="linenos">379</span></a>            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">die</span><span class="p">()</span><span class="o">.</span><span class="n">min_outcome</span><span class="p">(),)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_dice</span><span class="p">()</span>
</span><span id="DicePool.truncate_min-380"><a href="#DicePool.truncate_min-380"><span class="linenos">380</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_truncate_min</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>A sorted tuple of thresholds below which outcomes are truncated, one for each die in the pool. </p>

<h6 id="args">Args</h6>

<ul>
<li><strong>always_tuple:</strong>  If <code>False</code>, this will return <code>None</code> if there are no die-specific <code><a href="#DicePool.truncate_min">truncate_min</a></code>.
If <code>True</code> this will return a <code>tuple</code> even in this case.</li>
</ul>
</div>


                            </div>
                            <div id="DicePool.truncate_max" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#DicePool.truncate_max">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">truncate_max</span><span class="signature">(self, always_tuple=False)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DicePool.truncate_max-385"><a href="#DicePool.truncate_max-385"><span class="linenos">385</span></a>    <span class="k">def</span> <span class="nf">truncate_max</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">always_tuple</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="DicePool.truncate_max-386"><a href="#DicePool.truncate_max-386"><span class="linenos">386</span></a>        <span class="sd">&quot;&quot;&quot; A sorted tuple of thresholds above which outcomes are truncated, one for each die in the pool. </span>
</span><span id="DicePool.truncate_max-387"><a href="#DicePool.truncate_max-387"><span class="linenos">387</span></a><span class="sd">        </span>
</span><span id="DicePool.truncate_max-388"><a href="#DicePool.truncate_max-388"><span class="linenos">388</span></a><span class="sd">        Args:</span>
</span><span id="DicePool.truncate_max-389"><a href="#DicePool.truncate_max-389"><span class="linenos">389</span></a><span class="sd">            always_tuple: If `False`, this will return `None` if there are no die-specific `truncate_max`.</span>
</span><span id="DicePool.truncate_max-390"><a href="#DicePool.truncate_max-390"><span class="linenos">390</span></a><span class="sd">                If `True` this will return a `tuple` even in this case.</span>
</span><span id="DicePool.truncate_max-391"><a href="#DicePool.truncate_max-391"><span class="linenos">391</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DicePool.truncate_max-392"><a href="#DicePool.truncate_max-392"><span class="linenos">392</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_truncate_max</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">always_tuple</span><span class="p">:</span>
</span><span id="DicePool.truncate_max-393"><a href="#DicePool.truncate_max-393"><span class="linenos">393</span></a>            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">die</span><span class="p">()</span><span class="o">.</span><span class="n">max_outcome</span><span class="p">(),)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_dice</span><span class="p">()</span>
</span><span id="DicePool.truncate_max-394"><a href="#DicePool.truncate_max-394"><span class="linenos">394</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_truncate_max</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>A sorted tuple of thresholds above which outcomes are truncated, one for each die in the pool. </p>

<h6 id="args">Args</h6>

<ul>
<li><strong>always_tuple:</strong>  If <code>False</code>, this will return <code>None</code> if there are no die-specific <code><a href="#DicePool.truncate_max">truncate_max</a></code>.
If <code>True</code> this will return a <code>tuple</code> even in this case.</li>
</ul>
</div>


                            </div>
                            <div id="DicePool.has_counted_dice" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#DicePool.has_counted_dice">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">has_counted_dice</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DicePool.has_counted_dice-530"><a href="#DicePool.has_counted_dice-530"><span class="linenos">530</span></a>    <span class="k">def</span> <span class="nf">has_counted_dice</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool.has_counted_dice-531"><a href="#DicePool.has_counted_dice-531"><span class="linenos">531</span></a>        <span class="sd">&quot;&quot;&quot; Returns `True` iff any of the remaining dice are counted a nonzero number of times.</span>
</span><span id="DicePool.has_counted_dice-532"><a href="#DicePool.has_counted_dice-532"><span class="linenos">532</span></a><span class="sd">        </span>
</span><span id="DicePool.has_counted_dice-533"><a href="#DicePool.has_counted_dice-533"><span class="linenos">533</span></a><span class="sd">        This is used to skip to the base case when there are no more dice to consider.</span>
</span><span id="DicePool.has_counted_dice-534"><a href="#DicePool.has_counted_dice-534"><span class="linenos">534</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DicePool.has_counted_dice-535"><a href="#DicePool.has_counted_dice-535"><span class="linenos">535</span></a>        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count_dice</span><span class="p">())</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns <code>True</code> iff any of the remaining dice are counted a nonzero number of times.</p>

<p>This is used to skip to the base case when there are no more dice to consider.</p>
</div>


                            </div>
                            <div id="DicePool.sample" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#DicePool.sample">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">sample</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DicePool.sample-537"><a href="#DicePool.sample-537"><span class="linenos">537</span></a>    <span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DicePool.sample-538"><a href="#DicePool.sample-538"><span class="linenos">538</span></a>        <span class="sd">&quot;&quot;&quot; Samples a roll from this pool.</span>
</span><span id="DicePool.sample-539"><a href="#DicePool.sample-539"><span class="linenos">539</span></a><span class="sd">        </span>
</span><span id="DicePool.sample-540"><a href="#DicePool.sample-540"><span class="linenos">540</span></a><span class="sd">        Returns:</span>
</span><span id="DicePool.sample-541"><a href="#DicePool.sample-541"><span class="linenos">541</span></a><span class="sd">            A dict mapping outcomes to counts representing a single roll of this pool.</span>
</span><span id="DicePool.sample-542"><a href="#DicePool.sample-542"><span class="linenos">542</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DicePool.sample-543"><a href="#DicePool.sample-543"><span class="linenos">543</span></a>        <span class="n">raw_rolls</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DicePool.sample-544"><a href="#DicePool.sample-544"><span class="linenos">544</span></a>        <span class="k">for</span> <span class="n">min_outcome</span><span class="p">,</span> <span class="n">max_outcome</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_min</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncate_max</span><span class="p">(</span><span class="kc">True</span><span class="p">)):</span>
</span><span id="DicePool.sample-545"><a href="#DicePool.sample-545"><span class="linenos">545</span></a>            <span class="n">die</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">die</span><span class="p">()</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="n">min_outcome</span><span class="p">,</span> <span class="n">max_outcome</span><span class="p">)</span>
</span><span id="DicePool.sample-546"><a href="#DicePool.sample-546"><span class="linenos">546</span></a>            <span class="n">raw_rolls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
</span><span id="DicePool.sample-547"><a href="#DicePool.sample-547"><span class="linenos">547</span></a>        <span class="n">raw_rolls</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">raw_rolls</span><span class="p">)</span>
</span><span id="DicePool.sample-548"><a href="#DicePool.sample-548"><span class="linenos">548</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="DicePool.sample-549"><a href="#DicePool.sample-549"><span class="linenos">549</span></a>        <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">raw_rolls</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">count_dice</span><span class="p">()):</span>
</span><span id="DicePool.sample-550"><a href="#DicePool.sample-550"><span class="linenos">550</span></a>            <span class="n">data</span><span class="p">[</span><span class="n">roll</span><span class="p">]</span> <span class="o">+=</span> <span class="n">count</span>
</span><span id="DicePool.sample-551"><a href="#DicePool.sample-551"><span class="linenos">551</span></a>        <span class="k">return</span> <span class="n">data</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Samples a roll from this pool.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A dict mapping outcomes to counts representing a single roll of this pool.</p>
</blockquote>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#BasePool">BasePool</a></dt>
                                <dd id="DicePool.eval" class="function"><a href="#BasePool.eval">eval</a></dd>
                <dd id="DicePool.sum" class="function"><a href="#BasePool.sum">sum</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="EvalPool">
                                <div class="attr class">
        <a class="headerlink" href="#EvalPool">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">EvalPool</span><wbr>(<span class="base">abc.ABC</span>):
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EvalPool-11"><a href="#EvalPool-11"><span class="linenos"> 11</span></a><span class="k">class</span> <span class="nc">EvalPool</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="EvalPool-12"><a href="#EvalPool-12"><span class="linenos"> 12</span></a>    <span class="sd">&quot;&quot;&quot; An abstract, immutable, callable class for evaulating one or more `DicePool`s.</span>
</span><span id="EvalPool-13"><a href="#EvalPool-13"><span class="linenos"> 13</span></a><span class="sd">    </span>
</span><span id="EvalPool-14"><a href="#EvalPool-14"><span class="linenos"> 14</span></a><span class="sd">    There is one abstract method to implement: `next_state()`.</span>
</span><span id="EvalPool-15"><a href="#EvalPool-15"><span class="linenos"> 15</span></a><span class="sd">    This should incrementally calculate the result of the roll</span>
</span><span id="EvalPool-16"><a href="#EvalPool-16"><span class="linenos"> 16</span></a><span class="sd">    given one outcome at a time along with how many dice rolled that outcome.</span>
</span><span id="EvalPool-17"><a href="#EvalPool-17"><span class="linenos"> 17</span></a><span class="sd">    An example sequence of calls, as far as `next_state()` is concerned, is:</span>
</span><span id="EvalPool-18"><a href="#EvalPool-18"><span class="linenos"> 18</span></a><span class="sd">    </span>
</span><span id="EvalPool-19"><a href="#EvalPool-19"><span class="linenos"> 19</span></a><span class="sd">    1. `state = next_state(state=None, 1, how_many_dice_rolled_1)`</span>
</span><span id="EvalPool-20"><a href="#EvalPool-20"><span class="linenos"> 20</span></a><span class="sd">    2. `state = next_state(state, 2, how_many_dice_rolled_2)`</span>
</span><span id="EvalPool-21"><a href="#EvalPool-21"><span class="linenos"> 21</span></a><span class="sd">    3. `state = next_state(state, 3, how_many_dice_rolled_3)`</span>
</span><span id="EvalPool-22"><a href="#EvalPool-22"><span class="linenos"> 22</span></a><span class="sd">    4. `state = next_state(state, 4, how_many_dice_rolled_4)`</span>
</span><span id="EvalPool-23"><a href="#EvalPool-23"><span class="linenos"> 23</span></a><span class="sd">    5. `state = next_state(state, 5, how_many_dice_rolled_5)`</span>
</span><span id="EvalPool-24"><a href="#EvalPool-24"><span class="linenos"> 24</span></a><span class="sd">    6. `state = next_state(state, 6, how_many_dice_rolled_6)`</span>
</span><span id="EvalPool-25"><a href="#EvalPool-25"><span class="linenos"> 25</span></a><span class="sd">    7. `outcome = final_outcome(state, *pools)`</span>
</span><span id="EvalPool-26"><a href="#EvalPool-26"><span class="linenos"> 26</span></a><span class="sd">    </span>
</span><span id="EvalPool-27"><a href="#EvalPool-27"><span class="linenos"> 27</span></a><span class="sd">    A few other methods can optionally be overridden to further customize behavior.</span>
</span><span id="EvalPool-28"><a href="#EvalPool-28"><span class="linenos"> 28</span></a><span class="sd">    </span>
</span><span id="EvalPool-29"><a href="#EvalPool-29"><span class="linenos"> 29</span></a><span class="sd">    It is not expected that subclasses of `EvalPool`</span>
</span><span id="EvalPool-30"><a href="#EvalPool-30"><span class="linenos"> 30</span></a><span class="sd">    be able to handle arbitrary types or numbers of pools.</span>
</span><span id="EvalPool-31"><a href="#EvalPool-31"><span class="linenos"> 31</span></a><span class="sd">    Indeed, most are expected to handle only a fixed number of pools,</span>
</span><span id="EvalPool-32"><a href="#EvalPool-32"><span class="linenos"> 32</span></a><span class="sd">    and often even only pools with a particular type of die.</span>
</span><span id="EvalPool-33"><a href="#EvalPool-33"><span class="linenos"> 33</span></a><span class="sd">    </span>
</span><span id="EvalPool-34"><a href="#EvalPool-34"><span class="linenos"> 34</span></a><span class="sd">    Instances cache all intermediate state distributions.</span>
</span><span id="EvalPool-35"><a href="#EvalPool-35"><span class="linenos"> 35</span></a><span class="sd">    You should therefore reuse instances when possible.</span>
</span><span id="EvalPool-36"><a href="#EvalPool-36"><span class="linenos"> 36</span></a><span class="sd">    </span>
</span><span id="EvalPool-37"><a href="#EvalPool-37"><span class="linenos"> 37</span></a><span class="sd">    Instances should not be modified after construction</span>
</span><span id="EvalPool-38"><a href="#EvalPool-38"><span class="linenos"> 38</span></a><span class="sd">    in any way that affects the return values of these methods.</span>
</span><span id="EvalPool-39"><a href="#EvalPool-39"><span class="linenos"> 39</span></a><span class="sd">    Otherwise, values in the cache may be incorrect.</span>
</span><span id="EvalPool-40"><a href="#EvalPool-40"><span class="linenos"> 40</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="EvalPool-41"><a href="#EvalPool-41"><span class="linenos"> 41</span></a>    
</span><span id="EvalPool-42"><a href="#EvalPool-42"><span class="linenos"> 42</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="EvalPool-43"><a href="#EvalPool-43"><span class="linenos"> 43</span></a>    <span class="k">def</span> <span class="nf">next_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="o">*</span><span class="n">counts</span><span class="p">):</span>
</span><span id="EvalPool-44"><a href="#EvalPool-44"><span class="linenos"> 44</span></a>        <span class="sd">&quot;&quot;&quot; State transition function.</span>
</span><span id="EvalPool-45"><a href="#EvalPool-45"><span class="linenos"> 45</span></a><span class="sd">        </span>
</span><span id="EvalPool-46"><a href="#EvalPool-46"><span class="linenos"> 46</span></a><span class="sd">        This should produce a state given the previous state, an outcome,</span>
</span><span id="EvalPool-47"><a href="#EvalPool-47"><span class="linenos"> 47</span></a><span class="sd">        and the number of dice in each pool rolling that outcome.</span>
</span><span id="EvalPool-48"><a href="#EvalPool-48"><span class="linenos"> 48</span></a><span class="sd">        </span>
</span><span id="EvalPool-49"><a href="#EvalPool-49"><span class="linenos"> 49</span></a><span class="sd">        Make sure to handle the base case where `state is None`.</span>
</span><span id="EvalPool-50"><a href="#EvalPool-50"><span class="linenos"> 50</span></a><span class="sd">        </span>
</span><span id="EvalPool-51"><a href="#EvalPool-51"><span class="linenos"> 51</span></a><span class="sd">        Args:</span>
</span><span id="EvalPool-52"><a href="#EvalPool-52"><span class="linenos"> 52</span></a><span class="sd">            state: A hashable object indicating the state before rolling the current outcome.</span>
</span><span id="EvalPool-53"><a href="#EvalPool-53"><span class="linenos"> 53</span></a><span class="sd">                If there was no previous outcome, this will be `None`.</span>
</span><span id="EvalPool-54"><a href="#EvalPool-54"><span class="linenos"> 54</span></a><span class="sd">            outcome: The current outcome.</span>
</span><span id="EvalPool-55"><a href="#EvalPool-55"><span class="linenos"> 55</span></a><span class="sd">                `next_state` will see all outcomes in monotonic order,</span>
</span><span id="EvalPool-56"><a href="#EvalPool-56"><span class="linenos"> 56</span></a><span class="sd">                either ascending or descending depending on `direction()`.</span>
</span><span id="EvalPool-57"><a href="#EvalPool-57"><span class="linenos"> 57</span></a><span class="sd">                If there are multiple pools, the set of outcomes is the union of the outcomes of the invididual pools.</span>
</span><span id="EvalPool-58"><a href="#EvalPool-58"><span class="linenos"> 58</span></a><span class="sd">                Interleaving outcomes between different pools is allowed but discouraged.</span>
</span><span id="EvalPool-59"><a href="#EvalPool-59"><span class="linenos"> 59</span></a><span class="sd">            *counts: One `int` for each pool indicating how many dice in that pool rolled the current outcome.</span>
</span><span id="EvalPool-60"><a href="#EvalPool-60"><span class="linenos"> 60</span></a><span class="sd">                If there are multiple pools, it&#39;s possible that some outcomes will not appear in all pools.</span>
</span><span id="EvalPool-61"><a href="#EvalPool-61"><span class="linenos"> 61</span></a><span class="sd">                In this case, the count for the pool(s) that do not have the outcome will be 0. </span>
</span><span id="EvalPool-62"><a href="#EvalPool-62"><span class="linenos"> 62</span></a><span class="sd">                Zero-weight outcomes count as having that outcome.</span>
</span><span id="EvalPool-63"><a href="#EvalPool-63"><span class="linenos"> 63</span></a><span class="sd">                </span>
</span><span id="EvalPool-64"><a href="#EvalPool-64"><span class="linenos"> 64</span></a><span class="sd">                Most subclasses will expect a fixed number of pools and </span>
</span><span id="EvalPool-65"><a href="#EvalPool-65"><span class="linenos"> 65</span></a><span class="sd">                can replace this variadic parameter with a fixed number of named parameters.</span>
</span><span id="EvalPool-66"><a href="#EvalPool-66"><span class="linenos"> 66</span></a><span class="sd">        </span>
</span><span id="EvalPool-67"><a href="#EvalPool-67"><span class="linenos"> 67</span></a><span class="sd">        Returns:</span>
</span><span id="EvalPool-68"><a href="#EvalPool-68"><span class="linenos"> 68</span></a><span class="sd">            A hashable object indicating the next state.</span>
</span><span id="EvalPool-69"><a href="#EvalPool-69"><span class="linenos"> 69</span></a><span class="sd">            The special value `icepool.Reroll` can be used to immediately remove the state from consideration,</span>
</span><span id="EvalPool-70"><a href="#EvalPool-70"><span class="linenos"> 70</span></a><span class="sd">            effectively performing a full reroll of the pool.</span>
</span><span id="EvalPool-71"><a href="#EvalPool-71"><span class="linenos"> 71</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EvalPool-72"><a href="#EvalPool-72"><span class="linenos"> 72</span></a>    
</span><span id="EvalPool-73"><a href="#EvalPool-73"><span class="linenos"> 73</span></a>    <span class="k">def</span> <span class="nf">final_outcome</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">final_state</span><span class="p">,</span> <span class="o">*</span><span class="n">pools</span><span class="p">):</span>
</span><span id="EvalPool-74"><a href="#EvalPool-74"><span class="linenos"> 74</span></a>        <span class="sd">&quot;&quot;&quot; Optional function to generate a final outcome from a final state.</span>
</span><span id="EvalPool-75"><a href="#EvalPool-75"><span class="linenos"> 75</span></a><span class="sd">        </span>
</span><span id="EvalPool-76"><a href="#EvalPool-76"><span class="linenos"> 76</span></a><span class="sd">        By default, the final outcome is equal to the final state.</span>
</span><span id="EvalPool-77"><a href="#EvalPool-77"><span class="linenos"> 77</span></a><span class="sd">        Note that `None` is not a valid outcome for a die,</span>
</span><span id="EvalPool-78"><a href="#EvalPool-78"><span class="linenos"> 78</span></a><span class="sd">        and if all pools consist of empty dice, the final state will be `None`.</span>
</span><span id="EvalPool-79"><a href="#EvalPool-79"><span class="linenos"> 79</span></a><span class="sd">        Subclasses that want to handle this case should explicitly define what happens.</span>
</span><span id="EvalPool-80"><a href="#EvalPool-80"><span class="linenos"> 80</span></a><span class="sd">        </span>
</span><span id="EvalPool-81"><a href="#EvalPool-81"><span class="linenos"> 81</span></a><span class="sd">        Args:</span>
</span><span id="EvalPool-82"><a href="#EvalPool-82"><span class="linenos"> 82</span></a><span class="sd">            final_state: A state after all outcomes have been processed.</span>
</span><span id="EvalPool-83"><a href="#EvalPool-83"><span class="linenos"> 83</span></a><span class="sd">            *pools: One or more `DicePool`s being evaluated.</span>
</span><span id="EvalPool-84"><a href="#EvalPool-84"><span class="linenos"> 84</span></a><span class="sd">            </span>
</span><span id="EvalPool-85"><a href="#EvalPool-85"><span class="linenos"> 85</span></a><span class="sd">                Most subclasses will expect a fixed number of pools and </span>
</span><span id="EvalPool-86"><a href="#EvalPool-86"><span class="linenos"> 86</span></a><span class="sd">                can replace this variadic parameter with a fixed number of named parameters.</span>
</span><span id="EvalPool-87"><a href="#EvalPool-87"><span class="linenos"> 87</span></a><span class="sd">            </span>
</span><span id="EvalPool-88"><a href="#EvalPool-88"><span class="linenos"> 88</span></a><span class="sd">        Returns:</span>
</span><span id="EvalPool-89"><a href="#EvalPool-89"><span class="linenos"> 89</span></a><span class="sd">            A final outcome that will be used as part of constructing the result die.</span>
</span><span id="EvalPool-90"><a href="#EvalPool-90"><span class="linenos"> 90</span></a><span class="sd">            As usual for `Die()`, this could itself be a die or `icepool.Reroll`.</span>
</span><span id="EvalPool-91"><a href="#EvalPool-91"><span class="linenos"> 91</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EvalPool-92"><a href="#EvalPool-92"><span class="linenos"> 92</span></a>        <span class="k">return</span> <span class="n">final_state</span>
</span><span id="EvalPool-93"><a href="#EvalPool-93"><span class="linenos"> 93</span></a>    
</span><span id="EvalPool-94"><a href="#EvalPool-94"><span class="linenos"> 94</span></a>    <span class="k">def</span> <span class="nf">direction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">pools</span><span class="p">):</span>
</span><span id="EvalPool-95"><a href="#EvalPool-95"><span class="linenos"> 95</span></a>        <span class="sd">&quot;&quot;&quot; Optional function to determine the direction in which `next_state()` will see outcomes.</span>
</span><span id="EvalPool-96"><a href="#EvalPool-96"><span class="linenos"> 96</span></a><span class="sd">        </span>
</span><span id="EvalPool-97"><a href="#EvalPool-97"><span class="linenos"> 97</span></a><span class="sd">        Note that an ascending (&gt; 0) direction is not compatible with pools with `truncate_min`,</span>
</span><span id="EvalPool-98"><a href="#EvalPool-98"><span class="linenos"> 98</span></a><span class="sd">        and a descending (&lt; 0) direction is not compatible with pools with `truncate_max`.</span>
</span><span id="EvalPool-99"><a href="#EvalPool-99"><span class="linenos"> 99</span></a>
</span><span id="EvalPool-100"><a href="#EvalPool-100"><span class="linenos">100</span></a><span class="sd">        The default is ascending order.</span>
</span><span id="EvalPool-101"><a href="#EvalPool-101"><span class="linenos">101</span></a><span class="sd">        </span>
</span><span id="EvalPool-102"><a href="#EvalPool-102"><span class="linenos">102</span></a><span class="sd">        Args:</span>
</span><span id="EvalPool-103"><a href="#EvalPool-103"><span class="linenos">103</span></a><span class="sd">            *pools: One or more `DicePool`s being evaluated.</span>
</span><span id="EvalPool-104"><a href="#EvalPool-104"><span class="linenos">104</span></a><span class="sd">            </span>
</span><span id="EvalPool-105"><a href="#EvalPool-105"><span class="linenos">105</span></a><span class="sd">                Most subclasses will expect a fixed number of pools and </span>
</span><span id="EvalPool-106"><a href="#EvalPool-106"><span class="linenos">106</span></a><span class="sd">                can replace this variadic parameter with a fixed number of named parameters.</span>
</span><span id="EvalPool-107"><a href="#EvalPool-107"><span class="linenos">107</span></a><span class="sd">            </span>
</span><span id="EvalPool-108"><a href="#EvalPool-108"><span class="linenos">108</span></a><span class="sd">        Returns:</span>
</span><span id="EvalPool-109"><a href="#EvalPool-109"><span class="linenos">109</span></a><span class="sd">            * &gt; 0 if `next_state()` should always see the outcomes in ascending order.</span>
</span><span id="EvalPool-110"><a href="#EvalPool-110"><span class="linenos">110</span></a><span class="sd">            * &lt; 0 if `next_state()` should always see the outcomes in descending order.</span>
</span><span id="EvalPool-111"><a href="#EvalPool-111"><span class="linenos">111</span></a><span class="sd">            * 0 if the order may be determined automatically.</span>
</span><span id="EvalPool-112"><a href="#EvalPool-112"><span class="linenos">112</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EvalPool-113"><a href="#EvalPool-113"><span class="linenos">113</span></a>        <span class="k">return</span> <span class="mi">1</span>
</span><span id="EvalPool-114"><a href="#EvalPool-114"><span class="linenos">114</span></a>    
</span><span id="EvalPool-115"><a href="#EvalPool-115"><span class="linenos">115</span></a>    <span class="k">def</span> <span class="nf">ndim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">pools</span><span class="p">):</span>
</span><span id="EvalPool-116"><a href="#EvalPool-116"><span class="linenos">116</span></a>        <span class="sd">&quot;&quot;&quot; Optional function to specify the number of dimensions of the output die.</span>
</span><span id="EvalPool-117"><a href="#EvalPool-117"><span class="linenos">117</span></a><span class="sd">        </span>
</span><span id="EvalPool-118"><a href="#EvalPool-118"><span class="linenos">118</span></a><span class="sd">        If not provided, the ndim of the result will be determined automatically as per `Die()`.</span>
</span><span id="EvalPool-119"><a href="#EvalPool-119"><span class="linenos">119</span></a><span class="sd">        </span>
</span><span id="EvalPool-120"><a href="#EvalPool-120"><span class="linenos">120</span></a><span class="sd">        Args:</span>
</span><span id="EvalPool-121"><a href="#EvalPool-121"><span class="linenos">121</span></a><span class="sd">            *pools: One or more `DicePool`s being evaluated.</span>
</span><span id="EvalPool-122"><a href="#EvalPool-122"><span class="linenos">122</span></a><span class="sd">                </span>
</span><span id="EvalPool-123"><a href="#EvalPool-123"><span class="linenos">123</span></a><span class="sd">                Most subclasses will expect a fixed number of pools and </span>
</span><span id="EvalPool-124"><a href="#EvalPool-124"><span class="linenos">124</span></a><span class="sd">                can replace this variadic parameter with a fixed number of named parameters.</span>
</span><span id="EvalPool-125"><a href="#EvalPool-125"><span class="linenos">125</span></a><span class="sd">        </span>
</span><span id="EvalPool-126"><a href="#EvalPool-126"><span class="linenos">126</span></a><span class="sd">        Returns:</span>
</span><span id="EvalPool-127"><a href="#EvalPool-127"><span class="linenos">127</span></a><span class="sd">            The number of dimensions that the output die should have,</span>
</span><span id="EvalPool-128"><a href="#EvalPool-128"><span class="linenos">128</span></a><span class="sd">            or `None` if this should be determined automatically by `Die()`.</span>
</span><span id="EvalPool-129"><a href="#EvalPool-129"><span class="linenos">129</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EvalPool-130"><a href="#EvalPool-130"><span class="linenos">130</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="EvalPool-131"><a href="#EvalPool-131"><span class="linenos">131</span></a>    
</span><span id="EvalPool-132"><a href="#EvalPool-132"><span class="linenos">132</span></a>    <span class="nd">@cached_property</span>
</span><span id="EvalPool-133"><a href="#EvalPool-133"><span class="linenos">133</span></a>    <span class="k">def</span> <span class="nf">_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EvalPool-134"><a href="#EvalPool-134"><span class="linenos">134</span></a>        <span class="sd">&quot;&quot;&quot; A cache of (direction, pools) -&gt; weight distribution over states. &quot;&quot;&quot;</span>
</span><span id="EvalPool-135"><a href="#EvalPool-135"><span class="linenos">135</span></a>        <span class="k">return</span> <span class="p">{}</span>
</span><span id="EvalPool-136"><a href="#EvalPool-136"><span class="linenos">136</span></a>    
</span><span id="EvalPool-137"><a href="#EvalPool-137"><span class="linenos">137</span></a>    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">pools</span><span class="p">):</span>
</span><span id="EvalPool-138"><a href="#EvalPool-138"><span class="linenos">138</span></a>        <span class="sd">&quot;&quot;&quot; Evaluates pools.</span>
</span><span id="EvalPool-139"><a href="#EvalPool-139"><span class="linenos">139</span></a><span class="sd">        </span>
</span><span id="EvalPool-140"><a href="#EvalPool-140"><span class="linenos">140</span></a><span class="sd">        You can call the `EvalPool` object directly for the same effect,</span>
</span><span id="EvalPool-141"><a href="#EvalPool-141"><span class="linenos">141</span></a><span class="sd">        e.g. `sum_pool(pool)` is an alias for `sum_pool.eval(pool)`.</span>
</span><span id="EvalPool-142"><a href="#EvalPool-142"><span class="linenos">142</span></a><span class="sd">        </span>
</span><span id="EvalPool-143"><a href="#EvalPool-143"><span class="linenos">143</span></a><span class="sd">        Args:</span>
</span><span id="EvalPool-144"><a href="#EvalPool-144"><span class="linenos">144</span></a><span class="sd">            *pools: Each element may be one of the following:</span>
</span><span id="EvalPool-145"><a href="#EvalPool-145"><span class="linenos">145</span></a><span class="sd">                * A `DicePool` representing possible rolls of a pool.</span>
</span><span id="EvalPool-146"><a href="#EvalPool-146"><span class="linenos">146</span></a><span class="sd">                * A dict-like representing a single roll of a pool.</span>
</span><span id="EvalPool-147"><a href="#EvalPool-147"><span class="linenos">147</span></a><span class="sd">                    The dict maps outcomes to counts.</span>
</span><span id="EvalPool-148"><a href="#EvalPool-148"><span class="linenos">148</span></a><span class="sd">                * A sequence of outcomes representing a single roll of a pool. </span>
</span><span id="EvalPool-149"><a href="#EvalPool-149"><span class="linenos">149</span></a><span class="sd">                    Outcomes are treated as having 1 count per appearance.</span>
</span><span id="EvalPool-150"><a href="#EvalPool-150"><span class="linenos">150</span></a><span class="sd">                Most evaluators will expect a fixed number of pools.</span>
</span><span id="EvalPool-151"><a href="#EvalPool-151"><span class="linenos">151</span></a><span class="sd">                The outcomes of the pools must be mutually comparable.</span>
</span><span id="EvalPool-152"><a href="#EvalPool-152"><span class="linenos">152</span></a><span class="sd">                Pools with `truncate_min` and pools with `truncate_max` are not compatible.</span>
</span><span id="EvalPool-153"><a href="#EvalPool-153"><span class="linenos">153</span></a><span class="sd">        </span>
</span><span id="EvalPool-154"><a href="#EvalPool-154"><span class="linenos">154</span></a><span class="sd">        Returns:</span>
</span><span id="EvalPool-155"><a href="#EvalPool-155"><span class="linenos">155</span></a><span class="sd">            A die representing the distribution of the final score.</span>
</span><span id="EvalPool-156"><a href="#EvalPool-156"><span class="linenos">156</span></a><span class="sd">            If all pools are `PoolRoll`s, the result is a single outcome instead.</span>
</span><span id="EvalPool-157"><a href="#EvalPool-157"><span class="linenos">157</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EvalPool-158"><a href="#EvalPool-158"><span class="linenos">158</span></a>        
</span><span id="EvalPool-159"><a href="#EvalPool-159"><span class="linenos">159</span></a>        <span class="c1"># Cast non-pool arguments to `BasePool`.</span>
</span><span id="EvalPool-160"><a href="#EvalPool-160"><span class="linenos">160</span></a>        <span class="n">pools</span> <span class="o">=</span> <span class="p">[</span><span class="n">pool</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pool</span><span class="p">,</span> <span class="n">icepool</span><span class="o">.</span><span class="n">BasePool</span><span class="p">)</span> <span class="k">else</span> <span class="n">icepool</span><span class="o">.</span><span class="n">PoolRoll</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span> <span class="k">for</span> <span class="n">pool</span> <span class="ow">in</span> <span class="n">pools</span><span class="p">]</span>
</span><span id="EvalPool-161"><a href="#EvalPool-161"><span class="linenos">161</span></a>        
</span><span id="EvalPool-162"><a href="#EvalPool-162"><span class="linenos">162</span></a>        <span class="n">algorithm</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_select_algorithm</span><span class="p">(</span><span class="o">*</span><span class="n">pools</span><span class="p">)</span>
</span><span id="EvalPool-163"><a href="#EvalPool-163"><span class="linenos">163</span></a>        
</span><span id="EvalPool-164"><a href="#EvalPool-164"><span class="linenos">164</span></a>        <span class="n">dist</span> <span class="o">=</span> <span class="n">algorithm</span><span class="p">(</span><span class="n">direction</span><span class="p">,</span> <span class="o">*</span><span class="n">pools</span><span class="p">)</span>
</span><span id="EvalPool-165"><a href="#EvalPool-165"><span class="linenos">165</span></a>        
</span><span id="EvalPool-166"><a href="#EvalPool-166"><span class="linenos">166</span></a>        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">_is_single_roll</span><span class="p">()</span> <span class="k">for</span> <span class="n">pool</span> <span class="ow">in</span> <span class="n">pools</span><span class="p">):</span>
</span><span id="EvalPool-167"><a href="#EvalPool-167"><span class="linenos">167</span></a>            <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">dist</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="EvalPool-168"><a href="#EvalPool-168"><span class="linenos">168</span></a>                <span class="c1"># Return a single outcome.</span>
</span><span id="EvalPool-169"><a href="#EvalPool-169"><span class="linenos">169</span></a>                <span class="k">return</span> <span class="n">state</span>
</span><span id="EvalPool-170"><a href="#EvalPool-170"><span class="linenos">170</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EvalPool-171"><a href="#EvalPool-171"><span class="linenos">171</span></a>            <span class="n">final_outcomes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="EvalPool-172"><a href="#EvalPool-172"><span class="linenos">172</span></a>            <span class="n">final_weights</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="EvalPool-173"><a href="#EvalPool-173"><span class="linenos">173</span></a>            <span class="k">for</span> <span class="n">state</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="n">dist</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="EvalPool-174"><a href="#EvalPool-174"><span class="linenos">174</span></a>                <span class="n">outcome</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_outcome</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="o">*</span><span class="n">pools</span><span class="p">)</span>
</span><span id="EvalPool-175"><a href="#EvalPool-175"><span class="linenos">175</span></a>                <span class="k">if</span> <span class="n">outcome</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Reroll</span><span class="p">:</span>
</span><span id="EvalPool-176"><a href="#EvalPool-176"><span class="linenos">176</span></a>                    <span class="n">final_outcomes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
</span><span id="EvalPool-177"><a href="#EvalPool-177"><span class="linenos">177</span></a>                    <span class="n">final_weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span>
</span><span id="EvalPool-178"><a href="#EvalPool-178"><span class="linenos">178</span></a>            
</span><span id="EvalPool-179"><a href="#EvalPool-179"><span class="linenos">179</span></a>            <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="o">*</span><span class="n">final_outcomes</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">final_weights</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="o">*</span><span class="n">pools</span><span class="p">))</span>
</span><span id="EvalPool-180"><a href="#EvalPool-180"><span class="linenos">180</span></a>    
</span><span id="EvalPool-181"><a href="#EvalPool-181"><span class="linenos">181</span></a>    <span class="fm">__call__</span> <span class="o">=</span> <span class="nb">eval</span>
</span><span id="EvalPool-182"><a href="#EvalPool-182"><span class="linenos">182</span></a>    
</span><span id="EvalPool-183"><a href="#EvalPool-183"><span class="linenos">183</span></a>    <span class="k">def</span> <span class="nf">bind_dice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">dice</span><span class="p">):</span>
</span><span id="EvalPool-184"><a href="#EvalPool-184"><span class="linenos">184</span></a>        <span class="sd">&quot;&quot;&quot; Binds one die for each pool.</span>
</span><span id="EvalPool-185"><a href="#EvalPool-185"><span class="linenos">185</span></a><span class="sd">        </span>
</span><span id="EvalPool-186"><a href="#EvalPool-186"><span class="linenos">186</span></a><span class="sd">        For example, `sum_d6s = sum_pool.bind_dice(icepool.d6)` would produce</span>
</span><span id="EvalPool-187"><a href="#EvalPool-187"><span class="linenos">187</span></a><span class="sd">        a function that takes one argument and sums that many d6s.</span>
</span><span id="EvalPool-188"><a href="#EvalPool-188"><span class="linenos">188</span></a><span class="sd">        `sum_d6s(3)` would then be the same as `3 @ icepool.d6`.</span>
</span><span id="EvalPool-189"><a href="#EvalPool-189"><span class="linenos">189</span></a><span class="sd">        </span>
</span><span id="EvalPool-190"><a href="#EvalPool-190"><span class="linenos">190</span></a><span class="sd">        Args:</span>
</span><span id="EvalPool-191"><a href="#EvalPool-191"><span class="linenos">191</span></a><span class="sd">            *dice: One die for each pool taken by this `EvalPool`.</span>
</span><span id="EvalPool-192"><a href="#EvalPool-192"><span class="linenos">192</span></a><span class="sd">        </span>
</span><span id="EvalPool-193"><a href="#EvalPool-193"><span class="linenos">193</span></a><span class="sd">        Returns:</span>
</span><span id="EvalPool-194"><a href="#EvalPool-194"><span class="linenos">194</span></a><span class="sd">            A function that takes in one `num_dice` per pool,</span>
</span><span id="EvalPool-195"><a href="#EvalPool-195"><span class="linenos">195</span></a><span class="sd">            then runs this `EvalPool` for pools of that size using the bound dice.</span>
</span><span id="EvalPool-196"><a href="#EvalPool-196"><span class="linenos">196</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EvalPool-197"><a href="#EvalPool-197"><span class="linenos">197</span></a>        <span class="k">def</span> <span class="nf">bound_eval</span><span class="p">(</span><span class="o">*</span><span class="n">num_dices</span><span class="p">):</span>
</span><span id="EvalPool-198"><a href="#EvalPool-198"><span class="linenos">198</span></a>            <span class="n">pools</span> <span class="o">=</span> <span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">pool</span><span class="p">(</span><span class="n">num_dice</span><span class="p">)</span> <span class="k">for</span> <span class="n">die</span><span class="p">,</span> <span class="n">num_dice</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dice</span><span class="p">,</span> <span class="n">num_dices</span><span class="p">))</span>
</span><span id="EvalPool-199"><a href="#EvalPool-199"><span class="linenos">199</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="o">*</span><span class="n">pools</span><span class="p">)</span>
</span><span id="EvalPool-200"><a href="#EvalPool-200"><span class="linenos">200</span></a>        
</span><span id="EvalPool-201"><a href="#EvalPool-201"><span class="linenos">201</span></a>        <span class="k">return</span> <span class="n">bound_eval</span>
</span><span id="EvalPool-202"><a href="#EvalPool-202"><span class="linenos">202</span></a>    
</span><span id="EvalPool-203"><a href="#EvalPool-203"><span class="linenos">203</span></a>    <span class="k">def</span> <span class="nf">_select_algorithm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">pools</span><span class="p">):</span>
</span><span id="EvalPool-204"><a href="#EvalPool-204"><span class="linenos">204</span></a>        <span class="sd">&quot;&quot;&quot; Selects an algorithm and iteration direction.</span>
</span><span id="EvalPool-205"><a href="#EvalPool-205"><span class="linenos">205</span></a><span class="sd">        </span>
</span><span id="EvalPool-206"><a href="#EvalPool-206"><span class="linenos">206</span></a><span class="sd">        Returns:</span>
</span><span id="EvalPool-207"><a href="#EvalPool-207"><span class="linenos">207</span></a><span class="sd">            * The algorithm to use (`_eval_internal*`).</span>
</span><span id="EvalPool-208"><a href="#EvalPool-208"><span class="linenos">208</span></a><span class="sd">            * The direction in which `next_state()` sees outcomes.</span>
</span><span id="EvalPool-209"><a href="#EvalPool-209"><span class="linenos">209</span></a><span class="sd">                1 for ascending and -1 for descending.</span>
</span><span id="EvalPool-210"><a href="#EvalPool-210"><span class="linenos">210</span></a><span class="sd">            </span>
</span><span id="EvalPool-211"><a href="#EvalPool-211"><span class="linenos">211</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EvalPool-212"><a href="#EvalPool-212"><span class="linenos">212</span></a>        <span class="n">has_truncate_min</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">_has_truncate_min</span><span class="p">()</span> <span class="k">for</span> <span class="n">pool</span> <span class="ow">in</span> <span class="n">pools</span><span class="p">)</span>
</span><span id="EvalPool-213"><a href="#EvalPool-213"><span class="linenos">213</span></a>        <span class="n">has_truncate_max</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">_has_truncate_max</span><span class="p">()</span> <span class="k">for</span> <span class="n">pool</span> <span class="ow">in</span> <span class="n">pools</span><span class="p">)</span>
</span><span id="EvalPool-214"><a href="#EvalPool-214"><span class="linenos">214</span></a>        
</span><span id="EvalPool-215"><a href="#EvalPool-215"><span class="linenos">215</span></a>        <span class="k">if</span> <span class="n">has_truncate_min</span> <span class="ow">and</span> <span class="n">has_truncate_max</span><span class="p">:</span>
</span><span id="EvalPool-216"><a href="#EvalPool-216"><span class="linenos">216</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;A set of pools cannot be evaluated if they have both truncate_min and truncate_max.&#39;</span><span class="p">)</span>
</span><span id="EvalPool-217"><a href="#EvalPool-217"><span class="linenos">217</span></a>        
</span><span id="EvalPool-218"><a href="#EvalPool-218"><span class="linenos">218</span></a>        <span class="n">direction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span><span class="p">(</span><span class="o">*</span><span class="n">pools</span><span class="p">)</span>
</span><span id="EvalPool-219"><a href="#EvalPool-219"><span class="linenos">219</span></a>        
</span><span id="EvalPool-220"><a href="#EvalPool-220"><span class="linenos">220</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">direction</span><span class="p">:</span>
</span><span id="EvalPool-221"><a href="#EvalPool-221"><span class="linenos">221</span></a>            <span class="k">if</span> <span class="n">has_truncate_max</span><span class="p">:</span>
</span><span id="EvalPool-222"><a href="#EvalPool-222"><span class="linenos">222</span></a>                <span class="n">direction</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="EvalPool-223"><a href="#EvalPool-223"><span class="linenos">223</span></a>            <span class="k">elif</span> <span class="n">has_truncate_min</span><span class="p">:</span>
</span><span id="EvalPool-224"><a href="#EvalPool-224"><span class="linenos">224</span></a>                <span class="n">direction</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="EvalPool-225"><a href="#EvalPool-225"><span class="linenos">225</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="EvalPool-226"><a href="#EvalPool-226"><span class="linenos">226</span></a>                <span class="n">score_ascending</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">_direction_score_ascending</span><span class="p">()</span> <span class="k">for</span> <span class="n">pool</span> <span class="ow">in</span> <span class="n">pools</span><span class="p">)</span>
</span><span id="EvalPool-227"><a href="#EvalPool-227"><span class="linenos">227</span></a>                <span class="n">score_descending</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">_direction_score_descending</span><span class="p">()</span> <span class="k">for</span> <span class="n">pool</span> <span class="ow">in</span> <span class="n">pools</span><span class="p">)</span>
</span><span id="EvalPool-228"><a href="#EvalPool-228"><span class="linenos">228</span></a>                <span class="k">if</span> <span class="n">score_ascending</span> <span class="o">&lt;</span> <span class="n">score_descending</span><span class="p">:</span>
</span><span id="EvalPool-229"><a href="#EvalPool-229"><span class="linenos">229</span></a>                    <span class="n">direction</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="EvalPool-230"><a href="#EvalPool-230"><span class="linenos">230</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EvalPool-231"><a href="#EvalPool-231"><span class="linenos">231</span></a>                    <span class="n">direction</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="EvalPool-232"><a href="#EvalPool-232"><span class="linenos">232</span></a>        
</span><span id="EvalPool-233"><a href="#EvalPool-233"><span class="linenos">233</span></a>        <span class="k">if</span> <span class="n">direction</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">has_truncate_min</span> <span class="ow">or</span> <span class="n">direction</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">has_truncate_max</span><span class="p">:</span>
</span><span id="EvalPool-234"><a href="#EvalPool-234"><span class="linenos">234</span></a>            <span class="c1"># Forced onto the less-preferred algorithm.</span>
</span><span id="EvalPool-235"><a href="#EvalPool-235"><span class="linenos">235</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_internal_iterative</span><span class="p">,</span> <span class="n">direction</span>
</span><span id="EvalPool-236"><a href="#EvalPool-236"><span class="linenos">236</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EvalPool-237"><a href="#EvalPool-237"><span class="linenos">237</span></a>            <span class="c1"># Use the preferred algorithm.</span>
</span><span id="EvalPool-238"><a href="#EvalPool-238"><span class="linenos">238</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_internal</span><span class="p">,</span> <span class="n">direction</span>
</span><span id="EvalPool-239"><a href="#EvalPool-239"><span class="linenos">239</span></a>    
</span><span id="EvalPool-240"><a href="#EvalPool-240"><span class="linenos">240</span></a>    <span class="k">def</span> <span class="nf">_eval_internal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="o">*</span><span class="n">pools</span><span class="p">):</span>
</span><span id="EvalPool-241"><a href="#EvalPool-241"><span class="linenos">241</span></a>        <span class="sd">&quot;&quot;&quot; Internal algorithm for iterating in the more-preferred direction,</span>
</span><span id="EvalPool-242"><a href="#EvalPool-242"><span class="linenos">242</span></a><span class="sd">        i.e. giving outcomes to `next_state()` from wide to narrow. </span>
</span><span id="EvalPool-243"><a href="#EvalPool-243"><span class="linenos">243</span></a><span class="sd">        </span>
</span><span id="EvalPool-244"><a href="#EvalPool-244"><span class="linenos">244</span></a><span class="sd">        All intermediate return values are cached in the instance.</span>
</span><span id="EvalPool-245"><a href="#EvalPool-245"><span class="linenos">245</span></a><span class="sd">        </span>
</span><span id="EvalPool-246"><a href="#EvalPool-246"><span class="linenos">246</span></a><span class="sd">        Arguments:</span>
</span><span id="EvalPool-247"><a href="#EvalPool-247"><span class="linenos">247</span></a><span class="sd">            direction: The direction in which to send outcomes to `next_state()`.</span>
</span><span id="EvalPool-248"><a href="#EvalPool-248"><span class="linenos">248</span></a><span class="sd">            *pools: One or more `DicePool`s to evaluate.</span>
</span><span id="EvalPool-249"><a href="#EvalPool-249"><span class="linenos">249</span></a><span class="sd">                This *does* change recursively.</span>
</span><span id="EvalPool-250"><a href="#EvalPool-250"><span class="linenos">250</span></a><span class="sd">            </span>
</span><span id="EvalPool-251"><a href="#EvalPool-251"><span class="linenos">251</span></a><span class="sd">        Returns:</span>
</span><span id="EvalPool-252"><a href="#EvalPool-252"><span class="linenos">252</span></a><span class="sd">            A dict `{ state : weight }` describing the probability distribution over states.</span>
</span><span id="EvalPool-253"><a href="#EvalPool-253"><span class="linenos">253</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EvalPool-254"><a href="#EvalPool-254"><span class="linenos">254</span></a>        <span class="n">cache_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">direction</span><span class="p">,</span> <span class="n">pools</span><span class="p">)</span>
</span><span id="EvalPool-255"><a href="#EvalPool-255"><span class="linenos">255</span></a>        <span class="k">if</span> <span class="n">cache_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">:</span>
</span><span id="EvalPool-256"><a href="#EvalPool-256"><span class="linenos">256</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span>
</span><span id="EvalPool-257"><a href="#EvalPool-257"><span class="linenos">257</span></a>        
</span><span id="EvalPool-258"><a href="#EvalPool-258"><span class="linenos">258</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="EvalPool-259"><a href="#EvalPool-259"><span class="linenos">259</span></a>        
</span><span id="EvalPool-260"><a href="#EvalPool-260"><span class="linenos">260</span></a>        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">outcomes</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">pool</span> <span class="ow">in</span> <span class="n">pools</span><span class="p">):</span>
</span><span id="EvalPool-261"><a href="#EvalPool-261"><span class="linenos">261</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="p">{</span> <span class="kc">None</span> <span class="p">:</span> <span class="mi">1</span> <span class="p">}</span>
</span><span id="EvalPool-262"><a href="#EvalPool-262"><span class="linenos">262</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EvalPool-263"><a href="#EvalPool-263"><span class="linenos">263</span></a>            <span class="n">outcome</span><span class="p">,</span> <span class="n">iterators</span> <span class="o">=</span> <span class="n">_pop_pools</span><span class="p">(</span><span class="n">direction</span><span class="p">,</span> <span class="n">pools</span><span class="p">)</span>
</span><span id="EvalPool-264"><a href="#EvalPool-264"><span class="linenos">264</span></a>            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">iterators</span><span class="p">):</span>
</span><span id="EvalPool-265"><a href="#EvalPool-265"><span class="linenos">265</span></a>                <span class="n">prev_pools</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">)</span>
</span><span id="EvalPool-266"><a href="#EvalPool-266"><span class="linenos">266</span></a>                <span class="n">prod_weight</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
</span><span id="EvalPool-267"><a href="#EvalPool-267"><span class="linenos">267</span></a>                <span class="n">prev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_internal</span><span class="p">(</span><span class="n">direction</span><span class="p">,</span> <span class="o">*</span><span class="n">prev_pools</span><span class="p">)</span>
</span><span id="EvalPool-268"><a href="#EvalPool-268"><span class="linenos">268</span></a>                <span class="k">for</span> <span class="n">prev_state</span><span class="p">,</span> <span class="n">prev_weight</span> <span class="ow">in</span> <span class="n">prev</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="EvalPool-269"><a href="#EvalPool-269"><span class="linenos">269</span></a>                    <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_state</span><span class="p">(</span><span class="n">prev_state</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="o">*</span><span class="n">counts</span><span class="p">)</span>
</span><span id="EvalPool-270"><a href="#EvalPool-270"><span class="linenos">270</span></a>                    <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Reroll</span><span class="p">:</span>
</span><span id="EvalPool-271"><a href="#EvalPool-271"><span class="linenos">271</span></a>                        <span class="n">result</span><span class="p">[</span><span class="n">state</span><span class="p">]</span> <span class="o">+=</span> <span class="n">prev_weight</span> <span class="o">*</span> <span class="n">prod_weight</span>
</span><span id="EvalPool-272"><a href="#EvalPool-272"><span class="linenos">272</span></a>        
</span><span id="EvalPool-273"><a href="#EvalPool-273"><span class="linenos">273</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
</span><span id="EvalPool-274"><a href="#EvalPool-274"><span class="linenos">274</span></a>        <span class="k">return</span> <span class="n">result</span>
</span><span id="EvalPool-275"><a href="#EvalPool-275"><span class="linenos">275</span></a>    
</span><span id="EvalPool-276"><a href="#EvalPool-276"><span class="linenos">276</span></a>    <span class="k">def</span> <span class="nf">_eval_internal_iterative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="o">*</span><span class="n">pools</span><span class="p">):</span>
</span><span id="EvalPool-277"><a href="#EvalPool-277"><span class="linenos">277</span></a>        <span class="sd">&quot;&quot;&quot; Internal algorithm for iterating in the less-preferred direction,</span>
</span><span id="EvalPool-278"><a href="#EvalPool-278"><span class="linenos">278</span></a><span class="sd">        i.e. giving outcomes to `next_state()` from narrow to wide.</span>
</span><span id="EvalPool-279"><a href="#EvalPool-279"><span class="linenos">279</span></a><span class="sd">        </span>
</span><span id="EvalPool-280"><a href="#EvalPool-280"><span class="linenos">280</span></a><span class="sd">        This algorithm does not perform persistent memoization.</span>
</span><span id="EvalPool-281"><a href="#EvalPool-281"><span class="linenos">281</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EvalPool-282"><a href="#EvalPool-282"><span class="linenos">282</span></a>        <span class="n">dist</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="EvalPool-283"><a href="#EvalPool-283"><span class="linenos">283</span></a>        <span class="n">dist</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">pools</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="EvalPool-284"><a href="#EvalPool-284"><span class="linenos">284</span></a>        <span class="c1"># This is only safe because all pools are guaranteed to pop outcomes at the same rate.</span>
</span><span id="EvalPool-285"><a href="#EvalPool-285"><span class="linenos">285</span></a>        <span class="k">while</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">outcomes</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">pool</span> <span class="ow">in</span> <span class="n">pools</span><span class="p">):</span>
</span><span id="EvalPool-286"><a href="#EvalPool-286"><span class="linenos">286</span></a>            <span class="n">next_dist</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="EvalPool-287"><a href="#EvalPool-287"><span class="linenos">287</span></a>            <span class="k">for</span> <span class="p">(</span><span class="n">prev_state</span><span class="p">,</span> <span class="n">prev_pools</span><span class="p">),</span> <span class="n">weight</span> <span class="ow">in</span> <span class="n">dist</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="EvalPool-288"><a href="#EvalPool-288"><span class="linenos">288</span></a>                <span class="c1"># The direction flip here is the only purpose of this algorithm.</span>
</span><span id="EvalPool-289"><a href="#EvalPool-289"><span class="linenos">289</span></a>                <span class="n">outcome</span><span class="p">,</span> <span class="n">iterators</span> <span class="o">=</span> <span class="n">_pop_pools</span><span class="p">(</span><span class="o">-</span><span class="n">direction</span><span class="p">,</span> <span class="n">prev_pools</span><span class="p">)</span>
</span><span id="EvalPool-290"><a href="#EvalPool-290"><span class="linenos">290</span></a>                <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">iterators</span><span class="p">):</span>
</span><span id="EvalPool-291"><a href="#EvalPool-291"><span class="linenos">291</span></a>                    <span class="n">pools</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">)</span>
</span><span id="EvalPool-292"><a href="#EvalPool-292"><span class="linenos">292</span></a>                    <span class="n">prod_weight</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
</span><span id="EvalPool-293"><a href="#EvalPool-293"><span class="linenos">293</span></a>                    <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_state</span><span class="p">(</span><span class="n">prev_state</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="o">*</span><span class="n">counts</span><span class="p">)</span>
</span><span id="EvalPool-294"><a href="#EvalPool-294"><span class="linenos">294</span></a>                    <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Reroll</span><span class="p">:</span>
</span><span id="EvalPool-295"><a href="#EvalPool-295"><span class="linenos">295</span></a>                        <span class="n">next_dist</span><span class="p">[</span><span class="n">state</span><span class="p">,</span> <span class="n">pools</span><span class="p">]</span> <span class="o">+=</span> <span class="n">weight</span> <span class="o">*</span> <span class="n">prod_weight</span>
</span><span id="EvalPool-296"><a href="#EvalPool-296"><span class="linenos">296</span></a>            <span class="n">dist</span> <span class="o">=</span> <span class="n">next_dist</span>
</span><span id="EvalPool-297"><a href="#EvalPool-297"><span class="linenos">297</span></a>        <span class="k">return</span> <span class="p">{</span> <span class="n">state</span> <span class="p">:</span> <span class="n">weight</span> <span class="k">for</span> <span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">_</span><span class="p">),</span> <span class="n">weight</span> <span class="ow">in</span> <span class="n">dist</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">}</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>An abstract, immutable, callable class for evaulating one or more <code><a href="#DicePool">DicePool</a></code>s.</p>

<p>There is one abstract method to implement: <code><a href="#EvalPool.next_state">next_state()</a></code>.
This should incrementally calculate the result of the roll
given one outcome at a time along with how many dice rolled that outcome.
An example sequence of calls, as far as <code><a href="#EvalPool.next_state">next_state()</a></code> is concerned, is:</p>

<ol>
<li><code>state = next_state(state=None, 1, how_many_dice_rolled_1)</code></li>
<li><code>state = next_state(state, 2, how_many_dice_rolled_2)</code></li>
<li><code>state = next_state(state, 3, how_many_dice_rolled_3)</code></li>
<li><code>state = next_state(state, 4, how_many_dice_rolled_4)</code></li>
<li><code>state = next_state(state, 5, how_many_dice_rolled_5)</code></li>
<li><code>state = next_state(state, 6, how_many_dice_rolled_6)</code></li>
<li><code>outcome = final_outcome(state, *pools)</code></li>
</ol>

<p>A few other methods can optionally be overridden to further customize behavior.</p>

<p>It is not expected that subclasses of <code><a href="#EvalPool">EvalPool</a></code>
be able to handle arbitrary types or numbers of pools.
Indeed, most are expected to handle only a fixed number of pools,
and often even only pools with a particular type of die.</p>

<p>Instances cache all intermediate state distributions.
You should therefore reuse instances when possible.</p>

<p>Instances should not be modified after construction
in any way that affects the return values of these methods.
Otherwise, values in the cache may be incorrect.</p>
</div>


                            <div id="EvalPool.next_state" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#EvalPool.next_state">#&nbsp;&nbsp</a>

                <div class="decorator">@abstractmethod</div>

            <span class="def">def</span>
            <span class="name">next_state</span><span class="signature">(self, state, outcome, *counts)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EvalPool.next_state-42"><a href="#EvalPool.next_state-42"><span class="linenos">42</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="EvalPool.next_state-43"><a href="#EvalPool.next_state-43"><span class="linenos">43</span></a>    <span class="k">def</span> <span class="nf">next_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="o">*</span><span class="n">counts</span><span class="p">):</span>
</span><span id="EvalPool.next_state-44"><a href="#EvalPool.next_state-44"><span class="linenos">44</span></a>        <span class="sd">&quot;&quot;&quot; State transition function.</span>
</span><span id="EvalPool.next_state-45"><a href="#EvalPool.next_state-45"><span class="linenos">45</span></a><span class="sd">        </span>
</span><span id="EvalPool.next_state-46"><a href="#EvalPool.next_state-46"><span class="linenos">46</span></a><span class="sd">        This should produce a state given the previous state, an outcome,</span>
</span><span id="EvalPool.next_state-47"><a href="#EvalPool.next_state-47"><span class="linenos">47</span></a><span class="sd">        and the number of dice in each pool rolling that outcome.</span>
</span><span id="EvalPool.next_state-48"><a href="#EvalPool.next_state-48"><span class="linenos">48</span></a><span class="sd">        </span>
</span><span id="EvalPool.next_state-49"><a href="#EvalPool.next_state-49"><span class="linenos">49</span></a><span class="sd">        Make sure to handle the base case where `state is None`.</span>
</span><span id="EvalPool.next_state-50"><a href="#EvalPool.next_state-50"><span class="linenos">50</span></a><span class="sd">        </span>
</span><span id="EvalPool.next_state-51"><a href="#EvalPool.next_state-51"><span class="linenos">51</span></a><span class="sd">        Args:</span>
</span><span id="EvalPool.next_state-52"><a href="#EvalPool.next_state-52"><span class="linenos">52</span></a><span class="sd">            state: A hashable object indicating the state before rolling the current outcome.</span>
</span><span id="EvalPool.next_state-53"><a href="#EvalPool.next_state-53"><span class="linenos">53</span></a><span class="sd">                If there was no previous outcome, this will be `None`.</span>
</span><span id="EvalPool.next_state-54"><a href="#EvalPool.next_state-54"><span class="linenos">54</span></a><span class="sd">            outcome: The current outcome.</span>
</span><span id="EvalPool.next_state-55"><a href="#EvalPool.next_state-55"><span class="linenos">55</span></a><span class="sd">                `next_state` will see all outcomes in monotonic order,</span>
</span><span id="EvalPool.next_state-56"><a href="#EvalPool.next_state-56"><span class="linenos">56</span></a><span class="sd">                either ascending or descending depending on `direction()`.</span>
</span><span id="EvalPool.next_state-57"><a href="#EvalPool.next_state-57"><span class="linenos">57</span></a><span class="sd">                If there are multiple pools, the set of outcomes is the union of the outcomes of the invididual pools.</span>
</span><span id="EvalPool.next_state-58"><a href="#EvalPool.next_state-58"><span class="linenos">58</span></a><span class="sd">                Interleaving outcomes between different pools is allowed but discouraged.</span>
</span><span id="EvalPool.next_state-59"><a href="#EvalPool.next_state-59"><span class="linenos">59</span></a><span class="sd">            *counts: One `int` for each pool indicating how many dice in that pool rolled the current outcome.</span>
</span><span id="EvalPool.next_state-60"><a href="#EvalPool.next_state-60"><span class="linenos">60</span></a><span class="sd">                If there are multiple pools, it&#39;s possible that some outcomes will not appear in all pools.</span>
</span><span id="EvalPool.next_state-61"><a href="#EvalPool.next_state-61"><span class="linenos">61</span></a><span class="sd">                In this case, the count for the pool(s) that do not have the outcome will be 0. </span>
</span><span id="EvalPool.next_state-62"><a href="#EvalPool.next_state-62"><span class="linenos">62</span></a><span class="sd">                Zero-weight outcomes count as having that outcome.</span>
</span><span id="EvalPool.next_state-63"><a href="#EvalPool.next_state-63"><span class="linenos">63</span></a><span class="sd">                </span>
</span><span id="EvalPool.next_state-64"><a href="#EvalPool.next_state-64"><span class="linenos">64</span></a><span class="sd">                Most subclasses will expect a fixed number of pools and </span>
</span><span id="EvalPool.next_state-65"><a href="#EvalPool.next_state-65"><span class="linenos">65</span></a><span class="sd">                can replace this variadic parameter with a fixed number of named parameters.</span>
</span><span id="EvalPool.next_state-66"><a href="#EvalPool.next_state-66"><span class="linenos">66</span></a><span class="sd">        </span>
</span><span id="EvalPool.next_state-67"><a href="#EvalPool.next_state-67"><span class="linenos">67</span></a><span class="sd">        Returns:</span>
</span><span id="EvalPool.next_state-68"><a href="#EvalPool.next_state-68"><span class="linenos">68</span></a><span class="sd">            A hashable object indicating the next state.</span>
</span><span id="EvalPool.next_state-69"><a href="#EvalPool.next_state-69"><span class="linenos">69</span></a><span class="sd">            The special value `icepool.Reroll` can be used to immediately remove the state from consideration,</span>
</span><span id="EvalPool.next_state-70"><a href="#EvalPool.next_state-70"><span class="linenos">70</span></a><span class="sd">            effectively performing a full reroll of the pool.</span>
</span><span id="EvalPool.next_state-71"><a href="#EvalPool.next_state-71"><span class="linenos">71</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>State transition function.</p>

<p>This should produce a state given the previous state, an outcome,
and the number of dice in each pool rolling that outcome.</p>

<p>Make sure to handle the base case where <code>state is None</code>.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>state:</strong>  A hashable object indicating the state before rolling the current outcome.
If there was no previous outcome, this will be <code>None</code>.</li>
<li><strong>outcome:</strong>  The current outcome.
<code><a href="#EvalPool.next_state">next_state</a></code> will see all outcomes in monotonic order,
either ascending or descending depending on <code><a href="#EvalPool.direction">direction()</a></code>.
If there are multiple pools, the set of outcomes is the union of the outcomes of the invididual pools.
Interleaving outcomes between different pools is allowed but discouraged.</li>
<li><p><strong>*counts:</strong>  One <code>int</code> for each pool indicating how many dice in that pool rolled the current outcome.
If there are multiple pools, it's possible that some outcomes will not appear in all pools.
In this case, the count for the pool(s) that do not have the outcome will be 0. 
Zero-weight outcomes count as having that outcome.</p>

<p>Most subclasses will expect a fixed number of pools and 
can replace this variadic parameter with a fixed number of named parameters.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A hashable object indicating the next state.
  The special value <code><a href="#Reroll">icepool.Reroll</a></code> can be used to immediately remove the state from consideration,
  effectively performing a full reroll of the pool.</p>
</blockquote>
</div>


                            </div>
                            <div id="EvalPool.final_outcome" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#EvalPool.final_outcome">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">final_outcome</span><span class="signature">(self, final_state, *pools)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EvalPool.final_outcome-73"><a href="#EvalPool.final_outcome-73"><span class="linenos">73</span></a>    <span class="k">def</span> <span class="nf">final_outcome</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">final_state</span><span class="p">,</span> <span class="o">*</span><span class="n">pools</span><span class="p">):</span>
</span><span id="EvalPool.final_outcome-74"><a href="#EvalPool.final_outcome-74"><span class="linenos">74</span></a>        <span class="sd">&quot;&quot;&quot; Optional function to generate a final outcome from a final state.</span>
</span><span id="EvalPool.final_outcome-75"><a href="#EvalPool.final_outcome-75"><span class="linenos">75</span></a><span class="sd">        </span>
</span><span id="EvalPool.final_outcome-76"><a href="#EvalPool.final_outcome-76"><span class="linenos">76</span></a><span class="sd">        By default, the final outcome is equal to the final state.</span>
</span><span id="EvalPool.final_outcome-77"><a href="#EvalPool.final_outcome-77"><span class="linenos">77</span></a><span class="sd">        Note that `None` is not a valid outcome for a die,</span>
</span><span id="EvalPool.final_outcome-78"><a href="#EvalPool.final_outcome-78"><span class="linenos">78</span></a><span class="sd">        and if all pools consist of empty dice, the final state will be `None`.</span>
</span><span id="EvalPool.final_outcome-79"><a href="#EvalPool.final_outcome-79"><span class="linenos">79</span></a><span class="sd">        Subclasses that want to handle this case should explicitly define what happens.</span>
</span><span id="EvalPool.final_outcome-80"><a href="#EvalPool.final_outcome-80"><span class="linenos">80</span></a><span class="sd">        </span>
</span><span id="EvalPool.final_outcome-81"><a href="#EvalPool.final_outcome-81"><span class="linenos">81</span></a><span class="sd">        Args:</span>
</span><span id="EvalPool.final_outcome-82"><a href="#EvalPool.final_outcome-82"><span class="linenos">82</span></a><span class="sd">            final_state: A state after all outcomes have been processed.</span>
</span><span id="EvalPool.final_outcome-83"><a href="#EvalPool.final_outcome-83"><span class="linenos">83</span></a><span class="sd">            *pools: One or more `DicePool`s being evaluated.</span>
</span><span id="EvalPool.final_outcome-84"><a href="#EvalPool.final_outcome-84"><span class="linenos">84</span></a><span class="sd">            </span>
</span><span id="EvalPool.final_outcome-85"><a href="#EvalPool.final_outcome-85"><span class="linenos">85</span></a><span class="sd">                Most subclasses will expect a fixed number of pools and </span>
</span><span id="EvalPool.final_outcome-86"><a href="#EvalPool.final_outcome-86"><span class="linenos">86</span></a><span class="sd">                can replace this variadic parameter with a fixed number of named parameters.</span>
</span><span id="EvalPool.final_outcome-87"><a href="#EvalPool.final_outcome-87"><span class="linenos">87</span></a><span class="sd">            </span>
</span><span id="EvalPool.final_outcome-88"><a href="#EvalPool.final_outcome-88"><span class="linenos">88</span></a><span class="sd">        Returns:</span>
</span><span id="EvalPool.final_outcome-89"><a href="#EvalPool.final_outcome-89"><span class="linenos">89</span></a><span class="sd">            A final outcome that will be used as part of constructing the result die.</span>
</span><span id="EvalPool.final_outcome-90"><a href="#EvalPool.final_outcome-90"><span class="linenos">90</span></a><span class="sd">            As usual for `Die()`, this could itself be a die or `icepool.Reroll`.</span>
</span><span id="EvalPool.final_outcome-91"><a href="#EvalPool.final_outcome-91"><span class="linenos">91</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EvalPool.final_outcome-92"><a href="#EvalPool.final_outcome-92"><span class="linenos">92</span></a>        <span class="k">return</span> <span class="n">final_state</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Optional function to generate a final outcome from a final state.</p>

<p>By default, the final outcome is equal to the final state.
Note that <code>None</code> is not a valid outcome for a die,
and if all pools consist of empty dice, the final state will be <code>None</code>.
Subclasses that want to handle this case should explicitly define what happens.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>final_state:</strong>  A state after all outcomes have been processed.</li>
<li><p><strong>*pools:</strong>  One or more <code><a href="#DicePool">DicePool</a></code>s being evaluated.</p>

<p>Most subclasses will expect a fixed number of pools and 
can replace this variadic parameter with a fixed number of named parameters.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A final outcome that will be used as part of constructing the result die.
  As usual for <code><a href="#Die">Die()</a></code>, this could itself be a die or <code><a href="#Reroll">icepool.Reroll</a></code>.</p>
</blockquote>
</div>


                            </div>
                            <div id="EvalPool.direction" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#EvalPool.direction">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">direction</span><span class="signature">(self, *pools)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EvalPool.direction-94"><a href="#EvalPool.direction-94"><span class="linenos"> 94</span></a>    <span class="k">def</span> <span class="nf">direction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">pools</span><span class="p">):</span>
</span><span id="EvalPool.direction-95"><a href="#EvalPool.direction-95"><span class="linenos"> 95</span></a>        <span class="sd">&quot;&quot;&quot; Optional function to determine the direction in which `next_state()` will see outcomes.</span>
</span><span id="EvalPool.direction-96"><a href="#EvalPool.direction-96"><span class="linenos"> 96</span></a><span class="sd">        </span>
</span><span id="EvalPool.direction-97"><a href="#EvalPool.direction-97"><span class="linenos"> 97</span></a><span class="sd">        Note that an ascending (&gt; 0) direction is not compatible with pools with `truncate_min`,</span>
</span><span id="EvalPool.direction-98"><a href="#EvalPool.direction-98"><span class="linenos"> 98</span></a><span class="sd">        and a descending (&lt; 0) direction is not compatible with pools with `truncate_max`.</span>
</span><span id="EvalPool.direction-99"><a href="#EvalPool.direction-99"><span class="linenos"> 99</span></a>
</span><span id="EvalPool.direction-100"><a href="#EvalPool.direction-100"><span class="linenos">100</span></a><span class="sd">        The default is ascending order.</span>
</span><span id="EvalPool.direction-101"><a href="#EvalPool.direction-101"><span class="linenos">101</span></a><span class="sd">        </span>
</span><span id="EvalPool.direction-102"><a href="#EvalPool.direction-102"><span class="linenos">102</span></a><span class="sd">        Args:</span>
</span><span id="EvalPool.direction-103"><a href="#EvalPool.direction-103"><span class="linenos">103</span></a><span class="sd">            *pools: One or more `DicePool`s being evaluated.</span>
</span><span id="EvalPool.direction-104"><a href="#EvalPool.direction-104"><span class="linenos">104</span></a><span class="sd">            </span>
</span><span id="EvalPool.direction-105"><a href="#EvalPool.direction-105"><span class="linenos">105</span></a><span class="sd">                Most subclasses will expect a fixed number of pools and </span>
</span><span id="EvalPool.direction-106"><a href="#EvalPool.direction-106"><span class="linenos">106</span></a><span class="sd">                can replace this variadic parameter with a fixed number of named parameters.</span>
</span><span id="EvalPool.direction-107"><a href="#EvalPool.direction-107"><span class="linenos">107</span></a><span class="sd">            </span>
</span><span id="EvalPool.direction-108"><a href="#EvalPool.direction-108"><span class="linenos">108</span></a><span class="sd">        Returns:</span>
</span><span id="EvalPool.direction-109"><a href="#EvalPool.direction-109"><span class="linenos">109</span></a><span class="sd">            * &gt; 0 if `next_state()` should always see the outcomes in ascending order.</span>
</span><span id="EvalPool.direction-110"><a href="#EvalPool.direction-110"><span class="linenos">110</span></a><span class="sd">            * &lt; 0 if `next_state()` should always see the outcomes in descending order.</span>
</span><span id="EvalPool.direction-111"><a href="#EvalPool.direction-111"><span class="linenos">111</span></a><span class="sd">            * 0 if the order may be determined automatically.</span>
</span><span id="EvalPool.direction-112"><a href="#EvalPool.direction-112"><span class="linenos">112</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EvalPool.direction-113"><a href="#EvalPool.direction-113"><span class="linenos">113</span></a>        <span class="k">return</span> <span class="mi">1</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Optional function to determine the direction in which <code><a href="#EvalPool.next_state">next_state()</a></code> will see outcomes.</p>

<p>Note that an ascending (&gt; 0) direction is not compatible with pools with <code>truncate_min</code>,
and a descending (&lt; 0) direction is not compatible with pools with <code>truncate_max</code>.</p>

<p>The default is ascending order.</p>

<h6 id="args">Args</h6>

<ul>
<li><p><strong>*pools:</strong>  One or more <code><a href="#DicePool">DicePool</a></code>s being evaluated.</p>

<p>Most subclasses will expect a fixed number of pools and 
can replace this variadic parameter with a fixed number of named parameters.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <ul>
  <li>&gt; 0 if <code><a href="#EvalPool.next_state">next_state()</a></code> should always see the outcomes in ascending order.</li>
  <li>&lt; 0 if <code><a href="#EvalPool.next_state">next_state()</a></code> should always see the outcomes in descending order.</li>
  <li>0 if the order may be determined automatically.</li>
  </ul>
</blockquote>
</div>


                            </div>
                            <div id="EvalPool.ndim" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#EvalPool.ndim">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">ndim</span><span class="signature">(self, *pools)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EvalPool.ndim-115"><a href="#EvalPool.ndim-115"><span class="linenos">115</span></a>    <span class="k">def</span> <span class="nf">ndim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">pools</span><span class="p">):</span>
</span><span id="EvalPool.ndim-116"><a href="#EvalPool.ndim-116"><span class="linenos">116</span></a>        <span class="sd">&quot;&quot;&quot; Optional function to specify the number of dimensions of the output die.</span>
</span><span id="EvalPool.ndim-117"><a href="#EvalPool.ndim-117"><span class="linenos">117</span></a><span class="sd">        </span>
</span><span id="EvalPool.ndim-118"><a href="#EvalPool.ndim-118"><span class="linenos">118</span></a><span class="sd">        If not provided, the ndim of the result will be determined automatically as per `Die()`.</span>
</span><span id="EvalPool.ndim-119"><a href="#EvalPool.ndim-119"><span class="linenos">119</span></a><span class="sd">        </span>
</span><span id="EvalPool.ndim-120"><a href="#EvalPool.ndim-120"><span class="linenos">120</span></a><span class="sd">        Args:</span>
</span><span id="EvalPool.ndim-121"><a href="#EvalPool.ndim-121"><span class="linenos">121</span></a><span class="sd">            *pools: One or more `DicePool`s being evaluated.</span>
</span><span id="EvalPool.ndim-122"><a href="#EvalPool.ndim-122"><span class="linenos">122</span></a><span class="sd">                </span>
</span><span id="EvalPool.ndim-123"><a href="#EvalPool.ndim-123"><span class="linenos">123</span></a><span class="sd">                Most subclasses will expect a fixed number of pools and </span>
</span><span id="EvalPool.ndim-124"><a href="#EvalPool.ndim-124"><span class="linenos">124</span></a><span class="sd">                can replace this variadic parameter with a fixed number of named parameters.</span>
</span><span id="EvalPool.ndim-125"><a href="#EvalPool.ndim-125"><span class="linenos">125</span></a><span class="sd">        </span>
</span><span id="EvalPool.ndim-126"><a href="#EvalPool.ndim-126"><span class="linenos">126</span></a><span class="sd">        Returns:</span>
</span><span id="EvalPool.ndim-127"><a href="#EvalPool.ndim-127"><span class="linenos">127</span></a><span class="sd">            The number of dimensions that the output die should have,</span>
</span><span id="EvalPool.ndim-128"><a href="#EvalPool.ndim-128"><span class="linenos">128</span></a><span class="sd">            or `None` if this should be determined automatically by `Die()`.</span>
</span><span id="EvalPool.ndim-129"><a href="#EvalPool.ndim-129"><span class="linenos">129</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EvalPool.ndim-130"><a href="#EvalPool.ndim-130"><span class="linenos">130</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Optional function to specify the number of dimensions of the output die.</p>

<p>If not provided, the ndim of the result will be determined automatically as per <code><a href="#Die">Die()</a></code>.</p>

<h6 id="args">Args</h6>

<ul>
<li><p><strong>*pools:</strong>  One or more <code><a href="#DicePool">DicePool</a></code>s being evaluated.</p>

<p>Most subclasses will expect a fixed number of pools and 
can replace this variadic parameter with a fixed number of named parameters.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The number of dimensions that the output die should have,
  or <code>None</code> if this should be determined automatically by <code><a href="#Die">Die()</a></code>.</p>
</blockquote>
</div>


                            </div>
                            <div id="EvalPool.eval" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#EvalPool.eval">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">eval</span><span class="signature">(self, *pools)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EvalPool.eval-137"><a href="#EvalPool.eval-137"><span class="linenos">137</span></a>    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">pools</span><span class="p">):</span>
</span><span id="EvalPool.eval-138"><a href="#EvalPool.eval-138"><span class="linenos">138</span></a>        <span class="sd">&quot;&quot;&quot; Evaluates pools.</span>
</span><span id="EvalPool.eval-139"><a href="#EvalPool.eval-139"><span class="linenos">139</span></a><span class="sd">        </span>
</span><span id="EvalPool.eval-140"><a href="#EvalPool.eval-140"><span class="linenos">140</span></a><span class="sd">        You can call the `EvalPool` object directly for the same effect,</span>
</span><span id="EvalPool.eval-141"><a href="#EvalPool.eval-141"><span class="linenos">141</span></a><span class="sd">        e.g. `sum_pool(pool)` is an alias for `sum_pool.eval(pool)`.</span>
</span><span id="EvalPool.eval-142"><a href="#EvalPool.eval-142"><span class="linenos">142</span></a><span class="sd">        </span>
</span><span id="EvalPool.eval-143"><a href="#EvalPool.eval-143"><span class="linenos">143</span></a><span class="sd">        Args:</span>
</span><span id="EvalPool.eval-144"><a href="#EvalPool.eval-144"><span class="linenos">144</span></a><span class="sd">            *pools: Each element may be one of the following:</span>
</span><span id="EvalPool.eval-145"><a href="#EvalPool.eval-145"><span class="linenos">145</span></a><span class="sd">                * A `DicePool` representing possible rolls of a pool.</span>
</span><span id="EvalPool.eval-146"><a href="#EvalPool.eval-146"><span class="linenos">146</span></a><span class="sd">                * A dict-like representing a single roll of a pool.</span>
</span><span id="EvalPool.eval-147"><a href="#EvalPool.eval-147"><span class="linenos">147</span></a><span class="sd">                    The dict maps outcomes to counts.</span>
</span><span id="EvalPool.eval-148"><a href="#EvalPool.eval-148"><span class="linenos">148</span></a><span class="sd">                * A sequence of outcomes representing a single roll of a pool. </span>
</span><span id="EvalPool.eval-149"><a href="#EvalPool.eval-149"><span class="linenos">149</span></a><span class="sd">                    Outcomes are treated as having 1 count per appearance.</span>
</span><span id="EvalPool.eval-150"><a href="#EvalPool.eval-150"><span class="linenos">150</span></a><span class="sd">                Most evaluators will expect a fixed number of pools.</span>
</span><span id="EvalPool.eval-151"><a href="#EvalPool.eval-151"><span class="linenos">151</span></a><span class="sd">                The outcomes of the pools must be mutually comparable.</span>
</span><span id="EvalPool.eval-152"><a href="#EvalPool.eval-152"><span class="linenos">152</span></a><span class="sd">                Pools with `truncate_min` and pools with `truncate_max` are not compatible.</span>
</span><span id="EvalPool.eval-153"><a href="#EvalPool.eval-153"><span class="linenos">153</span></a><span class="sd">        </span>
</span><span id="EvalPool.eval-154"><a href="#EvalPool.eval-154"><span class="linenos">154</span></a><span class="sd">        Returns:</span>
</span><span id="EvalPool.eval-155"><a href="#EvalPool.eval-155"><span class="linenos">155</span></a><span class="sd">            A die representing the distribution of the final score.</span>
</span><span id="EvalPool.eval-156"><a href="#EvalPool.eval-156"><span class="linenos">156</span></a><span class="sd">            If all pools are `PoolRoll`s, the result is a single outcome instead.</span>
</span><span id="EvalPool.eval-157"><a href="#EvalPool.eval-157"><span class="linenos">157</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EvalPool.eval-158"><a href="#EvalPool.eval-158"><span class="linenos">158</span></a>        
</span><span id="EvalPool.eval-159"><a href="#EvalPool.eval-159"><span class="linenos">159</span></a>        <span class="c1"># Cast non-pool arguments to `BasePool`.</span>
</span><span id="EvalPool.eval-160"><a href="#EvalPool.eval-160"><span class="linenos">160</span></a>        <span class="n">pools</span> <span class="o">=</span> <span class="p">[</span><span class="n">pool</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pool</span><span class="p">,</span> <span class="n">icepool</span><span class="o">.</span><span class="n">BasePool</span><span class="p">)</span> <span class="k">else</span> <span class="n">icepool</span><span class="o">.</span><span class="n">PoolRoll</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span> <span class="k">for</span> <span class="n">pool</span> <span class="ow">in</span> <span class="n">pools</span><span class="p">]</span>
</span><span id="EvalPool.eval-161"><a href="#EvalPool.eval-161"><span class="linenos">161</span></a>        
</span><span id="EvalPool.eval-162"><a href="#EvalPool.eval-162"><span class="linenos">162</span></a>        <span class="n">algorithm</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_select_algorithm</span><span class="p">(</span><span class="o">*</span><span class="n">pools</span><span class="p">)</span>
</span><span id="EvalPool.eval-163"><a href="#EvalPool.eval-163"><span class="linenos">163</span></a>        
</span><span id="EvalPool.eval-164"><a href="#EvalPool.eval-164"><span class="linenos">164</span></a>        <span class="n">dist</span> <span class="o">=</span> <span class="n">algorithm</span><span class="p">(</span><span class="n">direction</span><span class="p">,</span> <span class="o">*</span><span class="n">pools</span><span class="p">)</span>
</span><span id="EvalPool.eval-165"><a href="#EvalPool.eval-165"><span class="linenos">165</span></a>        
</span><span id="EvalPool.eval-166"><a href="#EvalPool.eval-166"><span class="linenos">166</span></a>        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">_is_single_roll</span><span class="p">()</span> <span class="k">for</span> <span class="n">pool</span> <span class="ow">in</span> <span class="n">pools</span><span class="p">):</span>
</span><span id="EvalPool.eval-167"><a href="#EvalPool.eval-167"><span class="linenos">167</span></a>            <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">dist</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="EvalPool.eval-168"><a href="#EvalPool.eval-168"><span class="linenos">168</span></a>                <span class="c1"># Return a single outcome.</span>
</span><span id="EvalPool.eval-169"><a href="#EvalPool.eval-169"><span class="linenos">169</span></a>                <span class="k">return</span> <span class="n">state</span>
</span><span id="EvalPool.eval-170"><a href="#EvalPool.eval-170"><span class="linenos">170</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EvalPool.eval-171"><a href="#EvalPool.eval-171"><span class="linenos">171</span></a>            <span class="n">final_outcomes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="EvalPool.eval-172"><a href="#EvalPool.eval-172"><span class="linenos">172</span></a>            <span class="n">final_weights</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="EvalPool.eval-173"><a href="#EvalPool.eval-173"><span class="linenos">173</span></a>            <span class="k">for</span> <span class="n">state</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="n">dist</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="EvalPool.eval-174"><a href="#EvalPool.eval-174"><span class="linenos">174</span></a>                <span class="n">outcome</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_outcome</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="o">*</span><span class="n">pools</span><span class="p">)</span>
</span><span id="EvalPool.eval-175"><a href="#EvalPool.eval-175"><span class="linenos">175</span></a>                <span class="k">if</span> <span class="n">outcome</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Reroll</span><span class="p">:</span>
</span><span id="EvalPool.eval-176"><a href="#EvalPool.eval-176"><span class="linenos">176</span></a>                    <span class="n">final_outcomes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
</span><span id="EvalPool.eval-177"><a href="#EvalPool.eval-177"><span class="linenos">177</span></a>                    <span class="n">final_weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span>
</span><span id="EvalPool.eval-178"><a href="#EvalPool.eval-178"><span class="linenos">178</span></a>            
</span><span id="EvalPool.eval-179"><a href="#EvalPool.eval-179"><span class="linenos">179</span></a>            <span class="k">return</span> <span class="n">icepool</span><span class="o">.</span><span class="n">Die</span><span class="p">(</span><span class="o">*</span><span class="n">final_outcomes</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">final_weights</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="o">*</span><span class="n">pools</span><span class="p">))</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Evaluates pools.</p>

<p>You can call the <code><a href="#EvalPool">EvalPool</a></code> object directly for the same effect,
e.g. <code>sum_pool(pool)</code> is an alias for <code>sum_pool.eval(pool)</code>.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>*pools:</strong>  Each element may be one of the following:
<ul>
<li>A <code><a href="#DicePool">DicePool</a></code> representing possible rolls of a pool.</li>
<li>A dict-like representing a single roll of a pool.
The dict maps outcomes to counts.</li>
<li>A sequence of outcomes representing a single roll of a pool. 
Outcomes are treated as having 1 count per appearance.
Most evaluators will expect a fixed number of pools.
The outcomes of the pools must be mutually comparable.
Pools with <code>truncate_min</code> and pools with <code>truncate_max</code> are not compatible.</li>
</ul></li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A die representing the distribution of the final score.
  If all pools are <code>PoolRoll</code>s, the result is a single outcome instead.</p>
</blockquote>
</div>


                            </div>
                            <div id="EvalPool.bind_dice" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#EvalPool.bind_dice">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">bind_dice</span><span class="signature">(self, *dice)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EvalPool.bind_dice-183"><a href="#EvalPool.bind_dice-183"><span class="linenos">183</span></a>    <span class="k">def</span> <span class="nf">bind_dice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">dice</span><span class="p">):</span>
</span><span id="EvalPool.bind_dice-184"><a href="#EvalPool.bind_dice-184"><span class="linenos">184</span></a>        <span class="sd">&quot;&quot;&quot; Binds one die for each pool.</span>
</span><span id="EvalPool.bind_dice-185"><a href="#EvalPool.bind_dice-185"><span class="linenos">185</span></a><span class="sd">        </span>
</span><span id="EvalPool.bind_dice-186"><a href="#EvalPool.bind_dice-186"><span class="linenos">186</span></a><span class="sd">        For example, `sum_d6s = sum_pool.bind_dice(icepool.d6)` would produce</span>
</span><span id="EvalPool.bind_dice-187"><a href="#EvalPool.bind_dice-187"><span class="linenos">187</span></a><span class="sd">        a function that takes one argument and sums that many d6s.</span>
</span><span id="EvalPool.bind_dice-188"><a href="#EvalPool.bind_dice-188"><span class="linenos">188</span></a><span class="sd">        `sum_d6s(3)` would then be the same as `3 @ icepool.d6`.</span>
</span><span id="EvalPool.bind_dice-189"><a href="#EvalPool.bind_dice-189"><span class="linenos">189</span></a><span class="sd">        </span>
</span><span id="EvalPool.bind_dice-190"><a href="#EvalPool.bind_dice-190"><span class="linenos">190</span></a><span class="sd">        Args:</span>
</span><span id="EvalPool.bind_dice-191"><a href="#EvalPool.bind_dice-191"><span class="linenos">191</span></a><span class="sd">            *dice: One die for each pool taken by this `EvalPool`.</span>
</span><span id="EvalPool.bind_dice-192"><a href="#EvalPool.bind_dice-192"><span class="linenos">192</span></a><span class="sd">        </span>
</span><span id="EvalPool.bind_dice-193"><a href="#EvalPool.bind_dice-193"><span class="linenos">193</span></a><span class="sd">        Returns:</span>
</span><span id="EvalPool.bind_dice-194"><a href="#EvalPool.bind_dice-194"><span class="linenos">194</span></a><span class="sd">            A function that takes in one `num_dice` per pool,</span>
</span><span id="EvalPool.bind_dice-195"><a href="#EvalPool.bind_dice-195"><span class="linenos">195</span></a><span class="sd">            then runs this `EvalPool` for pools of that size using the bound dice.</span>
</span><span id="EvalPool.bind_dice-196"><a href="#EvalPool.bind_dice-196"><span class="linenos">196</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EvalPool.bind_dice-197"><a href="#EvalPool.bind_dice-197"><span class="linenos">197</span></a>        <span class="k">def</span> <span class="nf">bound_eval</span><span class="p">(</span><span class="o">*</span><span class="n">num_dices</span><span class="p">):</span>
</span><span id="EvalPool.bind_dice-198"><a href="#EvalPool.bind_dice-198"><span class="linenos">198</span></a>            <span class="n">pools</span> <span class="o">=</span> <span class="p">(</span><span class="n">die</span><span class="o">.</span><span class="n">pool</span><span class="p">(</span><span class="n">num_dice</span><span class="p">)</span> <span class="k">for</span> <span class="n">die</span><span class="p">,</span> <span class="n">num_dice</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dice</span><span class="p">,</span> <span class="n">num_dices</span><span class="p">))</span>
</span><span id="EvalPool.bind_dice-199"><a href="#EvalPool.bind_dice-199"><span class="linenos">199</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="o">*</span><span class="n">pools</span><span class="p">)</span>
</span><span id="EvalPool.bind_dice-200"><a href="#EvalPool.bind_dice-200"><span class="linenos">200</span></a>        
</span><span id="EvalPool.bind_dice-201"><a href="#EvalPool.bind_dice-201"><span class="linenos">201</span></a>        <span class="k">return</span> <span class="n">bound_eval</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Binds one die for each pool.</p>

<p>For example, <code>sum_d6s = sum_pool.bind_dice(<a href="#d6">icepool.d6</a>)</code> would produce
a function that takes one argument and sums that many d6s.
<code>sum_d6s(3)</code> would then be the same as <code>3 @ <a href="#d6">icepool.d6</a></code>.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>*dice:</strong>  One die for each pool taken by this <code><a href="#EvalPool">EvalPool</a></code>.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A function that takes in one <code>num_dice</code> per pool,
  then runs this <code><a href="#EvalPool">EvalPool</a></code> for pools of that size using the bound dice.</p>
</blockquote>
</div>


                            </div>
                </section>
                <section id="WrapFuncEval">
                                <div class="attr class">
        <a class="headerlink" href="#WrapFuncEval">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">WrapFuncEval</span><wbr>(<span class="base"><a href="#EvalPool">icepool.EvalPool</a></span>):
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WrapFuncEval-349"><a href="#WrapFuncEval-349"><span class="linenos">349</span></a><span class="k">class</span> <span class="nc">WrapFuncEval</span><span class="p">(</span><span class="n">EvalPool</span><span class="p">):</span>
</span><span id="WrapFuncEval-350"><a href="#WrapFuncEval-350"><span class="linenos">350</span></a>    <span class="sd">&quot;&quot;&quot; A `EvalPool` created from a single provided function.</span>
</span><span id="WrapFuncEval-351"><a href="#WrapFuncEval-351"><span class="linenos">351</span></a><span class="sd">    </span>
</span><span id="WrapFuncEval-352"><a href="#WrapFuncEval-352"><span class="linenos">352</span></a><span class="sd">    `next_state()` simply calls that function.</span>
</span><span id="WrapFuncEval-353"><a href="#WrapFuncEval-353"><span class="linenos">353</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="WrapFuncEval-354"><a href="#WrapFuncEval-354"><span class="linenos">354</span></a>    
</span><span id="WrapFuncEval-355"><a href="#WrapFuncEval-355"><span class="linenos">355</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">/</span><span class="p">):</span>
</span><span id="WrapFuncEval-356"><a href="#WrapFuncEval-356"><span class="linenos">356</span></a>        <span class="sd">&quot;&quot;&quot; Constructs a new instance given the function that should be called for `next_state()`.</span>
</span><span id="WrapFuncEval-357"><a href="#WrapFuncEval-357"><span class="linenos">357</span></a><span class="sd">        Args:</span>
</span><span id="WrapFuncEval-358"><a href="#WrapFuncEval-358"><span class="linenos">358</span></a><span class="sd">            func(state, outcome, *counts): This should take the same arguments as `next_state()`, minus `self`,</span>
</span><span id="WrapFuncEval-359"><a href="#WrapFuncEval-359"><span class="linenos">359</span></a><span class="sd">                and return the next state.</span>
</span><span id="WrapFuncEval-360"><a href="#WrapFuncEval-360"><span class="linenos">360</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WrapFuncEval-361"><a href="#WrapFuncEval-361"><span class="linenos">361</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_func</span> <span class="o">=</span> <span class="n">func</span>
</span><span id="WrapFuncEval-362"><a href="#WrapFuncEval-362"><span class="linenos">362</span></a>    
</span><span id="WrapFuncEval-363"><a href="#WrapFuncEval-363"><span class="linenos">363</span></a>    <span class="k">def</span> <span class="nf">next_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="o">*</span><span class="n">counts</span><span class="p">):</span>
</span><span id="WrapFuncEval-364"><a href="#WrapFuncEval-364"><span class="linenos">364</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_func</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="o">*</span><span class="n">counts</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>A <code><a href="#EvalPool">EvalPool</a></code> created from a single provided function.</p>

<p><code><a href="#WrapFuncEval.next_state">next_state()</a></code> simply calls that function.</p>
</div>


                            <div id="WrapFuncEval.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#WrapFuncEval.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">WrapFuncEval</span><span class="signature">(func, /)</span>
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WrapFuncEval.__init__-355"><a href="#WrapFuncEval.__init__-355"><span class="linenos">355</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">/</span><span class="p">):</span>
</span><span id="WrapFuncEval.__init__-356"><a href="#WrapFuncEval.__init__-356"><span class="linenos">356</span></a>        <span class="sd">&quot;&quot;&quot; Constructs a new instance given the function that should be called for `next_state()`.</span>
</span><span id="WrapFuncEval.__init__-357"><a href="#WrapFuncEval.__init__-357"><span class="linenos">357</span></a><span class="sd">        Args:</span>
</span><span id="WrapFuncEval.__init__-358"><a href="#WrapFuncEval.__init__-358"><span class="linenos">358</span></a><span class="sd">            func(state, outcome, *counts): This should take the same arguments as `next_state()`, minus `self`,</span>
</span><span id="WrapFuncEval.__init__-359"><a href="#WrapFuncEval.__init__-359"><span class="linenos">359</span></a><span class="sd">                and return the next state.</span>
</span><span id="WrapFuncEval.__init__-360"><a href="#WrapFuncEval.__init__-360"><span class="linenos">360</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WrapFuncEval.__init__-361"><a href="#WrapFuncEval.__init__-361"><span class="linenos">361</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_func</span> <span class="o">=</span> <span class="n">func</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Constructs a new instance given the function that should be called for <code><a href="#WrapFuncEval.next_state">next_state()</a></code>.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>func(state, outcome, *counts):</strong>  This should take the same arguments as <code><a href="#WrapFuncEval.next_state">next_state()</a></code>, minus <code>self</code>,
and return the next state.</li>
</ul>
</div>


                            </div>
                            <div id="WrapFuncEval.next_state" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#WrapFuncEval.next_state">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">next_state</span><span class="signature">(self, state, outcome, *counts)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WrapFuncEval.next_state-363"><a href="#WrapFuncEval.next_state-363"><span class="linenos">363</span></a>    <span class="k">def</span> <span class="nf">next_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="o">*</span><span class="n">counts</span><span class="p">):</span>
</span><span id="WrapFuncEval.next_state-364"><a href="#WrapFuncEval.next_state-364"><span class="linenos">364</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_func</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="o">*</span><span class="n">counts</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>State transition function.</p>

<p>This should produce a state given the previous state, an outcome,
and the number of dice in each pool rolling that outcome.</p>

<p>Make sure to handle the base case where <code>state is None</code>.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>state:</strong>  A hashable object indicating the state before rolling the current outcome.
If there was no previous outcome, this will be <code>None</code>.</li>
<li><strong>outcome:</strong>  The current outcome.
<code><a href="#WrapFuncEval.next_state">next_state</a></code> will see all outcomes in monotonic order,
either ascending or descending depending on <code><a href="#WrapFuncEval.direction">direction()</a></code>.
If there are multiple pools, the set of outcomes is the union of the outcomes of the invididual pools.
Interleaving outcomes between different pools is allowed but discouraged.</li>
<li><p><strong>*counts:</strong>  One <code>int</code> for each pool indicating how many dice in that pool rolled the current outcome.
If there are multiple pools, it's possible that some outcomes will not appear in all pools.
In this case, the count for the pool(s) that do not have the outcome will be 0. 
Zero-weight outcomes count as having that outcome.</p>

<p>Most subclasses will expect a fixed number of pools and 
can replace this variadic parameter with a fixed number of named parameters.</p></li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A hashable object indicating the next state.
  The special value <code><a href="#Reroll">icepool.Reroll</a></code> can be used to immediately remove the state from consideration,
  effectively performing a full reroll of the pool.</p>
</blockquote>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#EvalPool">EvalPool</a></dt>
                                <dd id="WrapFuncEval.final_outcome" class="function"><a href="#EvalPool.final_outcome">final_outcome</a></dd>
                <dd id="WrapFuncEval.direction" class="function"><a href="#EvalPool.direction">direction</a></dd>
                <dd id="WrapFuncEval.ndim" class="function"><a href="#EvalPool.ndim">ndim</a></dd>
                <dd id="WrapFuncEval.eval" class="function"><a href="#EvalPool.eval">eval</a></dd>
                <dd id="WrapFuncEval.bind_dice" class="function"><a href="#EvalPool.bind_dice">bind_dice</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="SumPool">
                                <div class="attr class">
        <a class="headerlink" href="#SumPool">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">SumPool</span><wbr>(<span class="base"><a href="#EvalPool">icepool.EvalPool</a></span>):
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SumPool-366"><a href="#SumPool-366"><span class="linenos">366</span></a><span class="k">class</span> <span class="nc">SumPool</span><span class="p">(</span><span class="n">EvalPool</span><span class="p">):</span>
</span><span id="SumPool-367"><a href="#SumPool-367"><span class="linenos">367</span></a>    <span class="sd">&quot;&quot;&quot; A simple `EvalPool` that just sums the dice in a pool. &quot;&quot;&quot;</span>
</span><span id="SumPool-368"><a href="#SumPool-368"><span class="linenos">368</span></a>    <span class="k">def</span> <span class="nf">next_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
</span><span id="SumPool-369"><a href="#SumPool-369"><span class="linenos">369</span></a>        <span class="sd">&quot;&quot;&quot; Add the dice to the running total. &quot;&quot;&quot;</span>
</span><span id="SumPool-370"><a href="#SumPool-370"><span class="linenos">370</span></a>        <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SumPool-371"><a href="#SumPool-371"><span class="linenos">371</span></a>            <span class="k">return</span> <span class="n">outcome</span> <span class="o">*</span> <span class="n">count</span>
</span><span id="SumPool-372"><a href="#SumPool-372"><span class="linenos">372</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SumPool-373"><a href="#SumPool-373"><span class="linenos">373</span></a>            <span class="k">return</span> <span class="n">state</span> <span class="o">+</span> <span class="n">outcome</span> <span class="o">*</span> <span class="n">count</span>
</span><span id="SumPool-374"><a href="#SumPool-374"><span class="linenos">374</span></a>    
</span><span id="SumPool-375"><a href="#SumPool-375"><span class="linenos">375</span></a>    <span class="k">def</span> <span class="nf">direction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">pools</span><span class="p">):</span>
</span><span id="SumPool-376"><a href="#SumPool-376"><span class="linenos">376</span></a>        <span class="sd">&quot;&quot;&quot; This eval doesn&#39;t care about direction. &quot;&quot;&quot;</span>
</span><span id="SumPool-377"><a href="#SumPool-377"><span class="linenos">377</span></a>        <span class="k">return</span> <span class="mi">0</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>A simple <code><a href="#EvalPool">EvalPool</a></code> that just sums the dice in a pool.</p>
</div>


                            <div id="SumPool.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SumPool.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">SumPool</span><span class="signature">()</span>
    </div>

    
    

                            </div>
                            <div id="SumPool.next_state" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SumPool.next_state">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">next_state</span><span class="signature">(self, state, outcome, count)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SumPool.next_state-368"><a href="#SumPool.next_state-368"><span class="linenos">368</span></a>    <span class="k">def</span> <span class="nf">next_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
</span><span id="SumPool.next_state-369"><a href="#SumPool.next_state-369"><span class="linenos">369</span></a>        <span class="sd">&quot;&quot;&quot; Add the dice to the running total. &quot;&quot;&quot;</span>
</span><span id="SumPool.next_state-370"><a href="#SumPool.next_state-370"><span class="linenos">370</span></a>        <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SumPool.next_state-371"><a href="#SumPool.next_state-371"><span class="linenos">371</span></a>            <span class="k">return</span> <span class="n">outcome</span> <span class="o">*</span> <span class="n">count</span>
</span><span id="SumPool.next_state-372"><a href="#SumPool.next_state-372"><span class="linenos">372</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SumPool.next_state-373"><a href="#SumPool.next_state-373"><span class="linenos">373</span></a>            <span class="k">return</span> <span class="n">state</span> <span class="o">+</span> <span class="n">outcome</span> <span class="o">*</span> <span class="n">count</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Add the dice to the running total.</p>
</div>


                            </div>
                            <div id="SumPool.direction" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SumPool.direction">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">direction</span><span class="signature">(self, *pools)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SumPool.direction-375"><a href="#SumPool.direction-375"><span class="linenos">375</span></a>    <span class="k">def</span> <span class="nf">direction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">pools</span><span class="p">):</span>
</span><span id="SumPool.direction-376"><a href="#SumPool.direction-376"><span class="linenos">376</span></a>        <span class="sd">&quot;&quot;&quot; This eval doesn&#39;t care about direction. &quot;&quot;&quot;</span>
</span><span id="SumPool.direction-377"><a href="#SumPool.direction-377"><span class="linenos">377</span></a>        <span class="k">return</span> <span class="mi">0</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>This eval doesn't care about direction.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#EvalPool">EvalPool</a></dt>
                                <dd id="SumPool.final_outcome" class="function"><a href="#EvalPool.final_outcome">final_outcome</a></dd>
                <dd id="SumPool.ndim" class="function"><a href="#EvalPool.ndim">ndim</a></dd>
                <dd id="SumPool.eval" class="function"><a href="#EvalPool.eval">eval</a></dd>
                <dd id="SumPool.bind_dice" class="function"><a href="#EvalPool.bind_dice">bind_dice</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="sum_pool">
                                <div class="attr variable"><a class="headerlink" href="#sum_pool">#&nbsp;&nbsp</a>

        <span class="name">sum_pool</span><span class="default_value"> = &lt;<a href="#SumPool">icepool.SumPool</a> object&gt;</span>
    </div>

    
    

                </section>
                <section id="FindBestSet">
                                <div class="attr class">
        <a class="headerlink" href="#FindBestSet">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">FindBestSet</span><wbr>(<span class="base"><a href="#EvalPool">icepool.EvalPool</a></span>):
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FindBestSet-382"><a href="#FindBestSet-382"><span class="linenos">382</span></a><span class="k">class</span> <span class="nc">FindBestSet</span><span class="p">(</span><span class="n">EvalPool</span><span class="p">):</span>
</span><span id="FindBestSet-383"><a href="#FindBestSet-383"><span class="linenos">383</span></a>    <span class="sd">&quot;&quot;&quot; A `EvalPool` that takes the best matching set in a pool.</span>
</span><span id="FindBestSet-384"><a href="#FindBestSet-384"><span class="linenos">384</span></a><span class="sd">    </span>
</span><span id="FindBestSet-385"><a href="#FindBestSet-385"><span class="linenos">385</span></a><span class="sd">    This prioritizes set size, then the outcome.</span>
</span><span id="FindBestSet-386"><a href="#FindBestSet-386"><span class="linenos">386</span></a><span class="sd">    </span>
</span><span id="FindBestSet-387"><a href="#FindBestSet-387"><span class="linenos">387</span></a><span class="sd">    The outcomes are `(set_size, outcome)`.</span>
</span><span id="FindBestSet-388"><a href="#FindBestSet-388"><span class="linenos">388</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FindBestSet-389"><a href="#FindBestSet-389"><span class="linenos">389</span></a>    
</span><span id="FindBestSet-390"><a href="#FindBestSet-390"><span class="linenos">390</span></a>    <span class="k">def</span> <span class="nf">next_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
</span><span id="FindBestSet-391"><a href="#FindBestSet-391"><span class="linenos">391</span></a>        <span class="sd">&quot;&quot;&quot; Replace the last best set if this one is better. </span>
</span><span id="FindBestSet-392"><a href="#FindBestSet-392"><span class="linenos">392</span></a><span class="sd">        </span>
</span><span id="FindBestSet-393"><a href="#FindBestSet-393"><span class="linenos">393</span></a><span class="sd">        Note the use of tuple comparison, which priortizes elements to the left.</span>
</span><span id="FindBestSet-394"><a href="#FindBestSet-394"><span class="linenos">394</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FindBestSet-395"><a href="#FindBestSet-395"><span class="linenos">395</span></a>        <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FindBestSet-396"><a href="#FindBestSet-396"><span class="linenos">396</span></a>            <span class="k">return</span> <span class="n">count</span><span class="p">,</span> <span class="n">outcome</span>
</span><span id="FindBestSet-397"><a href="#FindBestSet-397"><span class="linenos">397</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FindBestSet-398"><a href="#FindBestSet-398"><span class="linenos">398</span></a>            <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">outcome</span><span class="p">))</span>
</span><span id="FindBestSet-399"><a href="#FindBestSet-399"><span class="linenos">399</span></a>    
</span><span id="FindBestSet-400"><a href="#FindBestSet-400"><span class="linenos">400</span></a>    <span class="k">def</span> <span class="nf">direction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">pools</span><span class="p">):</span>
</span><span id="FindBestSet-401"><a href="#FindBestSet-401"><span class="linenos">401</span></a>        <span class="sd">&quot;&quot;&quot; This eval doesn&#39;t care about direction. &quot;&quot;&quot;</span>
</span><span id="FindBestSet-402"><a href="#FindBestSet-402"><span class="linenos">402</span></a>        <span class="k">return</span> <span class="mi">0</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>A <code><a href="#EvalPool">EvalPool</a></code> that takes the best matching set in a pool.</p>

<p>This prioritizes set size, then the outcome.</p>

<p>The outcomes are <code>(set_size, outcome)</code>.</p>
</div>


                            <div id="FindBestSet.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#FindBestSet.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">FindBestSet</span><span class="signature">()</span>
    </div>

    
    

                            </div>
                            <div id="FindBestSet.next_state" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#FindBestSet.next_state">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">next_state</span><span class="signature">(self, state, outcome, count)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FindBestSet.next_state-390"><a href="#FindBestSet.next_state-390"><span class="linenos">390</span></a>    <span class="k">def</span> <span class="nf">next_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
</span><span id="FindBestSet.next_state-391"><a href="#FindBestSet.next_state-391"><span class="linenos">391</span></a>        <span class="sd">&quot;&quot;&quot; Replace the last best set if this one is better. </span>
</span><span id="FindBestSet.next_state-392"><a href="#FindBestSet.next_state-392"><span class="linenos">392</span></a><span class="sd">        </span>
</span><span id="FindBestSet.next_state-393"><a href="#FindBestSet.next_state-393"><span class="linenos">393</span></a><span class="sd">        Note the use of tuple comparison, which priortizes elements to the left.</span>
</span><span id="FindBestSet.next_state-394"><a href="#FindBestSet.next_state-394"><span class="linenos">394</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FindBestSet.next_state-395"><a href="#FindBestSet.next_state-395"><span class="linenos">395</span></a>        <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FindBestSet.next_state-396"><a href="#FindBestSet.next_state-396"><span class="linenos">396</span></a>            <span class="k">return</span> <span class="n">count</span><span class="p">,</span> <span class="n">outcome</span>
</span><span id="FindBestSet.next_state-397"><a href="#FindBestSet.next_state-397"><span class="linenos">397</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FindBestSet.next_state-398"><a href="#FindBestSet.next_state-398"><span class="linenos">398</span></a>            <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">outcome</span><span class="p">))</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Replace the last best set if this one is better. </p>

<p>Note the use of tuple comparison, which priortizes elements to the left.</p>
</div>


                            </div>
                            <div id="FindBestSet.direction" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#FindBestSet.direction">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">direction</span><span class="signature">(self, *pools)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FindBestSet.direction-400"><a href="#FindBestSet.direction-400"><span class="linenos">400</span></a>    <span class="k">def</span> <span class="nf">direction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">pools</span><span class="p">):</span>
</span><span id="FindBestSet.direction-401"><a href="#FindBestSet.direction-401"><span class="linenos">401</span></a>        <span class="sd">&quot;&quot;&quot; This eval doesn&#39;t care about direction. &quot;&quot;&quot;</span>
</span><span id="FindBestSet.direction-402"><a href="#FindBestSet.direction-402"><span class="linenos">402</span></a>        <span class="k">return</span> <span class="mi">0</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>This eval doesn't care about direction.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#EvalPool">EvalPool</a></dt>
                                <dd id="FindBestSet.final_outcome" class="function"><a href="#EvalPool.final_outcome">final_outcome</a></dd>
                <dd id="FindBestSet.ndim" class="function"><a href="#EvalPool.ndim">ndim</a></dd>
                <dd id="FindBestSet.eval" class="function"><a href="#EvalPool.eval">eval</a></dd>
                <dd id="FindBestSet.bind_dice" class="function"><a href="#EvalPool.bind_dice">bind_dice</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="FindBestRun">
                                <div class="attr class">
        <a class="headerlink" href="#FindBestRun">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">FindBestRun</span><wbr>(<span class="base"><a href="#EvalPool">icepool.EvalPool</a></span>):
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FindBestRun-404"><a href="#FindBestRun-404"><span class="linenos">404</span></a><span class="k">class</span> <span class="nc">FindBestRun</span><span class="p">(</span><span class="n">EvalPool</span><span class="p">):</span>
</span><span id="FindBestRun-405"><a href="#FindBestRun-405"><span class="linenos">405</span></a>    <span class="sd">&quot;&quot;&quot; A `EvalPool` that takes the best run (aka &quot;straight&quot;) in a pool.</span>
</span><span id="FindBestRun-406"><a href="#FindBestRun-406"><span class="linenos">406</span></a><span class="sd">    </span>
</span><span id="FindBestRun-407"><a href="#FindBestRun-407"><span class="linenos">407</span></a><span class="sd">    Outcomes must be `int`s.</span>
</span><span id="FindBestRun-408"><a href="#FindBestRun-408"><span class="linenos">408</span></a><span class="sd">    </span>
</span><span id="FindBestRun-409"><a href="#FindBestRun-409"><span class="linenos">409</span></a><span class="sd">    This prioritizes run size, then the outcome.</span>
</span><span id="FindBestRun-410"><a href="#FindBestRun-410"><span class="linenos">410</span></a><span class="sd">    </span>
</span><span id="FindBestRun-411"><a href="#FindBestRun-411"><span class="linenos">411</span></a><span class="sd">    The outcomes are `(run_size, outcome)`.</span>
</span><span id="FindBestRun-412"><a href="#FindBestRun-412"><span class="linenos">412</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FindBestRun-413"><a href="#FindBestRun-413"><span class="linenos">413</span></a>    
</span><span id="FindBestRun-414"><a href="#FindBestRun-414"><span class="linenos">414</span></a>    <span class="k">def</span> <span class="nf">next_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
</span><span id="FindBestRun-415"><a href="#FindBestRun-415"><span class="linenos">415</span></a>        <span class="sd">&quot;&quot;&quot; Increments the current run if at least one die rolled this outcome,</span>
</span><span id="FindBestRun-416"><a href="#FindBestRun-416"><span class="linenos">416</span></a><span class="sd">        then saves the run to the state.</span>
</span><span id="FindBestRun-417"><a href="#FindBestRun-417"><span class="linenos">417</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FindBestRun-418"><a href="#FindBestRun-418"><span class="linenos">418</span></a>        <span class="n">best_run</span><span class="p">,</span> <span class="n">best_run_outcome</span><span class="p">,</span> <span class="n">run</span><span class="p">,</span> <span class="n">prev_outcome</span> <span class="o">=</span> <span class="n">state</span> <span class="ow">or</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">outcome</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="FindBestRun-419"><a href="#FindBestRun-419"><span class="linenos">419</span></a>        <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="FindBestRun-420"><a href="#FindBestRun-420"><span class="linenos">420</span></a>            <span class="k">if</span> <span class="n">outcome</span> <span class="o">==</span> <span class="n">prev_outcome</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="FindBestRun-421"><a href="#FindBestRun-421"><span class="linenos">421</span></a>                <span class="n">run</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="FindBestRun-422"><a href="#FindBestRun-422"><span class="linenos">422</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FindBestRun-423"><a href="#FindBestRun-423"><span class="linenos">423</span></a>                <span class="n">run</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="FindBestRun-424"><a href="#FindBestRun-424"><span class="linenos">424</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FindBestRun-425"><a href="#FindBestRun-425"><span class="linenos">425</span></a>            <span class="n">run</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="FindBestRun-426"><a href="#FindBestRun-426"><span class="linenos">426</span></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">((</span><span class="n">run</span><span class="p">,</span> <span class="n">outcome</span><span class="p">),</span> <span class="p">(</span><span class="n">best_run</span><span class="p">,</span> <span class="n">best_run_outcome</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">run</span><span class="p">,</span> <span class="n">outcome</span><span class="p">)</span>
</span><span id="FindBestRun-427"><a href="#FindBestRun-427"><span class="linenos">427</span></a>        
</span><span id="FindBestRun-428"><a href="#FindBestRun-428"><span class="linenos">428</span></a>    <span class="k">def</span> <span class="nf">final_outcome</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">final_state</span><span class="p">,</span> <span class="o">*</span><span class="n">pools</span><span class="p">):</span>
</span><span id="FindBestRun-429"><a href="#FindBestRun-429"><span class="linenos">429</span></a>        <span class="sd">&quot;&quot;&quot; Returns the best run. &quot;&quot;&quot;</span>
</span><span id="FindBestRun-430"><a href="#FindBestRun-430"><span class="linenos">430</span></a>        <span class="k">return</span> <span class="n">final_state</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="FindBestRun-431"><a href="#FindBestRun-431"><span class="linenos">431</span></a>    
</span><span id="FindBestRun-432"><a href="#FindBestRun-432"><span class="linenos">432</span></a>    <span class="k">def</span> <span class="nf">direction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">pools</span><span class="p">):</span>
</span><span id="FindBestRun-433"><a href="#FindBestRun-433"><span class="linenos">433</span></a>        <span class="sd">&quot;&quot;&quot; This only considers outcomes in ascending order. &quot;&quot;&quot;</span>
</span><span id="FindBestRun-434"><a href="#FindBestRun-434"><span class="linenos">434</span></a>        <span class="k">return</span> <span class="mi">1</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>A <code><a href="#EvalPool">EvalPool</a></code> that takes the best run (aka "straight") in a pool.</p>

<p>Outcomes must be <code>int</code>s.</p>

<p>This prioritizes run size, then the outcome.</p>

<p>The outcomes are <code>(run_size, outcome)</code>.</p>
</div>


                            <div id="FindBestRun.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#FindBestRun.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">FindBestRun</span><span class="signature">()</span>
    </div>

    
    

                            </div>
                            <div id="FindBestRun.next_state" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#FindBestRun.next_state">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">next_state</span><span class="signature">(self, state, outcome, count)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FindBestRun.next_state-414"><a href="#FindBestRun.next_state-414"><span class="linenos">414</span></a>    <span class="k">def</span> <span class="nf">next_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
</span><span id="FindBestRun.next_state-415"><a href="#FindBestRun.next_state-415"><span class="linenos">415</span></a>        <span class="sd">&quot;&quot;&quot; Increments the current run if at least one die rolled this outcome,</span>
</span><span id="FindBestRun.next_state-416"><a href="#FindBestRun.next_state-416"><span class="linenos">416</span></a><span class="sd">        then saves the run to the state.</span>
</span><span id="FindBestRun.next_state-417"><a href="#FindBestRun.next_state-417"><span class="linenos">417</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FindBestRun.next_state-418"><a href="#FindBestRun.next_state-418"><span class="linenos">418</span></a>        <span class="n">best_run</span><span class="p">,</span> <span class="n">best_run_outcome</span><span class="p">,</span> <span class="n">run</span><span class="p">,</span> <span class="n">prev_outcome</span> <span class="o">=</span> <span class="n">state</span> <span class="ow">or</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">outcome</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="FindBestRun.next_state-419"><a href="#FindBestRun.next_state-419"><span class="linenos">419</span></a>        <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="FindBestRun.next_state-420"><a href="#FindBestRun.next_state-420"><span class="linenos">420</span></a>            <span class="k">if</span> <span class="n">outcome</span> <span class="o">==</span> <span class="n">prev_outcome</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="FindBestRun.next_state-421"><a href="#FindBestRun.next_state-421"><span class="linenos">421</span></a>                <span class="n">run</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="FindBestRun.next_state-422"><a href="#FindBestRun.next_state-422"><span class="linenos">422</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FindBestRun.next_state-423"><a href="#FindBestRun.next_state-423"><span class="linenos">423</span></a>                <span class="n">run</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="FindBestRun.next_state-424"><a href="#FindBestRun.next_state-424"><span class="linenos">424</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FindBestRun.next_state-425"><a href="#FindBestRun.next_state-425"><span class="linenos">425</span></a>            <span class="n">run</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="FindBestRun.next_state-426"><a href="#FindBestRun.next_state-426"><span class="linenos">426</span></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">((</span><span class="n">run</span><span class="p">,</span> <span class="n">outcome</span><span class="p">),</span> <span class="p">(</span><span class="n">best_run</span><span class="p">,</span> <span class="n">best_run_outcome</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">run</span><span class="p">,</span> <span class="n">outcome</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Increments the current run if at least one die rolled this outcome,
then saves the run to the state.</p>
</div>


                            </div>
                            <div id="FindBestRun.final_outcome" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#FindBestRun.final_outcome">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">final_outcome</span><span class="signature">(self, final_state, *pools)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FindBestRun.final_outcome-428"><a href="#FindBestRun.final_outcome-428"><span class="linenos">428</span></a>    <span class="k">def</span> <span class="nf">final_outcome</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">final_state</span><span class="p">,</span> <span class="o">*</span><span class="n">pools</span><span class="p">):</span>
</span><span id="FindBestRun.final_outcome-429"><a href="#FindBestRun.final_outcome-429"><span class="linenos">429</span></a>        <span class="sd">&quot;&quot;&quot; Returns the best run. &quot;&quot;&quot;</span>
</span><span id="FindBestRun.final_outcome-430"><a href="#FindBestRun.final_outcome-430"><span class="linenos">430</span></a>        <span class="k">return</span> <span class="n">final_state</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Returns the best run.</p>
</div>


                            </div>
                            <div id="FindBestRun.direction" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#FindBestRun.direction">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">direction</span><span class="signature">(self, *pools)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FindBestRun.direction-432"><a href="#FindBestRun.direction-432"><span class="linenos">432</span></a>    <span class="k">def</span> <span class="nf">direction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">pools</span><span class="p">):</span>
</span><span id="FindBestRun.direction-433"><a href="#FindBestRun.direction-433"><span class="linenos">433</span></a>        <span class="sd">&quot;&quot;&quot; This only considers outcomes in ascending order. &quot;&quot;&quot;</span>
</span><span id="FindBestRun.direction-434"><a href="#FindBestRun.direction-434"><span class="linenos">434</span></a>        <span class="k">return</span> <span class="mi">1</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>This only considers outcomes in ascending order.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#EvalPool">EvalPool</a></dt>
                                <dd id="FindBestRun.ndim" class="function"><a href="#EvalPool.ndim">ndim</a></dd>
                <dd id="FindBestRun.eval" class="function"><a href="#EvalPool.eval">eval</a></dd>
                <dd id="FindBestRun.bind_dice" class="function"><a href="#EvalPool.bind_dice">bind_dice</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="d2">
                                <div class="attr variable"><a class="headerlink" href="#d2">#&nbsp;&nbsp</a>

        <span class="name">d2</span>
    </div>

    
    

                </section>
                <section id="d3">
                                <div class="attr variable"><a class="headerlink" href="#d3">#&nbsp;&nbsp</a>

        <span class="name">d3</span>
    </div>

    
    

                </section>
                <section id="d4">
                                <div class="attr variable"><a class="headerlink" href="#d4">#&nbsp;&nbsp</a>

        <span class="name">d4</span>
    </div>

    
    

                </section>
                <section id="d6">
                                <div class="attr variable"><a class="headerlink" href="#d6">#&nbsp;&nbsp</a>

        <span class="name">d6</span>
    </div>

    
    

                </section>
                <section id="d8">
                                <div class="attr variable"><a class="headerlink" href="#d8">#&nbsp;&nbsp</a>

        <span class="name">d8</span>
    </div>

    
    

                </section>
                <section id="d10">
                                <div class="attr variable"><a class="headerlink" href="#d10">#&nbsp;&nbsp</a>

        <span class="name">d10</span>
    </div>

    
    

                </section>
                <section id="d12">
                                <div class="attr variable"><a class="headerlink" href="#d12">#&nbsp;&nbsp</a>

        <span class="name">d12</span>
    </div>

    
    

                </section>
                <section id="d20">
                                <div class="attr variable"><a class="headerlink" href="#d20">#&nbsp;&nbsp</a>

        <span class="name">d20</span>
    </div>

    
    

                </section>
                <section id="d100">
                                <div class="attr variable"><a class="headerlink" href="#d100">#&nbsp;&nbsp</a>

        <span class="name">d100</span>
    </div>

    
    

                </section>
    </main>
</body>
</html>